{"id": "S0168874X15000931", "article": "MAIN-TITLE Second-order spread-of-plasticity approach for nonlinear time-history analysis of space semi-rigid steel frames   HIGHLIGHTS          Second-order spread-of-plasticity response of 3D semi-rigid steel frames is studied.      Second-order effects are considered by stability functions, save computational time.      Geometric, material and connection nonlinearities are taken into account.      Three major sources of damping of steel frames are considered simultaneously.      A solution procedure for nonlinear differential equations of motion is developed.          KEYPHRASES   Geometric nonlinearity  Nonlinear time-history analysis  Stability functions  Spread of plasticity  Semi-rigid connections  Steel frames   In conventional analysis and design, beam-to-column connections are usually assumed to be fully rigid or ideally pinned joints. The real behavior of beam-to-column connections is a nonlinear curve which depends on the configuration of connections. Such connections are called semi-rigid connections which play a role in transfering a part of moments from elements to other ones while the rest is resisted by themselves. The experimental studies showed that semi-rigid steel frames feature ductile and stable hysteretic behavior when the connections are designed appropriately [1\u20134]. The energy is dissipated through hysteretic loops of semi-rigid connections, which are one of the important damping sources of structures.  There are two common nonlinear analytical approaches for space steel framed structures: the plastic hinge methods (concentrated plasticity) [5\u201312] and the plastic zone methods (distributed plasticity) [13\u201317]. The plastic hinge methods [7\u201312] using stability functions obtained from the closed-form solution of the beam\u2013column element subjected to end forces can accurately capture the second-order effects using only one or two elements per member. Material nonlinearity is considered by the lumped plastic hinges at the two ends of the member. The effects of distributed plasticity and residual stress are indirectly taken into account by using the reduced tangent modulus approach. However, the plastic hinge methods are limited due to their incapability of capturing the more complex member behaviors that involve torsional\u2013flexural buckling, local buckling, and severe yielding under the combined action of compression and bi-axial bending, which may significantly reduce the load-carrying capacity of a structure [14]. Furthermore, the hinge methods have shown to over-estimate the limit strength when structural behavior is dominated by the instability of a few members [18]. Also, it may inadequately give information as to what is happening inside the member because the member is assumed to remain fully elastic between its ends. In the meanwhile, the plastic zone methods based on interpolation shape functions requires members to be divided into several elements to accurately predict the second-order effects and spread-of-plasticity behavior of steel framed structures. It is generally recognized to be an \u201cexact\u201d and computationally expensive solution compared with the plastic hinge methods.  In recent years, Alemdar and White [15] presented several beam\u2013column finite element formulations for full nonlinear distributed plasticity analysis of planar frame structures. The fundamental processes within the derivation of displacement-based, flexibility-based, and mixed element methods using Hermitian cubic polynomial functions are summarized. These formulations are presented using a total Lagrangian corotational approach and are also applicable to general beam\u2013column elements for space structural analysis. Chiorean [16] proposed a beam\u2013column method for nonlinear inelastic analysis of 3D semi-rigid steel frames. The nonlinear inelastic force\u2013strain relationship and stability functions are used in representing the inelastic behavior and second-order effects, respectively. The advantage of this study is its ability to trace the spread of plasticity along the member length by using only one beam\u2013column element per framed member in analysis modeling. However, it seems that the shape parameters a and n of the Ramberg\u2013Osgood model and \u03b1 and p of the proposed modified Albermani model for the force\u2013strain relationship of the cross-section, which considerably affect the inelastic behavior of the steel frames, are not consistently used. Mazza [19] proposed a distributed plasticity model which a frame member are simulated by two plastic-zone segments with lengths   l   P i   ,    l   P j   at the ends of the member and one elastic segment with length l at the middle. This method cannot accurately simulate spread of plasticity along the length of the member. To overcome the limitations of the above mentioned studies, this study will develop a fiber beam\u2013colum element based on stability functions for nonlinear inelastic time-history analysis of space steel frames with semi-rigid connections.  This study presents a second-order spread-of-plasticity approach for nonlinear time-history analysis of space semi-rigid steel frames. The second-order effects are considered by the use of stability functions obtained from the closed-form solution of the beam\u2013column element subjected to axial force and bending moments at the two ends. The spread of plasticity over the cross section and along the member length is captured by tracing uniaxial stress\u2013strain relations of each fiber on the cross sections located at the selected integration points along the member length. Warping torsion and lateral\u2013torsional buckling are ignored. An independent zero-length connection element with six translational and rotational springs is developed for beam-to-column joints with various connection types. This is efficient because modification of the beam\u2013column stiffness matrix considering semi-rigid connections is unnecessary and the connection is ready to integrate with any element type. The Kishi\u2013Chen three-parameter power model [20] and the Richard\u2013Abbott four-parameter model [21] are applied for representing the moment\u2013rotation relationship and predicting the instantaneous stiffness of connections. A numerical procedure based on the Hilber\u2013Hughes\u2013Taylor method combined with the Newton\u2013Raphson method is developed to solve nonlinear differential equations of motion. Several numerical examples are presented to verify the accuracy, efficiency, and applicability of the proposed proceduce in predicting nonlinear inelastic time-history responses of space steel frames with semi-rigid connections.  To capture the effect of axial force acting on bending moment through the lateral displacement of the beam\u2013column element (P-small delta effect), the stability functions reported by Chen and Lui [22] are used to minimize modeling and solution time. Generally, only one element per member is needed to accurately capture the P-small delta effect. From Kim and Choi [8], the incremental force\u2013displacement equation of space beam\u2013column element accounting for transverse shear deformation effects can be expressed as  (1)   {      \u0394 P       \u0394   M   y A         \u0394   M   y B         \u0394   M   z A         \u0394   M   z B         \u0394 T      }  =  [        E A  L     0   0   0   0   0     0      C   1 y         C   2 y      0   0   0     0      C   2 y         C   1 y      0   0   0     0   0   0      C   1 z         C   2 z      0     0   0   0      C   2 z         C   1 z      0     0   0   0   0   0      G J  L       ]   {      \u0394 \u03b4       \u0394   \u03b8   y A         \u0394   \u03b8   y B         \u0394   \u03b8   z A         \u0394   \u03b8   z B         \u0394 \u03d5      }    where \u0394 P , \u0394   M   y A   , \u0394   M   y B   , \u0394   M   z A   , \u0394   M   z B   , and \u0394 T are the incremental axial force, end moments with respect to y and z axes, and torsion, respectively; \u0394 \u03b4 , \u0394   \u03b8   y A   , \u0394   \u03b8   y B   , \u0394   \u03b8   z A   , \u0394   \u03b8   z B   , and \u0394 \u03d5 are the incremental axial displacement, joint rotations, and angle of twist, respectively; E , G and J are the elastic modulus and shear modulus of a material and the torsional constant of a cross section respectively;   C   1 y   ,   C   2 y   ,   C   1 z   , and   C   2 z   are bending stiffness coefficients accounting for the transverse shear deformation effects and are defined as  (2)    C   1 y   =     k   1 y   2   \u2212   k   2 y   2   +   k   1 y     A   s z   G L   2   k   1 y   + 2   k   2 y   +   A   s z   G L        (3)    C   2 y   =   \u2212   k   1 y   2   +   k   2 y   2   +   k   2 y     A   s z   G L   2   k   1 y   + 2   k   2 y   +   A   s z   G L        (4)    C   1 z   =     k   1 z   2   \u2212   k   2 z   2   +   k   1 z     A   s y   G L   2   k   1 z   + 2   k   2 z   +   A   s y   G L        (5)    C   2 z   =   \u2212   k   1 z   2   +   k   2 z   2   +   k   2 y     A   s y   G L   2   k   1 z   + 2   k   2 z   +   A   s y   G L     where   k   1 n   =   S   1 n    (  E   I   n   / L  )  and   k   2 n   =   S   2 n    (  E   I   n   / L  )  ;   S   1 n   and   S   2 n   are stability functions with respect to the axis of n   (  n = y , z  ) and are expressed as  (6)    S   1 n   =  {          k   n   L  sin  (    k   n   L  )  \u2212   (    k   n   L  )  2   cos  (    k   n   L  )    2 \u2212 2  cos  (    k   n   L  )  \u2212   k   n   L  sin  (    k   n   L  )        if  P < 0           (    k   n   L  )  2   cosh  (    k   n   L  )  \u2212   k   n   L  sinh  (    k   n   L  )    2 \u2212 2  cosh  (    k   n   L  )  +   k   n   L  sinh  (    k   n   L  )        if  P > 0            (7)    S   2 n   =  {          (    k   n   L  )  2  \u2212   k   n   L  sin  (    k   n   L  )    2 \u2212 2  cos  (    k   n   L  )  \u2212   k   n   L  sin  (    k   n   L  )        if  P < 0           k   n   L  sin  (    k   n   L  )  \u2212   (    k   n   L  )  2    2 \u2212 2  cosh  (    k   n   L  )  +   k   n   L  sinh  (    k   n   L  )        if  P > 0         where   k   n   2   =   | P |  /  E   I   n     . E A and E   I   n   denote the axial and bending stiffness of the beam\u2013column element and are integrated as follows:  (8)  E A =    \u2211  j = 1  s     w   j    (   \u2211  i = 1  m     E   i     A   i     )     j        (9)  E   I   y   =    \u2211  j = 1  s     w   j    [   \u2211  i = 1  m     E   i    (    A   i     z   i   2   +   I   y i    )    ]     j        (10)  E   I   z   =    \u2211  j = 1  s     w   j    [   \u2211  i = 1  m     E   i    (    A   i     y   i   2   +   I   z i    )    ]     j     in which s is the total number of monitored sections along an element; m is the total number of fibers divided on the monitored cross-section;   w   j   is the weight coefficient for Lobatto quadrature at the j th section [23];   E   i   and   A   i   are the elastic modulus of the material and the area of i th fiber, respectively;   I   y i   and   I   z i   are the y- and z-axis moment of inertia of i th fiber around its centroid;   y   i   and   z   i   are the coordinates of i th fiber to the centroidal bending axis of the cross-section as shown in Fig. 1. The element force\u2013deformation relationship of Eq. (1) can be expressed in symbolic form as  (11)   {  \u0394 F  }  =  [    K   e    ]   {  \u0394 d  }    where  (12)   {  \u0394 F  }  =   [      \u0394 P     \u0394   M   y A       \u0394   M   y B       \u0394   M   z A       \u0394   M   z B       \u0394 T      ]  T       (13)   {  \u0394 d  }  =   [      \u0394 \u03b4     \u0394   \u03b8   y A       \u0394   \u03b8   y B       \u0394   \u03b8   z A       \u0394   \u03b8   z B       \u0394 \u03d5      ]  T       The element stiffness matrix is evaluated numerically by the Gauss\u2013Lobatto integration rules [23]. The Gauss\u2013Lobato scheme with m integration points permits the exact integration of polynomials of degree up to (2m\u22123). This procedure is superior to the classical Gauss integration method, when it is important to include in the integration the end points of the element. Since inelastic behavior in beam\u2013column elements often concentrates at the ends of the member, the monitoring of the end sections of the element is advantageous from the standpoint of accuracy and numerical stability. By contrast, the outermost integration points of other integration methods (e.g., the classical Gauss method, the Legendre\u2013Gauss method, the Newton\u2013Cotes method, etc.) only approach the end sections with increasing order of integration but never coincide with the end sections, hence resulting in overestimation of the member strength [24].  In order to capture the spread of plasticity throughout the member length, a fiber beam\u2013column model as shown in Fig. 1 is used. The fiber beam\u2013column element is divided into a discrete number of monitored sections represented by the integration points. Each monitored section is divided into m small fibers, and each fiber is represented by its geometric characteristic, area   A   i   , and its coordinate location corresponding to its centroid (    y   i   ,   z   i    ) . For hot-rolled steel sections, the residual stresses are assigned directly to fibers as the initial stresses. Fig. 2 illustrates the ECCS residual stress pattern of the I-shape section used for this research [25]. Section deformations are represented by three strain resultants: the axial strain \u03b5 and curvatures   \u03c7   z   and   \u03c7   y   with respect to z and y axes, respectively. The corresponding force resultants are the axial force N and bending moments   M   z   and   M   y   . The section forces and deformations are grouped in the following vectors:  (14)  Section  force  vector   { Q }  =   [     N      M   y         M   z        ]  T       (15)  Section  deformation  vector   { q }  =   [     \u03b5      \u03c7   y         \u03c7   z        ]  T       The incremental section force vector at each integration point is determined based on the incremental element force vector {  \u0394 F  } and the force interpolation function matrix [  B  ( x )   ] given by Taucer et al. [26] as  (16)   {  \u0394 Q  }  =  [  B  ( x )   ]   {  \u0394 F  }       (17)   [  B ( x )  ]  =  [     1   0   0   0   0   0     0    (  x / L \u2212 1  )     x / L    0   0   0     0   0   0    (  x / L \u2212 1  )     x / L    0     ]       The incremental section deformation vector is determined based on the incremental section force vector and the section flexibility matrix as  (18)   {  \u0394 q  }  =   [    k   sec    ]   \u2212 1    {  \u0394 Q  }    where [    k   sec    ] is the section stiffness matrix given as  (19)   [    k   sec    ]  =  [       \u2211  i = 1  m     E   i     A   i         \u2211  i = 1  m     E   i     A   i     z   i        \u2212  \u2211  i = 1  m     E   i     A   i     y   i           \u2211  i = 1  m     E   i     A   i     z   i         \u2211  i = 1  m     E   i    (    A   i     z   i   2   +   I   y i    )       \u2212  \u2211  i = 1  m     E   i     A   i     y   i     z   i          \u2212  \u2211  i = 1  m     E   i     A   i     y   i        \u2212  \u2211  i = 1  m     E   i     A   i     y   i     z   i         \u2211  i = 1  m     E   i    (    A   i     y   i   2   +   I   z i    )        ]       Applying the assumption that plane sections remain plane after deformation and normal to the reference axis of the member (with the exception of warping deformations due to non-uniform torsion), the incremental longitudinal fiber strain vector is calculated from the incremental section deformation vector as  (20)   {  \u0394 e  }  =  [ l ]   {  \u0394 q  }    where [ l ] is the linear geometric matrix given as follows:  (21)   [ l ]  =  [     1      z   1       \u2212   y   1        1      z   2       \u2212   y   2        \u2026   \u2026   \u2026     1      z   m       \u2212   y   m        ]       Once the incremental fiber strain is evaluated, the incremental fiber stress is computed based on an appropriate stress\u2013strain constitutive law for material.  The section resisting forces are computed by integrating the axial force and biaxial bending moment contributions of all fibers as  (22)   {    Q   R    }  =  {     N        M   y           M   z        }  =  {       \u2211  i = 1  m     \u03c3   i      A   i          \u2211  i = 1  m     \u03c3   i      A   i     z   i         \u2212  \u2211  i = 1  m     \u03c3   i      A   i     y   i        }    where   \u03c3   i   is the normal stress of i th fiber accumulated from the incremental fiber stress itself. If the fiber is yielding, its normal stress will be assigned equal to the yield stress of steel   \u03c3   i   =   \u03c3   y   .  In this study, the elastic\u2013perfectly plastic model without strain hardening and cracking, in which tensile yielding stress is equal to compressive yielding stress, is adopted for steel materials. In the cyclic loading procedure, each steel fiber is monitored and traced by the isotropic hardening rule as illustrated in Fig. 3. Yielding stress is assumed to be no changes throughout cyclic loading, unloading and reloading. From observing the stress\u2013strain relationship (shown in Fig. 3), it is seen that the last yielding position of each fiber must be saved for calculating the next yielding position under unloading or reloading. The elastic modulus of each fiber   E   i   will either be equal to the initial elastic modulus or be equal to zero for yielding fibers. By updating during the iteration process, axial and bending stiffness of each cross-section (Eq. (19)) obtained in this way are then integrated along the member length by Eqs. (8)\u2013(10) to form the element tangent stiffness accounting for spread of plasticity.  The P-large delta effect is the influence of axial force P acting through the relative transverse displacement of the member ends. This effect can be considered by using the geometric stiffness matrix [    K   g    ] as  (23)    [    K   g    ]   12 \u00d7 12   =  [      [    K   s    ]     \u2212  [    K   s    ]        \u2212   [    K   s    ]  T      [    K   s    ]      ]    where  (24)   [    K   s    ]  =  [     0   a    \u2212 b    0   0   0     a   c   0   0   0   0      \u2212 b    0   c   0   0   0     0   0   0   0   0   0     0   0   0   0   0   0     0   0   0   0   0   0     ]       (25)  a =     M   z A   +   M   z B       L  2    ,  b =     M   y A   +   M   y B       L  2    ,  c =  P L  .      The displacement of a beam\u2013column element can be decomposed into two parts: the element deformation and rigid displacement. The incremental element deformation {  \u0394 d  } in Eq. (13) can be obtained from the incremental element displacement {  \u0394 D  } as  (26)   {  \u0394 d  }  =   [ T ]   6 \u00d7 12    {  \u0394 D  }    where   [ T ]   6 \u00d7 12   is the transformation matrix of the beam\u2013column element  (27)    [ T ]   6 \u00d7 12   =  [      \u2212 1    0   0   0   0   0   1   0   0   0   0   0     0   0    \u2212 1 / L    0   1   0   0   0    1 / L    0   0   0     0   0    \u2212 1 / L    0   0   0   0   0    1 / L    0   1   0     0    1 / L    0   0   0   1   0    \u2212 1 / L    0   0   0   0     0    1 / L    0   0   0   0   0    \u2212 1 / L    0   0   0   1     0   0   0   1   0   0   0   0   0    \u2212 1    0   0     ]       The tangent stiffness matrix of a nonlinear beam\u2013column element is obtained as follows:  (28)    [ K ]   12 \u00d7 12   =   [ T ]   6 \u00d7 12   T     [    K   e    ]   6 \u00d7 6     [ T ]   6 \u00d7 12   +   [    K   g    ]   12 \u00d7 12          Fig. 4 illustrates an integrated example of different stiffness components of structural members to clearly demonstrate how to formulate the numerical approach.  An independent zero-length multi-spring element with three translational and three rotational components is developed to simulate the connection of various elements. The multi-spring element can be used to connect two nodes with the same coordinate (  i \u2261 j  ) as illustrated in Fig. 5. Since the purpose of this study is mainly to verify the bending moment transference in the major and minor axes of the beam\u2013column element, the translational and torsional deformation components of the connection are prevented by modeling fully rigid springs in all numerical examples. The coupling effects between the six springs in a connection are also neglected.  The relation between the incremental force vector {  \u0394   F   s    } and incremental deformation vector {  \u0394   u   s    } of the multi-spring connection element is given by  (29)   {  \u0394   F   s    }  =  [    K   e s    ]   {  \u0394   u   s    }       (30)   [    K   e s    ]  =  [        R   x   \u03b4      0   0   0   0   0     0      R   y   \u03b4      0   0   0   0     0   0      R   z   \u03b4      0   0   0     0   0   0      R   y   \u03b8      0   0     0   0   0   0      R   z   \u03b8      0     0   0   0   0   0      R   x   \u03b8        ]       (31)   {  \u0394   F   s    }  =   [      \u0394   P   x       \u0394   P   y       \u0394   P   z       \u0394   M   y       \u0394   M   z       \u0394   M   x        ]  T       (32)   {  \u0394   u   s    }  =   [      \u0394   \u03b4   x       \u0394   \u03b4   y       \u0394   \u03b4   z       \u0394   \u03b8   y       \u0394   \u03b8   z       \u0394   \u03b8   x        ]  T    where [    K   e s    ] is the diagonal stiffness matrix of the connection element;   R   n   \u03b4   and   R   n   \u03b8   are the component stiffness of the translational and rotational springs with respect to the axis of n   (  n = x , y , z  ) ; \u0394   P   n   , \u0394   M   n   , \u0394   \u03b4   n   , and \u0394   \u03b8   n   are the incremental spring forces, moments, axial deformations, and bending deformations of the connection element with respect to the axis of n   (  n = x , y , z  ) , respectively. The instantaneous tangent stiffness of the major and minor-axis rotational springs (   R   z   \u03b8   and   R   y   \u03b8   ) is given by  (33)    R   n   \u03b8   =   d M   d  |    \u03b8   r    |      where the moment M is a nonlinear mathematical function following the relative rotation   \u03b8   r   at the connection represented by the Kishi\u2013Chen three-parameter power model [20] and the Richard\u2013Abbott four-parameter model [21].  The Kishi\u2013Chen model [20] is currently one of the most popular models used for semi-rigid connections since it needs only three parameters to capture the moment\u2013rotation curve and always yields a positive stiffness. The moment\u2013rotation relationship and instantaneous stiffness of the connection are presented by Chen and Kishi as follows:  (34)  M =     R   k i    |    \u03b8   r    |      [  1 +   (   |    \u03b8   r    |  /    \u03b8   0     )  n   ]   1 / n          (35)    R   k t   =   d M   d  |    \u03b8   r    |    =     R   k i       [  1 +    \u03b8   r   n   ]    (  n + 1  )  / n       where M and   \u03b8   r   are the moment and the rotation of the connection, respectively, n is the shape parameter,   \u03b8   0   = (   M   u   /   R   k i   ) is the reference plastic rotation,   R   k i   is the initial connection stiffness, and   M   u   is the ultimate moment of the connection.  Richard and Abbott proposed a four-parameter model [21]. The moment\u2013rotation relationship and instantaneous stiffness of the connection are defined by  (36)  M =    (    R   k i   \u2212   R   k p    )   |    \u03b8   r    |      {  1 +   |     (    R   k i   \u2212   R   k p    )   |    \u03b8   r    |      M   0      |  n   }   1 / n     +   R   k p    |    \u03b8   r    |       (37)    R   k t   =   d M   d  |    \u03b8   r    |    =   (    R   k i   \u2212   R   k p    )     {  1 +   |     (    R   k i   \u2212   R   k p    )   |    \u03b8   r    |      M   0      |  n   }    (  n + 1  )  / n     +   R   k p     where M and   \u03b8   r   are the moment and the rotation of the connection, respectively, n is the shape parameter,   R   k i   is the initial connection stiffness, and   R   k p   is the strain-hardening stiffness, and   M   0   is the reference moment.  The incremental connection element deformation {  \u0394   u   s    } in Eq. (32) can be obtained from the incremental connection element displacement {  \u0394   U   s    } as  (38)   {  \u0394   u   s    }  =   [    T   s    ]   6 \u00d7 12    {  \u0394   U   s    }    where,   [    T   s    ]   6 \u00d7 12   is the transformation matrix of the connection element  (39)    [    T   s    ]   6 \u00d7 12   =  [      \u2212 1    0   0   0   0   0   1   0   0   0   0   0     0    \u2212 1    0   0   0   0   0   1   0   0   0   0     0   0    \u2212 1    0   0   0   0   0   1   0   0   0     0   0   0   0    \u2212 1    0   0   0   0   0   1   0     0   0   0   0   0    \u2212 1    0   0   0   0   0   1     0   0   0    \u2212 1    0   0   0   0   0   1   0   0     ]       The tangent stiffness matrix of a nonlinear connection element used for assembling the global structural stiffness matrix is obtained as follows:  (40)    [    K   S    ]   12 \u00d7 12   =   [    T   s    ]   6 \u00d7 12   T     [    K   e s    ]   6 \u00d7 6     [    T   s    ]   6 \u00d7 12        The independent hardening model [27] shown in Fig. 6 is used to represent the cyclic behavior of semi-rigid connections because of its simple application. Therefore, the virgin M \u2212   \u03b8   r   relationship defined by the connection models in Eqs. (34)\u2013(36) will be no changes and repeated many times throughout hysteretic loops under cyclic excitations. The instantaneous tangent stiffness of the connection is determined by Eqs. (35)\u2013(37). Hysteretic behavior of semi-rigid connections is as follows:  (1) If a connection is initially loaded, M \u22c5 \u0394 M is positive and the M \u2212   \u03b8   r   curve follows the curve OA with the initial stiffness   R   k i   shown in Fig. 6. The instantaneous tangent stiffness will be   R   k t   .  At point A, if the connection is unloaded, M \u22c5 \u0394 M is negative and the M \u2212   \u03b8   r   curve goes back along the line ABC with the initial stiffness   R   k i   . Especially if the connection is unloaded from point A to point B, and then the connection is reloaded, M \u22c5 \u0394 M is positive and the M \u2212   \u03b8   r   curve goes back along the line BAG corresponding to the initial stiffness   R   k i   on the straight line BA and the instantaneous tangent stiffness   R   k t   on the curve AG, respectively.  At point C, if the connection is continuously unloaded, M \u22c5 \u0394 M is positive and the M \u2212   \u03b8   r   curve follows the curve CD with the initial stiffness   R   k i   followed by the tangent stiffness   R   k t   .  At point D, if the connection is reloaded, M \u22c5 \u0394 M is negative and the M \u2212   \u03b8   r   curve follows the straight line DE with the initial stiffness   R   k i   .  At point E, if the connection is continuously reloaded, the M \u2212   \u03b8   r   curve follows the curve EF which is similar to the curve OA.  At point F, the connection shows a similar curve to steps (1)\u2013(5). It is noted that the curves as OAG, CD, EF, etc. have the instantaneous tangent stiffness   R   k t   = ( d M / d  |    \u03b8   r    |  ) (Eqs. (35) or (37)), because the independent hardening model is assumed for the cyclic behavior of the connection, hence, when moment of the connection transfers from positive to negative branch or vice versa, the M \u2212   \u03b8   r   curve of the connection is repeated as the original relationship.  A nonlinear algorithm based on the Hilber\u2013Hughes\u2013Taylor (HHT) method [28] (also known as the alpha method) is developed for solving governing differential equations of motion because the HHT method possesses unconditional numerical stability and second-order accuracy. In addition, it can induce numerical damping in the nonlinear solution which is impossible with the Newmark-beta method [29]. The incremental equation of motion of a structure can be modified as  (41)      [ M ]   {  \u0394    D \u00a8    t + \u0394 t    }  +  (  1 + \u03b1  )   [ C ]   {  \u0394    D \u0307    t + \u0394 t    }  +  (  1 + \u03b1  )   [    K   T    ]   {  \u0394   D   t + \u0394 t    }      = \u2026  {  \u0394   F   e x t   t + \u0394 t    }  + \u03b1  [ C ]   {  \u0394    D \u0307    t    }  + \u03b1  [    K   T    ]   {  \u0394   D   t    }       where the dissipation coefficient of \u03b1 \u2208  [  \u2212   1 3   , 0  ]  for accuracy and numerical stability; {  \u0394  D \u00a8   } , {  \u0394  D \u0307   } , and {  \u0394 D  } are the vectors of incremental acceleration, velocity, and displacement, respectively; [ M ] , [ C ] , and [    K   T    ] are mass, damping, and tangent stiffness matrices, respectively; {  \u0394   F   ext    } is the external incremental load vector; and, subscripts t and t+\u0394t are used to distinguish the values at times t and t+\u0394t. The structural viscous damping matrix [ C ] can be defined as Rayleigh damping [30]:  (42)   [ C ]  =   \u03b1   M    [ M ]  +   \u03b2   K    [ K ]    where   \u03b1   M   and   \u03b2   K   are the coefficients of mass- and stiffness-proportional damping, respectively. If both modes are assumed to have the same damping ratio \u03be, then  (43)    \u03b1   M   = \u03be   2   \u03c9   1     \u03c9   2       \u03c9   1   +   \u03c9   2     ,    \u03b2   K   = \u03be  2    \u03c9   1   +   \u03c9   2       where \u03c9 1 and \u03c9 2 are the natural frequencies of the first and second modes of the frame, respectively.  Using Newmark\u05f3s approximate equations in standard form as shown in [29] and using coefficients \u03b3 = ( 1 / 2 ) \u2212 \u03b1 and \u03b2 =   (  1 \u2212 \u03b1  )  2  / 4 proposed by Hughes [31], we have:  (44)   {    D   t + \u0394 t    }  =  {    D   t    }  + \u0394 t  {     D \u0307    t    }  +  (   1 2  \u2212 \u03b2  )  \u0394   t  2   {     D \u00a8    t    }  + \u03b2 \u22c5 \u0394   t  2   {     D \u00a8    t + \u0394 t    }       (45)   {     D \u0307    t + \u0394 t    }  =  {     D \u0307    t    }  +  (  1 \u2212 \u03b3  )  \u0394 t  {     D \u00a8    t    }  + \u03b3 \u22c5 \u0394 t  {     D \u00a8    t + \u0394 t    }       Transforming Eqs. (44) and (45), the incremental velocity and acceleration vectors at the first iteration of each time step can be written as  (46)   {  \u0394    D \u0307    t + \u0394 t    }  =  \u03b3  \u03b2 \u22c5 \u0394 t    {  \u0394   D   t + \u0394 t    }  \u2212  \u03b3 \u03b2   {     D \u0307    t    }  +  (  1 \u2212  \u03b3  2 \u03b2    )  \u0394 t  {     D \u00a8    t    }       (47)   {  \u0394    D \u00a8    t + \u0394 t    }  =  1  \u03b2 \u22c5 \u0394   t  2     {  \u0394   D   t + \u0394 t    }  \u2212  1  \u03b2 \u22c5 \u0394 t    {     D \u0307    t    }  \u2212  1  2 \u03b2    {     D \u00a8    t    }       Substituting Eqs. (46) and (47) into Eq. (41), the incremental displacement vector can be calculated from  (48)   [  K ^  ]   {  \u0394   D   t + \u0394 t    }  =  {  \u0394  F ^   }    where [  K ^  ] and {  \u0394  F ^   } are the effective stiffness matrix and incremental effective force vector, respectively, given as  (49)   [  K ^  ]  =  (  1 + \u03b1  )   [    K   T    ]  +  (  1 + \u03b1  )   \u03b3  \u03b2 \u22c5 \u0394 t    [ C ]  +  1  \u03b2 \u22c5 \u0394   t  2     [ M ]       (50)   {  \u0394  F ^   }  =  {  \u0394   F   t + \u0394 t    }  + \u03b1  [    K   T    ]   {  \u0394   D   t    }  +  [ M ]   {   1  \u03b2 \u22c5 \u0394 t    {     D \u0307    t    }  +  1  2 \u03b2    {     D \u00a8    t    }   }  +  [ C ]   {   (  1 + \u03b1  )   \u03b3 \u03b2   {     D \u0307    t    }  \u2212  (  1 + \u03b1  )   (  1 \u2212  \u03b3  2 \u03b2    )  \u0394 t  {     D \u00a8    t    }  + \u03b1  {  \u0394    D \u0307    t    }   }       Unbalanced forces in each time step can be eliminated by using the well-known Newton\u2013Raphson iterative method. At the first iteration of each time step, the total displacement, velocity and acceleration at the time t + \u0394 t are updated based on the incremental displacement {  \u0394   D   t + \u0394 t    } as follows:  (51)   {    D   t + \u0394 t    }  =  {    D   t    }  +  {  \u0394   D   t + \u0394 t    }       (52)   {     D \u0307    t + \u0394 t    }  =  (  1 \u2212  \u03b3  2 \u03b2    )  \u0394 t  {     D \u00a8    t    }  +  (  1 \u2212  \u03b3 \u03b2   )   {     D \u0307    t    }  +  \u03b3  \u03b2 \u22c5 \u0394 t    {  \u0394   D   t + \u0394 t    }       (53)   {     D \u00a8    t + \u0394 t    }  =  (  1 \u2212  1  2 \u03b2    )   {     D \u00a8    t    }  \u2212  1  \u03b2 \u22c5 \u0394 t    {     D \u0307    t    }  +  1  \u03b2 \u22c5 \u0394   t  2     {  \u0394   D   t + \u0394 t    }       For the second and subsequent iterations of each time step, the structural system is solved under the effect of the unbalanced force vector { R } as  (54)    [  K ^  ]   k     {  \u03b4 \u0394   D   t + \u0394 t    }   k + 1   =   { R }   k     where the effective stiffness matrix   [  K ^  ]   k   and the residual force vector   { R }   k   are calculated at the unbalanced iterative step k, respectively, as follows:  (55)    [  K ^  ]   k   =  (  1 + \u03b1  )    [    K   T    ]   k   +  (  1 + \u03b1  )   \u03b3  \u03b2 \u22c5 \u0394 t    [ C ]  +  1  \u03b2 \u22c5 \u0394   t  2     [ M ]       (56)    { R }   k   =  {    F   e x t   t + \u0394 t    }  \u2212   {    F   int    }   k   \u2212   {    F   d a m    }   k   \u2212   {    F   i n e    }   k     where {    F   e x t   t + \u0394 t    } is the total external force vector. The inertial force vector   {    F   i n e    }   k   , the damping force vector   {    F   d a m    }   k   , and the updated internal force vector   {    F   int    }   k   at the unbalanced iterative step k are respectively defined as  (57)    {    F   i n e    }   k   =  [ M ]    {     D \u00a8    t + \u0394 t    }   k        (58)    {    F   d a m    }   k   =  [ C ]    {     D \u0307    \u03b1   t + \u0394 t    }   k        (59)    {    F   int    }   k   =  {    F   int    (    {    D   \u03b1   t + \u0394 t    }   k    )   }    where the displacement vector and the velocity vector at the intermediate time are given by  (60)    {    D   \u03b1   t + \u0394 t    }   k   =  (  1 + \u03b1  )    {    D   t + \u0394 t    }   k   \u2212 \u03b1  {    D   t    }       (61)    {     D \u0307    \u03b1   t + \u0394 t    }   k   =  (  1 + \u03b1  )    {     D \u0307    t + \u0394 t    }   k   \u2212 \u03b1  {     D \u0307    t    }       At each iterative step, the state of each fiber and characteristic of a cross section of each beam\u2013column element, stiffness of each multi-spring connection element are updated for assembling the new structural stiffness matrix. Once the convergence criterion is satisfied, the structural response history is saved for the next time step as  (62)    {  \u0394   D   t + \u0394 t    }   k + 1   =   {  \u0394   D   t + \u0394 t    }   k   +   {  \u03b4 \u0394   D   t + \u0394 t    }   k + 1        (63)   {    D   t + \u0394 t    }  =   {    D   t + \u0394 t    }   k + 1   =  {    D   t    }  +   {  \u0394   D   t + \u0394 t    }   k + 1        (64)   {     D \u0307    t + \u0394 t    }  =   {     D \u0307    t + \u0394 t    }   k + 1   =  (  1 \u2212  \u03b3  2 \u03b2    )  \u0394 t  {     D \u00a8    t    }  +  (  1 \u2212  \u03b3 \u03b2   )   {     D \u0307    t    }  +  \u03b3  \u03b2 \u22c5 \u0394 t     {  \u0394   D   t + \u0394 t    }   k + 1        (65)   {     D \u00a8    t + \u0394 t    }  =   {     D \u00a8    t + \u0394 t    }   k + 1   =  (  1 \u2212  1  2 \u03b2    )   {     D \u00a8    t    }  \u2212  1  \u03b2 \u22c5 \u0394 t    {     D \u0307    t    }  +  1  \u03b2 \u22c5 \u0394   t  2      {  \u0394   D   t + \u0394 t    }   k + 1        A structural analysis program written in FORTRAN programming language is developed based on the above-mentioned formulations to predict nonlinear inelastic time-history responses of space semi-rigid steel frames subjected to dynamic loadings. It is verified for accuracy and reliability by the comparison of predicted results with those generated by ABAQUS [32], SAP2000 [33], and the Stelmack experimental test [34] of a two-story steel frame. The elastic\u2013perfectly plastic steel material without hardening and cracking is used in this study as shown in Fig. 3. Each member is modeled by one element which is integrated along the member length using the Gauss\u2013Lobatto quadrature rule. All member cross-sections are divided into 66 fibers (48 fibers at each flange, 18 fibers at the web).  Considering a portal frame with masses lumped at the frame nodes subjected to the Loma Prieta and San Fernando earthquakes, the geometry and material properties of the frame are illustrated in Fig. 7. Earthquake records are shown in Fig. 8 and Table 1. In the numerical modeling of the proposed program, each frame member is modeled by one element with two integration points at the member ends. Meanwhile, the ABAQUS program uses 40 discrete elements per each B22 Timoshenko beam member since the ABAQUS analysis cannot accurately capture the second-order inelastic response of the frame if only a few elements per member are used in the modeling. All elements are divided into 66 fibers (48 fibers at each flange, 18 fibers at the web) on the cross section in the proposed program.  After performing the vibration analysis, the first two natural periods along the applied earthquake direction of the portal frame are obtained and compared in Table 2. It can be seen that a strong agreement of natural periods of the frame generated by ABAQUS [32] and the proposed program is obtained. These two natural periods are used to determine the Rayleigh damping coefficients (shown in Table 2) by assuming the equivalent viscous damping ratio \u03be of 5% in the next time-history analysis step.  Without considering the initial residual stress, the second-order elastic and second-order inelastic time-displacement responses of the frame under the two earthquakes of Loma Prieta and San Fernando are compared in  Figs. 9 and 10, respectively. A comparison of the peak displacements is given in Table 3 with the maximum difference of 1.55%. It can be observed that the proposed program and ABAQUS [32] generate nearly identical results in all cases, including the permanent drifts of displacement due to the gradual yielding behavior in the second-order inelastic analysis cases. The discrepancy in displacement response of the second-order elastic and second-order inelastic analyses is relatively clear.  In considering the effect of the initial ECCS residual stress [25], Fig. 11 shows the comparison of the second-order inelastic responses of the frame. It can be seen that the permanent drifts of the roof floor have significant differences in the two cases. It can be concluded that the effect of initial residual stresses should be considered in an advanced analysis for steel frames.  Using the same personal computer configuration (AMD Phenom II X4 955 Processor, 3.2GHz; 8.00GB RAM), the computational time of the proposed program and ABAQUS for the second-order inelastic responses of the frame subjected to the San Fernando earthquake are 1min 37s and 24min 48s, respectively. The computational time of ABAQUS is about 15 times longer than the proposed program. This result demonstrates the computational efficiency of the proposed program.  An experimental two-story frame shown in Fig. 12a is used to verify the proposed connection modeling with the results of the experimental test and numerical analysis of Stelmack et al. [34]. The geometry and applied loads of the test frame are shown in Fig. 12a and b, respectively. All frame members are W5\u00d716 A36 steel. The ECCS residual stress distribution [25] is assigned for steel cross-sections, assuming that residual stresses uniformly distribute along each fiber length. Young\u05f3s modulus of material is 29,000ksi. 1/2-in. angle connections were used in the test, and 14 monotonic moment\u2013rotation test results of such connections were reported by Stelmack et al. [34]. The upper and lower bounds obtained from the test data are shown in Fig. 12c. The trilinear model was utilized by Stelmack et al. [34] while the Richard\u2013Abbott model is used in the present study, as plotted in Fig. 12c. In the Stelmack study, kinematic hardening model represent cyclic behavior of connections while independent hardening model is employed in this study (shown in Fig. 5). The four parameters of the Richard\u2013Abbott model are determined by a curve-fitting procedure as follows:   R   k i   = 19 , 500  kip \u22c5 in / rad ,   R   k p   = 750  kip \u22c5 in / rad ,   M   o   = 150  kip \u22c5 in , and n = 1.56  [34]. The lateral load cycles begin with loads applied to the first story of \u00b11kip and increased by 1kip increments up to \u00b15kips as shown in Fig. 12b; the second-story load is a half of the first-story load; and, the total load procedure is divided into 500 steps.  The experimental and analytical results of the moment\u2013rotation loops at the connection C are separately compared for each load cycle as shown in Fig. 13. It can be seen that the results predicted by the proposed analysis using the Richard\u2013Abbott model are relatively close to the experimental results and smoother than the results of Stelmack et al. [34] using the trilinear model. It may be concluded that the proposed program can generate acceptably accurate and smooth moment\u2013rotation curves in predicting the nonlinear behavior of steel frames with semi-rigid connections.  A six-story space steel frame with semi-rigid beam-to-column connections is shown in Fig. 14. Nonlinear inelastic static analysis was performed by Chiorean [16], Ngo-Huu et al. [12], and Nguyen and Kim [17]. The nonlinear elastic dynamic behavior was investigated by Nguyen and Kim [36]. This study investigates nonlinear inelastic time-history responses of the frame subjected to the El Centro and San Fernando earthquakes, their records are shown in Fig. 7 and Table 1. The elastic modulus, shear modulus, and yield stress of steel are 206,850MPa, 79,293MPa, and 250MPa, respectively. Three parameters of the Kishi\u2013Chen power model for the semi-rigid connections calculated by Chiorean [16] are listed in Table 4. The lumped masses of 128.42 and 256.84kNs2/m are transferred from the uniform floor pressure of 9.6kN/m2, and they are assigned at the frame nodes as shown in Fig. 14b. In the proposed program, each frame member is modeled by one element with five integration points along the member length. The earthquake excitations are applied in the direction Y. Structural viscous damping is considered by using the Rayleigh damping matrix with a damping ratio \u03be of 0.05, where the first two natural periods of the frames are compared in Table 5. It can be seen that the obtained results by free vibration analysis of the proposed program and SAP2000 [37] are nearly identical.     Figs. 15 and 16 show the lateral displacement responses at the node A appropriating to the rigid, linear semi-rigid, and nonlinear semi-rigid frames under the El Centro and San Fernando earthquakes, respectively. Results of the peak displacements are compared in Table 6. It can be observed that a strong agreement of displacements predicted by the proposed program and SAP2000 is obtained in the second-order elastic analysis. The proposed program uses the spread-of-plasticity approach considering directly the effect of initial ECCS residual stress [25], whereas the SAP2000 program [33] uses the lumped-plasticity approach. Nonlinear inelastic displacement responses of the proposed program and SAP2000 in the second-order inelastic analysis have various permanent shifts of displacements. The proposed program is more accurate than SAP2000 because it can capture the real behavior of structures by taking into account for the effects of spread-of-plasticity, initial residual stresses, and nonlinear connections.  Figs. 17 and 18 show hysteretic loops of the strong-axis rotational spring at the connection C corresponding to the two earthquakes, respectively, which cannot be predicted by SAP2000.  The permanent displacement of the nonlinear semi-rigid frame is less than that of both the rigid and linear semi-rigid frames because of the effect of hysteretic damping of the nonlinear semi-rigid connections. It can be concluded that the beam-to-column connections play a significant role in the earthquake resistant design. Predicting accurately the real behavior of framed structures leads to both safer and more economic designs.  In this case study, the combined effect of inelastic hysteretic damping due to spread of plasticity, hysteresis loops of semi-rigid connections, residual stress, and initial member geometric imperfections acting on overall structural responses is investigated. The ECCS initial residual stress [25] is assumed. Initial member out-of-straightness is considered by employing the reduced tangent modulus method proposed by Kim and Chen [38] and Chen and Kim [39]. In the proposed program, Young\u05f3s modulus of 0.85\u00d7E is directly assigned for all steel members to consider initial member out-of-straightness. The frame with nonlinear semi-rigid connections subjected to the two earthquakes is analyzed for four cases (case 1 \u2013 without residual stress and initial member out-of-straightness, case 2 \u2013 considering only residual stress, case 3 \u2013 considering only initial member out-of-straightness, and case 4 \u2013 considering both residual stress and initial member out-of-straightness). As shown in Fig. 19, there are no significant differences in the second-order inelastic displacement responses between the frame models that include the initial residual stress and those without this effect, whereas the initial member out-of-straightness strongly acts on the final behavior of the frame. Thus, the effect of initial member out-of-straightness is more important than the effect of residual stress. Fig. 20 plots nonlinear moment\u2013rotation responses at the connection C corresponding to the four cases. It can be seen that the hysteresis loops are different because member-force redistribution caused by gradual yielding of framed members is different. It can be concluded that the proposed program is reliable in predicting the nonlinear inelastic behavior of space semi-rigid steel frames.  An accurate and effective numerical procedure for the nonlinear inelastic time-history analysis of semi-rigid steel frames accounting for three main sources of both nonlinearities and damping is successfully developed. The geometric nonlinearities are considered by using the stability functions and the geometric stiffness matrix. The spread-of-plasticity behavior is captured by monitoring the uniaxial stress\u2013strain relation of each fiber on the cross section and using only two to five Gauss\u2013Lobatto integration points along the member length. An independent zero-length connection element comprising six translational and rotational springs, in order to connect six degrees of freedom of two identical nodes, is developed to simulate the semi-rigid beam-to-column connections. The independent hardening model is employed for the cyclic behavior of semi-rigid connections. Three major sources of damping are considered: structural viscous damping, hysteretic damping due to gradual yielding of material, and hysteretic damping due to hysteresis loops of nonlinear connections. The Hilber\u2013Hughes\u2013Taylor method combined with the Newton\u2013Raphson iterative scheme is developed for solving governing nonlinear equilibrium equations of motion. Because the HHT method can induce numerical damping which helps the nonlinear solution obtain convergence more easily (especially when the yielding abruptly occurs in the nonlinear inelastic time-history analysis), whereas the Newmark-beta method is impossible. The accuracy and efficiency of the proposed procedure are proved by comparing the results with the commercial finite element packages ABAQUS and SAP2000, and the Stelmack experimental test [34]. The following conclusions can be drawn from the present study:  \u2022 By using only one element per member and two to five Gauss\u2013Lobatto intergration points along the member length, the proposed method can accurately capture the second-order effects and spread-of-plasticity, save computer resources, and reduce computational time.  The proposed connection element can be developed to simulate various structure connections (e.g., truss joints, bridge joints, concrete joints, damping, etc.). The proposed connection element can also be used to simulate the steel column base connections.  The flexibility of nonlinear semi-rigid connections plays a major role in predicting the real behavior of steel frames under dynamic loadings.  Initial geometric imperfections and residual stresses are important factors needed to be considered in the practical design of steel frames.  The proposed program can be used in lieu of sophisticated finite element software packages as ABAQUS and ANSYS.  In addition, the proposed program needs to be improved for considering the effects of panel-zone deformation, warping torsion, local buckling, lateral\u2013torsional buckling, etc. with aims of developing a performance-based practical design program of large-scale 3D steel structures subjected to extreme loadings.   ACKNOWLEDGMENTS   This work was supported by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIP) (No. 2011-0030040) and (No. 2015R1A2A2A01007339).   REFERENCES", "highlights": "In this paper, a nonlinear inelastic time-history analysis procedure for space semi-rigid steel frames subjected to dynamic loadings is presented. Geometric nonlinearities are taken into account by using stability functions and the geometric stiffness matrix. The spread of plasticity over the cross section and along the member length is captured by monitoring the uniaxial stress\u2013strain relation of each fiber on selected sections. The nonlinear semi-rigid beam-to-column connection is simulated by a multi-spring space element. Three main sources of inelastic hysteretic, nonlinear connecting, and structural viscous damping are considered. The differential equation of motion is solved by the Hilber\u2013Hughes\u2013Taylor method combined with the Newton\u2013Raphson method for the equilibrium iterative procedure. Using only one element per member in the structure modeling, the nonlinear time-history responses which are predicted by the proposed program compare well with those given by commercial finite element packages and other available results. Numerical examples are presented to verify the accuracy and efficiency of the proposed method."}