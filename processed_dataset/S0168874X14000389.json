{"id": "S0168874X14000389", "article": "MAIN-TITLE Adjoint shape design sensitivity analysis of fluid\u2013solid interactions using concurrent mesh velocity in ALE formulation   HIGHLIGHTS          Accurate adjoint shape design sensitivity for coupled FSI problems.      Efficient shape sensitivity analysis using converged tangent from nonlinear FSI analysis.      Variational equation includes the moving boundary of fluids in ALE formulation.      Concurrent mesh velocity determined from a displacement-loaded pseudo-structural problem.      A fast convergence of total solution due to consistent fluid mesh, interface, and solid mesh.          KEYPHRASES   Fluid\u2013solid interaction (FSI)  Arbitrary Lagrangian\u2013Eulerian (ALE)  NURBS  Displacement-loaded system  Adjoint shape sensitivity  Shape optimization   In many engineering disciplines such as aerospace, marine, automotive, and wind engineering fields, the consideration of FSI systems is substantial for quality engineering analysis and thus its necessity is continuously increasing [1]. Nevertheless, the prohibitive amount of computations has been one of the major issues in the coupled FSI analysis. When intended to design optimization for the large scale transient dynamic problems, it is impractical to employ finite difference sensitivity to perform shape design optimization of the coupled FSI problems. Furthermore, the inaccuracy of finite differencing could result in either convergence difficulty or premature results during the design optimization [2].  For the kinematical description of fluid domain, the difficulty of severe mesh distortion is inevitable if a Lagrangian approach is employed. On the other hand, the mesh distortion can be handled easily in an Eulerian approach. However, the treatment of moving boundaries and interfaces is challenging. A unified Lagrangian\u2013Eulerian kinematical description of fluid domain is developed by Hughes et al. [3] so that the grid points are displaced independently of fluid motion, where the moving boundary is described by the movement of the reference frame. Several algorithms have been proposed to control the movement of fluid mesh. An ALE kinematical description of fluid domain is adopted [4] so that grid points can be displaced independently of fluid motion. They imposed the mesh velocity by averaging grid velocities of neighboring nodes at the previous time step. For the shape sensitivity analysis in updated Lagrangian [5] or ALE formulation, the design velocity field needs to be updated at every configuration [6, Section 2.3]. In this paper, we employ a moving mesh method where the domain is considered as an elastic body subjected to a prescribed motion on its boundary.   To handle the moving boundary and interface of FSI problems, Farhat et al. [7] developed a non-matching discretization method that uses different grids to analyze two fields allowing the incompatibility at interfaces. In shape design optimization, the approximation to obtain the geometric information such as tangent and normal could result in inaccuracy issues in transferring the load and motion of boundary at each time step. Chiandussi et al. [8] proposed a mesh update method based on this approach. The mechanical properties of elements are properly selected to minimize the mesh distortion. Yoshida and Kawahara [9] performed a shape optimization using ALE FEM. The oscillating motion of rigid body was expressed by mesh displacements. They obtained the mesh velocity using an iterative scheme. Also, a space\u2013time Piola transformation method [10] is developed to treat the compatible interfaces, where the equations of motion are described in a reference domain. Recently, using a NURBS-based isogeometric analysis method that preserves geometrical exactness for the spatial discretization, Bazilevs et al. [11] present a fully coupled monolithic formulation of the FSI problems on a moving domain with nonlinear hyperelastic solids. Heinrich et al. [12] performed a shape design optimization of FSI problem which is solved by using the isogeometric approach. They used a gradient-free optimizer due to the expensive cost for the DSA.  In the early stage of theoretical development for the coupled FSI problems, many research efforts have been devoted to iterative methods [13] where both disciplines are solved independently in a staggered way at each time step. When it is extended to complicated nonlinear problems, however, some difficulties in convergence and efficiency could occur. To overcome these difficulties, Ghattas and Li [14] proposed a fully coupled method that solves two fields at the same time, using a unified tangent matrix that shares the same solution space for a traction continuity equation at interfaces. The surface traction expressed in terms of 1st Piola\u2013Kirchhoff stress at the undeformed interface is identical to the surface traction expressed in terms of the Cauchy stress at its image on the deformed interfaces. Also, a domain decomposition method is used for the sensitivity analysis of nonlinear aeroelasticity [15]. In a similar way, Lund et al. [16] performed the shape design optimization of FSI problems using semi-analytical sensitivity. Fernandez and Moubachir [17] proposed a shape design sensitivity analysis method and the corresponding linearized equation using ALE formulation and direct differentiation method for aeroelastic systems. Monolithic ALE framework is also used in deriving adjoint shape sensitivities for the goal-oriented adaptive mesh-refinement [18,19]. In this paper, to obtain efficient and accurate shape sensitivity for the coupled FSI problems, we derive continuum-based shape sensitivity. The obtained adjoint shape sensitivity is utilized to develop a shape optimization method.  In Section 2, considering a Navier\u2013Stokes equation for incompressible fluids, an equilibrium equation for geometrically nonlinear solids, and traction continuity conditions at interfaces, a coupled variational equation for the FSI problems is derived and solved using the FEM and Newton\u2013Raphson scheme. Second Piola\u2013Kirchhoff stress and Green\u2013Lagrange strain tensors are used to handle the finite deformation of solids in total Lagrangian formulation. A no-slip condition is imposed at the interfaces: the surface traction expressed in terms of the first Piola\u2013Kirchhoff stress at the undeformed interfaces is assumed to be identical to the one expressed in terms of the Cauchy stress at its image on the deformed interfaces [14].  In Section 3, an adjoint shape DSA method based on material derivative concept [20] is developed for steady state FSI problems. Even though the cost is very expensive for the response analysis due to the nonlinear nature of problems, the computation cost is trivial for the DSA since the converged solution and the tangent in the response analysis are readily available [21]. Using the developed DSA method, a shape optimization method is formulated for the FSI problems. The objective is to either maximize the stiffness of solids or minimize the drag on the solids while satisfying a constraint of allowable volume. Traditionally, the design and analysis are performed iteratively to produce an optimal design. However, in recent years, the integration of CAD, analysis, and design optimization become more important [22]. Thus, the whole domain including fluids, solids, and interfaces is parameterized to facilitate the shape variations using NURBS patches whose control points are considered as design variables. Akbari et al. [23] showed that if the same discretization, numerical integration, and linear design velocity fields as used in the response analysis are employed, the sensitivities obtained from the continuum\u2013discrete and the discrete\u2013discrete approaches are theoretically equivalent.  In Section 4, through numerical examples, the accuracy and efficiency of the developed DSA method is compared with finite difference sensitivity. The critical issue in a shape optimization of FSI problems is the computing cost for the analysis of coupled problems that include nonlinearity in each discipline. Thus, finite difference sensitivity is not practical for the shape design optimization, compared to a fully analytical one. However, the developed shape DSA method is extremely efficient and shown to be applicable to the FSI problems. Together with the shape parameterization method, the developed DSA method is applied to the shape optimization of FSI problems. The optimization process is shown to be very efficient and yields very reasonable results in a physical point of view.  Consider a continuum body composed of solids and fluids, which is described by multiple domains and boundaries as shown in Fig. 1 . The subscripts F, S, I, and   I   0   in the domain \u03a9 and boundary \u0393 are used to denote the fluid, solid, deformed, and undeformed interfaces, respectively. The superscripts n and d in the boundary \u0393 are used to denote the Neumann and Dirichlet types, respectively. The whole domain \u03a9 is composed of     \u03a9   \u00af     F   and     \u03a9   \u00af     S   which are respectively the complete domains of fluids and solids, and they share an interface boundary   \u0393     I   0     as  (1)      \u03a9   \u00af     F   =   \u03a9   F   \u222a   \u0393   F   \u222a   \u0393     I   0       and  (2)      \u03a9   \u00af     S   =   \u03a9   S   \u222a   \u0393   S   \u222a   \u0393     I   0     .      In isothermal incompressible flows, an incompressibility condition is written as  (3)  \u2207 \u00b7 u = 0  in    \u03a9   F     and the conservation of linear momentum is described in the ALE formulation as  (4)  \u2207 \u00b7   \u03c3   F   +   b   F   =   \u03c1   F   ( u \u00b7 \u2207 ) u \u2212   \u03c1   F   ( v \u00b7 \u2207 ) u  in    \u03a9   F   ,   where   \u03c3   F   ,   b   F   ,   \u03c1   F   , u, and v denote the Cauchy stress, body force intensity, fluid density, fluid velocity, and mesh velocity in the ALE formulation, respectively [3,4]. The constitutive relation of Newtonian fluids and the strain\u2013velocity relation are given by  (5)    \u03c3   F   = \u2212 p I + 2   \u03bc   F   d   and  (6)  d =    1   2    ( \u2207 u + \u2207   u   T   ) ,   where   \u03bc   F   is the fluid viscosity. Natural and essential boundary conditions are given, respectively, by  (7)    \u03c3   F     n   F   =     t   ^     F    on    \u0393   F   n     and  (8)  u =   u   ^    on    \u0393   F   d   ,   where     t   ^     F   and   u   ^   are the prescribed traction and velocity on the fluid boundaries, respectively. Using virtual pressure   p   \u00af   and velocity   u   \u00af   , variational equations for Eqs. (3)\u2013(8) can be written in abstract forms, neglecting the body force for simplicity, as  (9)  b (   p   \u00af   , u ) = 0 ,  \u2200   p   \u00af   \u2208   P   \u00af     and  (10)  a ( u ,   u   \u00af   ) + b ( p ,   u   \u00af   ) + c ( u ,   u   \u00af   ) + e ( u , v ,   u   \u00af   ) =   \u222b     \u0393   I       u   \u00af   \u00b7   \u03c3   F     n     I   F      d \u0393 ,  \u2200   u   \u00af   \u2208   U   \u00af   ,   where  (11)  a ( u ,   u   \u00af   ) \u2261   \u222b     \u03a9   F       1   2     \u03bc   F   ( \u2207 u + \u2207   u   T   ) : ( \u2207   u   \u00af   + \u2207     u   \u00af     T   )  d \u03a9 ,      (12)  b ( p ,   u   \u00af   ) \u2261 \u2212   \u222b     \u03a9   F     p \u2207 \u00b7   u   \u00af    d \u03a9 ,      (13)  c ( u ,   u   \u00af   ) \u2261   \u222b     \u03a9   F       \u03c1   F     u   \u00af   \u00b7 ( u \u00b7 \u2207 ) u  d \u03a9   and  (14)  e ( u , v ,   u   \u00af   ) \u2261 \u2212   \u222b     \u03a9   F       \u03c1   F     u   \u00af   \u00b7 ( v \u00b7 \u2207 ) u  d \u03a9 .   The variational spaces are defined by  (15)    U   \u00af   = {   u   \u00af    |    u   \u00af   \u2208   H   1   (   \u03a9   F   ) ,    u   \u00af   = 0  on    \u0393   F   d   }   and  (16)    P   \u00af   = {   p   \u00af    |    p   \u00af   \u2208   L   2   (   \u03a9   F   ) } .      In elastic solids, an equilibrium equation can be written in undeformed configuration as  (17)    \u2207   0   \u00b7   P   0   + b = 0  in    \u03a9   S   ,   where b is the body force intensity. Using the deformation gradient P and the relation between 1st Piola\u2013Kirchhoff stress   P   0   and 2nd Piola\u2013Kirchhoff stress S, Eq. (17) is rewritten as  (18)    \u2207   0   \u00b7 ( F \u00b7 S ) + b = 0  in    \u03a9   S   .   Natural and essential boundary conditions for the solid domain are given by  (19)    P   0     n   S   0   = ( F \u00b7 S )   n   S   0   =     t   ^     S    on    \u0393   S   n     and  (20)  z =   z   ^    on    \u0393   S   d   .   Using virtual displacement   z   \u00af   , variational equations for Eqs. (18)\u2013(20) can be written in total Lagrangian formulation [21], neglecting the body force term, as  (21)  d ( z ,   z   \u00af   ) \u2261   \u222b     \u03a9   S       \u03b5   \u2322   ( z ;   z   \u00af   ) : C : \u03b5 ( z )  d \u03a9 =   \u222b     \u0393     I   0         z   \u00af   \u00b7 ( F \u00b7 S )   n     I   S      d \u0393 ,  \u2200   z   \u00af   \u2208   Z   \u00af   ,   where  (22)    Z   \u00af   = {   z   \u00af    |    z   \u00af   \u2208   H   0   1   ( \u03a9 ) ,      z   \u00af     S   = 0  on    \u0393   S   d   ,      z   \u00af     F   = 0  on    \u0393   F   d   } .   The Green\u2013Lagrange strain and the virtual strain tensors are defined as  (23)  \u03b5 ( z ) =    1   2    (   \u2207   0   z +   \u2207   0     z   T   +   \u2207   0   z \u00b7   \u2207   0     z   T   )   and  (24)    \u03b5   \u2322   ( z ;   z   \u00af   ) =    1   2    (   \u2207   0     z   \u00af   +   \u2207   0       z   \u00af     T   +   \u2207   0     z   \u00af   \u00b7   \u2207   0     z   T   +   \u2207   0   z \u00b7   \u2207   0       z   \u00af     T   ) .      Assume that the surface traction expressed in terms of 1st Piola\u2013Kirchhoff stress at a point s \u2032 on the undeformed interface is identical to the surface traction expressed in terms of the Cauchy stress at its image s \u2033 on the deformed interface [14]. Thus, we may write the following:  (25)    P   0   ( s \u2032 )   n     I   S     ( s \u2032 ) =   \u03c3   S   ( s \u2033 )   n     I   S     ( s \u2033 ) .   The virtual displacement   z   \u00af   ( s \u2032 ) on the undeformed interface belongs to the same function space for the virtual velocity   u   \u00af   ( s \u2033 ) on the deformed interface. Thus, the followings hold:  (26)    \u222b     \u0393     I   0         z   \u00af   \u00b7 ( F \u00b7 S )   n     I   S      d \u0393 =   \u222b     \u0393   I       u   \u00af   \u00b7   \u03c3   S     n     I   S      d \u0393 = \u2212   \u222b     \u0393   I       u   \u00af   \u00b7   \u03c3   F     n     I   F      d \u0393 .   The following traction continuity condition should be satisfied at the interfaces:  (27)    \u03c3   S     n     I   S     +   \u03c3   F     n     I   F     = 0 .   Using Eq. (26), the weak forms of Eqs. (10) and (21) are combined into  (28)  a ( u ,   u   \u00af   ) + b ( p ,   u   \u00af   ) + c ( u ,   u   \u00af   ) + d ( z ,   z   \u00af   ) + e ( u , v ,   u   \u00af   ) = 0 ,  \u2200   u   \u00af   \u2208   U   \u00af   ,  \u2200   z   \u00af   \u2208   Z   \u00af   .   Also, the continuity condition is written as  (29)  b (   p   \u00af   , u ) = 0 ,  \u2200   p   \u00af   \u2208   P   \u00af   .      If the mesh velocity is given by averaging the grid velocities of neighboring nodes at the previous time step [4], the design velocity field of the mapping rate between original and perturbed designs should be updated at every configuration [6] and the sensitivity can be obtained only through a time integration procedure. To obtain the sensitivity without any time integrations, the mesh velocity should be determined together with the variational equations of Eqs. (28) and (29) at a concurrent time step. Also, to avoid mesh entanglement due to the deformation in solids and fluids, consider a pseudo-structural problem for the fluid field to obtain the mesh velocity v in Eq. (28). In steady state flows, mesh velocity v is approximated as   v   ^   that is change of interface displacement per unit time:  (30)    v   I   \u2248     z   I   \u2212   z     I   0       t   =   z   I   =     v   ^     I   .   To maintain the consistency of the whole response field, the pseudo-structural domain is also formulated in the same way as used in the elastic solid body that is formulated in total Lagrangian approach. A variational equation is formulated to determine the mesh velocity:  (31)    d   m   ( v ,   v   \u00af   ) = 0 ,  \u2200   v   \u00af   \u2208   V   \u00af   ,   where  (32)    d   m   ( v ,   v   \u00af   ) =   \u222b     \u03a9   F       \u03b5   \u2322   ( v ;   v   \u00af   ) :   C   m   \u00b7 \u03b5 ( v )  d \u03a9   and   C   m   is an artificial material tensor to reduce the mesh distortion. The function spaces for Eq. (31) are defined as  (33)  V = { v \u2208   H   1   (   \u03a9   F   ) : v = z  on    \u0393   I   ,  v = 0  on    \u0393   F   }   and  (34)    V   \u00af   = {   v   \u00af   \u2208   H   1   (   \u03a9   F   ) : v = 0  on    \u0393   I   \u222a   \u0393   F   } .   The pseudo-structural problem includes a displacement-loaded system that satisfies the non-homogeneous boundary conditions on the interface [21]. Thus, mesh velocity v is decomposed into w and y that satisfy the non-homogeneous and homogeneous boundary conditions, respectively:  (35)  v = w + y ,  w \u2208 V  and  y \u2208   V   \u00af   .   Also, the virtual mesh velocity is decomposed into  (36)    v   \u00af   =   w   \u00af   +   y   \u00af   =   y   \u00af   ,    y   \u00af   \u2208   V   \u00af   .   The second equality holds since both   w   \u00af   and   y   \u00af   are arbitrary functions that satisfy homogeneous boundary conditions in the space   V   \u00af   .  The forms c ( \u2022 , \u2022 ) and d ( \u2022 , \u2022 ) in Eq. (28) are nonlinear with respect to the fluid velocity u and solid displacement z , respectively. Consider Eqs. (28), (29) and (31) at the current configuration (n+1):  (37)  a (   u       n + 1   ,   u   \u00af   ) + b (   p       n + 1   ,   u   \u00af   ) + c (   u       n + 1   ,   u   \u00af   ) + d (   z       n + 1   ,   z   \u00af   ) + e (   u       n + 1   ,   v       n + 1   ,   u   \u00af   ) = 0 ,  \u2200   u   \u00af   \u2208   U   \u00af   ,  \u2200   z   \u00af   \u2208   Z   \u00af   ,      (38)  b (   p   \u00af   ,   u       n + 1   ) = 0 ,  \u2200   p   \u00af   \u2208   P   \u00af   ,   and  (39)    d   m   (   v       n + 1   ,   v   \u00af   ) = 0 ,  \u2200   v   \u00af   \u2208   V   \u00af   .   The nonlinear form c (   u       n + 1   ,   u   \u00af   ) in Eq. (37) is linearized, using \u0394 ( \u2022 ) =   ( \u2022 )       n + 1   \u2212   ( \u2022 )       n   , as  (40)  c (   u       n + 1   ,   u   \u00af   ) = c (   u       n   ,   u   \u00af   ) +   c   \u2322   (   u       n   ; \u0394 u ,   u   \u00af   ) ,   where  (41)    c   \u2322   (   u       n   ; \u0394 u ,   u   \u00af   ) =   \u222b     \u03a9   F       \u03c1   F     u   \u00af   \u00b7 [ (   u       n   \u00b7 \u2207 ) \u0394 u +   ( \u0394 u \u00b7 \u2207 )   n   u ]  d \u03a9 .   The nonlinear form d (   z       n + 1   ,   z   \u00af   ) in Eq. (37) is also linearized as  (42)  d (   z       n + 1   ,   z   \u00af   ) = d (   z       n   ,   z   \u00af   ) +   d   \u2322   (   z       n   ; \u0394 z ,   z   \u00af   ) ,   where  (43)  d (   z       n   ,   z   \u00af   ) =   \u222b   \u03a9     \u03b5   \u2322   (   z       n   ;   z   \u00af   ) : C : \u03b5 (   z       n   )  d \u03a9   and  (44)    d   \u2322   (   z       n   ; \u0394 z ,   z   \u00af   ) =   \u222b   \u03a9     \u03b5   \u2322   (   z       n   ;   z   \u00af   ) : C :   \u03b5   \u2322   (   z       n   ; \u0394 z )  d \u03a9 +   \u222b   \u03a9     \u03b7   \u2322   ( \u0394 z ;   z   \u00af   ) : C : \u03b5 (   z       n   )  d \u03a9 .   Note that the form   d   m   ( \u2022 , \u2022 ) in Eq. (32) is nonlinear with respect to the mesh velocity v.  At the current configuration ( n + 1 ) , the mesh velocity   v       n + 1   can be decomposed into a prescribed function   w       n + 1   that is identical to the interface displacement and an arbitrary function   y       n + 1   that satisfies a homogeneous boundary condition on the interface:  (45)    v       n + 1   =   w       n + 1   +   y       n + 1   =   v       n   + \u0394 w + \u0394 y .   The tri-linear form e ( \u2022 , \u2022 , \u2022 ) in Eq. (37) can be linearized as  (46)  e (   u       n + 1     ,   n + 1   v ,   u   \u00af   ) = e (   u       n   ,   v       n   ,   u   \u00af   ) + e ( \u0394 u ,   v       n   ,   u   \u00af   ) + e (   u       n   , \u0394 w ,   u   \u00af   ) + e (   u       n   , \u0394 y ,   u   \u00af   ) .   Since the operators a ( \u2022 , \u2022 ) and b ( \u2022 , \u2022 ) are linear, the linearized forms of Eqs. (37) and (38) are rewritten, using Eqs. (39), (42), and (46), as  (47)  a ( \u0394 u ,   u   \u00af   ) + b ( \u0394 p ,   u   \u00af   ) +   c   \u2322   (   u       n   ; \u0394 u ,   u   \u00af   ) +   d   \u2322   (   z       n   ; \u0394 z ,   z   \u00af   )  + e ( \u0394 u ,   v       n   ,   u   \u00af   ) + e (   u       n   , \u0394 w ,   u   \u00af   ) + e (   u       n   , \u0394 y ,   u   \u00af   )   = \u2212 a (   u       n   ,   u   \u00af   ) \u2212 b (   p       n   ,   u   \u00af   ) \u2212 c (   u       n   ,   u   \u00af   ) \u2212 d (   z       n   ,   z   \u00af   )    \u2212 e (   u       n   ,   v       n   ,   u   \u00af   ) ,  \u2200   u   \u00af   \u2208   U   \u00af   ,  \u2200   z   \u00af   \u2208   Z   \u00af     and  (48)  b (   p   \u00af   , \u0394 u ) = \u2212 b (   p   \u00af   ,   u       n   ) ,  \u2200   p   \u00af   \u2208   P   \u00af   ,   where   c   \u2322   (   u       n   ; \u2022 , \u2022 ) and   d   \u2322   (   z       n   ; \u2022 , \u2022 ) represent bilinear forms linearized at an n-configuration solution. The nonlinear form   d   m   ( \u2022 , \u2022 ) in Eq. (31) can be linearized as  (49)    d   m   (   v       n + 1   ,   v   \u00af   ) =   d   m   (   v       n   ,   v   \u00af   ) +     d   \u2322     m   (   v       n   ; \u0394 w ,   v   \u00af   ) +     d   \u2322     m   (   v       n   ; \u0394 y ,   v   \u00af   ) = 0   or  (50)      d   \u2322     m   (   v       n   ; \u0394 w ,   v   \u00af   ) +     d   \u2322     m   (   v       n   ; \u0394 y ,   v   \u00af   ) = \u2212   d   m   (   v       n   ,   v   \u00af   ) ,  \u2200   v   \u00af   \u2208   V   \u00af   .      At configuration ( n ) , the mesh velocity   v       n   can be decomposed into a prescribed function   w       n   that is identical to the interface displacement   z   I      n   and an arbitrary function   y       n   that satisfies a homogeneous boundary condition on the interface   \u0393   I   :  (51)    v       n   =   w       n   +   y       n   =   z   I      n   +   y   F      n   ,    w       n   \u2208 V  and    y       n   \u2208   V   \u00af   .   In the fluid domain, the following can be defined for the discretized virtual velocity     U   \u00af     F   :  (52)      U   \u00af     F   T   (   J   UF      n     \u03c7   F     +   n     J   UI     \u03c7   I   +   J   UM      n     \u03c7   M   )  \u2261 a ( \u0394 u ,   u   \u00af   ) +   c   \u2322   (   u       n   ; \u0394 u ,   u   \u00af   ) + b ( \u0394 p ,   u   \u00af   )   + e ( \u0394 u ,   v       n   ,   u   \u00af   ) + e (   u       n   , \u0394 y ,   u   \u00af   ) + e (   u       n   , \u0394 w ,   u   \u00af   )  = \u2212 a (   u       n   ,   u   \u00af   ) \u2212 b (   p       n   ,   u   \u00af   ) \u2212 c (   u       n   ,   u   \u00af   ) \u2212 e (   u       n   ,   v       n   ,   u   \u00af   )  \u2261 \u2212     U   \u00af     F   T      f   U      n   ,  \u2200   u   \u00af   \u2208   U   \u00af   ,   where   J       n   denotes a tangent matrix at n-configuration:  (53)    \u03c7   F   T   = { \u0394   U   F   T    \u0394   P   F   T    \u0394   P   I   T   } ,      (54)    \u03c7   I   = \u0394   Z   I     and  (55)    \u03c7   M   = \u0394   Y   F   .   Note that throughout the paper, capital letters are used to represent the discretized quantities. Also, the following can be defined for the discretized virtual pressure     P   \u00af     T   = {     P   \u00af     F   T        P   \u00af     I   T   }    (56)      P   \u00af     T   (   J   PF      n     \u03c7   F   ) \u2261 b (   p   \u00af   , \u0394 u ) = \u2212 b (   p   \u00af   ,   u       n   ) \u2261 \u2212     P   \u00af     T     f   P      n   ,  \u2200   p   \u00af   \u2208   P   \u00af   .   Eqs. (52) and (56) are restated, in a matrix form, as  (57)    {         U   \u00af     F         P   \u00af       }   T   [       J   UF      n       J   UI      n       J   UM      n         J   PF      n     0   0     ] {       \u03c7   F         \u03c7   I         \u03c7   M       } = \u2212   {         U   \u00af     F         P   \u00af       }   T   {       f   U      n         f   P      n       } .   Combining two rows in Eq. (57) using     \u03c7   \u00af     F   T   = {     U   \u00af     F   T        P   \u00af     T   } and   f   F   T     n   = {   f   U   T     n      f   P   T     n   } , the following is obtained:  (58)      \u03c7   \u00af     F   T   [   J   FF      n      J   FI      n      J   FM      n   ] {       \u03c7   F         \u03c7   I         \u03c7   M       } = \u2212     \u03c7   \u00af     F   T     f   F      n   .   Note that the fluid velocity on the interface   U   I   is eliminated by the no-slip condition. In the solid domain, taking   \u03c7   S   = \u0394   Z   S   , the following holds for the virtual displacement     Z   \u00af     S   :  (59)      Z   \u00af     S   T   (   J   SS      n     \u03c7   S   +   J   SI      n     \u03c7   I   ) \u2261   d   \u2322   (   z       n   ; \u0394 z ,   z   \u00af   ) = \u2212 d (   z       n   ,   z   \u00af   ) \u2261 \u2212     Z   \u00af     S   T     f   S      n   ,  \u2200   z   \u00af   \u2208   Z   \u00af   .   On the interface, using the fact that     U   \u00af     I   =     Z   \u00af     I   , the following holds:  (60)      Z   \u00af     I   T   (   J   IF      n     \u03c7   F   +   J   IS      n     \u03c7   S   +   J   II      n     \u03c7   I   +   J   IM      n     \u03c7   M   ) \u2261 \u2212     Z   \u00af     I   T     f   I      n   .   For the discretized mesh velocity, the following can be written:  (61)      V   \u00af     T   (   J   MI      n     \u03c7   I     +   n     J   MM     \u03c7   M   ) \u2261     d   \u2322     m   (   v       n   ; \u0394 w ,   v   \u00af   ) +     d   \u2322     m   (   v       n   ; \u0394 y ,   v   \u00af   ) = \u2212   d   m   (   v       n   ,   v   \u00af   ) \u2261 \u2212       V   \u00af     T     n     f   M   ,  \u2200   v   \u00af   \u2208   V   \u00af   .   The linearized variational equation at the previous configuration ( n ) seeks for the solution at the current configuration ( n + 1 ) . Thus, Eqs. (58)\u2013(61) are expressed, in an iterative algebraic form, as  (62)    [       J   FF      n     0     J   FI      n       J   FM      n       0     J   SS      n       J   SI      n     0       J   IF      n       J   IS      n       J   II      n       J   IM      n       0   0     J   MI      n       J   MM      n       ]   ( i \u2212 1 )     {       \u03c7   F         \u03c7   S         \u03c7   I         \u03c7   M       }   ( i )   = \u2212   {       f   F      n         f   S      n         f   I      n         f   M      n       }   ( i \u2212 1 )   .   Using the Newton\u2013Raphson iterative method, the steps are repeated until the difference between the external and the internal virtual work is negligible within a certain convergence measure.  Consider a variation of domain as shown in Fig. 2 . Suppose that only one parameter \u03c4 defines the mapping T. The process of deforming \u03a9 to   \u03a9   tau   by the mapping T may be viewed as a dynamic process of deforming a continuum, with \u03c4 playing the role of time. At initial time \u03c4 = 0 , the domain is \u03a9. The trajectories of points x \u2208 \u03a9 beginning at \u03c4 = 0 can now be followed. The initial point x moves to the point   x   \u03c4   = T ( x , t ) . Thinking of \u03c4 as time, a design velocity can be defined as  (63)  V (   x   \u03c4   , \u03c4 ) \u2261   d   x   \u03c4     d \u03c4   =   dT ( x , \u03c4 )   d \u03c4   =   \u2202 T ( x , \u03c4 )   \u2202 \u03c4   ,   since the initial point x does not depend on \u03c4. Suppose   z   \u03c4   ( x ) is the solution of the boundary value problem on   \u03a9   \u03c4   . It is evaluated at a point x. The point-wise material derivative at x \u2208 \u03a9 is defined as  (64)    z   \u0307   =   z   \u0307   ( x ; \u03a9 , V ) \u2261      d   d \u03c4     z   \u03c4   ( x + \u03c4 V ( x ) )  |   t = 0   = z \u2032 ( x ) + \u2207   z   T   V ( x ) ,   where z \u2032 and \u2207 z are the partial derivative with respect to the design and the gradient \u2207 z = [   z   , 1      z   , 2      z   , 3   ] , respectively. Taking the first order variations of Eqs. (37)\u2013(39) and using Eq. (64), the following are derived:  (65)  [ a (   u       n + 1   ,   u   \u00af   ) ] \u2032 + [ b (   p       n + 1   ,   u   \u00af   ) ] \u2032  + [ c (   u       n + 1   ,   u   \u00af   ) ] \u2032 + [ d (   z       n + 1   ,   z   \u00af   ) ] \u2032 + [ e (   u       n + 1   ,   v       n + 1   ,   u   \u00af   ) ] \u2032 = a (     u   \u0307         n + 1   ,   u   \u00af   ) + a (   u       n + 1   ,     u   \u00af     \u0307   ) +   a   V   \u2032   (   u       n + 1   ,   u   \u00af   ) + b (     p   \u0307         n + 1   ,   u   \u00af   ) + b (   p       n + 1   ,     u   \u00af     \u0307   )  +   b   V   \u2032   (   p       n + 1   ,   u   \u00af   ) +   c   \u2322   (   u       n + 1   ;     u   \u0307         n + 1   ,   u   \u00af   ) + c (   u       n + 1   ,     u   \u00af     \u0307   ) +   c   V   \u2032   (   u       n + 1   ,   u   \u00af   )  +   d   \u2322   (   z       n + 1   ;     z   \u0307         n + 1   ,   z   \u00af   ) + d (   z       n + 1   ,     z   \u00af     \u0307   ) +   d   V   \u2032   (   z       n + 1   ,   z   \u00af   ) + e (     u   \u0307         n + 1   ,   v       n + 1   ,   u   \u00af   )  + e (   u       n + 1     ,   n + 1     v   \u0307   ,   u   \u00af   ) + e (   u       n + 1   ,   v       n + 1   ,     u   \u00af     \u0307   ) +   e   V   \u2032   (   u       n + 1   ,   v       n + 1   ,   u   \u00af   ) = 0 ,      (66)  [ b (   p   \u00af   ,   u       n + 1   ) ] \u2032 = b (     p   \u00af     \u0307   ,   u       n + 1   ) + b (   p   \u00af   ,     u   \u0307         n + 1   ) +   b   V   \u2032   (   p   \u00af   ,   u       n + 1   ) = 0   and  (67)  [   d   m   (   v       n + 1   ,   v   \u00af   ) ] \u2032 =     d   \u2322     m   (   v       n + 1     ;   n + 1     v   \u0307   ,   v   \u00af   ) +   d   m   (   v       n + 1   ,     v   \u00af     \u0307   ) +   d   V   m \u2032   (   v       n + 1   ,   v   \u00af   ) = 0 .   Since     u   \u00af     \u0307   \u2208   U   \u00af   ,     p   \u00af     \u0307   \u2208   P   \u00af   ,     z   \u00af     \u0307   \u2208   Z   \u00af   , and     v   \u00af     \u0307   \u2208   V   \u00af   , the following holds:  (68)  a (   u       n + 1   ,     u   \u00af     \u0307   ) + b (   p       n + 1   ,     u   \u00af     \u0307   ) + c (   u       n + 1   ,     u   \u00af     \u0307   ) + d (   z       n + 1   ,     z   \u00af     \u0307   ) + e (   u       n + 1   ,   v       n + 1   ,     u   \u00af     \u0307   ) = 0 ,  \u2200     u   \u00af     \u0307   \u2208   U   \u00af   ,  \u2200     z   \u00af     \u0307   \u2208   Z   \u00af   ,      (69)  b (     p   \u00af     \u0307   ,   u       n + 1   ) = 0 ,  \u2200     p   \u00af     \u0307   \u2208   P   \u00af     and  (70)    d   m   (   v       n + 1   ,     v   \u00af     \u0307   ) = 0 ,  \u2200     v   \u00af     \u0307   \u2208   V   \u00af   .   Thus, Eqs. (65)\u2013(67) are rewritten as  (71)  a (     u   \u0307         n + 1   ,   u   \u00af   ) + b (     p   \u0307         n + 1   ,   u   \u00af   ) +   c   \u2322   (   u       n + 1   ;     u   \u0307         n + 1   ,   u   \u00af   )  +   d   \u2322   (   z       n + 1   ;     z   \u0307         n + 1   ,   z   \u00af   ) + e (     u   \u0307         n + 1   ,   v       n + 1   ,   u   \u00af   ) + e (   u       n + 1     ,   n + 1     v   \u0307   ,   u   \u00af   )   = \u2212   a   V   \u2032   (   u       n + 1   ,   u   \u00af   ) \u2212   b   V   \u2032   (   p       n + 1   ,   u   \u00af   ) \u2212   c   V   \u2032   (   u       n + 1   ,   u   \u00af   )     \u2212   d   V   \u2032   (   z       n + 1   ,   z   \u00af   ) \u2212   e   V   \u2032   (   u       n + 1   ,   v       n + 1   ,   u   \u00af   ) ,  \u2200   u   \u00af   \u2208   U   \u00af   ,  \u2200   z   \u00af   \u2208   Z   \u00af   ,      (72)  b (   p   \u00af   ,     u   \u0307         n + 1   ) = \u2212   b   V   \u2032   (   p   \u00af   ,   u       n + 1   ) ,  \u2200   p   \u00af   \u2208   P   \u00af     and  (73)      d   \u2322     m   (   v       n + 1   ;     v   \u0307         n + 1   ,   v   \u00af   ) = \u2212   d   V   m \u2032   (   v       n + 1   ,   v   \u00af   ) ,  \u2200   v   \u00af   \u2208   V   \u00af   ,   where, since C 1 regularity is assumed in the solution and velocity fields,  (74)    a   V   \u2032   (   u       n + 1   ,   u   \u00af   )  = \u2212 a (   \u2207       n + 1     u   T   V ,   u   \u00af   ) \u2212 a (   u       n + 1   , \u2207     u   \u00af     T   V ) +   a   ex   \u2032   (   u       n + 1   ,   u   \u00af   )  = \u2212   1   2     \u222b     \u03a9   F       \u03bc   F   (   u   i , k     V   k , j   +   u   j , k     V   k , i   ) (     u   \u00af     i , j      n + 1   +     u   \u00af     j , i      n + 1   )  d \u03a9   \u2212   1   2     \u222b     \u03a9   F       \u03bc   F   (   u   i , j   +   u   j , i   ) (     u   \u00af     i , k      n + 1     V   k , j   +     u   \u00af     j , k      n + 1     V   k , i   )  d \u03a9   +   1   2     \u222b     \u03a9   F     [   \u03bc   F   (   u   i , j   +   u   j , i   ) (     u   \u00af     i , j      n + 1   +     u   \u00af     j , i      n + 1   )   V   k , k   ]  d \u03a9 ,      (75)    b   V   \u2032   (   p       n + 1   ,   u   \u00af   ) = \u2212 b (   \u2207       n + 1     p   T   V ,   u   \u00af   ) +   b   ex   \u2032   (   p       n + 1   ,   u   \u00af   ) =   \u222b     \u03a9   F     (     u   \u00af     i , k     V   k , i     p       n + 1   \u2212     u   \u00af     i , i     p       n + 1     V   k , k   )  d \u03a9 ,      (76)    c   V   \u2032   (   u       n + 1   ,   u   \u00af   )  = \u2212   c   \u2322   (   u       n + 1   ;   \u2207       n + 1     u   T   V ,   u   \u00af   ) \u2212 c (   u       n + 1   , \u2207     u   \u00af     T   V ) +   c   ex   \u2032   (   u       n + 1   ,   u   \u00af   )  = \u2212   \u222b     \u03a9   F       \u03c1   F   (     u   \u00af     i     u   j      n + 1     u   i , k      n + 1     V   k , j     +     u   \u00af     i , k     V   k , j     u   j      n + 1     u   i      n + 1   \u2212     u   \u00af     i     u   j      n + 1     u   i , j      n + 1     V   k , k   )  d \u03a9 ,      (77)    d   V   \u2032   (   z       n + 1   ,   z   \u00af   )  = \u2212   d   \u2322   (   z       n + 1   ;   \u2207       n + 1     z   T   V ,   z   \u00af   ) \u2212 d (   z       n + 1   , \u2207     z   \u00af     T   V ) +   d   V   \u2032   (   z       n + 1   ,   z   \u00af   )   \u2212   1   2     \u222b     \u03a9   S       C   ijkl   [   z   k , m      n + 1     V   m , l   +   z   l , m      n + 1     V   m , k     +   z   i , m      n + 1     V   m , k     z   i , m      n + 1     +   n + 1     z   i , l     z   i , m      n + 1     V   m , l   ]     \u03b5   \u2322     ij   (   z       n + 1   ;   z   \u00af   )  d \u03a9   \u2212   1   2     \u222b     \u03a9   S       C   ijkl     \u03b5   kl   (   z       n + 1   ) [     z   \u00af     i , m     V   m , j   +     z   \u00af     j , m     V   m , i   +     z   \u00af     k , m     V   m , i     z   k , j      n + 1     +   z   k , i      n + 1       z   \u00af     k , m     V   m , j   +     z   \u00af     k , i     z   k , m      n + 1     V   m , j   +   z   k , m      n + 1     V   m , i       z   \u00af     k , j   ]  d \u03a9   +   \u222b     \u03a9   S       C   ijkl     \u03b5   kl   (   z       n + 1   )     \u03b5   \u2322     ij   (   z       n + 1   ;   z   \u00af   )   V   m , m    d \u03a9 ,      (78)    e   V   \u2032   (   u       n + 1   ,   v       n + 1   ,   u   \u00af   )  = \u2212 e (   \u2207       n + 1     u   T   V ,   v       n + 1   ,   u   \u00af   )  \u2212 e (   u       n + 1   ,   v       n + 1   , \u2207     u   \u00af     T   V ) +   e   ex   \u2032   (   u       n + 1   ,   v       n + 1   ,   u   \u00af   )  =   \u222b     \u03a9   F       \u03c1   F   (     u   \u00af     i     v   j      n + 1     u   i , k      n + 1     V   k , j    +     u   \u00af     i , k     V   k , j     v   j      n + 1     u   i      n + 1   \u2212     u   \u00af     i     v   j      n + 1     u   i , j      n + 1     V   k , k   )  d \u03a9   and  (79)    d   V   m \u2032   (   v       n + 1   ,   v   \u00af   )  = \u2212     d   \u2322     m   (   v       n + 1   ;   \u2207       n + 1     v   T   V ,   v   \u00af   ) \u2212   d   m   (   v       n + 1   , \u2207     v   \u00af     T   V ) +   d   ex   m \u2032   (   v       n + 1   ,   v   \u00af   )  = \u2212   1   2     \u222b     \u03a9   F       C   ijkl   m   [   v   k , q      n + 1     V   q , l   +   v   l , q      n + 1     V   q , k   +   v   s , q      n + 1     V   q , k     v   s , l      n + 1    +   v   s , k      n + 1     v   s , q      n + 1     V   q , l   ]     \u03b5   \u2322     ij   (   v       n + 1   ;   v   \u00af   )  d \u03a9  \u2212   1   2     \u222b     \u03a9   F       C   ijkl   m     \u03b5   kl   (   v       n + 1   ) [     v   \u00af     i , q     V   q , j   +     v   \u00af     j , q     V   q , i   +     v   \u00af     s , q     V   q , i     v   s , j      n + 1    +   v   s , i      n + 1       v   \u00af     s , q     V   q , j   +     v   \u00af     s , i     v   s , q      n + 1     V   q , j   +   v   s , q      n + 1     V   q , i       v   \u00af     s , j   ]  d \u03a9  +   \u222b     \u03a9   F       C   ijkl   m     \u03b5   kl   (   v       n + 1   )     \u03b5   \u2322     ij   (   v       n + 1   ;   v   \u00af   )   V   q , q    d \u03a9 .   The converged mesh velocity   v    ( i )     n   becomes the initial velocity at configuration ( n + 1 ) :  (80)    v       n + 1   =   w       n + 1   +   y       n + 1   =   z       n + 1   +   y   F      n + 1   ,    w       n + 1   \u2208 V  and    y       n + 1   \u2208   V   \u00af   .   In the fluid domain, the following can be defined for the discretized virtual velocity     U   \u00af     F   :  (81)      U   \u00af     F   T   (   J   UF      n + 1       \u03c7   \u0307     F       +   J   UI      n + 1       \u03c7   \u0307     I       +   J   UM      n + 1       \u03c7   \u0307     M       )  \u2261 a (     u   \u0307         n + 1   ,   u   \u00af   ) +   c   \u2322   (   u       n + 1   ;     u   \u0307         n + 1   ,   u   \u00af   ) + b (     p   \u0307         n + 1   ,   u   \u00af   )   + e (     u   \u0307         n + 1   ,   v       n + 1   ,   u   \u00af   ) + e (   u       n + 1   ,     y   \u0307         n + 1   ,   u   \u00af   ) + e (   u       n + 1   ,     w   \u0307         n + 1   ,   u   \u00af   )  = \u2212   a   V   \u2032   (   u       n + 1   ,   u   \u00af   ) \u2212   b   V   \u2032   (   p       n + 1   ,   u   \u00af   ) \u2212   c   V   \u2032   (   u       n + 1   ,   u   \u00af   ) \u2212   e   V   \u2032   (   u       n + 1   ,   v       n + 1   ,   u   \u00af   )  \u2261 \u2212     U   \u00af     F   T       f   \u02dc     U      n + 1   ,  \u2200   u   \u00af   \u2208   U   \u00af   ,   and for the discretized virtual pressure     P   \u00af     T   = {     P   \u00af     F   T        P   \u00af     I   T   }    (82)      P   \u00af     T   (   J   PE      n + 1       \u03c7   \u0307     F   ) \u2261 b (   p   \u00af   ,     u   \u0307         n + 1   ) = \u2212   b   V   \u2032   (   p   \u00af   ,   u       n + 1   ) \u2261 \u2212     P   \u00af     T       f   \u02dc     P      n + 1   ,  \u2200   p   \u00af   \u2208   P   \u00af   ,   where  (83)      \u03c7   \u0307     F   T   = {     U   \u0307     F   T     n + 1        P   \u0307     F   T     n + 1        P   \u0307     I   T     n + 1   } ,      (84)      \u03c7   \u0307     I   =     Z   \u0307     I      n + 1     and  (85)      \u03c7   \u0307     M   =     Y   \u0307     F      n + 1   .   Eqs. (81) and (82) are restated, in a matrix form, as  (86)    {         U   \u00af     F         P   \u00af       }   T   [       J   UF      n + 1       J   UI      n + 1       J   UM      n + 1         J   PE      n + 1     0   0     ] {         \u03c7   \u0307     F           \u03c7   \u0307     I           \u03c7   \u0307     M       }  = \u2212   {         U   \u00af     F         P   \u00af       }   T   {         f   \u02dc     U      n + 1           f   \u02dc     P      n + 1       } .   Combining two rows in Eq. (86) using     \u03c7   \u00af     F   T   = {     U   \u00af     F   T        P   \u00af     T   } and   f   F   T     n   = {     f   \u02dc     U   T     n        f   \u02dc     P   T     n   } , the following is obtained:  (87)      \u03c7   \u00af     F   T   [   J   FF      n + 1      J   FI      n + 1      J   FM      n + 1   ] {         \u03c7   \u0307     F           \u03c7   \u0307     I           \u03c7   \u0307     M       } = \u2212     \u03c7   \u00af     F   T       f   \u02dc     F      n + 1   .   In the solid domain, taking     \u03c7   \u0307     S   = \u0394     Z   \u0307     S   , the following holds for the discretized virtual displacement     Z   \u00af     S   :  (88)      Z   \u00af     S   T   (   J   SS      n + 1       \u03c7   \u0307     S   +   J   SI      n + 1       \u03c7   \u0307     I   )  \u2261   d   \u2322   (   z       n + 1   ;     z   \u0307         n + 1   ,   z   \u00af   )  = \u2212   d   V   \u2032   (   z       n + 1   ,   z   \u00af   ) \u2261 \u2212     Z   \u00af     S   T       f   \u02dc     S      n + 1   ,  \u2200   z   \u00af   \u2208   Z   \u00af   .   On the interface, using the fact that     U   \u00af     I   =     Z   \u00af     I   , the following holds:  (89)      Z   \u00af     I   T   (   J   IF      n + 1       \u03c7   \u0307     F   +   J   IS      n + 1       \u03c7   \u0307     S   +   J   II      n + 1       \u03c7   \u0307     I   +   J   IM      n + 1       \u03c7   \u0307     M   ) \u2261 \u2212     Z   \u00af     I   T       f   \u02dc     I      n + 1   .   For the discretized mesh velocity, the following can be written:  (90)      V   \u00af     T   (   J   MI      n + 1       \u03c7   \u0307     I   +   J   MM      n + 1       \u03c7   \u0307     M   )  \u2261     d   \u2322     m   (   v       n + 1   ;     w   \u0307         n + 1   ,   v   \u00af   ) +     d   \u2322     m   (   v       n + 1   ;     y   \u0307         n + 1   ,   v   \u00af   )  = \u2212   d   V   m \u2032   (   v       n + 1   ,   v   \u00af   ) \u2261 \u2212     V   \u00af     T       f   \u02dc     M      n + 1   ,  \u2200   v   \u00af   \u2208   V   \u00af   .   Eqs. (87)\u2013(90) are expressed, in an algebraic form, as  (91)  [       J   FF      n + 1     0     J   FI      n + 1       J   FM      n + 1       0     J   SS      n + 1       J   SI      n + 1     0       J   IF      n + 1       J   IS      n + 1       J   II      n + 1       J   IM      n + 1       0   0     J   MI      n + 1       J   MM      n + 1       ] {         \u03c7   \u0307     F           \u03c7   \u0307     S           \u03c7   \u0307     I           \u03c7   \u0307     M       } = \u2212 {         f   \u02dc     F      n + 1           f   \u02dc     S      n + 1           f   \u02dc     I      n + 1           f   \u02dc     M      n + 1       } .   Note that Eq. (91) is a linear system of equations for the sensitivity   {     \u03c7   \u0307     F        \u03c7   \u0307     S        \u03c7   \u0307     I        \u03c7   \u0307     M   }   T   . The tangent in Eq. (91) is obtained from the converged tangent in Eq. (62).  Consider a general performance measure for the FSI problem that can be written in an integral form at the final equilibrium configuration ( n + 1 ) :  (92)  \u03c8 =   \u222b     \u03a9   F       f   F   (   u       n + 1   ,   p       n + 1   ,   v       n + 1   )  d \u03a9 +   \u222b     \u03a9   S       f   S   (   z       n + 1   , \u2207   z       n + 1   )  d \u03a9 +   \u222b     \u0393   F       g   F   (   u       n + 1   ,   p       n + 1   ,   v       n + 1   )  d \u0393 +   \u222b     \u0393   S       g   S   (   z       n + 1   , \u2207   z       n + 1   )  d \u0393 +   \u222b     \u0393   I       g   I   (   u       n + 1   ,   p       n + 1   ,   v       n + 1   ,   z       n + 1   , \u2207   z       n + 1   )  d \u0393 .   The first order variation of Eq. (92) is obtained by  (93)  \u03c8 \u2032 =   \u222b     \u03a9   F     (   f   F , u       u   \u0307         n + 1   +   f   F , p       p   \u0307         n + 1   +   f   F , v       v   \u0307         n + 1   )  d \u03a9 +   \u222b     \u03a9   S     (   f   S , z       z   \u0307         n + 1   +   f   S , \u2207 z   \u2207     z   \u0307         n + 1   )  d \u03a9 +   \u222b     \u0393   F     (   g   F , u       u   \u0307         n + 1   +   g   F , p       p   \u0307         n + 1   +   g   F , v       v   \u0307         n + 1   )  d \u0393 +   \u222b     \u0393   S     (   g   S , z       z   \u0307         n + 1   +   g   S , \u2207 z   \u2207     z   \u0307         n + 1   )  d \u0393 +   \u222b     \u0393   I     (   g   I , u       u   \u0307         n + 1   +   g   I , p       p   \u0307         n + 1   +   g   I , v       v   \u0307         n + 1   +   g   I , z       z   \u0307         n + 1   +   g   I , \u2207 z   \u2207     z   \u0307         n + 1   )  d \u0393 \u2212   \u222b     \u03a9   F     {   f   F , u   \u2207   u    T     n + 1   V +   f   F , p   \u2207   p    T     n + 1   V +   f   F , v   \u2207   v    T     n + 1   V \u2212 div (   f   F   V ) }  d \u03a9 \u2212   \u222b     \u03a9   S     {   f   S , z   \u2207   z    T     n + 1   V +   f   S , \u2207 z   \u2207 \u2207   z    T     n + 1   V \u2212 div (   f   S   V ) }  d \u03a9 \u2212   \u222b     \u0393   F     {   g   F , u   \u2207   u    T     n + 1   V +   g   F , p   \u2207   p    T     n + 1   V +   g   F , v   \u2207   v    T     n + 1   V \u2212 ( \u2207   g   F   T   n +   Hg   F   )   V   T   n }  d \u0393 \u2212   \u222b     \u0393   S     {   g   S , z   \u2207   z    T     n + 1   V +   g   S , \u2207 z   \u2207 \u2207   z    T     n + 1   V \u2212 ( \u2207   g   I   T   n +   Hg   I   )   V   T   n }  d \u0393 \u2212   \u222b     \u0393   I     (   g   I , u   \u2207   u    T     n + 1   V +   g   I , p   \u2207   p    T     n + 1   V +   g   I , v   \u2207   v    T     n + 1   V +   g   I , z   \u2207   z    T     n + 1   V +   g   I , \u2207 z   \u2207 \u2207   z    T     n + 1   V )  d \u0393 +   \u222b     \u0393   I     ( \u2207   g   I   T   n +   Hg   I   )   V   T   n  d \u0393 .   To construct an adjoint system, consider Eqs. (71)\u2013(73) at configuration ( n + 1 ) . Changing the variables,     u   \u0307         n + 1   \u2192   \u03be   \u00af   ,   u   \u00af   \u2192 \u03be ,     p   \u0307         n + 1   \u2192   \u03d5   \u00af   ,   p   \u00af   \u2192 \u03d5 ,     z   \u0307         n + 1   \u2192   \u03b6   \u00af   ,   z   \u00af   \u2192 \u03b6 ,     v   \u0307         n + 1   \u2192   \u03c6   \u00af   ,   v   \u00af   \u2192 \u03c6 since each pair of them belongs to the same function space, the internal virtual work can be defined as  (94)  a (   \u03be   \u00af   , \u03be ) + b (   \u03d5   \u00af   , \u03be ) +   c   \u2322   (   u       n + 1   ;   \u03be   \u00af   , \u03be ) +   d   \u2322   (   z       n + 1   ;   \u03b6   \u00af   , \u03b6 )  + e (   \u03be   \u00af   ,   v       n + 1   , \u03be ) + e (   u       n + 1   ,   \u03c6   \u00af   , \u03be ) + b ( \u03d5 ,   \u03be   \u00af   ) +     d   \u2322     m   (   v       n + 1   ;   \u03c6   \u00af   , \u03c6 ) ,   where   \u03be   \u00af   ,   \u03d5   \u00af   ,   \u03b6   \u00af   , and   \u03c6   \u00af   are the virtual velocity, pressure, displacement, and mesh velocity, respectively. Also, changing the variables,     u   \u0307         n + 1   \u2192   \u03be   \u00af   ,     p   \u0307         n + 1   \u2192   \u03d5   \u00af   ,     v   \u0307         n + 1   \u2192   \u03c6   \u00af   ,     z   \u0307         n + 1   \u2192   \u03b6   \u00af   in the implicit dependence terms in Eq. (93) since each pair belongs to the same function space, an adjoint load can be defined as  (95)    \u222b     \u03a9   F     (   f   F , u     \u03be   \u00af   +   f   F , p     \u03d5   \u00af   +   f   F , v     \u03c6   \u00af   )  d \u03a9 +   \u222b     \u03a9   S     (   f   S , z     \u03b6   \u00af   +   f   S , \u2207 z   \u2207   \u03b6   \u00af   )  d \u03a9 +   \u222b     \u0393   F     (   g   F , u     \u03be   \u00af   +   g   F , p     \u03d5   \u00af   +   g   F , v     \u03c6   \u00af   )  d \u0393 +   \u222b     \u0393   S     (   g   S , z     \u03b6   \u00af   +   g   S , \u2207 z   \u2207   \u03b6   \u00af   )  d \u0393 +   \u222b     \u0393   I     (   g   I , u     \u03be   \u00af   +   g   I , p     \u03d5   \u00af   +   g   I , v     \u03c6   \u00af   +   g   I , z     \u03b6   \u00af   +   g   I , \u2207 z   \u2207   \u03b6   \u00af   )  d \u0393 .   The adjoint system of expressions (94) and (95) consists of a linear system of equations for the adjoint variables. Its tangent can be directly obtained from the converged tangent at configuration ( n + 1 ) in Eq. (62). The mesh velocity \u03c6 in adjoint system is decomposed into a prescribed function \u03c9 that is identical to the interface displacement   \u03b6   I   and an arbitrary function \u03bb that satisfies a homogeneous boundary condition on the interface   \u0393   I   :  (96)  \u03c6 = \u03c9 + \u03bb =   \u03b6   I   +   \u03bb   F   ,  \u03c9 \u2208 V  and  \u03bb \u2208   V   \u00af   .   Also, the virtual mesh velocity can be decomposed into two virtual functions as  (97)    \u03c6   \u00af   =   \u03c9   \u00af   +   \u03bb   \u00af   =   \u03bb   \u00af   ,    \u03c9   \u00af    and    \u03bb   \u00af   \u2208   V   \u00af   .   In the fluid domain, the following can be defined for the discretized virtual velocity     \u039e   \u00af     F   :  (98)      \u039e   \u00af     F   T   (   J   UF      n + 1     \u039b   F   +   J   UI      n + 1     \u039b   I   )  \u2261 a (   \u03be   \u00af   , \u03be ) +   c   \u2322   (   u       n + 1   ;   \u03be   \u00af   , \u03be ) + b ( \u03d5 ,   \u03be   \u00af   ) + e (   \u03be   \u00af   ,   v       n + 1   , \u03be )  =   \u222b     \u03a9   F       f   F , u     \u03be   \u00af    d \u03a9 +   \u222b     \u0393   F       g   F , u     \u03be   \u00af    d \u0393 +   \u222b     \u0393   I       g   I , u     \u03be   \u00af    d \u0393 \u2261     \u039e   \u00af     F   T       f   ^     U      n + 1   ,   where  (99)    \u039b   F   T   = {   \u039e   F   T      \u03a6   F   T      \u03a6   I   T   }   and  (100)    \u039b   I   =   Z   I   .   Vectors \u039e , \u03a6 , and Z (capital zeta) denote the discretized adjoint velocity, pressure, and displacement respectively. And over-bar denotes the corresponding discretized virtual functions. Also, the following can be defined for the discretized virtual pressure     \u03a6   \u00af     T   = {     \u03a6   \u00af     F   T        \u03a6   \u00af     I   T   . } :  (101)      \u03a6   \u00af     T   (   J   PF      n + 1     \u039b   F   )  \u2261 b (   \u03d5   \u00af   , \u03be )  =   \u222b     \u03a9   F       f   F , p     \u03d5   \u00af    d \u03a9 +   \u222b     \u0393   F       g   F , p     \u03d5   \u00af    d \u0393 +   \u222b     \u0393   I       g   I , p     \u03d5   \u00af    d \u0393 \u2261     \u03a6   \u00af     T       f   ^     P      n   .   Eqs. (98) and (101) are restated, in a matrix form, as  (102)    {         \u039e   \u00af     F         \u03a6   \u00af       }   T   [       J   UF      n + 1       J   UI      n + 1     0       J   PF      n + 1     0   0     ] {       \u039b   F         \u039b   I         \u039b   M       }  =   {         \u039e   \u00af     F         \u03a6   \u00af       }   T   {         f   ^     U      n + 1           f   ^     P      n + 1       } .   Combining two rows in Eq. (102) using     \u039b   \u00af     F   T   = {     \u039e   \u00af     F   T        \u03a6   \u00af     T   } and     f   ^     F   T     n + 1   = {     f   ^     U   T     n + 1        f   ^     P   T     n + 1   } , the following is obtained:  (103)      \u039b   \u00af     F   T   [   J   FF      n + 1      J   FI      n + 1    0 ] {       \u039b   F         \u039b   I         \u039b   M       } =     \u039b   \u00af     F   T       f   ^     F   T     n + 1   .   In the solid domain, taking   \u039b   S   =   Z   S   , the following holds for the discretized adjoint virtual displacement     Z   \u00af     S   :  (104)      Z   \u00af     S   T   (   J   SS      n + 1     \u039b   S   +   J   SI      n + 1     \u039b   I   )  \u2261   d   \u2322   (   z       n   ; \u03b6 ,   \u03b6   \u00af   )  =   \u222b     \u03a9   S     (   f   S , z     \u03b6   \u00af   +   f   S , \u2207 z   \u2207   \u03b6   \u00af   )  d \u03a9 +   \u222b     \u0393   S       g   S , z     \u03b6   \u00af   d \u0393 +   \u222b     \u0393   I     (   g   I , z     \u03b6   \u00af   +   g   I , \u2207 z   \u2207   \u03b6   \u00af   )  d \u0393 \u2261     Z   \u00af     S   T       f   ^     S      n + 1   .   On the interface, using the fact that     \u039e   \u00af     I   =     Z   \u00af     I   , the following holds:  (105)      Z   \u00af     I   T   (   J   IF      n + 1     \u039b   F     +   n + 1     J   IS     \u039b   S   +   J   II      n + 1     \u039b   I   +   J   IM      n + 1     \u039b   M   ) \u2261     Z   \u00af     I   T       f   ^     I      n + 1   .   For the discretized adjoint virtual mesh velocity   \u03a0   \u00af   , the following can be written:  (106)      \u03a0   \u00af     T   (   J   MF      n + 1     \u039b   F     +   n + 1     J   MI     \u039b   I   +   J   MM      n + 1     \u039b   M   )  \u2261 e (   u       n + 1   ,   \u03c6   \u00af   , \u03be ) +     d   \u2322     m   (   v       n + 1   ;   \u03c6   \u00af   , \u03c6 )  =   \u222b     \u03a9   F       f   F , v     \u03c6   \u00af    d \u03a9 +   \u222b     \u0393   F       g   F , v     \u03c6   \u00af    d \u0393 +   \u222b     \u0393   I       g   I , v     \u03c6   \u00af    d \u0393  \u2261     \u03a0   \u00af     T       f   ^     M      n + 1   ,   where  (107)    \u039b   M   =   \u0398   F   .   In Eq. (107), \u0398 is the discretized vector of \u03bb . Finally, Eqs. (103)\u2013(106) are expressed, in an algebraic form, as  (108)  [       J   FF      n + 1     0     J   FI      n + 1     0     0     J   SS      n + 1       J   SI      n + 1     0       J   IF      n + 1       J   IS      n + 1       J   II      n + 1       J   IM      n + 1         J   MF      n + 1     0     J   MI      n + 1       J   MM      n + 1       ] {       \u039b   F         \u039b   S         \u039b   I         \u039b   M       } = {         f   ^     F      n + 1           f   ^     S      n + 1           f   ^     I      n + 1           f   ^     M      n + 1       } .   Note that the tangent in the adjoint equation (108) is the transpose of tangent for the sensitivity analysis in Eq. (91). Since Eqs. (94) and (95) are identical, the implicit dependence terms in Eq. (93) can be expressed as  (109)  \u2212   a   V   \u2032   (   u       n + 1   , \u03be ) \u2212   b   V   \u2032   (   p       n + 1   , \u03be ) \u2212   c   V   \u2032   (   u       n + 1   , \u03be ) \u2212   d   V   \u2032   (   z       n + 1   , \u03b6 )  \u2212   e   V   \u2032   (   u       n + 1   ,   v       n + 1   , \u03be ) \u2212   b   V   \u2032   ( \u03d5 ,   u       n + 1   ) \u2212   d   V   m \u2032   (   v       n + 1   , \u03bb ) .   Plugging expression (109) into Eq. (93) leads to  (110)  \u03c8 \u2032 = \u2212   a   V   \u2032   (   u       n + 1   , \u03be ) \u2212   b   V   \u2032   (   p       n + 1   , \u03be ) \u2212   c   V   \u2032   (   u       n + 1   , \u03be ) \u2212   d   V   \u2032   (   z       n + 1   , \u03b6 ) \u2212   e   V   \u2032   (   u       n + 1   ,   v       n + 1   , \u03be ) \u2212   b   V   \u2032   ( \u03d5 ,   u       n + 1   ) \u2212   d   V   m \u2032   (   v       n + 1   , \u03bb ) \u2212   \u222b     \u03a9   F     {   f   F , u   \u2207   u    T     n + 1   V +   f   F , p   \u2207   p    T     n + 1   V +   f   F , v   \u2207   v    T     n + 1   V \u2212 div (   f   F   V ) }  d \u03a9 \u2212   \u222b     \u03a9   S     (   f   S , z   \u2207   z    T     n + 1   V +   f   S , \u2207 z   \u2207 \u2207   z    T     n + 1   V \u2212 div (   f   S   V ) )  d \u03a9 \u2212   \u222b     \u0393   F     {   g   F , u   \u2207   u    T     n + 1   V +   g   F , p   \u2207   p    T     n + 1   V +   g   F , v   \u2207   v    T     n + 1   V \u2212 ( \u2207   g   F   T   n +   Hg   F   )   V   T   n }  d \u0393 \u2212   \u222b     \u0393   S     {   g   S , z   \u2207   z    T     n + 1   V +   g   S , \u2207 z   \u2207 \u2207   z    T     n + 1   V \u2212 ( \u2207   g   I   T   n +   Hg   I   )   V   T   n }  d \u0393 \u2212   \u222b     \u0393   I     (   g   I , u   \u2207   u    T     n + 1   V +   g   I , p   \u2207   p    T     n + 1   V +   g   I , v   \u2207   v    T     n + 1   V +   g   I , z   \u2207   z    T     n + 1   V +   g   I , \u2207 z   \u2207 \u2207   z    T     n + 1   V )  d \u0393 +   \u222b     \u0393   I     ( \u2207   g   I   T   n +   Hg   I   )   V   T   n  d \u0393 .   Note that Eq. (110) is expressed in terms of only explicit dependence terms on the design.  Using a Newton type iterative method, the ALE-based FSI problem should be solved simultaneously in fluid and solid domains at a specific time. Also, the required mesh velocity needs to be determined in a consistent way with the obtained solutions. Thus, a correct tangent for the systems of equations is crucial for the convergence and efficiency of the solutions. Consider a flow in a symmetric channel (shaded regions in Fig. 3 ) made of an elastic material whose properties are Young\u05f3s modulus E = 10 , 000 , Poisson ratio \u03bd = 0.3 , mass density \u03c1 = 1 , Lam\u00e9 constant \u03bc = 0.1 , and the thickness of elastic wall t=1.0. The fluid flows in the channel from the left-hand side of fluid domain. The profile of the prescribed flow velocity (   u   0   = 0.8 ) with the Reynolds number Re=288 and the geometry of the model are shown in Fig. 3. The units are non-dimensionalized and artificial material properties are selected to magnify the coupling effects between the fluids and solids. Due to the symmetry of the model, a half model is considered. The magnitude of the prescribed velocity is divided into 10 steps, which are applied in an incremental way. Fig. 4 shows the deformed shape of solid and the contours for pressure and velocity vector whose direction and magnitude are expressed by the arrows.  For the stability of fluid analysis, the fluid velocity and the pressure fields are discretized using a biquadratic and a bilinear quadrilateral shape functions (i.e., Q2/Q1), respectively. To meet the requirement that the virtual displacement   z   \u00af   ( s \u2032 ) at the undeformed interface is equal to the virtual velocity   u   \u00af   ( s \u2033 ) at the deformed interface, an identical shape function is utilized for the displacement in solids and the velocity in fluids.  The whole load is divided into 10 load steps. The convergence criterion for j-th load step is usually expressed in a normalized form as  (111)  \u2225 \u0394   \u03c7   j   \u2225 / \u2225   \u03c7   j   \u2225 \u2264   10   \u2212 5   .   In the j-th load step, a prescribed velocity of (j/10)   u   0   is applied and all the incremental solutions such as displacement z , velocity u, pressure p, and mesh velocity v are plotted in a log scale. In all the loading steps, the ratio \u2225 \u0394   \u03c7   i + 1   \u2225 / \u2016 \u0394   \u03c7   i     \u2016   2   falls between 0.0112 and 0.5826. Fig. 5 shows a quadratic convergence order in all kinds of solution such as the displacement in solids, the velocity and pressure of fluid, and the mesh velocity for ALE formulation, which implies that the excellent convergence and stability of solution are due to the accurate tangent of system matrix and the fact that the Q2/Q1 pair satisfies the Ladyzhenskaya\u2013Babuska\u2013Brezzi stability condition [24].  To verify how accurately the derived analytical sensitivity is implemented, we compared the adjoint shape sensitivity with the finite difference one. In Fig. 6 , the design domain is parameterized by cubic NURBS curves that include 10 control points. The x and y coordinates of arbitrarily selected three control points (#2, #5, and #8) are perturbed by the same amount in each direction. To determine the appropriate amount of perturbation in finite differencing, we performed the step size analysis for the shape design sensitivity of strain energy in solids. The design is perturbed by \u03b4 b =   10   \u2212 5   b as shown in Fig. 6(b) since the acceptable parameter of design perturbation is determined as   10   \u2212 5   \u2013   10   \u2212 8   . The perturbed design in the figure is exaggerated by 5 \u00d7   10   4   times to distinguish the original and the perturbed designs. Taking the strain energy in solids as a performance measure,  (112)    \u03c8   2   =   1   2     \u222b     \u03a9   S       c   ijkl     \u03b5   kl   (   z       n + 1   )   \u03b5   ij   (   z       n + 1   )  d \u03a9 ,   and an adjoint system is defined from the expressions (94) and (95) as  (113)  a (   \u03be   \u00af   , \u03be ) + b (   \u03d5   \u00af   , \u03be ) +   c   \u2322   (   u       n + 1   ;   \u03be   \u00af   , \u03be ) +   d   \u2322   (   z       n + 1   ;   \u03b6   \u00af   , \u03b6 ) + e (   \u03be   \u00af   ,   v       n + 1   , \u03be )  + e (   u       n + 1   ,   \u03c6   \u00af   , \u03be ) + b ( \u03d5 ,   \u03be   \u00af   ) +     d   \u2322     m   (   v       n + 1   ;   \u03c6   \u00af   , \u03bb ) = d (   z       n + 1   ,   \u03b6   \u00af   ) .   Using the adjoint responses obtained from Eq. (113), the first order variation of strain energy is derived as  (114)    \u03c8   2   \u2032   = \u2212   a   V   \u2032   (   u       n + 1   , \u03be ) \u2212   b   V   \u2032   (   p       n + 1   , \u03be ) \u2212   c   V   \u2032   (   u       n + 1   , \u03be ) \u2212   d   V   \u2032   (   z       n + 1   , \u03b6 ) \u2212   e   V   \u2032   (   u       n + 1   ,   v       n + 1   , \u03be ) \u2212   b   V   \u2032   ( \u03d5 ,   u       n + 1   ) \u2212   d   V   m \u2032   (   v       n + 1   , \u03bb ) +   \u03c8   2 , V   \u2032   (   z       n + 1   ) ,   where  (115)    \u03c8   2 , V   \u2032   (   z       n + 1   ) = \u2212   1   2     \u222b     \u03a9   S       C   ijkl     \u03b5   kl   (   z   i , t     V   t , j   +   z   j , t     V   t , i   +   z   p , t     V   t , i     z   p , j   +   z   p , i     z   p , t     V   t , j   \u2212   \u03b5   ij     V   t , t   )  d \u03a9 .    Table 1 shows the shape design sensitivity of strain energy in solids. In Table 1, the forward difference method is used for the finite difference sensitivity \u0394   \u03c8   2   =   \u03c8   2   ( b + \u03c4 \u03b4 b ) \u2212   \u03c8   2   ( b ) , \u03c4=1. Compared with the finite difference sensitivity, the adjoint sensitivity turns out to be very accurate. To verify the shape design sensitivity of solution, 3 representative nodes are selected as shown in Fig. 7 . The adjoint variable method (AVM) results are compared with the finite difference sensitivities for all the degrees of freedom (DOF) of the selected nodes. The solution   \u03c7       n + 1   at the position   x   ^   in the domain can be expressed in an integral form as  (116)    \u03c8   1   =   \u03c7       n + 1   (   x   ^   ) =   \u222b   \u03a9   \u03b4 ( x \u2212   x   ^   )   \u03c7       n + 1   ( x )  d \u03a9 ,   where \u03b4 ( x ) is a Dirac delta function. Taking the first order variation of Eq. (116),  (117)    \u03c8   1   \u2032   =     \u03c7   \u0307         n + 1   (   x   ^   ) =   \u222b   \u03a9   \u03b4 ( x \u2212   x   ^   )     \u03c7   \u0307         n + 1   ( x )  d \u03a9 ,   and the following adjoint equation can be defined, from Eqs. (94) and (95), as  (118)  a (   \u03be   \u00af   , \u03be ) + b (   \u03d5   \u00af   , \u03be ) +   c   \u2322   (   u       n + 1   ;   \u03be   \u00af   , \u03be )  +   d   \u2322   (   z       n + 1   ;   \u03b6   \u00af   , \u03b6 ) + e (   \u03be   \u00af   ,   v       n + 1   , \u03be ) + e (   u       n + 1   ,   \u03c6   \u00af   , \u03be )  + b ( \u03d5 ,   \u03be   \u00af   ) +     d   \u2322     m   (   v       n + 1   ;   \u03c6   \u00af   , \u03bb ) =   \u222b   \u03a9   \u03b4 ( x \u2212   x   ^   )   \u03b9   \u00af    d \u03a9 ,   where   \u03b9   \u00af   =   \u03be   \u00af   ,   \u03d5   \u00af   ,   \u03b6   \u00af   ,   \u03c6   \u00af   if \u03c7 ( x ) =   u   i   , p,   z   i   ,   v   i   , respectively. Since there are no explicitly dependent terms in Eq. (117) on the design, the shape design sensitivity of the performance measure is obtained by  (119)    \u03c8   1   \u2032   = \u2212   a   V   \u2032   (   u       n + 1   , \u03be ) \u2212   b   V   \u2032   (   p       n + 1   , \u03be ) \u2212   c   V   \u2032   (   u       n + 1   , \u03be ) \u2212   d   V   \u2032   (   z       n + 1   , \u03b6 ) \u2212   e   V   \u2032   (   u       n + 1   ,   v       n + 1   , \u03be ) \u2212   b   V   \u2032   ( \u03d5 ,   u       n + 1   ) \u2212   d   V   m \u2032   (   v       n + 1   , \u03bb ) .    Table 2 shows the shape design sensitivity of the solution. The developed shape DSA method is accurate and efficient compared with the finite difference. For all the DOFs, the adjoint design sensitivity (b) matches well with the finite difference one (a).   Table 3 shows the comparison of computation costs for the DSA. The forward finite difference method (FDM) requires as much computing costs as the response analysis. However, the adjoint variable method (AVM) requires only 2% of the analysis time.  Consider the problem of flows in a channel (gray region). The fluid flows in the system from the bottom-left with a prescribed velocity and flows out of the system from the bottom-right, which is surrounded by the elastic walls as shown in Fig. 8 . Artificial material properties are selected to magnify the coupling effects between the fluids and solids. The material properties, the prescribed velocity, and the Reynolds number of the flow are given in Table 4 .  A design optimization problem is formulated to obtain the optimal shape of solid structure in a channel under steady state incompressible viscous fluid flow. To find an optimal shape of stiff structure, the optimization is formulated to minimize the strain energy of solid under the constraint that the volume of fluid is bigger than the allowable volume:  (120)  minimize    \u03c8   2   =   1   2     \u222b     \u03a9   S       c   ijkl     \u03b5   kl   (   z       n + 1   )   \u03b5   ij   (   z       n + 1   )  d \u03a9 ,      (121)  subject  to    V   Fluid   \u2265   V   allowable   ,   and the side constraints are given by   b   lower   \u2264   b   i   \u2264   b   upper   , where   b   lower   and   b   upper   are the lower and upper bounds for the design variables, respectively. The outer solid region is a designable domain and the inner solid region is assumed to be non-designable. The outer solid and the fluid regions are parameterized by NURBS surfaces as shown in Fig. 9 (a). The blue dots denote the control points, actually the design parameters. Through the design parameterization and mesh generation algorithm, a finite element model is obtained as shown in Fig. 9(b), where the red and blue lines denote the solid elements and the fluid elements, respectively. The interface is described by the cubic NURBS curve that consists of 10 control points. 18 design variables are selected as the coordinates of the control points as shown in Fig. 10 . For the performance measure of strain energy in solids and the 18 design variables, the shape design sensitivity is obtained using the adjoint variable method (AVM) and compared with the finite difference sensitivity (FDM). Excellent agreement is observed for all of the design variables (Table 5 ).   Table 6 shows the comparison of computation costs for the DSA. The forward finite difference method (FDM) requires 18 times of the computing costs of the response analysis. However, the adjoint variable method (AVM) requires 46% of the analysis time for 18 design variables. To solve the nonlinear mathematical programming problem of Eqs. (120) and (121), a gradient-based optimization algorithm of MMFD (modified method of feasible direction) [25] is utilized. After the design optimization under the constraint of 100% allowable volume, the analysis results at the deformed configuration in the fluid domain for the original and the optimal designs are compared in Fig. 11 . The arrows and contours represent the velocity vector and the pressure fields, respectively. Notice that the velocity changes more smoothly and the pressure value gets smaller after the shape optimization. The kinks of interface are smoothed to minimize the gradient of fluid velocity. Also, to minimize the inertial effects, the breadth of fluid gets smaller for the inlet and larger for the outlet, which is easily expected in an intuitive design. Also, the analysis results in the solid domain are compared in Fig. 12 , where the dotted black line and the solid red line represent the un-deformed and the deformed shapes, respectively. Compared with the original design, the optimal one shows much smaller deformations in the solid domain. Fig. 13 shows the history of the shape optimization problem. For the purpose of visualization, a log scale is used for the vertical axis since there is a significantly diminished decrease of objective function after 5th iterations. The strain energy in solids is decreased from 86.81839 to 0.422066, which is 0.5% of the initial value. Notice that the convergence is monotonic and its speed is quite fast, which implies that the derived tangent for the FSI analysis and the obtained adjoint shape design sensitivity are accurate and consistent with each other. During the optimization process, 126 response analyses and 24 design sensitivity analyses are required. If the finite difference sensitivity is used in this optimization problem, it is very time-consuming and could be impractical for large scale problems.   CONCLUSIONS   A coupled variational equation for FSI problems is derived using a steady state Navier\u2013Stokes equation for incompressible flows, an equilibrium equation for geometrically nonlinear solids, a traction continuity condition at interfaces, and a pseudo-equilibrium equation for mesh velocity. The moving boundary in ALE formulation is included in the variational equations by the mesh velocity obtained by solving a displacement-loaded pseudo-structural problem at a unified configuration, which eventually facilitates to derive shape design sensitivity. To obtain the shape sensitivity without any time integrations, the mesh velocity should be determined together with the variational equations at a concurrent time step. Based on material derivative concept, a continuum-based adjoint shape sensitivity is derived under the ALE formulation, which turns out to be very accurate and efficient due to the utilization of converged tangent and the linearity of both adjoint and sensitivity equations. The computation for the response analysis is very time-consuming and expensive due to the nonlinearity of problems. However, the computing cost for the design sensitivity is trivial since the converged solution and the tangent in the response analysis are readily available. Using the developed adjoint DSA method, a shape design optimization problem is formulated for the FSI problems. To facilitate the shape variations, the whole domain including the fluids, solids, and interfaces is parameterized using NURBS surfaces. Through numerical examples, the accuracy and efficiency of the developed DSA method is verified using the finite difference sensitivity. The optimization process is shown to be very efficient and the computing cost for the shape design optimization is significantly reduced due to the obtained adjoint sensitivity.   ACKNOWLEDGMENTS   This work was supported by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIP) (No. 2010-0018282). The support is gratefully acknowledged. The authors would also like to thank Ms. Inyoung Cho at Korea University for editing assistance.   REFERENCES", "highlights": "A coupled variational equation for fluid\u2013solid interaction (FSI) problems is derived using a steady state Navier\u2013Stokes equation for incompressible flows, an equilibrium equation for geometrically nonlinear solids, a traction continuity condition at interfaces, and a pseudo-equilibrium equation for mesh velocity. The moving boundary in arbitrary Lagrangian\u2013Eulerian (ALE) formulation is included in the variational equations by the mesh velocity obtained from a displacement-loaded pseudo-structural problem at a concurrent configuration, which eventually facilitates to derive shape design sensitivity. A continuum-based adjoint shape sensitivity is derived under ALE formulation, which turns out to be very accurate and efficient due to the utilization of converged tangent and the linearity of both adjoint and sensitivity equations. Through numerical examples, the obtained sensitivity is verified in terms of accuracy and efficiency compared with finite difference sensitivity and further applied to the shape optimization problem of finding a stiff structure while satisfying a volume constraint."}