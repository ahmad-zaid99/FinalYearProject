{"id": "S0168874X15001602", "article": "MAIN-TITLE Direct-differentiation-based sensitivity analysis of an axisymmetric finite element formulation including torsion   HIGHLIGHTS          We present a sensitivity analysis for axisymmetry including torsion using the direct differentiation method.      The sensitivity analysis is performed in the framework of finite strains.      The accuracy is assessed by comparison with finite difference results.      The sensitivity analysis permits the use of gradient-based methods in shape optimization in axisymmetry with torsional loads.          KEYPHRASES   Finite element modeling  Generalized axisymmetry  Direct differentiation   In case of axisymmetric or near-axisymmetric geometries, generalized axisymmetry offers the possibility to reduce a three-dimensional model to a two-dimensional model with additional degrees of freedom in tangential direction. Generally speaking, the geometry is defined in a plane, and a discrete Fourier expansion is operated in tangential direction, in order to take into account either a non-axisymmetric geometry or, as in most cases, non-axisymmetric loads. The introduction of a single degree of freedom in tangential direction enables the treatment of axisymmetry with superposed torsion. The generalized axisymmetry thus offers the possibility to strongly reduce the computational effort by reducing the number of degrees of freedom in comparison to a full three-dimensional model. This may especially be of interest in optimization or inverse problems, where the same finite element model has to be recomputed a significant number of times. An additional advantage of an axisymmetric model concerns contact mechanics, as the treatment of contact surfaces in three dimensions is reduced to that of contact curves in two dimensions, which greatly simplifies modeling and enables the use of methods for more efficient contact treatment, like for example contact surface discretizations with C 1-continuity [1].  Among the first authors to produce a finite element formulation for generalized axisymmetry are [2,3] for linear elasticity and [4] for inelastic materials, both at small strains. Finite strain formulations for generalized axisymmetry in solid mechanics have been presented in [5], and later on in various contexts like thermomechanical homogenization [6], mixed or enhanced strain formulations [7\u20139], ALE formulations [6], consolidation analysis [10], or others [11,12]. Contact mechanics in the context of generalized axisymmetry has been treated in [14], for example. One of the major challenges in finite strains is that the base vectors vary with position [13]. The treatment of generalized axisymmetry may be executed either in mathematical or physical coordinates [15], using different ways to arrive at the equations of virtual work. Different mathematical concepts are use for an efficient treatment of generalized axisymmetry. For example, use is made of a mathematical shifter tensor in [16] for deriving the kinematics of generalized axisymmetry. In [5], the finite element equations use cylindrical coordinates for the description of the geometry, but the displacements are kept in Cartesian coordinates, in order to avoid displacement locking. Issues related to the numerical integration of axisymmetric finite element formulations are discussed in [17], an improved treatment of incompressibility is detailed in [18] and methods for reducing mesh locking in the context of axisymmetry are given in [19\u201321], for example.  Sensitivity analysis, i.e. the calculation of derivatives with respect to model parameters like material or shape parameters, amongst others, is useful in gradient-based solution methods of inverse problems or shape optimization. Various aspects of sensitivity analysis in standard axisymmetry have been presented in [22\u201324], for example. Recently, the sensitivity analysis using the adjoint state method for generalized axisymmetry with fully asymmetric loading has been presented in [25] for the case of small strains. In the present work, sensitivity analysis based on the direct differentiation method is presented for finite strains for the most simple case of generalized axisymmetry, i.e. axisymmetry with superposed torsion. First, the kinematics of generalized axisymmetry are outlined. Then, the linearization and sensitivity analysis of the kinematic quantities are presented and introduced into the virtual work equation. With the sensitivity of the Cauchy stress, the discretized formulation of the linearized virtual work equation is given. Finally, the performance of the sensitivity analysis is assessed in two examples by comparing the sensitivities obtained by direct differentiation to those obtained by the finite difference method.  According to [13], the geometry x in the current state, described by the coordinates r, z and \u03d5,  (1)  x = r   e   r   + z   e   z   ,   is related to the initial geometry with coordinates R, Z and \u03a6 through the radial displacement u, the vertical displacement v and the angular displacement \u03b8:  (2)  r = R + u ( R , Z ) z = Z + v ( R , Z ) \u03d5 = \u03a6 + \u03b8 ( R , Z ) .   The current basis vectors are   e   r   ,   e   \u03d5   and   e   z   , the first two depending on \u03d5. Then, the deformation gradient can be expressed as  (3)  F = (       \u2202 r   \u2202 R       \u2202 r   \u2202 Z     0       \u2202 z   \u2202 R       \u2202 z   \u2202 Z     0     r   \u2202 \u03d5   \u2202 R     r   \u2202 \u03d5   \u2202 Z       r   R     \u2202 \u03d5   \u2202 \u03a6       ) = (     1 +   \u2202 u   \u2202 R       \u2202 u   \u2202 Z     0       \u2202 v   \u2202 R     1 +   \u2202 v   \u2202 Z     0     r   \u2202 \u03b8   \u2202 R     r   \u2202 \u03b8   \u2202 Z     1 +   u   R       ) .      Taking into account that in polar or cylindrical coordinates, the non-zero variations of the basis vectors are  (4)  \u03b4   e   r   = \u03b4 \u03b8    e   \u03d5   \u03b4   e   \u03d5   = \u2212 \u03b4 \u03b8    e   r   ,   the variation of the deformation gradient, Eq. (3), becomes  (5)  \u03b4 F = (       \u2202 \u03b4 u   \u2202 R       \u2202 \u03b4 u   \u2202 Z     0       \u2202 \u03b4 v   \u2202 R       \u2202 \u03b4 v   \u2202 Z     0     r   \u2202 \u03b4 \u03b8   \u2202 R     r   \u2202 \u03b4 \u03b8   \u2202 Z       \u03b4 u   R       ) + (     0   0   0     0   0   0     \u03b4 u   \u2202 \u03d5   \u2202 R     \u03b4 u   \u2202 \u03d5   \u2202 Z     0     ) + \u03b4 \u03b8 (     \u2212 r   \u2202 \u03d5   \u2202 R     \u2212 r   \u2202 \u03d5   \u2202 Z     \u2212   r   R       0   0   0       \u2202 r   \u2202 R       \u2202 r   \u2202 Z     0     ) .   With the partial velocity gradient  (6)  \u03b4   L   \u02dc   = (       \u2202 \u03b4 u   \u2202 r       \u2202 \u03b4 u   \u2202 z     0       \u2202 \u03b4 v   \u2202 r       \u2202 \u03b4 v   \u2202 z     0     r   \u2202 \u03b4 \u03b8   \u2202 r     r   \u2202 \u03b4 \u03b8   \u2202 z       \u03b4 u   r       )   and the sparse anti-symmetric tensor  (7)  \u03b4 \u039e = (     0   0   \u2212 \u03b4 \u03b8     0   0   0     \u03b4 \u03b8   0   0     ) ,   the variation of the deformation gradient can be expressed as  (8)  \u03b4 F = \u03b4   L   \u02dc   F + \u03b4 \u039e  F ,   where the last term in Eq. (5), which stems from the basis variation, equals the last term in Eq. (8). The variation of the velocity gradient \u03b4 L is subsequently obtained by multiplying Eq. (8) by the inverse of the deformation gradient, yielding  (9)  \u03b4 L = \u03b4 F    F   \u2212 1   = \u03b4   L   \u02dc   + \u03b4 \u039e .      In opposition to sensitivities of kinematic entities with respect to material parameters, where the sensitivities correspond to a linearization, shape sensitivities include additional terms because the initial and current coordinates include the shape change. Thus, for shape sensitivities, Eq. (2) has to be rewritten using a reference geometry,   X   r   , a design velocity V and a parameter \u03c4 quantifying the design change, as described in [26,27]. In the following, the sensitivity of a generic variable \u03b1, designating either a scalar or a first or second order tensor, is defined as  (10)    [  \u03b1  ]   \u22c4   =    lim   \u03c4 \u2192 0      \u03b1 (    X   r   + \u03c4 V (    X   r    )  ) \u2212 \u03b1 (    X   r    )   \u03c4   .   It should be noted that the design change is prescribed on the boundary of the solid, but the way the resulting design velocity propagates into the interior of the solid is determined using methods like the finite difference method, isoparametric mapping, boundary displacement method or fictitious load method [26,27]. In the present work, the boundary displacement method is used. In generalized axisymmetry, the shape change only affects the in-plane initial coordinates, i.e. no shape change in tangential direction, or shape change dependency in tangential direction, takes place. Thus one can extend Eq. (2) into  (11)  r =   R   r   +   V   r   \u03c4 + u ( R , Z ) z =   Z   r   +   V   z   \u03c4 + v ( R , Z ) \u03d5 = \u03a6 + \u03b8 ( R , Z ) .   The linearization of the deformation gradient gives a similar result to Eq. (5), notably  (12)    [  F  ]   \u22c4   =   [    L   \u02dc    ]   \u22c4    F +   [  \u039e  ]   \u22c4    F \u2212 F   \u2202 V   \u2202 X   ,   with  (13)    \u2202 V   \u2202 X   = (       \u2202   V   r     \u2202 R       \u2202   V   r     \u2202 Z     0       \u2202   V   z     \u2202 R       \u2202   V   z     \u2202 Z     0     0   0       V   r     R       ) .   The last term in Eq. (12) comes from the dependency of the initial geometry on the shape velocity in the differentiation with respect to the initial geometry, as explained in [27]. Multiplying Eq. (12) with the inverse of the deformation gradient, one gets  (14)    [  L  ]   \u22c4   =   [  F  ]   \u22c4      F   \u2212 1   =   [    L   \u02dc    ]   \u22c4   +   [  \u039e  ]   \u22c4   \u2212 F   \u2202 V   \u2202 x   ,   where  (15)    \u2202 V   \u2202 x   =   \u2202 V   \u2202 X      F   \u2212 1     and the tensors   [    L   \u02dc    ]   \u22c4   and   [  \u039e  ]   \u22c4   are defined as  (16)    [    L   \u02dc    ]   \u22c4   = (       \u2202   [  r  ]   \u22c4     \u2202 r       \u2202   [  r  ]   \u22c4     \u2202 z     0       \u2202   [  z  ]   \u22c4     \u2202 r       \u2202   [  z  ]   \u22c4     \u2202 z     0     r   \u2202   [  \u03d5  ]   \u22c4     \u2202 r     r   \u2202   [  \u03d5  ]   \u22c4     \u2202 z       \u03b4 u   r       )   and  (17)    [  \u039e  ]   \u22c4   = (     0   0   \u2212   [  \u03d5  ]   \u22c4       0   0   0       [  \u03d5  ]   \u22c4     0   0     ) .   Eqs. (16) and (17) are similar to the definitions of the respective variations in Eqs. (6) and (7), respectively, with the difference that the former use derivatives of sensitivities of the coordinates, whereas the latter use derivatives of the variations of the displacements. The sensitivity of Eq. (9) reads  (18)    [  \u03b4 L  ]   \u22c4   =   [  \u03b4 F  ]   \u22c4      F   \u2212 1   \u2212 \u03b4 F    F   \u2212 1     [  F  ]   \u22c4      F   \u2212 1   =   [  \u03b4 F  ]   \u22c4      F   \u2212 1   \u2212 \u03b4 L   [  L  ]   \u22c4   .   The second term in the middle of Eq. (18) comes from the sensitivity of the inverse of the deformation gradient, which is rewritten using the definitions of \u03b4 L and   [  L  ]   \u22c4   from Eqs. (9) and (14), respectively. With  (19)  \u03b4   F   \u02dc   = \u03b4   L   \u02dc   F ,   one can show that  (20)    [  \u03b4   F   \u02dc    ]   \u22c4      F   \u2212 1   =   M   \u02dc   \u2212 \u03b4   F   \u02dc     \u2202 V   \u2202 x   + \u03b4   F   \u02dc     [  \u039e  ]   \u22c4   ,   where the tensor   M   \u02dc   is defined as  (21)    M   \u02dc   = (     0   0   0     0   0   0     \u03b4 u   \u2202   [  \u03d5  ]   \u22c4     \u2202 r     \u03b4 u   \u2202   [  \u03d5  ]   \u22c4     \u2202 z     0     ) + (     0   0   0     0   0   0       [  r  ]   \u22c4     \u2202 \u03b4 \u03b8   \u2202 r       [  r  ]   \u22c4     \u2202 \u03b4 \u03b8   \u2202 z     0     ) .   Then, the linearization of the variational velocity gradient takes the form  (22)    [  \u03b4 L  ]   \u22c4   =   M   \u02dc   \u2212 \u03b4   F   \u02dc     \u2202 V   \u2202 x   +   [  \u03b4 \u039e  ]   \u22c4   + \u03b4 \u039e   [  L  ]   \u22c4   +   [  \u039e  ]   \u22c4   \u03b4 L \u2212 \u03b4 L   [  L  ]   \u22c4   .   With the second term in Eq. (22) also being included in the last term, and with the sensitivity of the variation of \u039e being zero, Eq. (22) becomes  (23)    [  \u03b4 L  ]   \u22c4   =   M   \u02dc   +   [  \u039e  ]   \u22c4    \u03b4   L   \u02dc   +   [  \u039e  ]   \u22c4    \u03b4 \u039e \u2212 \u03b4   L   \u02dc      [  \u039e  ]   \u22c4   \u2212 \u03b4   L   \u02dc      [    L   \u02dc    ]   \u22c4   .   It can easily be shown that in a Cartesian coordinate system or in a standard axisymmetric analysis, all terms but the last one in Eq. (23) vanish.  Using the Cauchy stress \u03c3 in a body of current volume v, the equation of virtual work can be expressed as  (24)  \u03b4 W =   \u222b   v   \u03c3 : \u03b4 L  dv =   \u222b   v   \u03c3 : (  \u03b4   L   \u02dc   + \u03b4 \u039e  )  dv .   The linearization of the virtual work equation then becomes, with the trace operator tr  (25)    [  \u03b4 W  ]   \u22c4   =   \u222b   v   (    [  \u03c3  ]   \u22c4   : \u03b4 L \u2212 \u03c3 : (  \u03b4   L   \u02dc      [    L   \u02dc    ]   \u22c4    ) + \u03c3 : \u03b4 L  tr   [  L  ]   \u22c4    )  dv +   \u222b   v   \u03c3 : \u03b4 L  tr (  F   \u2202 V   \u2202 x    )  dv +   \u222b   v   \u03c3 : (    M   \u02dc   +   [  \u039e  ]   \u22c4    \u03b4   L   \u02dc   +   [  \u039e  ]   \u22c4    \u03b4 \u039e \u2212 \u03b4   L   \u02dc      [  \u039e  ]   \u22c4    )  dv .   In Eq. (25), the first integral contains the standard constitutive, geometric and volumetric terms. The second integral stems from the shape change due to the shape parametrization. The last integral is specific to the use of cylindrical coordinates, as it vanishes in the case of Cartesian coordinates. Taking into consideration that \u03c3 and   [  \u03c3  ]   \u22c4   are symmetric whereas   [  \u039e  ]   \u22c4   is antisymmetric, the double contractions of some tensors are zero. In addition to that, the integrand of the second integral cancels out a part of the last term of the first integral, as can be seen from Eq. (14). Thus, Eqs. (24) and (25) can be simplified to  (26)  \u03b4 W =   \u222b   v   \u03c3 : \u03b4   L   \u02dc    dv .   and  (27)    [  \u03b4 W  ]   \u22c4   =   \u222b   v   (    [  \u03c3  ]   \u22c4   : \u03b4   L   \u02dc   \u2212 \u03c3 : (  \u03b4   L   \u02dc      [    L   \u02dc    ]   \u22c4    ) + \u03c3 : \u03b4   L   \u02dc    tr   [    L   \u02dc    ]   \u22c4    )  dv +   \u222b   v   \u03c3 : (    M   \u02dc   +   [  \u039e  ]   \u22c4    \u03b4   L   \u02dc   +   [  \u039e  ]   \u22c4    \u03b4 \u039e \u2212 \u03b4   L   \u02dc      [  \u039e  ]   \u22c4    )  dv .   The additional terms stemming from \u03b4 \u039e and   [  \u039e  ]   \u22c4   do not have a significant impact on the complexity or effort of calculating the stiffness matrix because these tensors are sparse and antisymmetric. It is important to notice that even in the absence of \u03b4 \u039e in Eq. (26) and in the first integral of Eq. (27), the angular degrees of freedom appear implicitly in \u03b4   L   \u02dc   , as can be seen from Eq. (6). Likewise, even if the shape velocity vector does not appear in Eq. (26), it is implicitly included in the sensitivities of the current coordinates in   [    L   \u02dc    ]   \u22c4   .  In this paper, neohookean material behavior is considered. However, for a generalization of the equations to inelastic material behavior, an incremental form of the material behavior is also used. The neohookean material behavior can be stated as  (28)  \u03c3 =   \u03bc   J   (  b \u2212 I  ) +   \u03bb  ln  J   J   I .   Here, J is the determinant of the deformation gradient, F, \u03bc and \u03bb are the Lam\u00e9 constants and I is the second order identity tensor. The right Cauchy\u2013Green deformation tensor b is defined as  (29)  b =   FF   T   ,   and with Eq. (14) and the symmetric fourth-order unit tensor   I   S   , its linearization becomes  (30)    [  b  ]   \u22c4   =   [  F  ]   \u22c4     F   T   + F   [    F   T    ]   \u22c4   =   [  L  ]   \u22c4   b + b   [    L   T    ]   \u22c4   = 2   I   S   : (    [  L  ]   \u22c4   b  ) ,   In an incremental formulation of kinematics, use is made of the deformation gradient   F   0   and deformation tensor   b   0   at the start of the time increment, and of the deformation gradient increment \u0394 F , defined as  (31)  \u0394 F = F   (    F   0    )   \u2212 1   .   Using Eq. (31), the deformation tensor can alternatively be written as  (32)  b = \u0394   Fb   0   \u0394   F   T   ,   and the linearization becomes  (33)    [  b  ]   \u22c4   = \u0394 F   [    b   0    ]   \u22c4   \u0394   F   T   +   [  \u0394 F  ]   \u22c4   \u0394   F   \u2212 1   b + b   [  \u0394   F   T    ]   \u22c4   \u0394   F   \u2212 T   = \u0394 F   [    b   0    ]   \u22c4   \u0394   F   T   + 2   I   S   : (    [  \u0394 F  ]   \u22c4   \u0394   F   \u2212 1   b  ) .   The linearization of the neohookean elasticity law can be written as  (34)    [  \u03c3  ]   \u22c4   =   \u2202 \u03c3   \u2202 \u03ba   + C :   [  b  ]   \u22c4   =   \u2202 \u03c3   \u2202 \u03ba   +   C   \u00af   :   [  L  ]   \u22c4   ,   where the fourth-order elasticity tensors, C and   C   \u00af   , are defined as  (35)  C =   1   J   (  \u03bc    I   S   +   \u03bb  I \u2212 J  \u03c3   2   \u2297   b   \u2212 1    )   and  (36)      C   \u00af     ijkl   = 2   C   ijmn   :   I   mnkp   S     b   pl   .   The first term on the right-hand side of Eq. (34) represents the explicit dependency of the Cauchy stress on the parameter \u03ba with respect to whom the sensitivity is determined, as for example in sensitivities with respect to material parameters. In shape optimization, this term is zero. For the linearization in the framework of a sensitivity analysis in an incremental setting with variables at the increment start labeled \u20180\u2019 and increment \u2018 \u0394 \u2019, the sensitivities of the coordinates can be brought in the form  (37)    [  r  ]   \u22c4   =   V   r   +   [    u   0    ]   \u22c4   +   [  \u0394 u  ]   \u22c4   =   [    r   0    ]   \u22c4   +   [  \u0394 u  ]   \u22c4     [  z  ]   \u22c4   =   V   z   +   [    v   0    ]   \u22c4   +   [  \u0394 v  ]   \u22c4   =   [    z   0    ]   \u22c4     [  \u0394 v  ]   \u22c4     [  \u03d5  ]   \u22c4   =   [    \u03b8   0    ]   \u22c4   +   [  \u0394 \u03b8  ]   \u22c4   =   [    \u03d5   0    ]   \u22c4   +   [  \u0394 \u03b8  ]   \u22c4   .   Using the incremental kinematic quantities, some auxiliary tensors may be defined:  (38)    [      L   \u02dc     01    ]   \u22c4   = (       \u2202   [    r   0    ]   \u22c4     \u2202 r       \u2202   [    r   0    ]   \u22c4     \u2202 z     0       \u2202   [    z   0    ]   \u22c4     \u2202 r       \u2202   [    z   0    ]   \u22c4     \u2202 z     0     r   \u2202   [    \u03d5   0    ]   \u22c4     \u2202 r     r   \u2202   [    \u03d5   0    ]   \u22c4     \u2202 z         [    r   0    ]   \u22c4     r       )      (39)    [  \u0394     L   \u02dc     01    ]   \u22c4   = (       \u2202   [  \u0394 u  ]   \u22c4     \u2202 r       \u2202   [  \u0394 u  ]   \u22c4     \u2202 z     0       \u2202   [  \u0394 v  ]   \u22c4     \u2202 r       \u2202   [  \u0394 v  ]   \u22c4     \u2202 z     0     r   \u2202   [  \u0394 \u03b8  ]   \u22c4     \u2202 r     r   \u2202   [  \u0394 \u03b8  ]   \u22c4     \u2202 z         [  \u0394 u  ]   \u22c4     r       ) ,      (40)    [    \u039e   0    ]   \u22c4   = (     0   0   \u2212   [    \u03d5   0    ]   \u22c4       0   0   0       [    \u03d5   0    ]   \u22c4     0   0     ) ,   and  (41)    [  \u0394 \u039e  ]   \u22c4   = (     0   0   \u2212   [  \u0394 \u03b8  ]   \u22c4       0   0   0       [  \u0394 \u03b8  ]   \u22c4     0   0     ) .   Here, it is crucial to keep in mind that the tensors with index \u201801\u2019 are derivatives with respect to the current configuration. Then, the sensitivity of the velocity gradient,   [  L  ]   \u22c4   in Eq. (14), can be written as  (42)    [  L  ]   \u22c4   =   [      L   \u02dc     01    ]   \u22c4   +   [    \u039e   0    ]   \u22c4   \u2212 F   \u2202 V   \u2202 x   +   [  \u0394     L   \u02dc     01    ]   \u22c4   +   [  \u0394 \u039e  ]   \u22c4   .   In Eq. (42), the first three terms on the right-hand side are known at the increment start once the boundary value problem is solved, whereas the last two terms contain the sensitivity of the displacement increments which remain to be determined. Likewise, the terms in Eq. (33) containing the sensitivity of the deformation gradient increment require the determination of  (43)    [  \u0394 F  ]   \u22c4   \u0394   F   \u2212 1   =   [  L  ]   \u22c4   \u2212 \u0394 F   [    F   0    ]   \u22c4     F   \u2212 1   .   Here, the second term on the right-hand side of Eq. (43) contains sensitivities of the increment start and is independent on the unknown sensitivities of the displacement increment. The second term uses the sensitivity of the deformation gradient at increment start,   [    F   0    ]   \u22c4   , calculated as  (44)    [    F   0    ]   \u22c4   =   [      L   \u02dc     00    ]   \u22c4      F   0   +   [    \u039e   0    ]   \u22c4      F   0   \u2212   F   0     \u2202 V   \u2202 X   ,   with  (45)    [      L   \u02dc     00    ]   \u22c4   = (       \u2202   [    r   0    ]   \u22c4     \u2202   r   0         \u2202   [    r   0    ]   \u22c4     \u2202   z   0       0       \u2202   [    z   0    ]   \u22c4     \u2202   r   0         \u2202   [    z   0    ]   \u22c4     \u2202   z   0       0       r   0     \u2202   [    \u03d5   0    ]   \u22c4     \u2202   r   0         r   0     \u2202   [    \u03d5   0    ]   \u22c4     \u2202   z   0           [    r   0    ]   \u22c4       r   0         ) .   With the absence of body forces and contact loads, splitting up between known sensitivities and unknown sensitivity increments, and using the consistent tangent operator D with components  (46)    D   ijkl   =     C   \u00af     ijkl   \u2212   \u03c3   il     \u03b4   jk   +   \u03c3   ij     \u03b4   kl     and the fourth order tensors   A   \u00af   and   B   \u00af   defined as  (47)    A   ijkl   =   \u03c3   jk     \u03b4   il   \u2212   \u03c3   il     \u03b4   jk     and  (48)    B   ijkl   =   \u03b4   il     \u03c3   jk   ,   Eq. (27) can be transformed into a linear equation for the determination of the sensitivity increments  (49)    \u222b   v   \u03b4   L   \u02dc   : D :   [  \u0394     L   \u02dc     01    ]   \u22c4    dv +   \u222b   v   \u03b4   L   \u02dc   :   C   \u00af   :   [  \u0394 \u039e  ]   \u22c4    dv +   \u222b   v   \u03b4 r (    \u03c3   31     \u2202   [  \u0394 \u03b8  ]   \u22c4     \u2202 r   +   \u03c3   32     \u2202   [  \u0394 \u03b8  ]   \u22c4     \u2202 z    )  dv +   \u222b   v   (    \u03c3   31     \u2202 \u03b4 \u03b8   \u2202 r   +   \u03c3   32     \u2202 \u03b4 \u03b8   \u2202 z    )   [  \u0394 u  ]   \u22c4    dv +   \u222b   v   (  \u03b4   L   \u02dc   : A + \u03b4 \u039e : B  ) :   [  \u0394 \u039e  ]   \u22c4    dv +   \u222b   v   \u03b4   L   \u02dc   : D :   [      L   \u02dc     01    ]   \u22c4    dv +   \u222b   v   \u03b4   L   \u02dc   :   C   \u00af   : (    [    \u039e   0    ]   \u22c4   \u2212 F   \u2202 V   \u2202 x    )  dv +   \u222b   v   \u03b4 u (    \u03c3   31     \u2202   [    \u03d5   0    ]   \u22c4     \u2202 r   +   \u03c3   32     \u2202   [    \u03d5   0    ]   \u22c4     \u2202 z    )  dv +   \u222b   v   (    \u03c3   31     \u2202 \u03b4 \u03b8   \u2202 r   +   \u03c3   32     \u2202 \u03b4 \u03b8   \u2202 z    )   [    r   0    ]   \u22c4    dv +   \u222b   v   (  \u03b4   L   \u02dc   : A + \u03b4 \u039e : B  ) :   [    \u039e   0    ]   \u22c4    dv = 0 .   The first five integrals in Eq. (49) constitute the consistent stiffness matrix with the unknown sensitivity increments, whereas the last five integrals make up the so-called pseudo-load vector.  With the axisymmetric solid being discretized using N  e solid elements with shape functions N  A , the coordinates and their variations, increments and sensitivities being interpolated as  (50)  \u03b1 =   N   A     \u03b1   A   ,  \u03b1 \u2208 { x ,   u   x   , \u0394   u   x   , \u03b4   u   x   ,   [  x  ]   \u22c4   ,   [    x   0    ]   \u22c4   ,   [  \u0394   u   x    ]   \u22c4   } ,   where a summation is performed over the index \u2018A\u2019, i.e. the number of nodes in an element, and x and u  x stand for the coordinates r, z, \u03d5 and the displacements u ,v, \u03b8, respectively. With the second order tensor P, defined as  (51)  P = (     0   0   \u2212 1     0   0   0     1   0   0     ) ,   the variation \u03b4 \u039e can be written as  (52)  \u03b4 \u039e = P   N   A   \u03b4   \u03b8   A   .   With the following auxiliary tensors  (53)    C   \u02dc   =   C   \u00af   : P   and  (54)    A   \u02dc   =   A   \u00af   : P   and with the scalar   B   \u02dc   defined as  (55)    B   \u02dc   = P :   B   \u00af   : P ,   Eq. (49) can be expressed as a summation over the integrals over elements with elemental volume v  e    (56)     \u2211     N   e        \u222b     v   e     \u03b4   L   \u02dc   : D :   [  \u0394     L   \u02dc     01    ]   \u22c4      dv   e   +    \u2211     N   e        \u222b     v   e     \u03b4   L   \u02dc   : (    C   \u02dc   +   A   \u02dc    )   N   B      dv   e     [  \u0394   \u03b8   B    ]   \u22c4   + \u03b4   u   A      \u2211     N   e        \u222b     v   e       N   A   (    \u03c3   31     \u2202   N   B     \u2202 r   +   \u03c3   32     \u2202   N   B     \u2202 z    )    dv   e     [  \u0394   \u03b8   B    ]   \u22c4   + \u03b4   \u03b8   A      \u2211     N   e        \u222b     v   e     (    \u03c3   31     \u2202   N   A     \u2202 r   +   \u03c3   32     \u2202   N   A     \u2202 z    )   N   B      dv   e     [  \u0394   u   B    ]   \u22c4   + \u03b4   \u03b8   A      \u2211     N   e        \u222b     v   e       N   A     B   \u02dc     N   B      dv   e     [  \u0394   \u03b8   B    ]   \u22c4   +    \u2211     N   e        \u222b     v   e     \u03b4   L   \u02dc   : (  D :   [      L   \u02dc     01    ]   \u22c4   + (    C   \u02dc   +   A   \u02dc    )   N   B     [    \u03d5   0 , B    ]   \u22c4   \u2212   C   \u00af   : (  F   \u2202 V   \u2202 x    )  )    dv   e   + \u03b4   u   A      \u2211     N   e        \u222b     v   e       N   A   (    \u03c3   31     \u2202   N   B     \u2202 r   +   \u03c3   32     \u2202   N   B     \u2202 z    )   [    \u03d5   0 , B    ]   \u22c4      dv   e   + \u03b4   \u03b8   A      \u2211     N   e        \u222b     v   e     (    \u03c3   31     \u2202   N   A     \u2202 r   +   \u03c3   32     \u2202   N   A     \u2202 z    )   N   B     [    r   0 , B    ]   \u22c4      dv   e   + \u03b4   \u03b8   A      \u2211     N   e        \u222b     v   e       N   A     B   \u02dc     N   B     [    \u03d5   B , B    ]   \u22c4      dv   e   = 0 .   With the vectors  (57)  \u03b4 x = (    N   A   \u03b4   u   A   ,   N   A   \u03b4   v   A   ,   N   A   \u03b4   \u03b8   A    ) ,      (58)    [  \u0394 x  ]   \u22c4   = (    N   A     [    u   A    ]   \u22c4   ,   N   A     [    v   A    ]   \u22c4   ,   N   A     [    \u03b8   A    ]   \u22c4    )   and  (59)    \u2202   N   A     \u2202 x   = (    \u2202   N   A     \u2202 r   ,   \u2202   N   A     \u2202 z   , 0  ) ,   together with the matrices  (60)  h = (     1   0   0     0   1   0     0   0   r     ) ,   and  (61)      L   \u00af     A   = (     0   0   0     0   0   0     0   0       N   A     r       ) ,   the variations in Eq. (6) and the sensitivities in (39) can be rewritten as  (62)  \u03b4     L   \u02dc     ij   = \u03b4   x   k   A     h   ki     \u2202   N   A     \u2202   x   j     +     L   \u00af     ij   A    \u03b4   u   A     and  (63)    [  \u0394     L   \u02dc     ij   01    ]   \u22c4   =   [  \u0394   x   k   B    ]   \u22c4     h   ki     \u2202   N   B     \u2202   x   j     +     L   \u00af     ij   B     [  \u0394   u   B    ]   \u22c4   .   With Eqs. (57)\u2013(63), Eq. (56) can be written as  (64)  \u03b4   x   p   A      \u2211     N   e        \u222b     v   e       h   pi     \u2202   N   A     \u2202   x   j        D   ijkl      h   qk     \u2202   N   B     \u2202   x   l        dv   e     [  \u0394   x   q   B    ]   \u22c4   + \u03b4   x   p   A      \u2211     N   e        \u222b     v   e       h   pi     \u2202   N   A     \u2202   x   j        D   ij 33       N   B     r      dv   e     [  \u0394   u   B    ]   \u22c4   + \u03b4   u   A      \u2211     N   e        \u222b     v   e         N   A     r     D   33 kl      h   qk     \u2202   N   B     \u2202   x   l        dv   e     [  \u0394   x   q   B    ]   \u22c4   + \u03b4   u   A      \u2211     N   e        \u222b     v   e         N   A     r     D   3333       N   B     r      dv   e     [  \u0394   u   B    ]   \u22c4   + \u03b4   x   p   A      \u2211     N   e        \u222b     v   e       h   pi     \u2202   N   A     \u2202   x   j     (      C   \u02dc     ij   +     A   \u02dc     ij    )   N   B      dv   e     [  \u0394   \u03b8   B    ]   \u22c4   + \u03b4   u   A      \u2211     N   e        \u222b     v   e       N   A   (        C   \u02dc     33   +     A   \u02dc     33     r     N   B   +   \u03c3   3 i     \u2202   N   B     \u2202   x   i      )    dv   e     [  \u0394   \u03b8   B    ]   \u22c4   + \u03b4   \u03b8   A      \u2211     N   e        \u222b     v   e       \u03c3   3 i     \u2202   N   A     \u2202   x   i       N   B      dv   e     [  \u0394   u   B    ]   \u22c4   + \u03b4   \u03b8   A      \u2211     N   e        \u222b     v   e       N   A     B   \u02dc     N   B      dv   e     [  \u0394   \u03b8   B    ]   \u22c4   . + \u03b4   x   p   A      \u2211     N   e        \u222b     v   e       h   pi     \u2202   N   A     \u2202   x   j     (    D   ijkl     [      L   \u02dc     kl   01    ]   \u22c4   + (      C   \u02dc     ij   +     A   \u02dc     ij    )   N   B     [    \u03d5   0 , B    ]   \u22c4   \u2212     C   \u00af     ijkl   (    F   kq     \u2202   V   q     \u2202   x   l      )  )    dv   e   + \u03b4   u   A      \u2211     N   e        \u222b     v   e         N   A     r   (    D   33 kl     [      L   \u02dc     kl   01    ]   \u22c4   + (  (      C   \u02dc     33   +     A   \u02dc     33    )   N   B   + r    \u03c3   3 i     \u2202   N   B     \u2202   x   i      )   [    \u03d5   0 , B    ]   \u22c4   \u2212     C   \u00af     33 kl   (    F   kq     \u2202   V   q     \u2202   x   l      )  )    dv   e   + \u03b4   \u03b8   A      \u2211     N   e        \u222b     v   e     (    \u03c3   3 i     \u2202   N   A     \u2202   x   i       [    r   0 , B    ]   \u22c4   +   N   A     B   \u02dc     [    \u03d5   0 , B    ]   \u22c4    )   N   B      dv   e   = 0 .   The first eight integrals in Eq. (64) yield the components of the elemental stiffness matrix relative to nodes A and B as  (65)    K   pq   e , AB   =   \u222b     v   e       h   pi     \u2202   N   A     \u2202   x   j        D   ijkl      h   qk     \u2202   N   B     \u2202   x   l        dv   e   +   \u222b     v   e       h   pi     \u2202   N   A     \u2202   x   j        D   ij 33       N   B     r     \u03b4   1 q      dv   e   +   \u222b     v   e       \u03b4   1 p       N   A     r     D   33 kl      h   qk     \u2202   N   B     \u2202   x   l        dv   e   +   \u222b     v   e       \u03b4   1 p       N   A     r     D   3333       N   B     r     \u03b4   1 q      dv   e   +   \u222b     v   e       h   pi     \u2202   N   A     \u2202   x   j     (      C   \u02dc     ij   +     A   \u02dc     ij    )   N   B     \u03b4   3 q      dv   e   +   \u222b     v   e       \u03b4   1 p     N   A   (        C   \u02dc     33   +     A   \u02dc     33     r     N   B   +   \u03c3   3 i     \u2202   N   B     \u2202   x   i      )   \u03b4   3 q      dv   e   +   \u222b     v   e       \u03b4   3 p     \u03c3   3 i     \u2202   N   A     \u2202   x   i       N   B     \u03b4   1 q      dv   e   +   \u222b     v   e       \u03b4   3 p     N   A     B   \u02dc     N   B     \u03b4   3 q      dv   e   .   Likewise, the last three integrals in Eq. (64), which make up the pseudo-load vector, yield the components of the elemental pseudo-load vector of node A as  (66)    f   p   A   =   \u222b     v   e       h   pi     \u2202   N   A     \u2202   x   j     (    D   ijkl     [      L   \u02dc     kl   01    ]   \u22c4   + (      C   \u02dc     ij   +     A   \u02dc     ij    )   N   B     [    \u03d5   0 , B    ]   \u22c4   \u2212     C   \u00af     ijkl   (    F   kq     \u2202   V   q     \u2202   x   l      )  )    dv   e   +   \u222b     v   e       \u03b4   1 p       N   A     r   (    D   33 kl     [      L   \u02dc     kl   01    ]   \u22c4   + (  (      C   \u02dc     33   +     A   \u02dc     33    )   N   B   + r    \u03c3   3 i     \u2202   N   B     \u2202   x   i      )   [    \u03d5   0 , B    ]   \u22c4   \u2212     C   \u00af     33 kl   (    F   kq     \u2202   V   q     \u2202   x   l      )  )    dv   e   +   \u222b     v   e       \u03b4   3 p   (    \u03c3   3 i     \u2202   N   A     \u2202   x   i       [    r   0 , B    ]   \u22c4   +   N   A     B   \u02dc     [    \u03d5   0 , B    ]   \u22c4    )   N   B      dv   e   .      Generally speaking, in the direct differentiation method, the sensitivities are calculated after the solution of the time increment of the boundary value problem by the finite element method, once the geometry and state variables both at increment start and increment end are known. The sensitivities at increment start are known, either they are zero (or equal to the shape velocity for the current geometry) at the start of the first time increment, or known from the solution of the previous time increment. In the direct differentiation method, each increment of the finite element model is treated in three stages:  1. Calculation of pseudo-load vector from Eq. (66) and, depending on the linearization used for the solution of the boundary value problem, retrieval or calculation of the consistent stiffness matrix according to Eq. (65).  Solution of the discretized system of linear equations, which results from Eq. (64), for each shape parameter to obtain the unknown sensitivities of the displacement increment.  Update of the sensitivities: backsubstitution of the displacement increment sensitivities to obtain the updated sensitivities of current geometry, x, and state variables, here only b, at the end of the increment.  After implementing the equations developed in Section 2.6 into a finite element program, it is of crucial importance to assess both the correctness and accuracy of the calculated sensitivities. Because in general, no test cases with analytical sensitivity results which represent load cases with sufficient complexity are available, the validation of the shape sensitivities, computed here by direct differentiation, has to be performed by comparison against results obtained by the finite difference method. It is important to keep in mind that the sensitivities obtained by finite differences may be severely affected by the applied perturbation size, and that numerical round-off errors may lead to outright wrong results. For this reason, any comparison between the sensitivities obtained by both methods yields a relative or absolute difference, but one cannot conclude straight away from a large difference in results that the sensitivities of the direct differentiation method are wrong, as would be the case with a comparison against analytical results.  For the validation of the shape sensitivities, it is sufficient to consider rather trivial shape changes involving single boundary nodes instead of shape parameters of parametrized shape boundaries, which in fact comes down to prescribing simultaneous shape changes to a larger number of boundary nodes. However, it is not sufficient to apply the finite difference method to two consecutive finite element models where the location of a single specific boundary has been perturbed. In fact, the definition of the sensitivity, Eq. (10), has to be applied, and the velocity field resulting from the perturbed boundary node has to be used for modifying all the affected nodes within the solid. Then, the sensitivity of a generic variable \u03b1 is approximated by the finite difference method as  (67)    [  \u03b1  ]   \u22c4   \u2248   \u03b1 (    X   r   + \u0394 \u03c4 V (    X   r    )  ) \u2212 \u03b1 (    X   r    )   \u0394 \u03c4   .   In the following first example, the shape change is introduced by modifying the coordinates of single nodes, whereas in the second, more complex example, a segment-wise linear interpolation of specific parts of the boundary by a small number of boundary nodes is performed. Thus, in both cases, the shape parameters are the coordinates of specific boundary nodes. As a consequence, the perturbation size for the finite difference method, \u0394 \u03c4 , is determined by machine precision, \u03b3 , the magnitude of the respective reference coordinate of the boundary node with respect to which the sensitivity is calculated, i.e. either R  r or Z  r , and a scaling factor, p, used for reducing the impact of numerical noise  (68)  \u0394 \u03c4 = p  \u03b3  | \u03b1 | ,  \u03b1 \u2208 {    R   r   ,   Z   r    } .      There is another very important issue in the validation of the sensitivity calculation by the comparison between finite difference and direct differentiation results. In the calculation of the pseudo-load vector and the consistent stiffness matrix, the sensitivity of the deformation gradient has to be calculated using Eq. (12). Likewise, all variables calculated from this sensitivity, like the sensitivity of the deformation tensor or of the stress rely on the definition of Eq. (12). However, the true sensitivities, computed in the update step, and to be compared to the finite difference results, require their calculation based on a sensitivity of the deformation without the second term on the right-hand side of Eq. (12), i.e. the term stemming from the rotation of the basis. For example, the sensitivity of the deformation gradient has to be compared using  (69)    F (    X   r   + \u0394 \u03c4 V (    X   r    )  ) \u2212 F (    X   r    )   \u0394 \u03c4   \u2248   [    L   \u02dc    ]   \u22c4    F \u2212 F   \u2202 V   \u2202 X   .   In elasticity, the deformation tensor and its sensitivity can be calculated directly from the deformation gradient and its sensitivity using Eqs. (29) and (30), respectively. In this case, the calculation of the sensitivities with or without the second term in Eq. (12) stemming from the basis rotation, to be used for the calculation of the pseudo-load vector or the true sensitivities after the sensitivity update step, respectively, is trivial. However, if the deformation tensor is defined in an incremental way using Eq. (32), and subsequently also its sensitivity in Eq. (33), which is not necessary in elasticity but unavoidable in inelasticity, an important change in variable storage is required. In fact, for the calculation of the pseudo-load vector, the term   [  \u039e  ]   \u22c4   F is required for the calculation of the sensitivities of the deformation tensor and the stress tensor, whereas in the update step, the sensitivity of the deformation tensor without this term is required, for example for calculating the stress sensitivity. Therefore, both versions of the sensitivity of the state variable b have to be stored and transferred between time increments.  A very simple finite element model has been used for a basic validation of the implementation of the direct differentiation method for axisymmetry with superposed torsion. The validation itself has been performed by comparing the sensitivities of the stress components with respect to the in-plane coordinates of several boundary nodes, calculated by the direct differentiation method (DD) to those obtained by the finite difference method (FD) with a perturbation scaling factor p =   10   2   . To this avail, the average magnitude of the difference in the results obtained by both methods is calculated over all integration points in the model, i.e.  (70)      E   \u00af     \u03b1 \u03b2   =   1     N   el     N   ip       \u2211   i = 1     N   el       \u2211   j = 1     N   ip     |      [   \u03c3   \u03b1 \u03b2   i , j   ]    \u22c4     FD       [   \u03c3   \u03b1 \u03b2   i , j   ]    \u22c4     DD     \u2212 1  | ,  \u2200 \u03b1 \u03b2 \u2208 {  rr , zz , \u03b8 \u03b8 , rz , z \u03b8 , r \u03b8  } .   The finite element model consists of an axisymmetric model of a slanted bloc. The finite element model is depicted in Fig. 1 . The bloc has a constant height of 8mm, whereas the width changes from 10 to 11mm in vertical direction. It contains   N   el   = 2 \u00d7 5 = 10 linear displacement-based elements with   N   ip   = 4 integration points, resulting in 18 nodes. The material behavior considered is finite strain elasticity with Young\u05f3s modulus of E = 175  000  MPa and a Poisson ratio of \u03bd = 0.3 . Two load cases are considered, one in displacement control and one in load control with the intent of producing inhomogeneous stress fields.  In displacement control, a vertical displacement of   u   z   = 3  mm is applied to node 13 and a tangential displacement of   u   \u03b8   = 0.1  rad is applied to node 18. In load control, a vertical point load of   F   z   = 100  000  N is applied to node 13 and a torsional moment of   F   \u03b8   = 10  000  N  mm is applied to node 18. The sensitivities are calculated with respect to both in-plane components of the nodal positions of nodes 6, 12, 15 and 18, whose locations are given in Fig. 1.  The results of the average difference between the sensitivities of DD and FD with respect to the nodal positions, as defined in Eq. (70), are given in Table 1 for displacement control and in Table 2 for load control. It can be observed that the relative difference between both methods is very small, i.e. in general below   10   \u2212 2   % , which leads to the conclusion that the sensitivities of the stress components calculated by the direct differentiation method are very accurate. In fact, differences below 0.01% can be considered as numerical noise. In case higher differences are found, it is worthwhile taking into account that both an inappropriate magnitude of the perturbation and values close to zero may lead to very large differences, in order to avoid mistaking numerical round-off issues for an implementation error.  In dental prosthetics, the replacement of a tooth by a prosthesis is performed in two stages. In a first stage, an implant is inserted into the jawbone. As the implant does not protrude out of the jawbone, it is only subjected to small loads, which is beneficial to the growth of bone cells around it. Once the implant has been sufficiently fixed to jawbone by growing bone cells, a crown is fitted onto the implant by means of an abutment. More precisely, the abutment is screwed to the implant and the crown is glued onto the abutment. In general, implant, abutment and screw are made of titanium. However, for the prosthesis of front teeth, one can observe a trend towards abutments made of zirconia ceramics, which are white, for purely aesthetic reasons. This comes with a major drawback, because ceramic materials are inherently brittle, and very specific design rules have to be applied. In this example, a shape sensitivity analysis is performed using a finite element model of the abutment shown in Fig. 2 . This sensitivity analysis may then for example be used in shape optimization using gradient-based optimization algorithms.  The finite element model of the ceramic abutment consists of 2175 four-noded displacement-based axisymmetric elements which include torsion. The abutment has neohookean elastic behavior, with Young\u05f3s modulus of E = 200  GPa and Poisson\u05f3s ratio of \u03bd = 0.25 . The finite element model is constrained in tangential and vertical direction on the line AB, which corresponds to the abutment/implant interface. The analyzed load case corresponds to the fixed implant without mastication loads, i.e. a torque applied to surface CD which is the abutment/screw interface. The torque of T = 250  N  mm of the screw induces a compressive load of F = 1000  N . Both the vertical load and the torque are applied as surface loads on the surface CD. The inner surface of the abutment is represented by a segment-wise linear interpolation using the nodes at locations U, C, D and V in Fig. 2, where U and V are remaining fixed. A part of the outer surface is interpolated using locations A, B and W, with fixed A and W. The shape sensitivities are calculated with respect to the vertical shape change of points C and D, as well as the horizontal and vertical displacement of point B. Like in the previous example, the relative difference between the sensitivities computed by direct differentiation and finite differences according to Eq. (70) is used as a global indicator for assessing the quality of the sensitivities. The finite difference sensitivity analysis uses a perturbation scaling factor p =   10   1   . In Table 3 , the average global relative difference is shown for all six stress components. One can see that most values are well below 0.01%, which indicates that the sensitivities are very accurate.   CONCLUSIONS   A shape sensitivity analysis based on the direct differentiation method has been developed in this article for axisymmetry including torsion in finite strains. It has been shown that the obtained sensitivities are highly accurate and the method is suitable for use in gradient-based shape optimization of axisymmetric structures subjected to torsional loading. Thus, the main advantage of this type of axisymmetric analysis in comparison to fully three-dimensional finite element model, which is a highly reduced number of degrees of freedom, can help to considerably reduce the computational effort required in shape optimization of this type of mechanical problems.   ACKNOWLEDGMENTS   This project has been funded by the Fonds National de la Recherche of the Grand Duchy of Luxembourg under Grant number C10/MS/783981/MOLBIER.   REFERENCES", "highlights": "The shape sensitivity analysis using the direct differentiation method is developed for the case of axisymmetry with superposed torsion in the framework of finite strains and elastic material behavior. The accuracy of this method is compared to results obtained by the finite difference method in two simple examples."}