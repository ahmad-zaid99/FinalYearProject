{"id": "S0168874X15001973", "article": "MAIN-TITLE Blending isogeometric and Lagrangian elements in three-dimensional analysis   HIGHLIGHTS          A method is proposed to blend NURBS and finite elements in 3D isogeometric analysis.      The interfacing facets of a NURBS patch are transformed to Lagrangian form.      Transformation from NURBS to Lagrangian can preserve the original geometry.      Connection between higher order NURBS and lower order finite elements is discussed.      A blended model of an intricate geometric gear is built and analyzed.          KEYPHRASES   Isogeometric analysis  Finite element analysis  NURBS  Blended element  Lagrangian transformation   Finite element method (FEM) has been the most widely used numerical method in engineering analysis. In FEM a material body is represented by a topological mesh which discretizes the body into a collection of elements. The mesh is an additional geometric entity, and one that is disconnected from an underlying geometric model. To better integrate geometric modeling and analysis, Hughes [1] put forward the concept of isogeometric analysis (IGA). The basic idea of the IGA is to unify the geometric basis, using the geometric language for both design and analysis. Currently the NURBS [2] and T-Splines [3] are the primary geometry languages used in isogeometric analysis [4\u20136]. NURBS is the de-facto standard in Computer Aided Design (CAD); thus using NURBS enables a direct integration between CAD and analysis. Compared with the standard FEM, the IGA has some remarkable merits [7\u20139]: (1) It provides a more accurate description for complicated geometries, and in particular, common shapes such as circle, cylinder, sphere, and ellipsoid can be represented exactly [10,11]. (2) The original geometry is preserved in h- p- and k-refinement [12]. (3) It offers up to C  p\u22121 continuity between elements [13], in contrast to the C 0 continuity in FEM, and (4) it facilitates an integration of analysis, design, and optimization at the geometry level.  While the theoretical foundation of IGA has been firmly established, the development of IGA computer code, especially general purpose programs such as existing ones in FEM, is still at the early stage. One of hurdles has been to automatically convert a 3D CAD model into NURBS meshes. While significant advances have been made in recent years [14\u201317], generating NURBS meshes for complicated 3D geometries remains a challenge. We envision that, for the time being there is a need for blended models which admit both traditional Lagrangian elements and NURBS/T-spline isogeometric elements. Conceivably, for some problems it is unnecessary to describe the entire domain in NURBS or T-Splines. One could leave a part of the domain in FEM while describing some crucial regions in NURBS. Similar situations can arise in the analysis of multi-component structures where some components are supplied in FE meshes while others are in NURBS. It would be convenient to keep both representations in the analysis, giving rise to a blended model. This blended modeling enables the advantages of both methods to be exploited. Perhaps more importantly, it enables one to incorporate isogeometric features in well-developed finite element programs.  A key step in blending Lagrangian and NURBS elements is to develop interface elements containing mixed representations. Fortunately, interfacing NURBS to Lagrangian elements is straightforward, as both are polynomial based representations. B-spline basis functions and Lagrangian polynomials are mutually expressible because both are polynomial basis. Based on this observation, Lu et al. [18] proposed a blending technique; the basic idea is to represent some edges or facets of a NURBS element in Lagrangian form. However, in our previous 2D model we have not discussed the blended-element (a quadratic NURBS element with a quadratic Lagrangian element and a quadratic NURBS element with a linear finite element) simulation. In addition, three dimensional models have not been developed. In [18] the parent elements are in NURBS. A NURBS-enhanced finite element method (NEFEM) was proposed by Sevilla et al. [19]. There the parent element was Lagrangian, and selected boundaries were transformed into NURBS. A similar setting was adapted by Corbett et al. [20] in contact analysis where NURBS representation was used on contact surfaces to improve the smoothness of geometric representation. In a different front, efforts have been devoted to coupling isogeometric analysis and meshfree methods [21\u201323]. The development in [18] and similar contributions hinges on the idea of inter-representation between splines and other polynomial basis. In isogeometric analysis, this idea can be traced back to [24,25]. Therein the authors introduced the concept of B\u00e9zier extraction which represents each element (a non-empty knot span or tensor product of such) in terms of Bernstein polynomials defined over the element. A B\u00e9zier element contains a fixed set of basis functions, just like regular Lagrangian elements. Recently, the concept of Lagrange extraction was proposed by Schillinger et al. [26] representing all elements in a NURBS domain in Lagrangian form. This establishes a direct link between splines and nodal finite element basis functions.  In this paper, we will develop the 3D blended isogeometric and Lagrangian elements. We will introduce the geometric representation of blended elements, and discuss how much representations are constructed. While the essential idea remains the same as the previous work in 2D, the details of the geometric representation need to be worked out. This paper is organized as follows: in Section 2 the geometric basis for transforming a NURBS curve or surface into a Lagrangian form is reviewed. The construction of three dimensional blended elements, including the treatment of interfacing elements of different polynomials degrees, is presented in Sections 3 and 4. Numerical examples are introduced in Section 5 to demonstrate the application of the proposed approach.  A p-order NURBS curve is specified by a knot vector  U =  {    u   1   ,   u   2   , \u2026 ,   u   n + p + 1    }   , a set of control points and corresponding weights   {    Q   i   ,   \u03c9   i    }   i = 1   n   . The curve is expressed as  (1)    C   ( u )  =     \u03a3   i = 1   n     N   i , p    ( u )    \u03c9   i     Q   i       \u03a3   i = 1   n     N   i , p    ( u )    \u03c9   i        where    N   i , p    ( u )   are the B-spline basis functions that are determined by the knot vector and the degree p.  A NURBS curve is a composition of polynomial segments (or elements), each corresponding to a non-empty knot interval. A polynomial segment can be represented using Lagrangian interpolation. To this end, consider the segment  [   u   k   ,   u   k + 1   ] ( k \u2265 p + 1 )  and introduce p+1 interpolation points     u  \u00af     l + i   = ( 1 \u2212  i / p  )   u   k   +  (  i / p  )    u   k + 1   ,     i = 0 , \u2026 , p .  These points determine a set of Lagrangian basis   {   L   i , p   }   i = l   l + p   . We seek to express the segment in a rational Lagrangian form  (2)    C  ( u ) =     \u03a3   i = l   l + p     L   i ,  p     ( u )    \u03d6   i     P   i       \u03a3   i = l   l + p     L   i , p    ( u )    \u03d6   i        where   {   P   i   }   i = l   l + p   are Lagrangian nodes and   {   \u03d6   i   }   i = l   l + p   are the corresponding weights. The Lagrangian nodes and weights are determined by setting the numerators and denominators to be equal in both forms:  (3)    \u2211  i = k \u2212 p  k     N   i , p    ( u )    Q   i   \u03c9    =  \u2211  i = l   l + p      L   i , p    ( u )    P   i   \u03d6     \u2211  i = k \u2212 p  k     N   i , p    ( u )    \u03c9   i    =  \u2211  i = l   l + p      L   i , p    ( u )    \u03d6   i       where    Q   i   \u03c9   =   \u03c9   i     Q   i    and    P   i   \u03d6   =   \u03d6   i     P   i    .  Due to the interpolation property of the Lagrangian basis, the nodes Pi is nothing but the value of curve at    u  \u00af     i   . It follows that  (4)   [        P   l   \u03d6           P   l + 1   \u03d6        \u22ee        P   l + p   \u03d6        ]  = M  [        Q   k \u2212 p   \u03c9           Q   k \u2212 p + 1   \u03c9        \u22ee        Q   k   \u03c9        ]       (5)   [        \u03d6   l           \u03d6   l + 1        \u22ee        \u03d6   l + p        ]  = M  [        \u03c9   k \u2212 p           \u03c9   k \u2212 p + 1        \u22ee        \u03c9   k        ]    where    M =  [        N   k \u2212 p , p   (    u  \u00af     l   )       N   k \u2212 p + 1 , p   (    u  \u00af     l   )    \u22ef      N   k , p   (    u  \u00af     l   )         N   k \u2212 p , p   (    u  \u00af     l + 1   )       N   k \u2212 p + 1 , p   (    u  \u00af     l + 1   )    \u22ef      N   k , p   (    u  \u00af     l + 1   )      \u22ee   \u22ee   \u22ee   \u22ee        N   k \u2212 p , p   (    u  \u00af     l + p   )       N   k \u2212 p + 1 , p   (    u  \u00af     l + p   )    \u22ef      N   k , p   (    u  \u00af     l + p   )      ]        These two sets of equations completely determine the Lagrangian weights   {   \u03d6   i   }   i = l   l + p   and the weighted nodes   P   i   \u03d6   . The values of the physical nodes follow the following form   P i  =  P i \u03d6  /  \u03d6 i  ,  i = l , \u2026 , l + p  . Note that, by construction, this transformation preserves the original geometry.  It should be emphasized that this transformation is defined at the element level. It depends only on the knot vector and the placement of Lagrangian knots, not the control points. The transformation for each element can be pre-computed and stored. The transformation is invertible, and the inversion gives a linear transformation between the basis functions:  (6)   [        L   p , l           L   p , l + 1        \u22ee        L   p , l + p        ]  =   M   \u2212 1    [        N   k \u2212 p , p           N   k \u2212 p + 1 , p        \u22ee        N   k , p        ]       This relation allows us express the Lagrangian basis in terms of the B-spline basis over a segment. The relation will be used later.  The transformation to NURBS surface proceeds in the same way. Let us consider an element in a  p \u00d7 q  degree NURBS mesh. Let  {    Q   i j    }  and  {    \u03c9   i j    }  ,  i = 1 , p + 1 ; j = 1 , q + 1  , be the element control points and weights, respectively. The element is represented as  (7)  S ( u , v ) =    \u03a3  i = 1   p + 1    \u03a3  j = 1   q + 1    N  i , p    u   N  j , q    v   \u03c9  i j    Q  i j      \u03a3  i = 1   p + 1    \u03a3  j = 1   q + 1    N  i , p    u   N  j , q    v   \u03c9  i j          We seek to represent it as  (8)  S   u , v   =    \u03a3  i = 1   p + 1    \u03a3  j = 1   q + 1    L  i , p    u   L  j , q    v   \u03d6  i j    P  i j      \u03a3  i = 1   p + 1    \u03a3  j = 1   q + 1    L  i , p    u   L  j , q    v   \u03d6  i j       where    L   i , p    ( u )   and    L   j , q    ( v )   are Lagrangian polynomials defined in the u- and v-parametric coordinates. The Lagrangian nodes in the parametric coordinates are taken to be uniformly placed,     u  \u00af     1 + i   = ( 1 \u2212  i / p  )   u   p + 1   +  (  i / p  )    u   p + 2   ,     i = 0 , \u2026 , p  , and     v  \u00af     1 + j   = ( 1 \u2212  j / q  )   v   q + 1   +  (  j / q  )    v   q + 2   ,     j = 0 , \u2026 ,  q   . Evaluating the two representations at the Lagrangian nodes, we obtain  (9)   [        P   1 , 1 , 1   \u03d6           P   2 , 1 , 1   \u03d6        \u22ee       P   p + 1 , 1 , 1   \u03d6         P   p + 1 , 2 , 1   \u03d6       \u22ee       P   p + 1 , q + 1 , 1   \u03d6       ]  = M  [        Q   1 , 1 , 1   \u03c9           Q   2 , 1 , 1   \u03c9        \u22ee       Q   p + 1 , 1 , 1   \u03c9         Q   p + 1 , 2 , 1   \u03c9       \u22ee        Q   p + 1 , q + 1 , 1   \u03c9        ]       (10)   [        \u03d6   1 , 1 , 1           \u03d6   2 , 1 , 1        \u22ee       \u03d6   p + 1 , 1 , 1         \u03d6   p + 1 , 2 , 1       \u22ee       \u03d6   p + 1 , q + 1 , 1       ]  = M  [        \u03c9   1 , 1 , 1           \u03c9   2 , 1 , 1        \u22ee       \u03c9   p + 1 , 1 , 1         \u03c9   p + 1 , 2 , 1       \u22ee        \u03c9   p + 1 , q + 1 , 1        ]    where  (11)   M =  [        N   1 , p   (    u  \u00af     1   )   N   1 , q   (    v  \u00af     1   )       N   2 , p   (    u  \u00af     1   )   N   1 , q   (    v  \u00af     1   )    \u22ef      N   p + 1 , p   (    u  \u00af     1   )   N   1 , q   (    v  \u00af     1   )       N   p + 1 , p   (    u  \u00af     1   )   N   2 , q   (    v  \u00af     1   )    \u22ef      N   p + 1 , p   (    u  \u00af     1   )   N   q + 1 , q   (    v  \u00af     1   )         N   1 , p   (    u  \u00af     2   )   N   1 , q   (    v  \u00af     1   )       N   2 , p   (    u  \u00af     2   )   N   1 , q   (    v  \u00af     1   )    \u22ef      N   p + 1 , p   (    u  \u00af     2   )   N   1 , q   (    v  \u00af     1   )       N   p + 1 , p   (    u  \u00af     2   )   N   2 , q   (    v  \u00af     1   )    \u22ef      N   p + 1 , p   (    u  \u00af     2   )   N   q + 1 , q   (    v  \u00af     1   )       \u22ee   \u22f1   \u22ee   \u22ee   \u22f0   \u22ee        N   1 , p   (    u  \u00af     p + 1   )   N   1 , q   (    v  \u00af     1   )       N   2 , p   (    u  \u00af     p + 1   )   N   1 , q   (    v  \u00af     1   )    \u22ef      N   p + 1 , p   (    u  \u00af     p + 1   )   N   1 , q   (    v  \u00af     1   )       N   p + 1 , p   (    u  \u00af     p + 1   )   N   2 , q   (    v  \u00af     1   )    \u22ef      N   p + 1 , p   (    u  \u00af     p + 1   )   N   q + 1 , q   (    v  \u00af     1   )         N   1 , p   (    u  \u00af     p + 1   )   N   1 , q   (    v  \u00af     2   )       N   2 , p   (    u  \u00af     p + 1   )   N   1 , q   (    v  \u00af     2   )    \u22ef      N   p + 1 , p   (    u  \u00af     p + 1   )   N   1 , q   (    v  \u00af     2   )       N   p + 1 , p   (    u  \u00af     p + 1   )   N   2 , q   (    v  \u00af     2   )    \u22ef      N   p + 1 , p   (    u  \u00af     p + 1   )   N   q + 1 , q   (    v  \u00af     2   )       \u22ee   \u22f0   \u22ee   \u22ee   \u22f1   \u22ee        N   1 , p   (    u  \u00af     p + 1   )   N   1 , q   (    v  \u00af     q + 1   )       N   2 , p   (    u  \u00af     p + 1   )   N   1 , q   (    v  \u00af     q + 1   )    \u22ef      N   p + 1 , p   (    u  \u00af     p + 1   )   N   1 , q   (    v  \u00af     q + 1   )       N   p + 1 , p   (    u  \u00af     p + 1   )   N   2 , q   (    v  \u00af     q + 1   )    \u22ef      N   p + 1 , p   (    u  \u00af     p + 1   )   N   q + 1 , q   (    v  \u00af     q + 1   )      ]        This is the 3D version of the transformation in Eq. (9). We write it symbolically as  (12)   P = M Q       For a NURBS patch containing multiple elements, the transformation is applied element by element to obtain a global Lagrangian form.  A 3D NURBS element in the parametric space is a tensor product domain of non-empty knot that spans in three parametric dimensions. A 3D NURBS patch can contain multiple elements, and each element can be defined by a set of local knot vectors and a set of control points. Let us assume that the degrees in the three parametric directions are p, q, and r, respectively, and write the element knot vector (numbered locally) as     U  = {   u   1   ,   u   2   , \u2026 ,   u   2 ( p + 1 )   } ,   V  = {   v   1   ,   v   2   , \u2026 ,   v   2 ( q + 1 )   } ,   W  = {   w   1   ,   w   2   , \u2026 ,   w   2 ( r + 1 )   }       Note that the length of the knot vectors is 2(p+1), 2(q+1), and 2(r+1), respectively. The physical element is expressed as  (13)    V   (  u , v , w  )  =     \u03a3   i = 1   p + 1     \u03a3   j = 1   q + 1     \u03a3   k = 1   r + 1     N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )    \u03c9   i j k     Q   i j k       \u03a3   i = 1   p + 1     \u03a3   j = 1   q + 1     \u03a3   k = 1   r + 1     N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )    \u03c9   i j k           Below we will give blended representation when some of the facets are transformed into Lagrangian form.  As mentioned earlier the transformation takes place only on a boundary facet of a NURBS patch. We assume that the NURBS patch is defined by open knot vectors, so the interpolatory properties hold for the end knots. Consider, for example, the facet  w =   w   1    . On this surface    N   1 , r    (    w   1    )  = 1  while    N   2 , r    (    w   1    )  = \u22ef   = N   r + 1 , r    (    w   1    )  = 0  . The NURBS representation reduces to  (14)     S   1   ( u , v ) =     \u03a3   i = 1   p + 1     \u03a3   j = 1   q + 1     N   i , p    ( u )    N   j , q    ( v )    \u03c9   i j 1     Q   i j 1       \u03a3   i = 1   p + 1     \u03a3   j = 1   q + 1      N   i , p    ( u )    N   j , q    ( v )    \u03c9   i j 1            The Lagrangian transformation is applied to convert the facet representation to yield  (15)     S   1    (  u , v  )  =     \u03a3   i = 1   p + 1     \u03a3   j = 1   q + 1     L   i , p    ( u )    L   j , q    ( v )    \u03d6   i j 1     P   i j 1       \u03a3   i = 1   p + 1     \u03a3   j = 1   q + 1      L   i , p    ( u )    L   j , q    ( v )    \u03d6   i j 1            Having the facet transformed, the 3D element can be expressed in a blended form, as  (16)   V  (  u , v , w  )  =    \u2211  i = 1   p + 1     \u2211  j = 1   q + 1     \u2211  k = 2   r + 1      N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )    \u03c9   i j k     Q   i j k   +  \u2211  i = 1   p + 1     \u2211  j = 1   q + 1      N   1 , r    ( w )    L   i , p    ( u )    L   j , q    ( v )    \u03d6   i j 1     P   i j 1           \u2211  i = 1   p + 1     \u2211  j = 1   q + 1     \u2211  k = 2   r + 1      N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )    \u03c9   i j k   +  \u2211  i = 1   p + 1     \u2211  j = 1   q + 1      N   1 , r    ( w )    L   i , p    ( u )    L   j , q    ( v )    \u03d6   i j 1                When two adjacent facets, for example  u =   u   1    and  v =   v   1    , are converted, they are transformed individually first. On the facet  u =   u   1    , we obtain a bi-variant Lagrangian form  (17)   S (   u   1   , v , w ) =  \u2211  j = 1   q + 1     \u2211  k = 1   r + 1      L   j , q    ( v )      L   k , r    ( w )     \u03c9  \u00af     1 j k      Q  \u00af     1 j k         On the facet  v =   v   1    , we obtain  (18)   S ( u ,   v   1   , w ) =  \u2211  i = 1   p + 1     \u2211  k = 1   r + 1      L   i , p    ( u )      L   k , r    ( w )     \u03c9  \u00af     i 1 k      Q  \u00af     i 1 k         The common edge is then parameterized as   \u2211  k = 1   r + 1      L   k , r    ( w )     \u03c9 \u00af    11 k      Q  \u00af     11 k     . The 3D element is expressed as  (19)     V  \u03c9   (  u , v , w  )  =  \u2211  k = 1   r + 1      L   1 , p    ( u )     L   1 , q    ( v )    L   k , r    ( w )     \u03c9  \u00af     11 k      Q  \u00af     11 k   +  \u2211  j = 2   q + 1     \u2211  k = 1   r + 1      N   1 , p    ( u )     L   j , q    ( v )    L   k , r    ( w )     \u03c9  \u00af     1 j k      Q  \u00af     1 j k    +  \u2211  i = 2   p + 1     \u2211  k = 1   r + 1      L   i , p    ( u )     N   1 , q    ( v )    L   k , r    ( w )     \u03c9  \u00af     i 1 k      Q  \u00af     i 1 k    +  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1     \u2211  k = 1   r + 1      N   i , p    ( u )     N   j , q    ( v )    N   k , r    ( w )     \u03c9  \u00af     i j k      Q  \u00af     i j k           Note that some of the interior control parameters are also modified because the presence of the tri-Lagrangian basis    L   1 , p    ( u )    L   1 , q    ( v )    L   k , r    ( w )   . It is shown in Appendix A that the new interior control parameters are        Q   \u00af     i j k  \u03c9  =  Q  i j k  \u03c9  \u2212  c i   d j   Q  11 k  \u03c9  ,  i = 2 , \u2026 , p + 1 ,  j = 2 , \u2026 , q + 1    \u03c9   \u00af    i j k   =  \u03c9  i j k   \u2212  c i   d j   \u03c9  11 k   ,  i = 2 , \u2026 , p + 1 ,  j = 2 , \u2026 , q + 1    where    c   i   ,    d   j    are the coefficients that satisfy    L   1 , p    ( u )  =  \u2211  i = 1   p + 1      c   i     N   i , p    ( u )   ,   L   1 , q    ( v )  =  \u2211  j = 1   q + 1      d   j     N   j , q    ( v )    . These coefficients can be obtained from the transformation (6), and it can be shown that    c   1   = 1 ,   c   p + 1   = 0 ,   d   1   = 1 ,   d   q + 1   = 0  . Due to these properties the modification is applied only to the interior nodes of the element. The control parameters of the opposite facets  u =   u   m + p + 1    and  v =   v   n + q + 1    remain intact.  While three facets with a vertex, for example  u =   u   1    ,  v =   v   1    and  w =   w   1    are converted simultaneously. On the facet  u =   u   1    , we obtain a bi-variant Lagrangian form  (20)   S (   u   1   , v , w ) =  \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      L   j , q   ( v )   L   k , r   ( w )    Q \u00af    1 j k   \u03c9           On the facet  v =   v   1    , we obtain  (21)   S ( u ,   v   1   , w ) =  \u2211  i = 2   p + 1     \u2211  k = 2   r + 1      L   i , p   ( u )   L   k , r   ( w )    Q \u00af    i 1 k   \u03c9           On the facet  w =   w   1    , we obtain  (22)   S ( u , v ,   w   1   ) =  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1      L   i , p   ( u )   L   j , q   ( v )    Q \u00af    i j 1   \u03c9           The three common edges are then parameterized as   \u2211  i = 2   p + 1      L   i , p   ( u )    Q  \u00af     i 11   \u03c9     ,   \u2211  j = 2   q + 1      L   j , q   ( v )    Q  \u00af     1 j 1   \u03c9     , and   \u2211  k = 2   r + 1      L   k , r   ( w )    Q  \u00af     11 k   \u03c9     . respectively. On the common vertex, we obtain     Q  \u00af     111   \u03c9   =   Q   111   \u03c9    . Thus, the 3D element is expressed as  (23)     V  \u03c9   (  u , v , w  )  =   L   1 , p    ( u )    L   1 , q    ( v )    L   1 , r    ( w )     Q  \u00af     111   \u03c9   +  \u2211  i = 2   p + 1      L   i , p    ( u )    L   1 , q    ( v )    L   1 , r    ( w )     Q  \u00af     i 11   \u03c9    +  \u2211  j = 2   q + 1      L   1 , p    ( u )    L   j , q    ( v )    L   1 , r    ( w )     Q  \u00af     1 j 1   \u03c9    +  \u2211  k = 2   r + 1      L   1 , p    ( u )    L   1 , q    ( v )    L   k , r    ( w )     Q  \u00af     11 k   \u03c9    +  \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      N   1 , p    ( u )    L   j , q    ( v )    L   k , r    ( w )     Q  \u00af     1 j k   \u03c9     +  \u2211  i = 2   p + 1     \u2211  k = 2   r + 1      L   i , p    ( u )    N   1 , q    ( v )    L   k , r    ( w )     Q  \u00af     i 1 k   \u03c9     +  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1      L   i , p    ( u )    L   j , q    ( v )    N   1 , r    ( w )     Q  \u00af     i j 1   \u03c9     +  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )     Q  \u00af     i j k   \u03c9            It is shown in Appendix B that the new interior control parameters are  (24)      Q  \u00af     i j k   \u03c9   =   Q   i j k   \u03c9   + 2   c   i     d   j     e   k     Q   111   \u03c9   \u2212   d   j     e   k     Q   i 11   \u03c9   \u2212   c   i     e   k     Q   1 j 1   \u03c9   \u2212   c   i     d   j     Q   11 k   \u03c9      \u03c9  \u00af     i j k   =   \u03c9   i j k   + 2   c   i     d   j     e   k     \u03c9   111   \u2212   d   j     e   k     \u03c9   i 11   \u2212   c   i     e   k     \u03c9   1 j 1   \u2212   c   i     d   j     \u03c9   11 k         where the coefficients    c   i   ,    d   j   ,    e   k    satisfy the following conditions:       L   1 , p    ( u )  =  \u2211  i = 1   p + 1      c   i     N   i , p    ( u )   ,     L   1 , q    ( v )  =  \u2211  j = 1   q + 1      d   j     N   j , q    ( v )   ,    L   1 , r    ( w )  =  \u2211  k = 1   r + 1      e   k     N   k , r    ( w )       Again they are available from the transformation matrix in (6). Notably, in this case only the control parameters of the vertex opposite to the vertex three transformed facets intersect, and its three facets are left intact, while other control points are modified. Fig. 1 shows an example. Fig. 1(a) is the 3D original NURBS element, Fig. 1(b) is the blended element with a single facet converted, Fig. 1(c) is the blended element with two adjacent facets converted and Fig. 1(d) is the blended element with three facets and only one vertex converted.  For a multi-element NURBS patch the transformation proceeds element-by-element. When a single facet is converted, only the control parameters on the facet need to be modified, while interior parameters remain unchanged. An example is shown in Fig. 2.  When two intersecting facets are converted, the control parameters   {    Q   1 j k   ,   \u03c9   1 j k    }   j = 1 , k = 1   n , l   ,   {    Q   i 1 k   ,   \u03c9   i 1 k    }   i = 1 , k = 1   m , l   of the two facets should be transformed into Lagrangian form   {    P   1 j k   ,   \u03d6   1 j k    }   j = 1 , k = 1     n   1   ,   l   1     ,   {    P   i 1 k   ,   \u03d6   i 1 k    }   i = 1 , k = 1     m   1   ,   l   1     , while the interior control parameters are modified accordingly. In order to confine the change to a minimum range,   u   p + 2   is inserted in the knot vector repeated p\u22121 times and   v   q + 2   is inserted in the knot vector repeated q\u22121 times. Therefore, a row of B\u00e9zier\u2013Bernstein elements   [    u   p + 1   ,   u   p + 2    ]  \u00d7  [    v   q + 1   ,   v   q + 2    ]  \u00d7  [    w   1   , \u2026 ,   w   l    ]   appears in the boundary curve of the adjacent facets, as shown in Fig. 2(c). In this way, the internal control parameters modified are limited only in the B\u00e9zier\u2013Bernstein elements, while the others are unchanged. The same example patch with two adjacent facets converted is shown in Fig. 2(d).  While three intersecting facets are converted simultaneously, the control parameters of the three facets    {    Q   1 j k   ,   \u03c9   1 j k    }   j = 1 , k = 1   n , l   ,   {    Q   i 1 k   ,   \u03c9   i 1 k    }   i = 1 , k = 1   m , l   ,   {    Q   i j 1   ,   \u03c9   i j 1    }   i = 1 , j = 1   m , n    are transformed into the Lagrangian form    {    P   1 j k   ,   \u03d6   1 j k    }   j = 1 , k = 1     n   1   ,   l   1     ,   {    P   i 1 k   ,   \u03d6   i 1 k    }   i = 1 , k = 1     m   1   ,   l   1     ,   {    P   i j 1   ,   \u03d6   i j 1    }   i = 1 , j = 1     m   1   ,   n   1      . Some internal parameters also need to be modified. As mentioned above,   u   p + 2   is inserted in the knot vector repeated p\u22121 times and   v   q + 2   is inserted in the knot vector repeated q\u22121 times,   w   r + 2    r\u22121 times. As expected, three rows of B\u00e9zier\u2013Bernstein elements are generated on the three boundary curves of the facets, as demonstrated in the example in Fig. 2(e). Similar to the above two adjacent facets converted, the modified parameters are limited only in the B\u00e9zier\u2013Bernstein elements, while the others remain unchanged. The multi-element NURBS patch with three facets and only one vertex converted are shown in Fig. 2(f).  When more intersecting facets are involved, just repeat the steps above.  Once the basis functions of the blended element are established, the computation of stiffness matrix and force vector can proceed in the usual way in the isoparametric setting. For small strain problems, the stiffness matrix can be obtained simply by a transformation. Here we will discuss the transformation and related issues.  As alluded before we assume that the parent element is in NURBS element, and the stiffness matrix in NURBS is K 0.  (25)     K   0   =   \u222b   V      B   T    DB    d  V     where B is strain matrix and D is elasticity matrix.   B  = [   B   1   ,   B   2   ,   B   3   , \u2026 ,   B   26   ,   B   27   ]  . The equivalent nodal force in NURBS are originally computed as      F   0   =   \u222b   V      N   T    f    d  V  +   \u222b   S      N   T    h    d  S     where f is the body force and h is the boundary surface force, N is the NURBS basis function matrix.  At the element level Eq. (12) for the transformation between the original NURBS control point Q and the blended nodes P which include both intact control points and transformed Lagrangian nodes can be expresses as  (26)   Q =   M   \u2212 1   P :  = T P       where the linear mapping M stands for the Lagrangian transformation in Eq. (4) for 2D and Eq. (9) for 3D.  In the light of this transformation, the stiffness matrix of a blended element can be obtained as  (27)   K =   T  T    K   0   T       Similarly, the equivalent nodal force of a blended element can also be calculated by  (28)   F =   T  T    F   0         Transforming a NURBS facet to Lagrangian form always results in a tensor-produce patch of nodes. In particular, when a bi-quadratic NURBS surface is converted, the ensuing Lagrangian elements have nine nodes on the surface. This is not compatible with an 8-node quadrilateral facet. To connect the element to an 8-node surface, the middle node must be eliminated. Similarly, the polynomial degree of a Lagrangian facet may need to be reduced in order to connect a higher order NURBS to a trilinear finite element. Here, we discuss two common cases.  Consider the situation where a bi-quadratic NURBS element is to be interfaced to a four-node finite element through a common edge. When the connecting edge on the NURBS side is transformed, it is still quadratic having three nodes. The middle node is subsequently eliminated to obtain a line edge. The process is described as follows.  After the connecting edge is transformed into Lagrangian, the basis functions of the NURBS element can be expressed as    N = [   N   1   ,   N   2   ,   N   3   ,   N   4   ,   N   5   ,   N   6   ,   N   7   ,   N   8   ,   N   9   ]       The middle node (node 2 in this demonstration) is eliminated by forcing P 2 to be the middle point of P 1 and P 3,     [   P   1   ,     P   1   +   P   3    2  ,   P   3   ,   P   4   ,   P   5   ,   P   6   ,   P   7   ,   P   8   ,   P   9   ]       And thus the element is parameterized by 8 nodes,  [   P   1   ,   P   3   ,   P   4   ,   P   5   ,   P   6   ,   P   7   ,   P   8   ,   P   9   ]  . This is equivalent to the following adjustment on basis function:    N \u2032 = [   N   1   + 0.5   N   2   ,   N   3   + 0.5   N   2   ,   N   4   ,   N   5   ,   N   6   ,   N   7   ,   N   8   ,   N   9   ]       The transformation on basis functions is illustrated in Fig. 3.  We can define that the basis functions in the u-parametric coordinate are R 1(u), R 2(u) and R 3(u), and the basis functions in the v-parametric coordinate are R 1(v), R 2(v) and R 3(v). Thus    {        N   1   =   L   1   ( u ) *   R   1   ( v )         N   2   =   L   2   ( u ) *   R   1   ( v )         N   3   =   L   3   ( u ) *   R   1   ( v )            The rest of the basis functions are the same as the normal NURBS basis functions. Assuming that the element in Fig. 3(b) is a B\u00e9zier element, the ensuing basis functions are shown in Fig. 4.  If P\u2032 represents the set of reduced nodes, one can write the reduction as    P = R P \u2032       Thus,    Q =   M   \u2212 1   P =   M   \u2212 1   R  P \u2032  = T  P \u2032        The stiffness matrix in Eq. (27) is computed with this modified transformation matrix.  The same technique can be used in 3D to interface a NURBS element with a Lagrangian element of the same or a reduced order. Consider the example shown in Fig. 7. The system contains a quadratic 3D NURBS element (upper) and a 20-node brick (lower) connected at a common facet. After Lagrangian transformation, the connecting facet of the NURBS element still has nine nodes which is incompatible with the 8-node facet of the Lagrangian element. Let     N  = [   N   1   ,   N   2   ,   N   3   ,   N   4   ,   N   5   ,   N   6   ,   N   7   ,   N   8   ,   N   9   , \u2026 ,   N   24   ,   N   25   ,   N   26   ,   N   27   ]    be the (mixed) basis functions of the NURBS element after the application of Lagrangian transformation. Here, nodes 1 through 9 are on the connecting facet, with node 5 at the center, 2, 4, 6 and 8 at the middle of edges, and 1, 3, 5, 7 the vertices. The middle node is eliminated by enforcing the constraint      P   5   =  1 2   (   P   2   +   P   4   +   P   6   +   P   8   ) \u2212  1 4   (   P   1   +   P   3   +   P   5   +   P   7   )       The redistributed basis functions are     N  \u2032 = [   N   1   - 0.25   N   5   ,   N   2   + 0.5   N   5   ,   N   3   - 0.25   N   5   ,   N   4   + 0.5   N   5   ,   N   6   + 0.5   N   5   ,   N   7   - 0.25   N   5   ,   N   8   + 0.5   N   5   ,   N   9   - 0.25   N   5   , \u2026 ,   N   24   ,   N   25   ,   N   26   ,   N   27   ]       Consider further the interfacing of a tri-quadratic 3D NURBS element and a tri-linear 8 node brick, as shown in Fig. 8(a). First the 9 nodes to 8 nodes reduction described above is applied. During this process the middle node (node 5) is eliminated and the basis functions of the remains nodes on the facet are modified. Next, the middle nodes on each edge are eliminated by taking each of them to be the average of its two neighboring vertices. The resulting basis functions are    N \u2032\u2032 = [  N 1  + 0.5  N 2  + 0.5  N 4  + 0.25  N 5  ,  N 3  + 0.5  N 2  + 0.5  N 6  + 0.25  N 5  ,  N 7  + 0.5  N 4  + 0.5  N 8  + 0.25  N 5  ,  N 9  + 0.5  N 6  + 0.5  N 8  + 0.25  N 5  , \u2026 ,  N 24  ,  N 25  ,  N 26  ,  N 27  ]       The planar model in Fig. 5(a) is composed of a quadratic NURBS element and a quadratic finite element connected through a common edge in the middle. The upper nine-node square element is a quadratic NURBS element whose lower edge is transformed into Lagrangian and the element at the bottom is an eight-node Lagrangian element. Both the length and width of the NURBS element are 10mm, while the length and width of the finite element are 10 and 5mm respectively. The plane stress condition is assumed, and the material parameters are: Young\u2019s modulus E=2.1E5MPa, Poisson\u05f3s ratio v=0.3. A uniform vertical pressure of 1MPa is applied at the top edge of the model. The vertical degree of freedom at the bottom and the horizontal degree of freedom at the lower left corner are constrained. The stress contour and the displacement contour are shown in Fig. 5(b) and (c). Clearly a uniform stress distribution and a linear y-displacement field are obtained, as expected. The proposed formulation satisfies the compatibility condition across NURBS elements and C 0 finite elements. The displacement is continuous and the stress is C 0 continuous.  Next we test a quadratic NURBS element connecting to a linear finite element in Fig. 6. The material property, domain, type of plane, load and boundary constraints remain the same. Again the exact solution is obtained.  The solid model in Fig. 7(a) is composed of a tri-quadratic NURBS element and a 20-node brick element. The length, width and height of the NURBS element are 10, 10 and 5mm respectively, same as the finite element. The material parameters are: E=2.1E5MPa, v=0.3. A uniform vertical pressure of 1MPa is applied at the top facet of the model. The vertical displacement at the bottom surface is constrained, and the structure is constrained against rigid body motion otherwise. The stress contour and z-displacement contour are displayed in Fig. 7(b) and (c), showing a uniform stress field and a linear displacement field.    Fig. 8(a) shows the results of a modified model where the bottom element is an 8-node brick. Under the same material property, domain, loading and boundary conditions, the stress contour and z-displacement contour are shown in Fig. 8(b) and (c). Again the exact solutions are obtained.  A 3D simply supported beam is used here as the benchmark example to test the convergence of the blended element model. The length, width and height of the beam are L=1000mm, t=200mm, and H=200mm respectively. A uniform vertical pressure of 1MPa is applied at the top surface of the beam. The system is shown in Fig. 9. The material parameters are: Young\u2019s modulus E=2.1E5MPa, Poisson ratio v=0.3. The exact solution of the normal stress in the x-direction is given by    \u03c3   x   = 6 q y (   L  2  / 4 \u2212   x  2  ) /   H  3  + q y ( 4   y  2  /   H  2  \u2212 3 / 5 ) / H  . The exact value of   \u03c3   x   at the point x=0, y=100mm and z=0 is 18.95MPa. A half-half discretization as shown in Fig. 10 is used, where the left and right half domains are approximated by the quadratic Lagrangian elements and quadratic NURBS elements respectively. Several levels of mesh refinement are considered. The comparison of numerical results and exact solution is shown in Table 1. The relative error of   \u03c3   x   at the point x=0, y=100mm and z=0 is plotted in Fig. 11. The pure NURBS model exhibits a higher rate of convergence than both the blended model and the Lagrangian element model, while the blended model has a higher rate of convergence than the Lagrangian element model. This is expected because the basis functions are complete to quadratic order and are globally smooth. Fig. 12 depicts the stress distributions along the bottom edge y=100mm and z=0, computed in the finest mesh wherein the number of element divisions in the x-, y- and z-direction is 64\u204e8\u204e8. The results of the blended model\u00a0agree well with the analytical solution, especially on the right half edge where the domain are approximated by the quadratic NURBS elements.  Gears are common mechanical parts. In gear operations, the magnitude of contact stress on the tooth depends on the shape of the surface. In simulation, the geometric accuracy becomes a crucial issue. If FE modeling is used, the mesh on the surface must be fine enough in order to capture the geometry. If the blended approach is used, the tooth surface can be parameterized in NURBS which can exactly describe the geometry at any refinement level.    Fig. 13 illustrates a blended model of a gear and the procedure of the blended model is derived. Due to symmetry, the procedure is demonstrated using a single tooth. The blended model is established in the following steps:  (1) The tooth is modeled using NURBS elements in Fig. 13(a). Tri-quadratic elements are used.  The facet to be transformed in Fig. 13(b) and the associated control parameters are selected.  The selected surface is reparameterized in Lagrangian elements in Fig. 13(c).  The remaining domain is modeled using quadratic Lagrangian elements.  By repeating the above steps for each tooth the blended model is yielded as shown in Fig. 13(e). For reference the CAD model in shaded form is plotted side by side shown in Fig. 13(f).  A single tooth is chosen to perform a stress analysis. A uniform line load of 1N/mm at a 20o pressure angle is applied on one top side of the tooth. The lateral surfaces of the tooth are constrained. The resulting stress and displacement are shown in Fig. 14(a) and (b). The stress contour and displacement contour of finite element model under the same condition is shown in Fig. 14(c) and (d).  The blended model uses a small number of degrees of freedom and an exact description of the tooth geometry is achieved. The maximum stress and maximum displacement values of the blended model which uses 2260 elements to preserve the original geometry are close to those of the finite element model which uses 6280 elements, as shown in Table 2. Comparing the contours of the two models, it is shown that the stress distribution from NURBS is smoother. Thus, the use of NURBS elements, despite only regionally, still contributes to improve the stress predictions.  A method of constructing 3D blended element is presented, wherein selected boundary facets of NURBS elements are transformed into Lagrangian form. These blended elements can be used as interface between a NURBS domain and standard finite element domain. Blending NURBS and finite element in analysis allows one to selectively model some subdomain in NURBS while leaving the others in FEM, and thus to fully exploit the advantages of both. A 3D simply supported beam and a gear examples were used to demonstrate the method. The blended approach opens a pathway for analyzing large scale practical engineering problems partially using NURBS elements, and does so on the platform of existing finite element programs. Future work includes implementing this blended technique in commercial software such as ABAQUS to analysis large-scale, complex problems.   ACKNOWLEDGMENTS   We would like to thank the financial support from the National Natural Science Foundation of China (No. 11172139), the National Key Scientific Instrument and Equipment Development Project of China (No. 2013YQ47076508) and the Fundamental Research Funds for the Central Universities (No. 30915118825).  The blended representation (19) is to exactly recover the NURBS form, thus  (A.1)    \u2211  k = 1   r + 1      L   1 , p    ( u )     L   1 , q    ( v )    L   k , r    ( w )     \u03c9  \u00af     11 k      Q  \u00af     11 k   +  \u2211  j = 2   q + 1     \u2211  k = 1   r + 1      N   1 , p    ( u )     L   j , q    ( v )    L   k , r    ( w )     \u03c9  \u00af     1 j k      Q  \u00af     1 j k    +  \u2211  i = 2   p + 1     \u2211  k = 1   r + 1      L   i , p    ( u )     N   1 , q    ( v )    L   k , r    ( w )     \u03c9  \u00af     i 1 k      Q  \u00af     i 1 k    +  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1     \u2211  k = 1   r + 1      N   i , p    ( u )     N   j , q    ( v )    N   k , r    ( w )     \u03c9  \u00af     i j k      Q  \u00af     i j k     =  \u2211  i = 1   p + 1     \u2211  j = 1   q + 1     \u2211  k = 1   r + 1      N   i , p    ( u )     N   j , q    ( v )    N   k , r    ( w )    \u03c9   i j k     Q   i j k           By construction, on the facet  u =   u   1    we have  (A.2)    \u2211  j = 1   q + 1     \u2211  k = 1   r + 1      L   j , q    ( v )      L   k , r    ( w )     \u03c9  \u00af     1 j k      Q  \u00af     1 j k   =  \u2211  j = 1   q + 1     \u2211  k = 1   r + 1      N   j , q    ( v )      N   k , r    ( w )    \u03c9   1 j k     Q   1 j k         Likewise, on the facet  v =   v   1       (A.3)    \u2211  i = 1   p + 1     \u2211  k = 1   r + 1      L   i , p    ( u )      L   k , r    ( w )     \u03c9  \u00af     i 1 k      Q  \u00af     i 1 k   =  \u2211  i = 1   p + 1     \u2211  k = 1   r + 1      N   i , p    ( u )      N   k , r    ( w )    \u03c9   i 1 k     Q   i 1 k         Meanwhile, on the common edge of  u =   u   1    and  v =   v   1    ,  (A.4)    \u2211  k = 1   r + 1      L   k , r    ( w )     Q  \u00af     11 k   \u03c9   =   \u2211  k = 1   r + 1      N   k , r    ( w )    Q   11 k   \u03c9          Using these relations the equation (A.1) can be simplified as  (A.5)    \u2211  k = 1   r + 1    (    L   1 , p    ( u )    L   1 , q    ( v )  \u2212   N   1 , p    ( u )    L   1 , q    ( v )  \u2212   L   1 , p    ( u )    N   1 , q    ( v )  +   N   1 , p    ( u )    N   1 , q    ( v )   )    L   k , r    ( w )     Q  \u00af     11 k   \u03c9   +  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1     \u2211  k = 1   r + 1      N   i , p    ( u )     N   j , q    ( v )    N   k , r    ( w )     Q  \u00af     i j k   \u03c9     =  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      N   i , p    ( u )     N   j , q    ( v )    N   k , r    ( w )    \u03c9   i j k     Q   i j k           To determine the modified control points we now replace the Lagrangian basis functions in (A.5) with linear combinations of NURBS basis, via      L   1 , p    ( u )  =   \u2211   i = 1   p + 1      c   i     N   i , p    ( u )   ,    L   1 , q    ( v )  =   \u2211   j = 1   q + 1      d   j     N   j , q    ( v )         Since    L   1 , p    ( u )   and    N   1 , p    ( u )   both equal to 1 at  u =   u   1    ,   c   1   must equals to 1. Likewise,    d   1   = 1  . Thus,  (A.6)     L   1 , p    ( u )    L   1 , q    ( v )  \u2212   N   1 , p    ( u )    L   1 , q    ( v )  \u2212   L   1 , p    ( u )    N   1 , q    ( v )  +   N   1 , p    ( u )    N   1 , q    ( v )  =  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1      c   i     d   j     N   i , p    ( u )    N   j , q    ( v )          Substutitng this result into (A.5) we conclude           Q   \u00af     i j k   \u03c9   =   Q   i j k   \u03c9   \u2212   c   i     d   j     Q   11 k   \u03c9   ,  i = 2 , \u2026 , p + 1 , j = 2 , \u2026 , q + 1 ,     \u03c9   \u00af     i j k   =   \u03c9   i j k   \u2212   c   i     d   j     \u03c9   11 k   ,  i = 2 , \u2026 , p + 1 , j = 2 , \u2026 , q + 1 .       The blended representation (23) is constructed to exactly recover the NURBS form, thus  (B.1)     V  \u03c9   (  u , v , w  )  =   L   1 , p    ( u )    L   1 , q    ( v )    L   1 , r    ( w )     Q  \u00af     111   \u03c9   +  \u2211  i = 2   p + 1      L   i , p    ( u )    L   1 , q    ( v )    L   1 , r    ( w )     Q  \u00af     i 11   \u03c9    +  \u2211  j = 2   q + 1      L   1 , p    ( u )    L   j , q    ( v )    L   1 , r    ( w )     Q  \u00af     1 j 1   \u03c9    +  \u2211  k = 2   r + 1      L   1 , p    ( u )    L   1 , q    ( v )    L   k , r    ( w )     Q  \u00af     11 k   \u03c9    +  \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      N   1 , p    ( u )    L   j , q    ( v )    L   k , r    ( w )     Q  \u00af     1 j k   \u03c9     +  \u2211  i = 2   p + 1     \u2211  k = 2   r + 1      L   i , p    ( u )    N   1 , q    ( v )    L   k , r    ( w )     Q  \u00af     i 1 k   \u03c9     +  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1      L   i , p    ( u )    L   j , q    ( v )    N   1 , r    ( w )     Q  \u00af     i j 1   \u03c9     +  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )     Q  \u00af     i j k   \u03c9      =  \u2211  i = 1   p + 1     \u2211  j = 1   q + 1     \u2211  k = 1   r + 1      N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )    Q   i j k   \u03c9            On the facet  u =   u   1    ,  v =   v   1    and  w =   w   1    , we have  (B.2)    \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      L   j , q   ( v )   L   k , r   ( w )    Q \u00af    1 j k   \u03c9     =  \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      N   j , q   ( v )   N   k , r   ( w )   Q   1 j k   \u03c9      \u2211  i = 2   p + 1     \u2211  k = 2   r + 1      L   i , p   ( u )   L   k , r   ( w )    Q \u00af    i 1 k   \u03c9     =  \u2211  i = 2   p + 1     \u2211  k = 2   r + 1      N   i , p   ( u )   N   k , r   ( w )   Q   i 1 k   \u03c9      \u2211  i = 2   p + 1     \u2211  j = 2   q + 1      L   i , p   ( u )   L   j , q   ( v )    Q \u00af    i j 1   \u03c9     =  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1      N   i , p   ( u )   N   j , q   ( v )   Q   i j 1   \u03c9           On the common edge,  (B.3)    \u2211  i = 2   p + 1      L   i , p   ( u )    Q  \u00af     i 11   \u03c9    =  \u2211  i = 2   p + 1      N   i , p   ( u )   Q   i 11   \u03c9     \u2211  j = 2   q + 1      L   j , q   ( v )    Q  \u00af     1 j 1   \u03c9    =  \u2211  j = 2   q + 1      N   j , q   ( v )   Q   1 j 1   \u03c9     \u2211  k = 2   r + 1      L   k , r   ( w )    Q  \u00af     11 k   \u03c9    =  \u2211  k = 2   r + 1      N   k , r   ( w )   Q   11 k   \u03c9          On the common vertex,     Q  \u00af     111   \u03c9   =   Q   111   \u03c9    .  Considering the solution of three adjacent facets converted, Eq. (B.1) can be simplified as  (B.4)    \u2211  i = 2   p + 1     \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      d   j     e   k     N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )    Q   i 11   \u03c9      +  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      c   i     e   k     N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )    Q   1 j 1   \u03c9      +  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      c   i     d   j     N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )    Q   11 k   \u03c9      \u2212 2  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      c   i     d   j     e   k     N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )    Q   111   \u03c9      +  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )     Q  \u00af     i j k   \u03c9      =  \u2211  i = 2   p + 1     \u2211  j = 2   q + 1     \u2211  k = 2   r + 1      N   i , p    ( u )    N   j , q    ( v )    N   k , r    ( w )    Q   i j k   \u03c9            And we conclude  (B.5)      Q  \u00af     i j k   \u03c9   =   Q   i j k   \u03c9   + 2   c   i     d   j     e   k     Q   111   \u03c9   \u2212   d   j     e   k     Q   i 11   \u03c9   \u2212   c   i     e   k     Q   1 j 1   \u03c9   \u2212   c   i     d   j     Q   11 k   \u03c9      \u03c9  \u00af     i j k   =   \u03c9   i j k   + 2   c   i     d   j     e   k     \u03c9   111   \u2212   d   j     e   k     \u03c9   i 11   \u2212   c   i     e   k     \u03c9   1 j 1   \u2212   c   i     d   j     \u03c9   11 k      where the coefficients    c   i   ,   d   j   ,   e   k    satisfy the following conditions:      L   1 , p    ( u )  =  \u2211  i = 1   p + 1      c   i     N   i , p    ( u )   ,     L   1 , q    ( v )  =  \u2211  j = 1   q + 1      d   j     N   j , q    ( v )   ,     L   1 , r    ( w )  =  \u2211  k = 1   r + 1      e   k     N   k , r    ( w )         They are readily obtained from the inverse of the transformation matrix in (12).   REFERENCES", "highlights": "A method for blending three-dimensional\u00a0Non-Uniform Rational B-Splines (NURBS) elements and Lagrangian elements is proposed. In the blended element, selected boundary facets of a NURBS patch are presented in Lagrangian form, enabling the patch to be directly connected to standard Lagrangian elements. The transformation from NURBS to Lagrangian preserves the original geometry and thus retains the geometric exactness. The transformation is utilized to develop blended models wherein a part of the domain is described in NURBS while the remaining domain is in traditional finite elements. A simply supported beam is used as the benchmark example to test the convergence of the 3D blended element model. The utility of the blended model is also demonstrated with an example of a gear with intricate geometry. The stress solutions are compared with those of the pure finite element model and the validity of the blended analysis is demonstrated."}