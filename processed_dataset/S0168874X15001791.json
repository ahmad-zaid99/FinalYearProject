{"id": "S0168874X15001791", "article": "MAIN-TITLE A 3D PVP co-rotational formulation for large-displacement and small-strain analysis of bi-modulus materials   HIGHLIGHTS          An efficient computational method is developed for geometrically nonlinear analysis of 3D bi-modulus materials.      A unified PVP constitutive equation is proposed to deal with the numerical instability of algorithms.      Traditional stress iteration is not required and the proposed algorithm shows excellent convergence.      The proposed algorithm is used to simulate the unilateral contact behavior of staggered bio-composites.          KEYPHRASES   Bi-modulus materials  Bio-composites  Parametric variational principle  Quadratic programming algorithm  Convergence   Some materials, such as concrete, polymer and composites, usually exhibit different mechanical responses in tension and compression in that they have different tensile and compressive moduli [1\u20133]. This kind of material is usually called bi-modulus material which has been reported in a lot of literature and monograph. For instance, a test shows that a certain granule concrete, made of quartzite and Portland cement, is a typical bi-modulus whose tensile modulus is    E  \u2212  = 6.50 \u00d7   10  3   MPa  and compressive modulus is    E  \u2212  = 1.82 \u00d7   10  4   MPa  . A glass-reinforced fiber exhibits significantly different mechanical behaviors in tension and compression and the value of    E  +  /   E  \u2212   is close to eight at room temperature [4]. Similar phenomena were observed in a damaged brittle material containing micro-cracks [5], aged polycrystalline NiTi alloys [6] and some bio-materials composed of soft organisms and hard minerals [7].  Mechanical analysis of bi-modulus materials is out of the scope of classical elasticity theory in solid mechanics which assumes material has the same moduli in tension and compression [8,9]. A great error cannot be ignored as the classical elasticity theory is used to analyze the mechanical behavior of bi-modulus materials, especially when the value of    E  +  /   E  \u2212   is far from 1. The new stress\u2013strain relationships and elasticity theory were developed by some researchers for bi-modulus materials. Jones [10] and Vijayakumar and Rao [11] proposed different stress\u2013strain relationships for composites with different stiffness in tension and compression. Subsequently, the stress\u2013strain relationship of bi-modulus materials was simplified as a bilinear model as shown in Fig. 1, which plays an important role on the later analytical and numerical solutions [4]. Some analytical solutions of bi-modulus materials can be found [12,13], but they are limited to simple and regular structures such as beams and columns, which are subjected to idealized loads and constraints.  Numerical analysis based on the finite element method (FEM) is a useful way for the complicated engineering structures made of bi-modulus materials. Zhang and Wang proposed the finite element formulation for a planar bi-modulus structure with a circle hole and they pointed out that the convergence was poor when using traditional iterative schemes to solve the nonlinear equation [14]. To improve the convergence, Yang and Zhu proposed a smoothing technique, which can be applied to solve 2D static bi-modulus problem [15] and also 1D dynamic and inverse problems [16,17]. Although convergence of the algorithm is improved by the smoothing technique, it still depends on the determination of parameters in the smoothing function. He et al. discussed and revealed the reason why the traditional Newton\u2013Raphson scheme was not stable for a 2D bi-modulus problem and proposed a more proper shear modulus to improve the convergence [18], only with modest success.  Recently, a quadratic programming method based on the PVP was developed for nonlinear analysis of bi-modulus truss and tensegrity structures [19]. The PVP method improves the convergence very well and has been demonstrated by numerical tests of the 1D bi-modulus problem, involving in both the small- and large-displacement analyses. Then the PVP formulation was extended to the 2D bi-modulus continuum by Zhang et al. and good convergence of the algorithm was also found [20]. In addition, a series of functional formulations, based on the minimum complementary energy principle, Hellinger\u2013Reissner type mixed variational principle and Hu\u2013Washizu type generalized variational principle, respectively, were proposed by Du and Guo for 3D bi-modulus materials while the elastic bounds of bio-composites were estimated accurately [21]. However, the work is limited to the small-deformation framework. To the authors\u05f3 knowledge, geometrically nonlinear analysis of 3D bi-modulus materials is rarely seen. It is necessary to develop an efficient computational method for the geometrically nonlinear analysis of 3D bi-modulus materials, which includes both material and geometric nonlinearities. Convergence of the algorithm also needs to be investigated for this issue.  The object of this paper is to develop an efficient computational method, which is based on the parametric variational principle and the co-rotational approach, for large-displacement and small-strain analysis of 3D bi-modulus materials. The rest of the paper is organized as follows. The non-smooth stress\u2013strain relationship of 3D bi-modulus materials is introduced in Section 2. In Section 3, a unified PVP constitutive equation is proposed in principal stress directions and the principle of minimum potential energy is established for small deformation analysis. In Section 4, the PVP formulation for small-deformation analysis is combined with the co-rotational approach to achieve the geometrically nonlinear analysis of 3D bi-modulus materials and then the PVP finite element formulation including incompatible modes is also presented. In Section 5, two numerical examples are employed to investigate the validity and convergence of the proposed PVP-CR algorithm. A novel application for staggered bio-composites is presented, too. Some conclusions are drawn in the final section.  The same as the classical elasticity that has the same moduli in tension and compression, the equilibrium equation and strain\u2013displacement relationship of 3D bi-modulus materials are given by  (1)   A \u03c3 + b = 0       (2)   \u03b5 = Lu    where \u03b5 and \u03c3 are strain and stress vectors, respectively. u is a displacement vector and b is a body force vector. L and A are differential operators,  (3)   A =   L  T  =  [        \u2202   \u2202 x      0   0      \u2202   \u2202 y      0      \u2202   \u2202 z        0      \u2202   \u2202 y      0      \u2202   \u2202 x         \u2202   \u2202 z      0     0   0      \u2202   \u2202 z      0      \u2202   \u2202 y         \u2202   \u2202 x        ]        However, the constitutive equation of 3D bi-modulus elasticity is different from the one of classical elasticity. The stress\u2013strain relationship of bi-modulus materials is shown in Fig. 1. It can be seen that material has a tensile modulus   E  +  when it is in tension, while has a compressive modulus   E  \u2212  when in compression. There is a nondifferentiable point on the constitutive curve, which leads to strain discontinuity. The constitutive equation of 3D bi-modulus materials is established in principal stress directions, which are marked by   x   I   ,   y   I   and   z   I   , as shown in Fig. 2.  O \u2212   x   I     y   I     z   I    is the coordinate system of principal stresses, while  O \u2212 x y z  is the coordinate system of stresses.  With principal strain and stress vectors denoted by   \u03b5   I   and   \u03c3   I   , respectively, and a flexibility matrix in principal stress directions denoted by   a   I   , the constitutive equation of 3D bi-modulus materials in the principal coordinate system  O \u2212   x   I     y   I     z   I    can be written as  (4)     \u03b5   I   =   a   I     \u03c3   I    or    \u03c3   I   =   D   I     \u03b5   I      where  (5)     \u03b5   I   =   [        \u03b5   \u03b1         \u03b5   \u03b2         \u03b5   \u03b3        ]  T        (6)     \u03c3   I   =   [        \u03c3   \u03b1         \u03c3   \u03b2         \u03c3   \u03b3        ]  T        (7)     a   I   =   D   I   \u2212 1   =  [        a   \u03b1 \u03b1         a   \u03b1 \u03b2         a   \u03b1 \u03b3           a   \u03b2 \u03b1         a   \u03b2 \u03b2         a   \u03b2 \u03b3           a   \u03b3 \u03b1         a   \u03b3 \u03b2         a   \u03b3 \u03b3        ]             \u03b5   i     ( i = \u03b1 , \u03b2 , \u03b3 )  represents three principal strains and    \u03c3   i    ( i = \u03b1 , \u03b2 , \u03b3 )  represents three principal stresses.   D   I   is the elasticity matrix in principal stress directions. Elements in matrix   a   I   are flexibility coefficients which are determined by the signs of principal stresses. Particularly for 3D bi-modulus materials, there are eight principal stress states that are determined by  (8)   {        a   i i   =  1    E  +    ,       \u03c3   i   > 0         a   i i   =  1    E  \u2212    ,       \u03c3   i   < 0       ( i = \u03b1 , \u03b2 , \u03b3 )      (9)   {        a   i j   = \u2212     \u03bd  +      E  +    ,       \u03c3   j   > 0         a   i j   = \u2212     \u03bd  \u2212      E  \u2212    ,       \u03c3   j   < 0       ( i , j = \u03b1 , \u03b2 , \u03b3 ; i \u2260 j )   where   \u03bd  +  is a tensile Poisson\u05f3s ratio and   \u03bd  \u2212  is a compressive Poisson\u05f3s ratio. Moreover, a recognized assumption based on experimental data,    \u03bd  +  /   E  +  =   \u03bd  \u2212  /   E  \u2212   , is used to ensure the symmetry of flexibility and elasticity matrices [4].  Eq. (4) is the stress\u2013stain relationship established in principal stress directions. Using the transformation from the principal coordinate system  O \u2212   x   I     y   I     z   I    to the coordinate system  O \u2212 x y z  ,  (10)     \u03b5   I   = Q \u03b5       (11)     \u03c3   I   = Q \u03c3    the constitutive equation in the coordinate system  O \u2212 x y z  can be given by  (12)   \u03c3 = D \u03b5    where  (13)   D =   Q  T    D   I   Q       (14)   Q =  [        l   1   2         m   1   2         n   1   2         m   1     n   1         n   1     l   1         l   1     m   1           l   2   2         m   2   2         n   2   2         m   2     n   2         n   2     l   2         l   2     m   2           l   3   2         m   3   2         n   3   2         m   3     n   3         n   3     l   3         l   3     m   3        ]     in which   l   i   ,   m   i   and   n   i      ( i = 1 , 2 , 3 )  are direction cosines of axes   x   I   ,   y   I   and   z   I   in the coordinate system  O \u2212 x y z  . From Eqs. (4), (8) and (9), it can be found that the stress\u2013strain relationship of 3D bi-modulus materials depends on the principal stress states. Strain discontinuity and absence of the shear modulus in Eq. (7) often cause troubles in traditional iterative solutions [14,15,17,19]. In fact, strain discontinuity may be dealt with a unified constitutive equation, which can describe the eight principal stress states indicated by Eqs. (8) and (9), in order to improve the convergence of the algorithm. To achieve this goal, the PVP for 3D bi-modulus materials will be proposed in the following section.  There are two cases to be considered, including    E  +  <   E  \u2212   and    E  +  >   E  \u2212   . We can take an arbitrary case to present the detailed derivation. In the case of    E  +  <   E  \u2212   , the flexibility matrix   a   I   can always be determined by selecting compressive modulus   E  \u2212  and Poisson\u05f3s ratio   \u03bd  \u2212  for the eight principal stress states indicated by Eqs. (8) and (9). Three parametric variables   \u03bb   \u03b1   ,   \u03bb   \u03b2   and   \u03bb   \u03b3   in the three principal stress directions can be introduced into Eq. (4) and a new unified constitutive equation for the eight principal stress states are given by  (15)   {        \u03b5   \u03b1           \u03b5   \u03b2           \u03b5   \u03b3        }  =  [       1    E  \u2212        \u2212     \u03bd  \u2212      E  \u2212        \u2212     \u03bd  \u2212      E  \u2212          \u2212     \u03bd  \u2212      E  \u2212         1    E  \u2212        \u2212     \u03bd  \u2212      E  \u2212          \u2212     \u03bd  \u2212      E  \u2212        \u2212     \u03bd  \u2212      E  \u2212         1    E  \u2212         ]   {        \u03c3   \u03b1           \u03c3   \u03b2           \u03c3   \u03b3        }  +  {        \u03bb   \u03b1           \u03bb   \u03b2           \u03bb   \u03b3        }       In addition, to keep the equivalence between Eq. (15) and Eqs. (4), (8) and (9), three complementarity equations need to be introduced in the three principal stress directions. The complementarity equations are given by  (16)       E  +    E  \u2212      E  \u2212  \u2212   E  +      \u03bb   \u03b1   =  {      0 ,       \u03c3   \u03b1   < 0         \u03c3   \u03b1   ,       \u03c3   \u03b1   \u2265 0             (17)       E  +    E  \u2212      E  \u2212  \u2212   E  +      \u03bb   \u03b2   =  {      0 ,       \u03c3   \u03b2   < 0         \u03c3   \u03b2   ,       \u03c3   \u03b2   \u2265 0             (18)       E  +    E  \u2212      E  \u2212  \u2212   E  +      \u03bb   \u03b3   =  {      0 ,       \u03c3   \u03b3   < 0         \u03c3   \u03b3   ,       \u03c3   \u03b3   \u2265 0             For    E  +  <   E  \u2212   , it is obvious that    E  \u2212  \u2212   E  +  > 0  . Thus it is definite that   \u03bb   \u03b1   ,   \u03bb   \u03b2   and   \u03bb   \u03b3   are always greater than or equal to zero. In fact,   \u03bb   \u03b1   represents the difference between     \u03c3   \u03b1       E  +    and     \u03c3   \u03b1       E  \u2212    , when   E  \u2212  is selected as the assumed modulus for the principal stress state    \u03c3   \u03b1   > 0  . Therefore,    \u03bb   \u03b1   > 0  means that material is in tension in the principal stress direction   x   I   and    \u03bb   \u03b1   = 0  means that material is in compression.   \u03bb   \u03b2   and   \u03bb   \u03b3   have similar physical meanings to   \u03bb   \u03b1   . From the above discussion, the eight principal stress states can be indicated by values of   \u03bb   \u03b1   ,   \u03bb   \u03b2   and   \u03bb   \u03b3   , such as  (a)      \u03bb   \u03b1   > 0 ,    \u03bb   \u03b2   > 0 ,    \u03bb   \u03b3   > 0  , material is in tension along the directions of   x   I   ,   y   I   and   z   I   ;       \u03bb   \u03b1   = 0 ,    \u03bb   \u03b2   = 0 ,     \u03bb   \u03b3   = 0  , material is in compression along the directions of   x   I   ,   y   I   and   z   I   ;       \u03bb   \u03b1   > 0 ,    \u03bb   \u03b2   = 0 ,    \u03bb   \u03b3   = 0  , material is in tension along the direction of   x   I   , while in compression along the directions of   y   I   and   z   I   ;       \u03bb   \u03b1   > 0 ,    \u03bb   \u03b2   = 0 ,    \u03bb   \u03b3   > 0  , material is in tension along the directions of   x   I   and   z   I   , while in compression along the direction of   y   I   ;       \u03bb   \u03b1   > 0 ,    \u03bb   \u03b2   > 0 ,    \u03bb   \u03b3   = 0  , material is in tension along the directions of   x   I   and   y   I   , while in compression along the direction of   z   I   ;       \u03bb   \u03b1   = 0 ,    \u03bb   \u03b2   = 0 ,    \u03bb   \u03b3   > 0  , material is in tension along the direction of   z   I   , while in compression along the directions of   x   I   and   y   I   ;       \u03bb   \u03b1   > 0 ,    \u03bb   \u03b2   = 0 ,    \u03bb   \u03b3   = 0  , material is in tension along the direction of   x   I   , while in compression along the directions of   y   I   and   z   I   ;       \u03bb   \u03b1   = 0 ,       \u03bb   \u03b2   > 0 ,        \u03bb   \u03b3   = 0  , material is in tension along the direction of   y   I   , while in compression along the directions of   x   I   and   z   I   .  Introducing slack variables   \u03bd   \u03b1   ,   \u03bd   \u03b2   and   \u03bd   \u03b3   into Eqs. (16)\u2013(18), respectively, the complementarity equations can be expressed as  (19)     \u03c3   I   \u2212     E  +    E  \u2212      E  \u2212  \u2212   E  +    \u03bb + \u03bd = 0       (20)     \u03bb   i   \u2265 0 ,     \u03bd   i   \u2265 0 ,    \u03bb   i     \u03bd   i   = 0  ( i = \u03b1 , \u03b2 , \u03b3 )    where  (21)   \u03bb =   [        \u03bb   \u03b1         \u03bb   \u03b2         \u03bb   \u03b3        ]  T  , \u03bd =   [        \u03bd   \u03b1         \u03bd   \u03b2         \u03bd   \u03b3        ]  T        Eq. (19) is the governing equation, which indicates the stress\u2013strain relationship and Eq. (20) is a complementary condition, which indicates the principal stress states. The new unified constitutive equation consists of Eqs. (19) and (20). Substituting Eq. (15) into Eq. (19), it yields  (22)     D   I   \u2212     \u03b5   I   \u2212  (      E  +    E  \u2212      E  \u2212  \u2212   E  +    I +   D   I   \u2212    )  \u03bb + \u03bd = 0    where  (23)   I =  [     1   0   0     0   1   0     0   0   1     ]  ,   D   I   \u2212   =   [       1    E  \u2212        \u2212     \u03bd  \u2212      E  \u2212        \u2212     \u03bd  \u2212      E  \u2212          \u2212     \u03bd  \u2212      E  \u2212         1    E  \u2212        \u2212     \u03bd  \u2212      E  \u2212          \u2212     \u03bd  \u2212      E  \u2212        \u2212     \u03bd  \u2212      E  \u2212         1    E  \u2212         ]   \u2212 1         In the case of    E  +  >   E  \u2212   , similar derivation can be achieved. Combing the two cases,    E  +  <   E  \u2212   and    E  +  >   E  \u2212   , the unified constitutive equation is rewritten as  (24a)   s    D   I   \u2212     \u03b5   I   \u2212  (  s \u03b4 I +   D   I   \u2212    )  \u03bb + \u03bd = 0       (24b)     \u03bb   i   \u2265 0 ,    \u03bd   i   \u2265 0 ,     \u03bb   i     \u03bd   i   = 0  ( i = \u03b1 , \u03b2 , \u03b3 )    where  (25)   s = sign (   E  \u2212  \u2212   E  +  ) ,   \u03b4 =     E  +    E  \u2212      E  \u2212  \u2212   E  +          (26)   sign ( a ) =  {      + 1 ,      i f  a > 0       \u2212 1 ,     i f   a < 0             The unified PVP constitutive equation of 3D bi-modulus materials has been derived so far. Now the eight principal stress states and stress\u2013strain relationships are indicated by the new constitutive equation, Eq. (24a), and the additional complementary equation, Eq. (24b). In the next\u00a0section, the principle of minimum potential energy with parametric variables will be proposed for numerical analysis with the FEM.  Strain energy of a bi-modulus continuum can be formulated in the principal coordinate system  O \u2212   x   I     y   I     z   I    , where strain energy density can be given by  (27)   \u03d5 =  1 2    (    \u03b5   I   \u2212 s \u03bb  )  T    D   I   \u2212    (    \u03b5   I   \u2212 s \u03bb  )        Substituting Eq. (10) into Eq. (27), it yields  (28)   \u03d5 =  1 2    (  Q \u03b5 \u2212 s \u03bb  )  T    D   I   \u2212    (  Q \u03b5 \u2212 s \u03bb  )        Combining with Eq. (24), the principle of minimum potential energy with parametric variables can be formulated as follows:  (29a)   min  .  \u220f  [  \u03bb  ( \u2219 )   ]  =  1 2   \u222b \u03a9   [    (  QLu \u2212 s \u03bb  )  T    D   I   \u2212    (  QLu \u2212 s \u03bb  )   ]    d V \u2212  \u222b \u03a9     u  T   b  d V \u2212  \u222b S     u  T  p  d S       (29b)   s .t .  s    D   I   \u2212     \u03b5   I   \u2212  (  s \u03b4 I +   D   I   \u2212    )  \u03bb + \u03bd = 0       (29c)     \u03bb   i   \u2265 0 ,    \u03bd   i   \u2265 0 ,     \u03bb   i     \u03bd   i   = 0  ( i = \u03b1 , \u03b2 , \u03b3 )       Note that the parametric variable \u03bb does not take part in the variational calculation [25], when variation is performed to get the equilibrium equation. The difference between the conventional variational principle (CVP) and the parametric variational principle (PVP) is illustrated in Fig. 3. Eqs. (29a) and (29b) show that the slack variable \u03bd is complementary to the parametric variable \u03bb . It is not difficult to prove that the solution of Eq. (29) is the real displacement of 3D bi-modulus materials subjected to a definite force and displacement boundary. We refer readers to Ref. [22] for the detailed proof on PVP of an elasto-plastic problem which is similar to the one of the bi-modulus problem discussed in this paper.  With the strain, element stiffness, coordinate transformation and shape function matrices denoted by B ,   K   e   ,     Q   e    and N respectively, the discretized formulation of potential energy for one element can be given by  (30)     \u03a0   e   =  \u222b    \u03a9   e       [   1 2    (    Q   e   B   q   e   \u2212 s   \u03bb   e    )  T    D   I   \u2212     (    Q   e   B   q   e   \u2212 s   \u03bb   e    )  \u2212   q   e   T     N  T    f   e    ]     d V =  1 2    q   e   T     K   e     q   e   \u2212   q   e   T     W   e     \u03bb   e   \u2212   q   e   T     f   e      where  (31)   B =  LN  ,    K   e   =  \u222b    \u03a9   e        B  T    D  \u2212  B  d V  ,    W   e   = s  \u222b    \u03a9   e        B  T    Q   e   T     D   I   \u2212   d V        Based on the PVP, variation of Eq. (30) yields  (32)     q   e   =   K   e   \u2212 1   (   W   e     \u03bb   e   +   f   e   )       On the other hand, the discretized complementarity equation of the element is given by  (33)     s   D   I   \u2212     Q   e   B   q   e   \u2212  (  s \u03b4  I +   D   I   \u2212    )    \u03bb   e   +   \u03bd   e   = 0        \u03bb   e   \u2265 0 ,    \u03bd   e   \u2265 0 ,    \u03bb   e     \u03bd   e   = 0          Eq. (32) is the finite element equilibrium equation within the small deformation framework and Eq. (33) indicates a standard LCP that can be solved by mature methods, such as Lemke\u05f3s algorithm, interior- and non-interior-point methods [23]. The nodal displacement vector   q   e   can be obtained once the parametric variable   \u03bb   e   is calculated by Eq. (33).  In this section, the PVP formulation for small deformation analysis presented above is combined with a co-rotational formulation, developed by Moita and Crisfield [24]. A new tangent stiffness matrix, including a parametric variable, is derived based on the parametric variational principle and the co-rotational approach that has been proved efficient for a large-rotation problem [25\u201328].  The coordinate systems and variables are introduced prior to the presentation of detailed derivation. Two coordinate systems and three configurations are illustrated in Fig. 4, where O-XYZ is a fixed global coordinate system and  O -   X   l     Y   l     Z   l    is a local coordinate system which is convected with the eight-node isoparametric brick element. The initial unit vectors  (   i   1   ,   i   2   ,   i   3   )  locating on the local co-ordinate system changes to  (   e   1   ,   e   2   ,   e   3   )  via a rigid body rotation and translation. By the co-rotational approach [25], a large deformation from configuration I to III is divided into two steps. The first step refers to a large rigid body motion from the configuration I to II in the global coordinate system O-XYZ; the second step refers to a pure small deformation from configuration II to III in the local coordinate system  O -   X   l     Y   l     Z   l    . Thus the PVP finite element formulation for the small deformation analysis can be used in the local coordinate system as the co-rotational approach is carried out, and then the local formulation can be mapped into the global formulation by transformation from the local to global coordinate system. In the following derivation, the subscript \u2018l\u2019 indicates the variables defined in the local coordinate system, while \u2018g\u2019 indicates those defined in the global coordinate system.  The transformation relation between the local and global nodal internal force vectors of the one element can be given by  (34)     f   g e   =   T   e   T     f   l e         The transformation is also available for the incremental local and global nodal displacement vectors,  (35)   \u03b4   q   l e   =   T   e   \u03b4   q   g e             T   e   is the transformation matrix which will be presented explicitly later. In Eq. (34), the local nodal internal force can be calculated by the small deformation formulation, Eq. (32), and it is given by  (36)     f   l e   =   K   l e     q   l e   \u2212   W   l e     \u03bb   l e         Here all the variables are denoted by adding a subscript \u2018 l \u2019 to indicate that they are defined and used in the local coordinate system. The tangent stiffness matrix can be derived by the variation of Eq. (34) ,   (37)   \u03b4   f   g e   =   T   e   T   \u03b4   f   l e   + \u03b4   T   e   T     f   l e         Firstly, we deal with the first term on the right side. Substitute Eq. (36) into the first term and the variation is performed by the PVP which rules that the parametric variable   \u03bb   l e   does not take part in the variation. Thus we can obtain  (38)     T   e   T   \u03b4   f   l e   =   T   e   T     K   l e   \u03b4   q   l e         Using Eq. (35), we obtain  (39)     T   e   T   \u03b4   f   l e   =   T   e   T     K   l e     T   e   \u03b4   q   g e         So the first part of the tangent stiffness matrix is given by  (40)     K   t e 1   =   T   e   T     K   l e     T   e         Subsequently, we focus on the second term on the right side of Eq. (37), which produces another part of the tangent stiffness matrix, i.e.,   K   t 2   . The detailed derivation of   K   t 2   has been presented by Moita and Crisfield [24]. Here we just list those formulations which are useful for this work. The transformation matrix   T   e   in Eq. (34) is given by  (41)   T      e   =  diag  (   R  T  ) +   z   e     v   e   T      where  (42)   R = [   e   1      e   2       e   3   ]         R is a  3 \u00d7 3  rotation matrix rotating the initial base vectors  (   i   1   ,   i   2   ,   i   3   )  into  (   e    1   ,   e    2   ,   e    3   )  (form the configuration I to II) which represents the local coordinate system. In fact, R can be calculated by the polar decomposition  F = R U  , made at the centroid of the element. F and U are the deformation-gradient and stretch matrices, respectively. Using the rotation matrix R , the local nodal displacement that produces strain can be obtained by  (43)     q   l e   i   =   R  T    x   g e   i 1   \u2212   X   l e   i      in which  (44)     x   g e   i 1   =   x   g e   i   \u2212   x   g e   1   =   [        x   g e   i   \u2212   x   g e   1   ,       y   g e   i   \u2212   y   g e   1   ,       z   g e   i   \u2212   z   g e   1        ]  T           (   x   g e   i   ,   y   g e   i   ,   z   g e   i   )  is the global coordinate of the node i on the configuration III and   X   l e   i   is the local coordinate of the node i on the configuration II. The global nodal coordinate vector   x   g e   of the element can be obtained by the following relationship,  (45)     x   g e   =   X   g e   +   q   g e      where   X   g e   and   q   g e   are the global coordinate vector on the configuration I and the global displacement vector from the configuration I to III. In Eq. (41),   v   e   is a  24 \u00d7 3  matrix,  (46)     v   e   T   = \u2212   [   A   l   T     z   e   ]   \u2212 1     A   l   T   [ d i a g (   R  T  ) ]    in which  (47)     z   e   = col  (   z  i  )       (48)     z  i  =   R  T   [     0    \u2212 (   z   g e   i   \u2212   z   g e   1   )       y   g e   i   \u2212   y   g e   1           z   g e   i   \u2212   z   g e   1      0    \u2212 (   x   g e   i   \u2212   x   g e   1   )       \u2212 (   y   g e   i   \u2212   y   g e   1   )       x   g e   i   \u2212   x   g e   1      0     ]        The denotation \u2018col\u2019 represents arranging    z  i  ( i = 1 , 2 , 3 , .. . , 8 )  as a column vector.   A   l   is a  24 \u00d7 3  matrix and is given by  (49)     A   l   = row (   A   l   i   )       (50)     A   l   i   =  [     0    \u2212 (   J   31   \u2212 1     h   \u03be   i   +   J   32   \u2212 1     h   \u03b7   i   +   J   33   \u2212 1     h   \u03b6   i   )       J   21   \u2212 1     h   \u03be   i   +   J   22   \u2212 1     h   \u03b7   i   +   J   23   \u2212 1     h   \u03b6   i           J   31   \u2212 1     h   \u03be   i   +   J   32   \u2212 1     h   \u03b7   i   +   J   33   \u2212 1     h   \u03b6   i      0    \u2212 (   J   11   \u2212 1     h   \u03be   i   +   J   12   \u2212 1     h   \u03b7   i   +   J   13   \u2212 1     h   \u03b6   i   )       \u2212 (   J   21   \u2212 1     h   \u03be   i   +   J   22   \u2212 1     h   \u03b7   i   +   J   23   \u2212 1     h   \u03b6   i   )       J   11   \u2212 1     h   \u03be   i   +   J   12   \u2212 1     h   \u03b7   i   +   J   13   \u2212 1     h   \u03b6   i      0     ]     where   J   \u2212 1   is the inverse of the Jacobian matrix which is calculated at the centroid of the element.   h   \u03be   i   ,   h   \u03b7   i   and   h   \u03b6   i   are the shape functions at the node i . The denotation \u2018row\u2019 indicates to arrange    A   l   i   ( i = 1 , 2 , 3 , .. . , 8 )  as a row vector.  The second term of Eq. (37) is manipulated by the variation, which yields  (51)   \u03b4   T   e   T     f   l e   =  \u03b4 [ diag ( R )  +   v   e     z   e   T   ]    f   l e         For the node i, the first term on the right side of Eq. (51) can be written as  (52)   \u03b4 R   f   l e   i   = S   (    f \u00af    l e   i   )  T      v   e   T   \u03b4   f   g e   i      where  (53)      f \u00af    l e   i   = R   f   l e   i            S ( \u2022 )  is an operator transforming the column vector    f \u00af    l e   i   into a skew-symmetric matrix, i.e.,  (54)   S =  [     0    \u2212    f \u00af    l e , z   i          f \u00af    l e , y   i            f \u00af    l e , z   i      0    \u2212    f \u00af    l e , x   i         \u2212    f \u00af    l e , y   i          f \u00af    l e , x   i      0     ]             f \u00af    l e , x   i   ,    f \u00af    l e , y   i   and    f \u00af    l e , z   i   are the three components of the vector    f \u00af    l e   i   .  The second term on the right side of Eq. (51) is given by  (55)   \u03b4 (   v   e     z   e   T    )   f   l e   =   v   e   \u03b4   z   e   T     f   l e   + \u03b4   v   e     z   e   T     f   l e         Derivation for the first term of Eq. (55) yields  (56)     v   e   \u03b4   z   e   T     f   l e   =   v   e    \u2211  j = 1  n   S (    f \u00af    l e   i   ) \u03b4   q   g   i    +   v   e    \u2211  j = 1  n   S (   x   g   i 1   ) S (    f \u00af    l e   i   )    v   e   T   \u03b4   q   g         In addition, the second term of Eq. (55) is proved to be zero at equilibrium [24], so another part of the tangent stiffness matrix can be directly given by  (57)     K   t e 2   = \u2212 col  [ S (    f \u00af    l e   i   ) ]    v   e   T    +   v   e   row [ S (    f \u00af    l e   i   ) ] +   v   e   sym  \u2211  j = 1  n   [ S (   x   g   i 1   ) S (    f \u00af    l e   i   ) ]     v   e   T         Note that the parametric variable   \u03bb   e   is included implicitly in the above formulation because of     f \u00af    l e   i   = R   f   l e   i    and    f   l e   =   K   l e     q   l e   \u2212   W   l e     \u03bb   l e    , which suggests that in the Newton iteration, the local stiffness matrix   K   l e   doesn\u05f3t need to be updated according to the current principal stress states. Instead the parametric variable   \u03bb   e   is calculated to get the tangent stiffness matrix and the local nodal force.  The incremental finite element equilibrium equation of the structure is given by  (58)     K   t   \u03b4   q   g   =   F   e x t   \u2212   F   int      where  (59)     K   t   =  \u2211  e = 1   N E    (   K   t e 1   +   K   t e 2   )            F   e x t   is the global nodal external force and   F   int   is the global nodal internal force which can be obtained by  (60)     F   int   =  \u2211  e = 1   N E      T   e   T     f   l e    =  \u2211  e = 1   N E      T   e   T   (   K   l e     q   l e   \u2212   W   l e     \u03bb   l e    )       Shear locking occurs when an eight-node brick element is used to analyze a bending dominated problem and it can be eliminated by using incompatible shape functions [29]. The PVP finite element formulation including incompatible modes is presented here, which will be used in the numerical examples behind. The displacement interpolation can be rewritten by adding an additional shape function,  (61)   u = N   q   e   +   N  *  \u03b1    where  (62)     N  *  =  [        h  *     0   0     0      h  *     0     0   0      h  *       ]  ,   h  *  =  [      1 \u2212   \u03be  2      1 \u2212   \u03b7  2      1 \u2212   \u03b6  2       ]          \u03b1 is an additional displacement vector including nine incompatible displacement modes that can be condensed. Thus the local PVP finite element formulation, Eq. (32), can be rewritten as  (63)     q   l e   =    K \u00af    l e   \u2212 1   (    W \u00af    l e     \u03bb   l e   +   f   l e   )    where  (64)      K \u00af    l e   =   K   l e   \u2212   K   u \u03b1     K   \u03b1 \u03b1   \u2212 1     K   \u03b1 u   ,    W \u00af    l e   =   W   l e   \u2212   K   l e     K   \u03b1 \u03b1   \u2212 1     W   l e   *      in which  (65)     K   u \u03b1   =  \u222b    \u03a9   e        B   * T     D  \u2212  B  d V  ,   K   \u03b1 \u03b1   =  \u222b    \u03a9   e        B   * T     D  \u2212    B  *   d V  ,   W   l e   *   = s  \u222b    \u03a9   e        B   * T     Q   e   T     D   I   \u2212   d V     and    B  *  = L   N  *   .  Flow chart of the finite element procedure of the PVP-CR algorithm is shown in Fig. 5. It can be seen that the local stiffness matrix doesn\u05f3t need to be updated by the current principal stress state when the global tangent stiffness matrix and the local nodal force are calculated. A local linear complementarity problem is solved firstly at the element level to get the parametric variable   \u03bb   l e   and then the incremental equilibrium equation is solved by the Newton\u2013Raphson scheme in the global coordinate system. The procedure stops if the convergence tolerance    \u2016    F   e x t   \u2212   F   int    \u2016   \u2016    F   e x t    \u2016   < \u03c8  is achieved. The tolerance is set to be  \u03c8 = 1 \u00d7   10   \u2212 5    and applied to all the numerical examples. In addition, flow chart of the arc length procedure combined with the proposed PVP method (can be called PVP-CR-Arc algorithm) is presented in Fig. 6 to deal with snap-through or snap-back problems. Here the superscript i denotes the load incremental step, while j denotes the iteration step. Details of the arc length procedure can be found in the monograph by Crisfield [33].  An\u00a0L-frame made of bi-modulus material is analyzed in this example. The size and mesh information of the structure are shown in Fig. 7 where the left surface of the horizontal beam is fixed and the top surface of the vertical column is subject to a traction force which is transformed into equivalent nodal forces and imposed at these nodes on the top surface. All the parameters are dimensionless. The tensile modulus of the material is    E  +  = 1 \u00d7   10  8   and the value of    E  +  /   E  \u2212   is set to 1:1, 1:10, 1:20, 10:1 and 20:1, respectively. The point M (0.577, 0.577, 0.577) is a selective integration point of the element.  First of all, geometrically nonlinear analysis of the structure with the same moduli in tension and compression  (   E  +  =   E  \u2212  = 1 \u00d7   10  8  )  is achieved by both the proposed PVP-CR algorithm and the commercial software ABAQUS. The load\u2013displacement curves are plotted in Fig. 8, where the horizontal axis represents the load and the vertical axis represents the horizontal displacement at the central node on the top surface of the vertical column. It can be seen that the two results are in a good agreement and are smaller than the linear elastic analysis. Then the cases with different values of    E  +  /   E  \u2212   , which cannot be solved directly by ABAQUS, are analyzed using the proposed PVP-CR algorithm. The conventional modified Newton\u2013Raphson scheme, called MNR-CR here, is also employed to solve the problem both including material and geometric nonlinearities, in order to verify the validity and convergence of algorithms.  The results of displacement  (   E  +  /   E  \u2212  = 10 : 1 )  obtained by PVP-CR and MNR-CR algorithms are plotted in Fig. 9, where   \u0394  F  denotes the load increment between two adjacent load steps. Obviously, the results obtained by the PVP-CR algorithm with a small load step   \u0394  F = 6  agree with the ones obtained by a large load step,   \u0394  F = 60  . In addition, for   \u0394  F = 6  the MNR-CR algorithm produces the same results with the PVP-CR algorithm at the beginning of loading, but it aborts after only several load steps.  To investigate the convergence of algorithms, convergence curves in the first load step are presented in Fig. 10. From Fig. 10(a), it can be seen that both the two algorithms converge successfully in the first load step when the load increment is   \u0394  F = 6  , and the proposed PVP-CR algorithm requires less iterations than the MNR-CR algorithm. However, Fig. 10(b) and (c) show that the MNR-CR algorithm fails to converge as a large load increment is adopted. As shown in Fig. 10(b), oscillation is observed for the MNR-CR algorithm with   \u0394  F = 60  and Fig. 10(c) shows that the MNR-CR algorithm diverges dramatically after several iterations as a larger load step   \u0394  F = 600  is adopted. In contrast to the MNR-CR algorithm, the proposed PVP-CR algorithm shows a stable convergence behavior and can achieve the convergence tolerance via a few iterations for all the three cases with different load increments.  Load\u2013displacement curves of the structure are plotted in Fig. 11 and von Mises stress curves are plotted in Fig. 12. Three typical deformed shapes of the structure obtained by the PVP-CR algorithm are plotted in Fig. 13, where the external load at the central node on the top surface is up to 6000. Von Mises stress contours are shown in Fig. 14. It is visible that the smaller the compressive modulus, the larger the deformation, because the compressive resistance of the material reduces with the decrease of compressive modulus. The distribution of von Mises stress of bi-modulus structures are obviously different from those of classical structures which has the same moduli in tension and compression, which demonstrates that the necessity of applying the bi-modulus elasticity theory to the mechanical analysis of bi-modulus structures with a large value of    E  +  /   E  \u2212   .  The bi-modulus cylindrical thin shell shown in Fig. 15 is studied by a combination of the PVP-CR algorithm with the arc-length procedure (PVP-CR-Arc algorithm). A quarter of the shell is discretized by using 32  ( 4 \u00d7 4 \u00d7 2 )  eight-node isoparametric brick elements which include incompatible modes and a concentrated force F is applied at the central point A . The size and material property of the structure are selected from the work by Moita and Crisfield [24], in which the cylindrical shell with the same moduli in tension and compression was analyzed. The radius of the cylinder is  R = 2540 mm  , the length is  l = 508 mm  , the angle theta is  \u03b8 = 0 . 1rad  and the thickness is  t = 12.7 mm  . The tensile modulus and Poisson\u05f3s ratio are    E  +  = 3105   N /   mm  2   and    v  +  = 0.3  . The value of    E  +  /   E  \u2212   is set to be 1:1, 2:1, 3:1, 5:1 and 10:1.  The load\u2013displacement curves obtained by the proposed PVP-CR-Arc algorithm and the commercial software ANSYS respectively are plotted in Fig. 16, when the case of    E  +  =   E  \u2212   is considered. As can be form above, the results obtained by using the brick element, including incompatible modes, agree with the ones obtained by using the shell element. Load\u2013displacement curves of the node A of the structure with different compressive moduli are shown in Fig. 17 and the limited load for compression is listed in Table 1, which suggests that the limited load decreases approximately linearly with the increase of the value of    E  +  /   E  \u2212   .  Note that the traditional Newton\u2013Raphson scheme embedded in the arc length procedure fails to converge in this example.  As a natural load-bearing bio-composite material with staggered microstructures, nacre has received much attention for recent years [21,30\u201332]. The microstructure of the nacre scanned by the electric mirror is shown in Fig. 18, which can be simplified as a \u2018brick-mortar\u2019 model shown in Fig. 19(a). Fig. 19(b) shows a typical representative volume element of the periodic structure. The gap between the mineral materials extends when the structure is in tension, as shown in Fig. 19(c), while the mineral materials contact as the structure is in compression, as shown in Fig. 19(d). This phenomenon is usually called the unilateral contact.  Evans et al. studied the mechanical responses of the nacre and revealed that nacre is of bi-modularity due to the unilateral contact behavior that occurs when the structure is in compression [30]. Ji and Gao proposed an analytical model to determine the effective modulus [31] and Bertodli et al. improved this model and simulated the mechanical responses of the nacre, using the boundary element method (BEM) to achieve a hard contact analysis [7]. Recently, Du and Guo substituted a simple bi-modulus spring model for the hard contact analysis to simulate the unilateral contact behavior. The upper and lower bounds of the staggered bio-composite material are determined by the variational method [21].  In this example, the unilateral contact behavior observed in the microstructure of nacre is simulated by a multi-phase bi-modulus material model and the effective moduli of the staggered bio-composite material are determined by the proposed algorithm. Half of the \u2018brick-mortar\u2019 structure shown in Fig. 19(b) is discretized by 414  ( 23 \u00d7 18 \u00d7 1 )  elements and the left edge of the finite element model is subjected to a symmetric displacement constraint, as shown in Fig. 20.  The model consists of three-phase materials including mineral, organism and bi-modulus materials. The Young\u05f3s moduli of the mineral and organism materials are    E   m   = 100 GPa  and   E   o   ranges from 1 to 10GPa. The tensile and compressive moduli of bi-modulus materials are    E  +  = 0.1 GPa  and    E  \u2212  = 1000 GPa   [21]. Poisson\u05f3s ratio of materials is 0.33. The volume of the mineral material occupies 90% of all the materials and the widths of the mineral and organic materials are    h   m   = 0.5 \u03bc m  and    h   o   = 20 nm  . Numerical simulations for the uniaxial tension and compression are performed by the proposed PVP-CR algorithm and then the effective moduli of the bio-composite can be calculated by   E \u00af  =  R \u00af  / \u0394  , in which  E \u00af  is the effective modulus, \u0394 is the forced displacement on the free edge and  R \u00af  is the effective action force on the constrained edge.  The effective moduli of tension and compression denoted by    E \u00af    1   t   and    E \u00af    1   c   respectively are presented in Fig. 21. The subscript \u20181\u2019 represents the direction paralleling to the load. It can be seen that the effective moduli obtained by the FEM proposed in this paper agree with the ones obtained by the analytical model proposed by Bertoldi et al. [7]. In addition, the results obtained by the FEM locate between the upper (the red line) and lower (the blue line) bounds, predicated by Du and Guo [21] using a variational method, as shown in Fig. 22. The result is also in a good agreement with the ones in Ref. [21]. This example thus demonstrates the validity of using the bi-modulus material model to simulate the unilateral contact behavior of staggered bio-composite like nacre or other materials with micro-cracks.   CONCLUSIONS   This paper develops an efficient computational method for large-displacement and small-strain analysis of 3D bi-modulus materials. The material nonlinearity is dealt with the parametric variational principle and geometric nonlinearity is formulated by the co-rotational approach that decomposes a large deformation into a rigid body motion in the global coordinate system and a pure small deformation in the local coordinate system. A unified PVP constitutive equation is proposed in the local coordinate system to overcome numerical instability which is caused by strain discontinuity, so that the traditional stress iteration is not required. The proposed PVP-CR algorithm does not require selection of the elastic modulus by the signs of principal stresses while the local stiffness matrix does not require updating when calculating the global stiffness matrix and the nodal internal force. Compared with the traditional iterative solution, the PVP-CR algorithm shows good convergence and can deal with a large load step successfully. Numerical examples indicate that the mechanical responses of bi-modulus materials are apparently different from the ones of classical structures with the same moduli in tension and compression. In addition, the proposed algorithm is successfully used to simulate the unilateral contact behavior of microscopic staggered bio-composites, which suggests that the bi-modulus stress\u2013strain relationship can be used as a model of hard contact. Experimental verification is necessary in future.  The proposed method can be extended to geometrically nonlinear analysis of anisotropic bi-modulus composites.   ACKNOWLEDGMENTS   The projects supported by National Natural Science Foundation of China (Nos. 11502035, 11572060), Fundamental Research Funds for the Central Universities (No. 106112015CDJXY320006) and Open Research Foundation (No. GZ1404) of State Key Laboratory of Structural Analysis for Industrial Equipment at Dalian University of Technology are gratefully acknowledged.   REFERENCES", "highlights": "An efficient computational method is developed for large-displacement and small-strain analysis of 3D bi-modulus materials which are often found in civil, composite and biological engineering. Based on the parametric variational principle (PVP), a unified constitutive equation of 3D bi-modulus materials is proposed to deal with the problem of numerical instability. The small-strain bi-modulus problem is transformed into a standard linear complementarity problem that can be solved easily by the classic Lemke\u05f3s algorithm. By using the co-rotational approach, the local PVP formulation is combined with an existing co-rotational formulation and a new tangent stiffness matrix, including a parametric variable, is derived for geometrically nonlinear analysis. Traditional stress iteration is not required for calculation of the nodal internal force when the Newton\u2013Raphson scheme or Arc-length method is employed to solve the material and geometric nonlinear problem. Convergence of the proposed algorithm is improved greatly in contrast to the traditionally iterative solution. Also, the proposed algorithm is used to simulate a unilateral contact behavior of staggered bio-composites and the effective elasticity modulus of composites is determined accurately."}