{"id": "S0168874X14001346", "article": "MAIN-TITLE A total-Lagrangian position-based FEM applied to physical and geometrical nonlinear dynamics of plane frames including semi-rigid connections and progressive collapse   HIGHLIGHTS          Development of an alternative FE for physical and geometrical nonlinear dynamics.      Generalized vectors with natural energy conserving property.      Analysis of 2D frames and machines.      Multi-linear elastoplastic for continuum members and semi-rigid connections.      Progressive collapse analysis of structures subjected to seismic loads.          KEYPHRASES   Physical and geometrical nonlinear dynamics  Frames  Machines  Finite element methods  Semi-rigid connections  Progressive collapse   Due to recent advances in computational resources new possibilities are opened to the dynamic analysis of solids, structures and mechanisms. Particularly, in structural analysis, time domain nonlinear formulations are gaining more space in the specialized literature. It occurs because this kind of analysis allows forecasting the behavior of structures in situations beyond the elastic limit, including the loss of strength and stiffness related to the inelastic behavior of materials and the occurrence of large displacements and rotations [1].  Regarding large displacement and rotations one must make difference between the geometrically exact representations present in works like [2,3,4,5] and the approximate second order ones described by [6,7,8,9], for example. Second order formulations, for which stability functions are employed to modify the stiffness of bending elements, do not consider the inertial properties of transverse movements and are not capable of giving precise results for mechanism analysis and for the post-critical behavior of ruined structures. Therefore, in this work we choose to adopt a geometrically exact formulation.  Among the geometrically exact formulations for the analysis of structures and mechanisms one should highlight the updated Lagrangian or co-rotational schemes and the total Lagrangian strategies. Due to the change of reference the mass matrix varies in updated Lagrangian approaches, arising the need of special time integration algorithms to guarantee the energy and momentum conservation [3,5,10]. The total Lagrangian formulations present a constant (or quasi-constant) mass matrix, which allows the use of well established time integration procedures developed in the context of geometrically linear analysis, as for example the Newmark \u03b2 algorithm [11].  Thus, in this work we use the total Lagrangian formulation based on positions to develop a strategy for the physical and geometrical nonlinear analysis of plane structures and mechanisms. The developed frame elements have cross sections constituted by laminas of different materials and widths following the Reissner\u2013Mindlin kinematics which includes a complete constitutive relation. These elements are connected among each other by semi-rigid connections. Both elements and connections have multi-linear elastoplastic behavior with isotropic hardening.  Various researches related to geometrical nonlinear analysis of two and three-dimensional frames that consider plasticity can be cited. Some pioneering authors [12,13] applied co-rotational techniques to analyze three-dimensional frames developing plasticity. In these works elastoplasticity is treated in a discrete way (plastic hinges), in which a moment\u2013curvature relation is assumed for continuous members cross sections. One can cite some recent works that follow the same localized plastic hinge strategy to model the behavior of frame elements, like [14\u201322].  Some authors [23\u201325] use distributed plasticity to model two and three dimensional frames. One advantage of distributed plasticity, when compared to plastic hinges, is the better representation of the plastic evolution over cross sections, without the necessity of a previous knowledge of moment\u2013curvature curves. However, both plastic hinges and the existent distributed plasticity frame models do not consider the shear stress influence like the finite element proposed in this work.  In the context of three dimensional analyses advanced works such as [26\u201328] should be mentioned. In these works cable, truss and beam-column elements are specifically designed to guarantee efficiency for practical applications. Authors include second order formulations for the beam-column element and apply lumped mass matrix to proceed with time integration when all elements are coupled together. Moreover, fiber concept plasticity is introduced to consider distributed plasticity along elements.  Concerning problems in which semi-rigid connections are present one can cite the works of [29\u201336]. All these works use second order geometrical description, which limits the range of applications, i.e., displacements and rotations should not be large as required, for example, in machine and progressive collapse analysis including the post-critical behavior of ruined structures.  In order to implement semi-rigid connections in any computational code it is necessary to use results from works that study the experimental behavior of these connections, as, for example, [37,38]. Some works, using experimental results, to establish empirical mathematical models for connections behavior are also present in literature; see, for example, the works of [29,39\u201344]. Based on these studies and in second order instability theory some authors [45] adopted elastoplastic power laws to model the nonlinear behavior of semi-rigid connection for the analysis of 2D structures subjected to seismic loads. These authors also adopted localized plasticity at extremity of elements (as the elastic instability approach has been adopted along bars) to model the physical nonlinear behavior of 2D frames.  In the present work an alternative position based on finite element (FE) formulation [46,47] is developed to comprise geometrical and physical nonlinearity of both frame members and connections for dynamic analysis of machines and structures. The formulation, originally developed and presented in this work, is geometrically exact and, considering the Reissner kinematic hypothesis, includes shear stress contribution for both displacement and failure criterion. Based on [48] the developed elastoplastic algorithm is multi-linear with an alternative flow direction rule, which allows the reproduction of any stress\u2013strain curve and the determination of closed solution for the plastic multiplier. Moreover, semi-rigid elastoplastic connections develop large rotations allowing realistic analysis of unload situations for which connections and/or frame elements suffer plastic deformations.  We start the formulation description by defining the Reissner kinematic for laminate frame elements passing through the establishment of the total potential energy including plastic dissipation for both frame elements and semi-rigid connections. After that, the principle of stationary energy is employed to write the dynamic equilibrium equations (regarding positions) and the elastoplastic evolution is defined. The Newmark time integration algorithm and the Newton\u2013Raphson procedure are combined to solve the resulting time step nonlinear system of equations. Examples are presented to validate the proposed formulation and to show its possibilities.  The FE formulation presented here is called positional as it is based on positions, not displacements [46,47]. The main advantages of this total Lagrangian strategy are the establishment of gradient deformation without the explicit use of the chain rule and the achievement of quasi-constant mass matrix [49\u201352]. The chain rule operation appears as a simple numerical (2\u00d72) matrix inversion, which allows an easy generalization of this procedure for any class of nonlinear mechanical problems.  In this section we present the complete development of the alternative 2D positional laminate Reissner kinematics to be used in the proposed finite element formulation.  The positional formulation is based on two mappings, one related to the initial configuration and another related to the current configuration. To describe the initial configuration mapping one starts with the reference line approximation, see Fig. 1a, by the following expression:  (1)    f   o i   m   (   \u03be   1   ) =   x   i   m   (   \u03be   1   ) =   \u03d5   \u2113     X   i \u2113   m     in which i is the coordinate direction (1 or 2), m represents the reference line and \u2113 the element node (or shape function). In expression (1) the repetition of index \u2113 indicates summation (Einstein notation). Fig. 1a shows 4 nodes (cubic approximation); however any number of nodes or approximation order may be chosen.  In Fig. 1a    f \u2192    0   m   (   \u03be   1   ) is the mapping from the non-dimensional variable   \u03be   1   to the initial reference line. To define the cross sections initial position one calculates the nodal angle   \u03b8   k   0   that the normal vector   v   i k   makes with the horizontal direction (x 1 axis), see Fig. 1b, as  (2)    \u03b8   k   0   = a r c t g (   v   2 ( k )   /   v   1 ( k )   )   in which  (3)    v   1 k   = \u2212   T   2 k   / | |  T \u2192  | |  and    v   2 k   =   T   1 k   / | |  T \u2192  | |   and  (4)    T   i k   =      d   \u03d5   \u2113   (   \u03be   1   )   d   \u03be   1      |     \u03be   1   k       X   i \u2113   m        Knowing the nodal (cross sections) angles we use the same shape functions to approximate   \u03b8   0   (   \u03be   1   ) along the initial configuration  (5)    \u03b8  0  (   \u03be   1   ) =   \u03d5   \u2113   (   \u03be   1   )   \u03b8   \u2113   0        In Fig. 2 one can find any point inside the continuum (laminate frame) using the following expressions:  (6)    f   01   (   \u03be   1   ,   \u03be   2   ) =   x   1   l a m   (   \u03be   1   ,   \u03be   2   ) =   \u03d5   \u2113   (   \u03be   1   )   X   1 \u2113   + (   d   l a m   +     h   l a m    2    \u03be   2   ) cos (   \u03d5   \u2113   (   \u03be   1   )   \u03b8   \u2113   0   )      (7)    f   02   (   \u03be   1   ,   \u03be   2   ) =   x   2   l a m   (   \u03be   1   ,   \u03be   2   ) =   \u03d5   \u2113   (   \u03be   1   )   X   2 \u2113   +  (    d   l a m   +     h   l a m    2    \u03be   2    )  sin (   \u03d5   \u2113   (   \u03be   1   )   \u03b8   \u2113   0   )   in which   \u03be   2   is the second non-dimensional variable,   d   l a m   is the distance of the lamina mid line from the reference line,   h   l a m   is the height of a lamina and the pair ( cos (   \u03d5   \u2113   (   \u03be   1   )   \u03b8   \u2113   0   ) ,  sin (   \u03d5   \u2113   (   \u03be   1   )   \u03b8   \u2113   0   ) ) is the parameterized unit orthogonal vector. In Eqs. (6) and (7) the symbol m is suppressed, and from now on   X   i \u2113   is simply the initial nodal coordinate.  The width of each lamina (   b   l a m   ) is introduced at the integration procedure as an additional weighting value.  The necessary information to build the initial configuration comprises the reference line nodal coordinates and the distance of each lamina from the reference line (assumed constant) as well as the height and width of each lamina (assumed constant). The current configuration is achieved by a nonlinear process that uses a trial position to start the solution procedure. So, at this stage, we do not worry about the solution process and write the current configuration similarly to the initial one, as  (8)    f   11   (   \u03be   1   ,   \u03be   2   ) =   y   1   l a m   (   \u03be   1   ,   \u03be   2   ) =   \u03d5   \u2113   (   \u03be   1   )   Y   1 \u2113   +  (    d   l a m   +     h   l a m    2    \u03be   2   ) cos (   \u03d5   \u2113   (   \u03be   1   )   \u03b8   \u2113    )       (9)    f   12   (   \u03be   1   ,   \u03be   2   ) =   y   2   l a m   (   \u03be   1   ,   \u03be   2   ) =   \u03d5   \u2113   (   \u03be   1   )   Y   2 \u2113   +  (    d   l a m   +     h   l a m    2    \u03be   2    )  ( sin (   \u03d5   \u2113   (   \u03be   1   )   \u03b8   \u2113     Here   y   i   l a m   are the current coordinates of a general point inside the frame element and lamina,   Y   i \u2113   are current nodal coordinates and   \u03b8   \u2113   are the current angles of cross sections, see Fig. 3.  One can see from Fig. 3 and from Eqs. (8) and (9) that cross sections remain straight, but not orthogonal to the reference line. This characterizes the general Reissner kinematics. Moreover we kept   h   l a m   and   b   l a m   unchanged, limiting our constitutive relation to accept any shear elastic modulus (G), but null Poisson ratio regarding the longitudinal strain relations, see Eq. (16).  As the mappings from the non-dimensional space to initial and current configurations had been defined in previous section, we start the description of the deformation of the analyzed body (laminate frame). This is done by joining the two mappings of Figs. 2 and 3 in a single representation, see Fig. 4, for which the function  f \u2192  describes the deformation from initial configuration (   B   0   ) to the current one ( B ) . As is well known [46]   f \u2192  is written as a composition of mappings    f \u2192    0   and    f \u2192    1   as  (10)   f \u2192  =    f \u2192    1     (    f \u2192    0   )   \u2212 1     and the gradient of  f \u2192  , called here A (a 2\u00d72 tensor), is written from the gradient of    f \u2192    0   and    f \u2192    1   as  (11)  A =   A  1  \u22c5   (   A  0  )   \u2212 1    or    A   i j   =   A   i k   1     D   k j     in which   D   k j   is the inverse of   A  0  .  The gradients of initial and current mappings are written as  (12)    A   i j   0   =   \u2202   f   0 i     \u2202   \u03be   j     =   f   0 i , j   =  [      {    \u03d5   \u2113 , 1     X   1 \u2113   \u2212  (    d   l a m   +     h   l a m    2    \u03be   2    )  sin (   \u03d5   k     \u03b8   k   0   ) (   \u03d5   z , 1     \u03b8   z   0   )  }     {      h   l a m    2   cos (   \u03d5   \u2113     \u03b8   \u2113   0   )  }       {    \u03d5   \u2113 , 1     X   2 \u2113   +  (    d   l a m   +     h   l a m    2    \u03be   2   ) cos (   \u03d5   k     \u03b8   k   0   ) (   \u03d5   z , 1     \u03b8   z   0    )   }     {      h   l a m    2   sin (   \u03d5   \u2113     \u03b8   \u2113   0   )  }      ]       (13)    A   i j   1   =   \u2202   f   1 i     \u2202   \u03be   j     =   f   1 i , j   =  [      {    \u03d5   \u2113 , 1     Y   1 \u2113   \u2212  (    d   l a m   +     h   l a m    2    \u03be   2    )  sin (   \u03d5   k     \u03b8   k   ) (   \u03d5   z , 1     \u03b8   z   )  }     {      h   l a m    2   cos (   \u03d5   \u2113     \u03b8   \u2113   )  }       {    \u03d5   \u2113 , 1     Y   2 \u2113   +  (    d   l a m   +     h   l a m    2    \u03be   2    )  cos (   \u03d5   k     \u03b8   k   ) (   \u03d5   z , 1     \u03b8   z   )  }     {      h   l a m    2   sin (   \u03d5   \u2113     \u03b8   \u2113   )  }      ]       The objective Green\u2013Lagrange strain measure E is chosen to develop the geometrically exact FE, that is  (14)  E =  1 2  ( C \u2212 I ) =  1 2  (   A  t  \u22c5 A \u2212 I )  or    E   i j   =  1 2  (   A   k i     A   k j   \u2212   \u03b4   i j   )   where I is the second order identity tensor and C is the right Cauchy stretch.  In this section, the elastic Saint-Venant-Kirchhoff constitutive relation is adopted to relate the second Piola\u2013Kirchhoff stress S and the Green strain E for frame elements. Moreover, semi-rigid linear elastic connections are introduced to make a preliminary development of the complete nonlinear solution technique, including plasticity, to be shown in the next section.  In order to unify the notation, the degree of freedom   \u03b8   \u2113   will be called   Y   3 \u2113   . Each element node has three degrees of freedom but when connecting elements by means of semi-rigid connections (global numbering) an extremity node may have more than three degrees of freedom, as the rotations of the connected elements are not the same. Fig. 5 shows three cases to illustrate the linking by means of free connections (joints).  Following Fig. 5 one observes that a master element defines the first rotation degree of freedom (the third of the node) and each slave element introduces an extra degree of freedom for the connection node. Fig. 6 shows the introduction of elastic connections in the arrangement of Fig. 5.  In general, the strain energy stored in a semi-rigid connection with stiffness modulus   k   ( \u03b7 \u03b1 \u03b2 )   is given by  (15)    U   \u03b7   S R   =     k   ( )    2    (   \u03b8   \u03b1   \u03b7   \u2212   \u03b8   \u03b2   \u03b7   )  2  =     k   ( \u03b7 \u03b1 \u03b2 )    2    (   Y   3 \u03b1   \u03b7   \u2212   Y   3 \u03b2   \u03b7   )  2       in which \u03b7 is the node where the connection is considered, \u03b1 is the first connected element (master) and \u03b2 is the other connected element. No summation is implied.  As mentioned before the Saint-Venant-Kirchhoff specific strain energy is adopted here to relate the Green strain (E) and the second Piola\u2013Kirchhoff stress (S) as  (16)    u   e   =  E 2  (   E   11   2   +   E   22   2   ) + G (   E   12   2   +   E   21   2   )  or    u   e   =  1 2  E : \u212d : E   in which G = E /  [  2 ( 1 + \u03bd )  ]  is the shear elastic modulus, \u03bd is the Poisson ratio and   E   i j   are the Green strain tensor in Einstein notation. Alternatively, in dyadic notation, E is the Green strain tensor and \u212d is the elastic constitutive tensor. Expression (16) avoids Poisson locking by annihilating the transverse material expansion or contraction.  As the Green strain has been written as a function of nodal positions, see Eqs. (11) (through 14), the strain energy stored in structure elements is written as  (17)    U   e   (  Y \u2192  ) =  \u222b    V   0        u   e   (  Y \u2192  ) d   V   0      in which   V   0   is the initial volume of the analyzed structure [47,50].  In order to write the total potential energy of the mechanical system \u03a0 (  Y \u2192  ) (conservative and isothermal) one sums the strain energy of frame elements, the strain energy of semi-rigid connections, the potential energy of external loads (and moments), the potential energy of external distributed forces and the kinetic energy, resulting in  (18)  \u03a0 (  Y \u2192  ) =  \u222b    V   0        u   e   (  Y \u2192  ) d   V   0    +   U   e   S R   \u2212  F \u2192  \u22c5  Y \u2192  \u2212  \u222b    S   0       q \u2192  \u22c5    y \u2192   m   d   S   0    +  1 2   \u222b    V   0        \u03c1   0      y \u2192  \u0307  \u22c5   y \u2192  \u0307   d   V   0      where  F \u2192  is the external nodal force vector (including moments),  q \u2192  is the general distributed force vector written as function of nodal values (   q   i   =   \u03d5   \u2113   ( \u03be )   Q   \u2113 i   ) ,   \u03c1   0   is the mass density related to the initial configuration,   y \u2192  \u0307  is the velocity of a general point inside the domain,    y \u2192   m  is the current position at the reference line of frame elements (see Eqs. (8) and (9)) and d   S   0   is the infinitesimal length of the curved frame element.  In order to find the equilibrium configuration one applies the principle of stationary potential energy on Eq. (18), using as parameters the nodal positions:  (19)  \u03b4 \u03a0 =  \u222b    V   0        \u2202   u   e     \u2202 E   :   \u2202 E   \u2202  Y \u2192    \u22c5 \u03b4  Y \u2192   d   V   0    +   \u2202   U   e   S R     \u2202  Y \u2192    \u22c5 \u03b4  Y \u2192  \u2212  F \u2192  \u22c5 \u03b4  Y \u2192  \u2212  \u222b    S   0       q \u2192  \u22c5   \u2202    y \u2192   m    \u2202  Y \u2192    \u22c5 \u03b4  Y \u2192    d   S   0   +  \u222b    V   0        \u03c1   0     y \u2192  \u00a8  \u22c5 ( \u03d5 \u22c5 \u03b4  Y \u2192  ) d   V   0    =  0 \u2192    in which   y \u2192  \u0307   \u03b4 t = \u03b4  y \u2192  has been used.  By the energy conjugate principle [53], the first term of the first integral of Eq. (19) is the second Piola\u2013Kirchhoff stress and the derivative of the strain energy stored in elastic connections is the internal moment    M \u2192    int   . Therefore, in order to simplify the understanding of the physical nonlinear procedure shown in the next section, one rewrites Eq. (19) as  (20)  \u03b4 \u03a0 =  \u222b    V   0      S :   \u2202 E   \u2202  Y \u2192    d   V   0   \u22c5 \u03b4  Y \u2192  +    M \u2192    int   \u22c5 \u03b4  Y \u2192  \u2212  F \u2192  \u22c5 \u03b4  Y \u2192   \u2212  \u222b    S   0       q \u2192  \u22c5 \u03d5 d   S   0   \u22c5 \u03b4  Y \u2192   +  \u222b    V   0        \u03c1   0     Y \u2192  \u00a8  \u22c5  \u03d5 \u2192  \u2297  \u03d5 \u2192  d   V   0   \u22c5 \u03b4  Y \u2192   =  0 \u2192    To obtain Eq. (20) the property \u2202    y \u2192   m  / \u2202  Y \u2192  =  \u03d5 \u2192  and the nodal characteristic of \u03b4  Y \u2192  have been used. Moreover, the same approximation adopted to position is used for acceleration.  The understanding of Eq. (20) can be further improved as  (21)  \u03b4 \u03a0 =    F \u2192    int   \u22c5 \u03b4  Y \u2192  +    M \u2192    int   \u22c5 \u03b4  Y \u2192  \u2212  F \u2192  \u22c5 \u03b4  Y \u2192  \u2212 L \u22c5  Q \u2192  \u22c5 \u03b4  Y \u2192  + M \u22c5   Y \u2192  \u00a8  \u22c5 \u03b4  Y \u2192  + D \u22c5   Y \u2192  \u0307  \u22c5 \u03b4  Y \u2192  =  0 \u2192    in which L is the matrix that transforms the distributed forces into nodal equivalent ones, M is the constant mass matrix and D is the mass proportional damping [52,54,55]. Due to the arbitrariness of \u03b4  Y \u2192  Eq. (21) represents the geometrical nonlinear dynamic equilibrium equation, i.e.  (22)     F \u2192    int   +    M \u2192    int   \u2212  F \u2192  \u2212 L \u22c5  Q \u2192  + M \u22c5   Y \u2192  \u00a8  + D \u22c5   Y \u2192  \u0307  =  0 \u2192       It is important to note that this work deals with relatively slender bars whose cross section rotational inertia is neglected; see [47] for more information regarding this subject.  To close this item we show the pair of internal moments, for an elastic semi-rigid connection, associated to a global node \u03b7 related to the initial (or final) point of a frame element \u03b1 and to the final (or initial) point of a frame element \u03b2 , as  (23)    F   3 \u03b1   \u03b7   =   M   \u03b1   \u03b7   =   k   ( \u03b7 \u03b1 \u03b2 )   (   Y   3 \u03b1   \u03b7   \u2212   Y   3 \u03b2   \u03b7   )  a n d    F   3 \u03b2   \u03b7   =   M   \u03b2   \u03b7   = \u2212   k   ( \u03b7 \u03b1 \u03b2 )   (   Y   3 \u03b1   \u03b7   \u2212   Y   3 \u03b2   \u03b7   )      In Appendix A one finds explicit expressions to calculate \u2202 E / \u2202  Y \u2192  present in Eq. (20). In Section 4 the nonlinear dynamic equilibrium is extended to include plasticity. In Section 5 the Newmark time integration and the Newton\u2013Raphson procedure are combined to solve the resulting nonlinear dynamic system of equations.  The previous section is used to introduce the geometrical nonlinearity concept into the total Lagrangian dynamic formulation based on positions. This section takes advantage of the previous equations to introduce elastoplasticity into the nonlinear dynamic problem and briefly presents the multi-linear elastoplastic evolution model, adopted for both frame end semi-rigid connections.  The difference between the elastic and inelastic procedures is the way the potential energy of external forces is transferred to the deformed body and dissipated during the dynamic process. In this case, instead of using the elastic strain energy, for both the frame element and connections, one adopts the Helmholtz free energy potential [54].  Following this reasoning the total potential energy for isothermal problems is written as  (24)  \u03a0 (  Y \u2192  ) =  \u222b    V   0      \u03a8 ( E , \u03b1 ) d   V   0    +   \u0398   S R   ( (   Y   3 \u03b1   \u03b7   \u2212   Y   3 \u03b2   \u03b7   ) ,  \u03b1 \u00af  ) \u2212  F \u2192  \u22c5  Y \u2192  \u2212  \u222b    S   0       q \u2192  \u22c5    y \u2192   m  (  Y \u2192  ) d   S   0    +  1 2   \u222b    V   0        \u03c1   0     y \u2192  \u0307  \u22c5   y \u2192  \u0307  d   V   0      where \u03a8 and   \u0398   S R   are, respectively, the frame elements and the connections free energy potentials. These potentials are written as a function of the Green strain tensor, the relative angle positions at connections and the thermodynamic parameters \u03b1 and  \u03b1 \u00af  .  The variation of the total potential energy is zero at the equilibrium position, i.e.  (25)  \u03b4 \u03a0 =  \u222b    V   0        \u2202 \u03a8   \u2202 E   :   \u2202 E   \u2202  Y \u2192    d   V   0   \u22c5 \u03b4  Y \u2192  +   \u2202   \u0398   S R     \u2202  Y \u2192    \u22c5 \u03b4  Y \u2192  \u2212  F \u2192  \u22c5 \u03b4  Y \u2192   \u2212  \u222b    S   0       q \u2192  \u22c5 \u03d5 d   S   0   \u22c5 \u03b4  Y \u2192   +  \u222b    V   0        \u03c1   0     Y \u2192  \u00a8  \u22c5  \u03d5 \u2192  \u2297  \u03d5 \u2192  d   V   0   \u22c5 \u03b4  Y \u2192   =  0 \u2192    in which parameters \u03b1 and  \u03b1 \u00af  are not present due to their intrinsic relation with E and S and with the relative rotation and    M \u2192    int   to be shown in Section 4.2.  Even for inelastic problems, the derivative of the free energy potential with reference to Green strain is the second Piola\u2013Kirchhoff stress tensor. For the same reason, the energy conjugate of the free energy at elastoplastic connections with repect to relative angles are internal moments. In this way Eq. (25) can be written exactly as Eq. (21) or (22). However, with a physical nonlinear meaning; i.e., while the passage from Eq. (19) to Eq. (20) is done by a simple differentiation of the quadratic potential shown by Eq. (16), now it is necessary to define an inelastic (plastic for instance) relation to describe the material behavior and its evolution rule.  In this item, we summarize the constitutive elastoplastic relation developed by [48] and [56]. We follow a general 3D description in order to adequate the constitutive relation to any finite element kinematic, avoiding volumetric locking. A brief description of the main equations is given for both frame and connections.  Although the developed displacements are high, the strain level present in our applications is relatively small. Therefore, the Green strain approximates the linear strain and the second Piola\u2013Kirchhoff stress can be used in place of the Cauchy stress. Following this reasoning we adopt the additive strain decomposition as  (26)  E =   E  e  +   E  p   or    E  e  = E \u2212   E  p    in which   E  e  and   E  p  are, respectively, the elastic and plastic parts of E . Therefore, the free energy potential can be written as  (27)  \u03a8 ( E \u2212   E  p  , \u03b1 ) =  1 2    E  e  : \u212d :   E  e  +  1 2  h   \u03b1  2    where \u212d is the elastic constitutive tensor and h is the isotropic hardening parameter.  The second Piola\u2013Kirchhoff stress and the thermodynamic force \u03c7 are written as  (28)  S =   \u2202 \u03a8   \u2202 E   = \u212d :   E  e  = \u212d : ( E \u2212   E  p  )      (29)  \u03c7 = \u2212   \u2202 \u03a8   \u2202 \u03b1   = \u2212 h  \u03b1   As mentioned after Eq. (25), in order to eliminate \u03b1 from equilibrium equation it is necessary to relate   E  p  and \u03b1 . In classical formulations this is done introducing a plastic potential F  (  S , \u03c7  )   [57] for which the plastic flow is given by  (30)     E \u0307   p  =  \u03bb \u0307    \u2202 F   \u2202 S    and   \u03b1 \u0307  =  \u03bb \u0307    \u2202 F   \u2202 \u03c7     or in infinitesimal notation  (31)  d   E  p  = d \u03bb   \u2202 F   \u2202 S    and  d \u03b1 = d \u03bb   \u2202 F   \u2202 \u03c7     where \u03bb is the plastic multiplier. In the adopted formulation [48,56] Eqs. (29) and (31) are replaced by \u03b1 = \u2212 \u03bb and  (32)  d   E  p  = \u03b7 d \u03bb  and  d \u03c7 = h d \u03bb   for which  (33)  \u03b7 =   D  p  : S =  G      J   2        (    S \u00af   2 G   +   t r ( S )   9   k  p    I  )   and    D  p  =  G      J   2         (   \u212d  p  )   \u2212 1     In Eq. (33)    J   2   = 1 / 2  [   S \u00af  :    S \u00af   t   ]  is the second invariant of the deviatory stress  S \u00af  and   \u212d  p  is an elastic constitutive tensor, similar to \u212d changing the \u03bd by   \u03bd  p  . Moreover   k  p  = E /  [  3  (  1 \u2212 2   \u03bd  p   )   ]  is the elastoplastic bulk modulus. Following this strategy, when   \u03bd  p  \u2245 0.5 isochoric plasticity takes place and when \u03bd =   \u03bd  p  the plastic flow occurs in the same direction of elastic flow. In this work we adopt   \u212d  p  = \u212d , defined by the second derivative of expression (16) with reference to strain. This choice releases any possible locking related to Reissner kinematic.  To complete the elastoplasticity procedure one defines the yielding failure expression as  (34)  f =     J   2     \u2212 \u03c7 \u2212   S   y     in which   S   y   =   \u03c3   y   /  3  is the initial size of the Von-Mises surface (f=0) with   \u03c3   y   being the yielding uniaxial stress.  It is important to know that the plastic multiplier should satisfy the Khun\u2013Tucker conditions, related to the yielding surface (34), i.e.  (35)  d \u03bb \u2265 0 ,  f \u2264 0 ,  d \u03bb  f = 0   which means that if f \u2264 0 then d \u03bb = 0 and no plastic evolution occurs and if, for some situation, one finds f > 0 then d \u03bb > 0 should be achieved in order to guarantee the equality f = 0 .  In terms of incremental solution we assume isotropic hardening (h), constant by parts, and a typical interval [    t   n   ,   t   n + 1    ] for which n is a previous (solved) step and n + 1 is the current step. Therefore, one writes        E  ( n + 1 )     t      \u2192 elastic  trial  of  the  total  strain        E  ( n + 1 )   p    t  =   E   n   p       \u2192 accumulated  plastic  strain  ( assumed  as  trial )        \u03bb  ( n + 1 )     t  =   \u03bb   n       \u2192 trial  internal  variable        \u03c7  ( n + 1 )     t  =   \u03c7   n       \u2192 trial  thermodynamic  internal  force       Using these variables we calculate the stress level considering \u0394   E  p  ( instead  of  d   E  p  ) as the main unknown, as follows:  (36)    S   ( n + 1 )   = \u212d : (  E  ( n + 1 )     t  \u2212  E  n   p    t  \u2212 \u0394   E  p  ) =  S  ( n + 1 )     t  \u2212 \u212d : \u0394   E  p    where the trial stress  S  ( n + 1 )     t  is known. Using this value we calculate the trial yielding expression  (37)   f  ( n + 1 )     t  =    J 2    t    \u2212  \u03c7     t  \u2212   S   y     If  f  (  n + 1  )     t  \u2264 0 the step is elastic and the trial variables are the correct ones. However, if  f  (  n + 1  )     t  > 0 then the step is elastoplastic and   f   (  n + 1  )   should be zero, resulting in  (38)  \u0394 \u03bb =  f  ( n + 1 )     t  / ( G + H )   Finally, the correct stress tensor to be introduced in Eq. (25) results by substituting (38) into (32) and using (32) and (36), i.e.  (39)    \u2202 \u03a8   \u2202 E   = S =  S     t  \u2212    f  ( n + 1 )     t    ( G + H )   \u212d :  (      S \u00af   ( n + 1 )     t    2    J  2 ( n + 1 )     t      +   G  t r  (   S     t   )    9   k  P     J  2 ( n + 1 )     t      I  )    Moreover, the constitutive elastoplasticity tensor is written as [56]   (40)    \u212d   e p   =   \u2202 S   \u2202 E   =     \u2202  2  \u03a8   \u2202 E \u2202 E   = \u212d -  (    E : \u03b7 \u2297   S \u00af      t  : \u212d     S \u00af      t  : \u212d : \u03b7 + 2     J   2     H    )  = \u212d \u2212   \u212d  p       In this item the previous general elastoplastic procedure (multi-linear) is simplified to accomplish the semi-rigid connection. Firstly, the notation of Eqs. (15) and (23) is changed to  (41)    R   3 \u03b1 \u03b2   \u03b7   = (   Y   3 \u03b1   \u03b7   \u2212   Y   3 \u03b2   \u03b7   )   in which   R   3 \u03b1 \u03b2   \u03b7   is the relative rotation between frame bars \u03b1 and \u03b2 at a connection node \u03b7 . From now on, to simplify the developments, this relative rotation will be called simply R . This variable is clearly one-dimensional and is separated into elastic and plastic parts, as  (42)  R =   R  e  +   R  p   o r    R  e  = R \u2212   R  p    The free Helmholtz energy potential, implicit in Eq. (24), is written as  (43)    \u0398   S R   ( R \u2212   R  p  ,  \u03b1 \u00af  ) =  1 2  k   (   R  e  )  2  +  1 2  h    \u03b1 \u00af   2    where k is the elastic stiffness of the connection and h its isotropic hardening. Following the previous item one writes the internal moment and the thermodynamic force related to the internal variable  \u03b1 \u00af  as  (44)  M =   \u2202   \u0398   S R     \u2202 R   = k   R  e  = k ( R \u2212   R  p  )      (45)  \u03c7 = \u2212   \u2202 \u03b8   \u2202  \u03b1 \u00af    = \u2212 h  \u03b1 \u00af       In the case of semi-rigid connections, the elastic limiting moment   M   y   > 0 is used to write the failure expression as  (46)  f = | M | \u2212   M   y   \u2212 \u03c7 \u2264 0  a n d  f = | M | \u2212   M   y   + h  \u03b1 \u00af  \u2264 0   Following the steps described in the previous item, one achieves  (47)  \u0394   R  p  = s i g n ( M ) .    f     t    k + h     in which s i g n represents signal. Moreover the tangent modulus is obtained as  (48)    k   t   =     \u2202  2    \u0398   S R     \u2202   R  2    =   k . h   k + h        In this section we combine the Newmark time integration and the Newton\u2013Raphson algorithm to solve the nonlinear dynamic equilibrium described by Eqs. (25) or (22), rewritten here joining the external conservative loads into one single vector  F \u2192  :  (49)   g \u2192  =    F \u2192    int   +    M \u2192    int   \u2212  F \u2192  + M \u22c5   Y \u2192  \u00a8  + D \u22c5   Y \u2192  \u0307  =  0 \u2192    in which  g \u2192  is a vector that is null if  Y \u2192  is the right position trial used to calculate internal forces    F \u2192    int   and    M \u2192    int   , if not it turns into the unbalanced mechanical force. Expression (49) represents the dynamic equilibrium equation at any time and has to be solved. In order to do so the first step is to write this equilibrium for a specific instant   t   s + 1   , as follows:  (50)   g \u2192    |   S + 1   =      \u2202 \u03a0   \u2202  Y \u2192     |   S + 1   =      \u2202 \u03a8   \u2202  Y \u2192     |   S + 1   +      \u2202   \u0398   S R     \u2202  Y \u2192     |   S + 1   \u2212    F \u2192    S + 1   + M \u22c5     Y \u2192  \u00a8    S + 1   + D \u22c5     Y \u2192  \u0307    S + 1   =  0 \u2192    in which internal forces are assumed as the derivatives of Helmholtz free energy potentials regarding positions. Substituting the Newmark approximations [52,55] into Eq. (50) gives  (51)   g \u2192    |   S + 1   =      \u2202 \u03a0   \u2202  Y \u2192     |   S + 1   =      \u2202 \u03a8   \u2202  Y \u2192     |   S + 1   +      \u2202   \u0398   S R     \u2202  Y \u2192     |   S + 1   \u2212    F \u2192    S + 1   +  M  \u03b2 \u0394   t  2    \u22c5    Y \u2192    S + 1   \u2212 M \u22c5    T \u2192    S   + D \u22c5    R \u2192    S   +   \u03b3 D   \u03b2 \u0394 t   \u22c5    Y \u2192    S + 1   \u2212 \u03b3 \u0394 t D \u22c5    T \u2192    S   = 0   where vectors    T \u2192    s   and    R \u2192    s   represent the dynamic contribution of the past as  (52)     T \u2192    S   =      Y \u2192    S     \u03b2 \u0394   t  2    +       Y \u2192  \u0307    S     \u03b2 \u0394 t   +  (   1  2 \u03b2   \u2212 1  )      Y \u2192  \u00a8    S    a n d     R \u2192    S   =     Y \u2192  \u0307    S   + \u0394 t ( 1 \u2212 \u03b3 ) _     Y \u2192  \u00a8    S     and \u03b2 and \u03b3 are the usual Newmark parameters [11].  Eq. (51) can be understood simply by  g \u2192  (    Y \u2192    S + 1   ) = 0 and is clearly nonlinear in    Y \u2192    S + 1   . A Taylor expansion to solve this nonlinear equation is developed. The second derivative of the total energy potential is then given by  (53)         \u2202  2  \u03a0   \u2202  Y \u2192  \u2202  Y \u2192     |   S + 1   = H = \u2207  g \u2192  =        \u2202  2  \u03a8   \u2202  Y \u2192  \u2202  Y \u2192     |   S + 1   +        \u2202  2  \u0398   \u2202  Y \u2192  \u2202  Y \u2192     |   S + 1   +  M  \u03b2 \u0394   t  2    +   \u03b3 D   \u03b2 \u0394 t     and the first order expansion results  (54)   0 \u2192  =  g \u2192  (    Y \u2192    s + 1   ) \u2245 g (    Y \u2192    s + 1   0   ) + \u2207 g (    Y \u2192    s + 1   0   ) \u22c5 \u0394    Y \u2192    s + 1     From Eq. (54) the Newton\u2013Raphson procedure to solve the nonlinear equation (51) gives  (55)  H \u22c5 \u0394    Y \u2192    s + 1   = \u2212  g \u2192  (    Y \u2192    s + 1   0   )  a n d  \u0394    Y \u2192    s + 1   = \u2212   H   - 1   \u22c5  g \u2192  (    Y \u2192    s + 1   0   )   where    Y \u2192    s + 1   0   is a trial position (usually    Y \u2192    s   as the first choice) for   Y   s + 1   used in Eq. (51) to calculate  g \u2192  (    Y \u2192    s + 1   0   ) . Solving \u0394    Y \u2192    s + 1   one calculates a new trial for    Y \u2192    s + 1   as  (56)     Y \u2192    S + 1   =    Y \u2192    s + 1   0   + \u0394    Y \u2192    s + 1     Acceleration and velocity are corrected, for each iteration, by,  (57)      Y \u00a8  \u2192    S + 1   =      Y \u2192    S + 1     \u03b2 \u0394   t  2    \u2212    T \u2192    S    a n d      Y \u2192  \u0307    S + 1   =     Y \u2192  \u0307    S   + \u0394 t ( 1 \u2212 \u03b3 )     Y \u2192  \u00a8    S   + \u03b3 \u0394 t     Y \u2192  \u00a8    S + 1     The stop criterion when a chosen tolerance (TOL) is satisfied, is  (58)  | |  g \u2192  (    Y \u2192    s + 1   ) | | \u2264 T O L  o r  | | \u0394    Y \u2192    s + 1   | | \u2264 T O L      In order to conclude the description of the formulation the second derivatives of the Helmholtz free energy potentials of frame elements and semi-rigid connections regarding positions are presented. From Eqs. (25), (40), (48) and (53) one writes  (59)      \u2202  2  \u03a8   \u2202  Y \u2192  \u2202  Y \u2192    =   \u2202 E   \u2202  Y \u2192    :     \u2202  2  \u03a8   \u2202 E \u2202 E   :   \u2202 E   \u2202  Y \u2192    +   \u2202 \u03a8   \u2202 E   :     \u2202  2  E   \u2202  Y \u2192  \u2202  Y \u2192    =   \u2202 E   \u2202  Y \u2192    :   \u212d   e p   :   \u2202 E   \u2202  Y \u2192    + S :     \u2202  2  E   \u2202  Y \u2192  \u2202  Y \u2192         (60)      \u2202  2    \u0398   S R     \u2202  Y \u2192  \u2202  Y \u2192    =     \u2202  2    \u0398   S R     \u2202 R \u2202 R   =   k   t     The necessary expressions to calculate the last term of Eq. (59) is presented in Appendix B.  Various examples have been selected to test the formulation regarding all its features; they are nonlinear dynamics, large rotation, elastoplastic connections, elastoplastic behavior of materials and all aspects working together.  The first numerical example is used to show the ability of the proposed formulation to deal with nonlinear dynamics and large rotations, it is a benchmark of nonlinear dynamic formulations presented in several references [2,4,58,59]. The spin-up-maneuver is subject to a turn function (\u03c8(t)), applied on the restricted node, see Fig. 7. The adopted parameters for the beam are EI=1.4\u00d7104, EA=2.8\u00d7107, \u03c1I=6.0\u00d710\u22124, \u03c1A=1.2 for a slender bar. The adopted time step to run the problem is \u0394 t = 0.0015 . This type of turn function represents a typical helicopter blade rotation. The structure is approximated by a mesh of 10 cubic Reissner kinematic finite elements.  The expressions of the turn function are as follows:   \u03c8 ( t ) =  2 5   [      t  2   2  +   (    15   2 \u03c0    )  2   (  cos    2 \u03c0   15   t \u2212 1  )   ]   rad ,  0 \u2264 t \u2264 15       \u03c8 ( t ) = ( 6 t \u2212 45 )  rad ,  t > 15      All results compare very well with the ones presented by all references. Fig. 8 shows the difference between the free cross section angle (at the blade free extremity) and the imposed rotation angle. Reference [4] results are used for comparison.  In Fig. 9 some selected positions are compared with the rigid bar and the solution achieved by [4] using an Euler\u2013Bernoulli kinematics.  In Fig. 10 the difference between the distance of the extreme free cross section from the pin and the original length of the bar is depicted against time. There is an apparent reduction of the length of the bar due to the bending that occurs at the beginning of the movement. As expected, the achieved final stretching presents a slight oscillation around the technical solution \u03c1   \u03c9  2    \u2113  3  / ( 3 E ) .  This example is used to confirm the computational implementation of the elastoplastic connection and to demonstrate the geometrically exact description of the proposed total Lagrangian frame formulation. A clamped bar is divided into two equal elastic parts linked by an elastoplastic connection, as seen in Fig. 11.  The cross section and the elastic properties of the bar are also depicted in Fig. 11. Two finite elements of cubic approximation order have been used and the load is divided into 30 steps. Fig. 12a shows the moment versus rotation graphic comparing the achieved numerical result with the analytical curve for a monotonically crescent load. The initial elastic modulus of the connection is k = 12  kN  cm with elastic limit   M   y   = 3  kN  cm . Fig. 12b shows the connection behavior when subjected to a cyclic loading.  As one can see in Fig. 12 the multi-linear strategy is capable of accurately reproducing any elastoplastic curve.    Fig. 13 shows partial positions for 15 equally spaced loading levels, demonstrating that the nonlinear geometric description is exact. This level of rotation is not accomplished by formulations that adopt second order geometrical descriptions.  In order to show the behavior of the implemented elastoplasticity, a simply supported beam, subjected to a monotonically crescent controlled displacement at load positions, see Fig. 14, is analyzed. The cross section is also presented in Fig. 14, for which three laminas and five Gauss integrations points for each lamina are employed to perform the Gauss integration procedure. Two different materials are employed for comparisons, one is perfect elastoplastic and the other presents softening, see Fig. 15a.   Fig. 15b shows the beam behavior for both materials. Results are compared to the elastic limit load and the ultimate load for perfect elastoplasticity. Position control is sufficient to model the post-critical behavior of this example. Three cubic elements (without considering symmetry) are used to model this case.    Fig. 16 shows the evolution of bending moments for different load levels. One can observe that for the perfect elastoplastic case a degradation spreads over the beam; moreover the load stabilizes after the displacement of 7cm. After the imposed displacement of 2.2cm a reduction in the load level occurs for the softening case and, consequently, in the bending moment. Moreover, no bending moment spreads along the beam.  This example tests the formulation regarding the coupling of plasticity and geometrical nonlinearity. It is the simulation of an eccentric compression of a column, depicted in Fig. 17a. The material properties are E = 21 , 000  kN/cm2, \u03bd = 0.0 and   \u03c3   y   = 21  kN/cm2 with perfect elastoplasticity. Fig. 17b compares the results obtained using the proposed formulation with the elastic closed second order analytical solution (secant formulae). We adopt six cubic finite elements to run this example: four along the column and two for the small consoles at extremities. Position control is employed and, to impose symmetry, the rotation of the central node is restricted.  This example confirms that the elastic second order theory gives a more flexible result than the elastic geometrically exact one. The plastic flow starts at the load level of 13  kN, 16 % less than the column critical load ( 15.545  kN). The elastic release starts at the load level 3.773  kN and the residual displacement, at the new unloaded situation, is about 30  cm .  In this example the frames depicted in Fig. 18 are analyzed considering elastoplastic connections. The original data of this problem are given by [60,36]. In these works the connection model handles nonlinear elasticity and bars follow second order approximation. Moreover the kinematics does not include shear effects. To simplify comparisons, we adopt elastic bars with E = 21 , 000  kN/cm2 and \u03bd = 0.0 .  The adopted multi-linear connection diagrams, shown in Fig. 19, are extracted from [60]. The adopted elastic limits of the connections for the four tested cases are   M   y   A   = 750  kNcm,   M   y   B   = 1625  kNcm,   M   y   C   = 5000  kNcm and   M   y   D   = 20 , 480  kNcm with their corresponding rotations   \u03b8   y   A   = 1.67 \u00d7   10   \u2212 3    rad,   \u03b8   y   B   = 1.67 \u00d7   10   \u2212 3    rad,   \u03b8   y   C   = 5.00 \u00d7   10   \u2212 3    rad and   \u03b8   y   D   = 6.67 \u00d7   10   \u2212 3    rad. More data information can be seen in [60].  Beams are constituted of steel wide flange shaped section W 14 \u00d7 48 while columns are constituted of W 12 \u00d7 96 section. It is interesting to note that bars behave elastically because the ultimate limit of the strongest connection (case D) is practically equal to the elastic limit of beams, and loads are applied at connections.  The load P (Fig. 18) grows monotonically until the critical load shows up.  Figs. 20 and 21 show that the results presented by our formulation agree with the ones given by references. For semi-rigid connections the differences in results are less than 2% for all cases. For rigid connection the difference is about 6%, explained by the difference among the exact geometrical description and second order approximations.  For connections A and B the displacement levels are very small and failure occurs in an abrupt way. In order to show up the horizontal plateau (for A and B), Figs. 20 and 21, we used lateral loads of 0.0015 P and 0.003 P instead of 0.001 P and 0.002 P . However, this procedure does not change the critical load value.  This example demonstrates the capability of the proposed formulation to model the behavior of structures to real seismic loading. The real event chosen is the Superstation Hill in 1987. The original unscaled time series record has been extracted from [61]. Both vertical (UP) and horizontal (360) accelerations are transformed into displacements (cm) and applied as base movements in the time domain analysis. The structure is a 25 storeys building, Fig. 22, modeled with (a) free connections (articulated joints), (b) rigid connections, (c) semi-rigid connections, (d) semi-rigid connections with bracing and (e) semi-rigid connections with bracing and pendulum.  All beams are made of wide flange W200\u00d746. The columns are divided as follows: (i) from the 1st to the 5th floor W610\u00d7155, (ii) from the 6th to the 10th floor W610\u00d7140, (iii) from the 11th to the 15th W610\u00d7113, (iv) from the 16th to the 20th floor W460\u00d774 and (v) from the 21st to the 25th W200\u00d746. Bracings are 3.606  m long and pose square cross section of 5.83  cm side.  The adopted material is structural steel with simplified properties depicted in Fig. 23. The adopted density of columns is   \u03c1   s t   = 7000  kg/m3. For beams we adopt an equivalent density   \u03c1   e q   = 15 , 333  kg/m3, in order to include the mass influence of a reinforced concrete slab with 10cm of height and 4m of width. The considered vertical load q = 4088  kN/m is uniformly distributed over beams. The frame is considered simple supported and the soil moves horizontally and vertically following the real earthquake data.  The adopted semi-rigid connection moment\u2013rotation diagram is depicted in Fig. 24, in which 70  kNm is the elastic limit of the connection and 120  kNm is the final strength.  The pendulum is modeled by a steel bar connected through a free joint at the top of the structure (point A of Fig. 22) and a steel cylinder also connected to this bar through a free joint. The bar is 1.75  m long and has square cross section of 5.83  cm side. The cylinder is 2.50  m long with a diameter of 1.93  m; the body weight of the cylinder is distributed over its length. The adopted time step is the same as the one given by the earthquake data, i.e., \u0394 t = 0.005  s.  The structure modeled in case (a) suffers a progressive collapse shown in Fig. 25. Fig. 25a presents sequential positions for time from 2.25s through 3s with a displacement scale amplification of 10. Fig. 25b presents sequential positions from time 3s through 4s without amplification.  In Fig. 26 the horizontal displacements at the top of the building for cases \u2018b\u2019 through \u2018e\u2019 are depicted together with the horizontal soil movement; values are presented for 50 time steps. The horizontal displacements are computed subtracting the resting value. This static displacement is different for each case due to the difference of the respective elastic center and the maintenance of the external vertical applied load.  As one can see the proposed formulation is a good tool to model the behavior of structures under seismic loads. Starting with rigid connection one may say that substituting them by semi-rigid elastoplastic connections reduces the general amplitude with time and reduces the overall movement frequency; however the first pick has been increased during the plastic dissipation. The introduction of bracings along the stair case increases the overall frequency and reduces the plastification of connections, but does not reduce the overall amplitude. The best solution for the problem is introducing a contra-balance pendulum; however the columns from floor 21st through 23rd, under the pendulum connection, should be substituted by the same ones used in floors 16th through 20th, in order to resist the extra load. In order to illustrate the pendulum movement, Fig. 27 shows some select positions for case (e); displacements are enlarged 20 times.   CONCLUSIONS   In this study an alternative position based on finite element formulation is presented and successfully implemented. The formulation is originally presented here, providing all steps for its reproduction. It is capable of accurately solving geometrical and physical nonlinear dynamic problems of both machines and structures.  Examples show good behavior of the formulation for various applications, covering progressive collapse of structures under seismic loading. Future works include the implementation of damage mechanics, also allowing the analysis of reinforced concrete structures developing large displacements and under severe dynamic loading.   ACKNOWLEDGMENTS   The authors would like to thank FAPESP (S\u00e3o Paulo Research Foundation) and CNPq (National Council for Scientific and Technological Development \u2013 Brazil) for the financial support of this research (FAPESP: 11/15731-5; CNPq: 306152/2013-4).  From expression (14), reproduces as,  (A1)  E =  1 2  ( C \u2212 I ) =  1 2  (   A  t  \u22c5 A \u2212 I )   one writes  (A2)    \u2202 E   \u2202  Y \u2192    =  1 2    \u2202 C   \u2202  Y \u2192    =  1 2   \u2202  \u2202  Y \u2192    {   A  t  \u22c5 A } =  1 2   \u2202  \u2202  Y \u2192    { [   (   A  0  )   \u2212 t   \u22c5   (   A  1  )  t  ] \u22c5 [ (   A  1  ) \u22c5   (   A  0  )   \u2212 1   ] } =  1 2   {   [    (   A  0  )   \u2212 t   \u22c5   (    \u2202   A  1    \u2202  Y \u2192     )  t   ]  \u22c5 [ (   A  1  ) \u22c5   (   A  0  )   \u2212 1   ] + [   (   A  0  )   \u2212 t   \u22c5   (   A  1  )  t  ] \u22c5  [   (    \u2202   A  1    \u2202  Y \u2192     )  \u22c5   (   A  0  )   \u2212 1    ]   }    In which all terms are known except \u2202   A  1  / \u2202  Y \u2192  , detailed as follows:  (A3)    \u2202   A  1    \u2202   Y   1 \u03d6     =  [        \u03d5   \u03d6 , 1      0     0   0     ]       (A4)    \u2202   A  1    \u2202   Y   2 \u03d6     =  [     0   0        \u03d5   \u03d6 , 1      0     ]       (A5)    \u2202   A  1    \u2202   Y   3 \u03d6     =   \u2202   A  1    \u2202   \u03b8   \u03d6     =  [      {  \u2212  (    d   l a m   +      h   l a m    2     \u03be   2    )  [  cos (   \u03d5   k     \u03b8   k   ) (   \u03d5   z , 1     \u03b8   z   )   \u03d5   \u03d6   +  sin (   \u03d5   k     \u03b8   k   )   \u03d5   \u03d6 , 1   ]  }     {  \u2212      h   l a m    2    sin (   \u03d5   \u2113     \u03b8   \u2113   )   \u03d5   \u03d6    }       {   (    d   l a m   +      h   l a m    2     \u03be   2    )  [  cos (   \u03d5   k     \u03b8   k   )   \u03d5   \u03d6 , 1   \u2212  sin (   \u03d5   k     \u03b8   k   ) (   \u03d5   z , 1     \u03b8   z   )   \u03d5   \u03d6   ]  }     {       h   l a m    2    cos (   \u03d5   \u2113     \u03b8   \u2113   )   \u03d5   \u03d6    }      ]    in which   Y   i \u03d6   is the degree of freedom i of node \u03d6 , component of vector  Y \u2192  .  From expression (A2) one writes:  (B1)      \u2202  2  E   \u2202  Y \u2192  \u2202  Y \u2192    =  1 2   {     2 \u22c5  [    (   A  0  )   \u2212 t   \u22c5   (    \u2202   A  1    \u2202  Y \u2192     )  t   ]  \u22c5  [   (    \u2202   A  1    \u2202  Y \u2192     )  \u22c5   (   A  0  )   \u2212 1    ]  +     +    [    (   A  0  )   \u2212 t   \u22c5   (      \u2202  2    A  1    \u2202  Y \u2192  \u2202  Y \u2192     )  t   ]  \u22c5 [ (   A  1  ) \u22c5   (   A  0  )   \u2212 1   ] + [   (   A  0  )   \u2212 t   \u22c5   (   A  1  )  t  ] \u22c5  [   (      \u2202  2    A  1    \u2202  Y \u2192  \u2202  Y \u2192     )  \u22c5   (   A  0  )   \u2212 1    ]   }         All terms are known except   \u2202  2    A  1  / ( \u2202  Y \u2192  \u2202  Y \u2192  ) . From Eqs. (A3) and (A4) one concludes that all second derivatives regarding translations are null. However, from Eq. (A5) one writes:  (B2)          \u2202  2    A  1    \u2202   Y   3 \u03d6   \u2202   Y   3 \u03bc          =  [      {  \u2212  (    d   l a m   +      h   l a m    2     \u03be   2    )   [     cos (   \u03d5   k     \u03b8   k   )   \u03d5   \u03bc , 1     \u03d5   \u03d6   +  cos (   \u03d5   k     \u03b8   k   )   \u03d5   \u03d6 , 1     \u03d5   \u03bc   +     \u2212  sin (   \u03d5   k     \u03b8   k   ) (   \u03d5   z , 1     \u03b8   z   )   \u03d5   \u03d6     \u03d5   \u03bc       ]   }     {  \u2212      h   l a m    2    cos (   \u03d5   \u2113     \u03b8   \u2113   )   \u03d5   \u03d6     \u03d5   \u03bc    }       {  \u2212  (    d   l a m   +      h   l a m    2     \u03be   2    )   [     sin (   \u03d5   k     \u03b8   k   )   \u03d5   \u03d6 , 1     \u03d5   \u03bc   +  sin (   \u03d5   k     \u03b8   k   )   \u03d5   \u03bc     \u03d5   \u03bc , 1   +     +  cos (   \u03d5   k     \u03b8   k   ) (   \u03d5   z , 1     \u03b8   z   )   \u03d5   \u03d6     \u03d5   m       ]   }     {  \u2212      h   l a m    2    sin (   \u03d5   \u2113     \u03b8   \u2113   )   \u03d5   \u03d6     \u03d5   \u03bc    }      ]           REFERENCES", "highlights": "In this study we apply the total Lagrangian formulation based on positions to develop a strategy for the physical and geometrical nonlinear analysis of plane structures and mechanisms. The developed frame elements have cross sections constituted by laminas of different materials and widths. The Reissner\u2013Mindlin kinematics is adopted to include shear effects into the formulation. These elements are connected among each other by semi-rigid connections. Both elements and connections have multi-linear elastoplastic behavior with isotropic hardening. An alternative flow direction rule, which allows the reproduction of any stress\u2013strain curve and the determination of closed solution for the plastic multiplier, is shown. All steps to reproduce the formulation are provided. Various examples are used to demonstrate the good behavior of the formulation, including a progressive collapse analysis of a tall building subjected to a real seismic load."}