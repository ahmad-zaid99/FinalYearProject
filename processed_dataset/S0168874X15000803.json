{"id": "S0168874X15000803", "article": "MAIN-TITLE Semi-implicit finite strain constitutive integration of porous plasticity models   HIGHLIGHTS          The combination of relative Green-Lagrange strains with the exact corotational method.      The use of L\u00a8owdin algorithm based on the Jacobians of configurations \u03a9 b and \u03a9 a.      Replacement of the complementarity condition by the Chen-Mangasarian function.      GTN and Rousselier constitutive models, with the determination of intersections with axes of pressure-shear diagram (p \u2212 q).      The use of MINI element in triangles and tetrahedra to avoid locking due to quasi-incompressibility.          KEYPHRASES   Constitutive integration  Porous plasticity  Finite strains  Semi-implicit  L\u00f6wdin\u05f3s method   For common metals at room temperature, void nucleation and particle debonding, void growth and coalescence are the mechanisms for crack growth from the process region [10]. Detailed multiple-scale analysis of these mechanisms require robust polycrystalline plasticity and representation of dislocation dynamics and grain boundary barriers (Roters et al. [30] present a comprehensive review). Therefore, the so-called phenomenological models (e.g. [18]) are considered a cost-effective tool for predicting damage and fracture in metals when overall quantities, like maximum load and dissipated energy, are of interest. The now well-established GTN model is based on the original yield surface by Gurson [16] and was subsequently modified by Tvergaard and Needleman [34,35]. The void growth part of the GTN model is based on the micromechanics of the ductile process. Phenomenological models formulated based on thermodynamical principles have also been proposed such as the Lemaitre model [18] and its subsequent modifications. Among this class of constitutive models, the Rousselier model [31,4] is interesting from a computational perspective as it is simpler and requires the specification of fewer parameters than the GTN model, while possessing the ability to closely match the predictions of the latter by determination of its parameters. It adheres to the idea that the occurrence of localization, crack initiation and propagation emerges as a direct consequence of strain softening due to void growth. Hence, unlike micro-mechanics models of porous metal plasticity, the Rousselier model does not directly model the mechanism of coalescence. However, two properties are worth mentioning:  1. The Rousselier model predicts void fraction growth in pure shear.  The Rousselier yield surface has an isochoric vertex causing a non-zero plastic volumetric term component.  The GTN model uses the same coalescence approach as the classical Tvergaard\u2013Needleman technique (cf. [35]).  Both void fraction and damage variables are integrated in closed-form using the Lambert W and the ERF functions.  Due to their complementarity form (see, e.g. [20]), finite strain plasticity problems often exhibit convergence difficulties for large strain values and severe sensitivity to step size [3]. We have two measures to attenuate these difficulties: the use of a smoothed complementarity condition and the removal of iterative rotation matrices from the constitutive laws in finite strains.  It is computationally convenient that both hyperelastic and finite-strain elasto-plastic laws are implemented in a unique algorithm and applicable to any discretization scheme.  Classical assumed-strain elements typically do not directly provide the deformation gradient (e.g. [9]), necessary for many constitutive formulations. An estimated deformation gradient can be calculated from the polar decomposition if an approximate rotation matrix is available. Since a constitutive frame is adopted, the rotation matrix is obtained from this frame in two distinct configurations. Compatible frames use L\u00f6wdin\u05f3s method [19].  Since the seminal contributions of Weber and Anand [36] and Simo [32], Kirchhoff stress tensors (i.e. \u03c4 = J \u03c3 ) are frequently employed in the yield functions. This is a computational convenience, as commonly adopted elasto-plastic and hyperelastic models are often quasi-incompressible. This is not the case of porous plasticity (cf. [4]). We therefore avoid that approach.  Semi-implicit formulations, where certain quantities are fixed in the flow vector (but not the flow vector itself), cf. [23,8] can lead to substantial savings in constitutive integration. We further extend the semi-implicit algorithm presented in [3] to achieve very large time steps. Consistent linearization of integrated form of objective rates is intricate and computationally expensive, making it a possible candidate for the explicit integration part of the semi-implicit scheme. However, rigid body motions are exactly accounted for.  Cauchy equations of equilibrium for a rotated reference configuration are obtained from the corresponding spatial equilibrium (derivations for the latter are shown in Ogden [27]). Using standard notation (cf. [27]) we write the spatial equilibrium equations as  (1)    \u2202   \u03c3   ij     \u2202   x     a   j       +   b   i   = 0   with the Cauchy tensor components \u03c3  ij ( i , j = 1 , 2 , 3 ). In (1) i is the direction index and j is the facet index. The components of the body force vector are identified as b  i . In (1), coordinates   x     a   j     are the spatial, or deformed, coordinates of a given point under consideration. In addition, the following natural and essential boundary conditions hold on each part of the boundary   \u0393   a   =   \u0393   a   t   \u222a   \u0393   a   u   where \u0393  a   t is the natural boundary and \u0393  a   u is the essential boundary:  (2)    t   \u00af   = \u03c3 \u00b7 v  on    \u0393   a   t        (3)    u   \u00af   = u  on    \u0393   a   u     where   t   \u00af   is the known stress vector on \u0393  a   t , v is the outer normal and   u   \u00af   is the known displacement field on \u0393  a   u . It is assumed that (1) and (2)\u2013(3) are satisfied for a time parameter   t   a   \u2208 [ 0 , T ] with T being the total time of observation and for a point with position   x   a   \u2208   \u03a9   a   belonging to the deformed position domain at the time of analysis. Equilibrium configuration corresponds to the domain \u03a9  a and is identified by the subscript a. In tensor notation, Eq. (1) can be presented as  (4)  \u2207 \u00b7   \u03c3   T   + b = 0   with \u2207 = \u2202 / \u2202   x   a   being the spatial gradient operator. After multiplication by the velocity field   u   \u0307   , integration in the deformed configuration \u03a9  a and application of integration by parts component-wise, we obtain the following power form (     W   \u0307     int   is the internal and     W   \u0307     ext   is the external power):  (5)        \u222b     \u03a9   a     \u03c3 : L  d   \u03a9   a     \ufe38         W   \u0307     int     =       \u222b     \u03a9   a     b \u00b7   u   \u0307    d   \u03a9   a   +   \u222b     \u0393   a   t       t   \u00af   \u00b7   u   \u0307    d   \u0393   a     \ufe38         W   \u0307     ext       where L is the velocity gradient: L = \u2202   u   \u0307   / \u2202   x   a   . L can be decomposed into a symmetric part ( D , called strain rate) and a skew-symmetric part ( W , called vorticity), L = D + W . We also introduce the Jacobian J = det  F and F is the deformation gradient. The use of equivalence between internal     W   \u0307     int   and external     W   \u0307     ext   power for a continuum has been used to obtain objective rates of the Cauchy stress \u03c3 . In the corotational case, we can rotate the Kirchhoff stress and the strain rate to obtain  (6)      W   \u0307     int   =   \u222b     \u03a9   0     (    R   0 a   T   \u03c4   R   0 a    ) : (    R   0 a   T     DR   0 a    )  d   \u03a9   0        From each element nodal arrangement, we use three directions, where     e   \u00af     1 a   ,     e   \u00af     2 a   and     e   \u00af     3 a   to define   R   0 a   as  (7)    R   0 a   = [      e   \u00af     1 a   ,     e   \u00af     2 a   ,     e   \u00af     3 a    ]   where each column is a unit vector and     e   \u00af     ia   \u00b7     e   \u00af     ja   =   \u03b4   ij   . Section 2.3 describes the calculation of   R   0 a   . We then use the following convention for writing tensors: the bold symbol indicates tensor components. Therefore, the frame where the tensor components are defined is identified as a superscript. For example, the second-order tensor   S   ab   with the equilibrium configuration \u03a9  a and reference configuration \u03a9  b has the following components in frame c:   S   ab   c   . If a global frame 0 is adopted, component transformation between frame 0 and frame c follows:  (8)    S   ab   c   =   R   c 0     S   ab   0     R   c 0   T        Note that this approach, although related, does not correspond to the rotated Algorithm of Areias and Belytschko (cf. [2]). Generalizing (8), change of basis  2   2 This corresponds to a change of frame, denoted by a superscript. from d to c results in the following transformation:  (9)    S   ab   c   =   R   cd     S   ab   d     R   cd   T        In addition, change in reference configuration reads  (10)    S   ac   0   =   R   bc     S   ab   0     R   bc   T        Using (10) and transformation (9) for coinciding reference configuration and frame,  (11)    S   ac   c   =   S   ab   b        From the relation between the time derivative right Cauchy\u2013Green tensor C and the strain rate D , we obtain  (12)    C   \u0307   = 2   F   T   DF   Simo [33, p. 281, Eq. 8.1.13] derived the following one-step scheme for integrating the strain rate in frame 0, producing the following \u201cstrain\u201d from integration of D :  (13)    e   ab , \u03b2   0   \u2245    1   2      F   b \u03b2   T   [    F   a \u03b2   T     F   a \u03b2   \u2212 I  ]   F   b \u03b2     where \u03b2 is an arbitrary configuration. Using the previous power conjugacy (6), the internal power can be written in the initial configuration \u03a9 0 as       W   \u0307     int   =   \u222b     \u03a9   0       S   a 0   0   :   D   a 0   0    d   \u03a9   0     where   S   a 0   0   =   R   0 a   T     \u03c4   a   0     R   0 a   and   D   a 0   0   =   R   0 a   T     d   a   0     R   0 a   . Using a hypoelastic relation, stress updating is performed as follows:     S   a 0   0   =   S   b 0   0   + \u0394   S   a   (   R   \u03b2 0     e   ab , \u03b2   0     R   \u03b2 0   T   )   where \u0394     S   \u02c7     a   is a function of the strain   e   ab , \u03b2   0   . This term \u0394     S   \u02c7     a   is called the constitutive part of the stress. However, since   S   a 0   0   =   S   ab   b   and   S   b 0   0   =   S   bb   b   , we have     S   ab   b   =   S   bb   b   + \u0394   S   a   (   R   \u03b2 0     e   ab , \u03b2   0     R   \u03b2 0   T   )      In the case \u03b2 = b , the result is  (14)    S   ab   b   =   S   bb   b   + \u0394   S   a   (   e   ab   b   )   with Simo integration scheme reducing to  (15)    e   ab   b   \u2245    1   2      R   b 0   [    F   ab   T     F   ab   \u2212 I  ]   R   b 0   T        We now insert the Jacobian for configuration \u03a9  b in (14) as  (16)        1     J   b 0       S   ab   b     \ufe38       S   ab   \u22c6 b     =       1     J   b 0       S   bb   b     \ufe38       \u03c3   b   b     +   1     J   b 0     \u0394     S   \u02c7     a   (   e   ab   b   )   Defining  (17)    S   ab   \u22c6 b   =   1     J   b 0       S   ab   b     then we obtain the Cauchy stress in configuration \u03a9  a and frame a as  (18)    \u03c3   a   a   =   S   aa   \u22c6 a   =   1     J   a 0       S   aa   a   =   1     J   a 0       S   ab   b   =     J   b 0       J   a 0       S   ab   \u22c6 b        If \u0394     S   \u02c7     a   (   e   ab   b   ) is homogeneous of degree one, then it follows that     S   ab   \u22c6 b   =   \u03c3   b   b   + \u0394     S   \u02c7     a   (      e   \u02dc     ab   b    )   where  (19)      e   \u02dc     ab   b   =   1     J   b 0       e   ab   b        For hyperelastic models, we require the total strain, which is the strain from configuration \u03a9  a with respect to configuration \u03a9 0. Using frame b, we have the following update formula for the Green\u2013Lagrange strain:  (20)    e   a 0   b   =   e   b 0   b   +   F   b 0   bT     e   ab   b     F   b 0   b     We can observe that   S   ab   \u22c6 b   is work-conjugate to   e   a 0   b   in configuration \u03a9  b . Global Cauchy stress can be obtained as   \u03c3   b   0   =   R   0 b     \u03c3   b   b     R   0 b   T   . In frame a,   e   a 0   a   reads  (21)    e   a 0   a   =   R   ba   T     e   a 0   b     R   ba        For symmetric tensors, such as   S   ab   \u22c6 b   and   e   ab   b   , it is preferable to use the Voigt notation. Upright bold symbols denote Voigt form of symmetric tensors:  (22)    S   ab   \u22c6 b   = Voigt [   S   ab   \u22c6 b   ] =   1     J   b 0       V   S   (    F   b 0   b    )   S   a 0   b     where   S   a 0   b   = Voigt [   S   a 0   b   ] . We note that, omitting indices a, b, and 0,   V   S   ( F ) can be written as     V   S   ( F ) = [       F   11   2       F   21   2       F   31   2     2   F   21     F   11     2   F   31     F   11     2   F   31     F   21         F   12   2       F   22   2       F   32   2     2   F   22     F   12     2   F   32     F   12     2   F   32     F   22         F   13   2       F   23   2       F   33   2     2   F   23     F   13     2   F   33     F   13     2   F   33     F   23         F   11     F   12       F   21     F   22       F   31     F   32       F   21     F   12   +   F   11     F   22       F   31     F   12   +   F   11     F   32       F   31     F   22   +   F   21     F   32         F   11     F   13       F   21     F   23       F   31     F   33       F   21     F   13   +   F   11     F   23       F   31     F   13   +   F   11     F   33       F   31     F   23   +   F   21     F   33         F   12     F   13       F   22     F   23       F   32     F   33       F   22     F   13   +   F   12     F   23       F   32     F   13   +   F   12     F   33       F   32     F   23   +   F   22     F   33       ]   and, for the strain quantities,   V   E   ( F ) =   V   S   T   ( F ) . The full algorithm is given in Algorithm 1. In summary:  \u2022 Local constitutive quantities, as well as quadratic strain increments are implicitly integrated.  Local frames a and b, and therefore the rotation tensor are explicitly integrated.  General relative Lagrangian formulation (Voigt notation adopted).       Given   F   ab   b   ,   e   ab   b   (both in frame b),   R   0 b   and   R   0 a   (both in frame 0) and T  b and T  a     Recovered from storage   F   b 0   b   ,   \u03c3   b   0   ,   e   b 0   b   (   \u03c3   b   is stored in frame 0 for purpose of representation)   Represent Cauchy stress in frame b      \u03c3   b   b   =   V   S   (    R   0 b   T    )   \u03c3   b   0       Relevant Jacobian determinants     J   b 0   = det    F   b 0   b            J   ab   = det    F   ab   b       Relative rotation and total deformation gradient update     R   ab   =   R   0 a   T     R   0 b            F   a 0   b   =   F   ab   b     F   b 0   b       Thermal effect in the relative strain     e   ab   b \u25cb   =   e   ab   b   + \u03b1 (    T   a   \u2212   T   b    ) I     Total strain update     e   a 0   b   =   e   b 0   b   +   V   E   (    F   b 0   bT    )   e   ab   b \u25cb       Corrected relative strain for UL        e   \u02dc     ab   b \u25cb   =   1     J   b 0       e   ab   b \u25cb        (UL) Determine    S   ab   \u22c6 b   =   \u03c3   b   b   + \u0394     S   \u02c7     a   (      e   \u02dc     ab   b \u25cb    ) and Q  ab along with sensitivity quantities   C   ab   =   1     J   b 0       \u2202 \u0394     S   \u02c7     a     \u2202     e   \u02dc     ab   b \u25cb     ,   \u2202 \u0394     S   \u02c7     a     \u2202   T   a     ,   1     J   b 0       \u2202   Q   ab     \u2202     e   \u02dc     ab   b \u25cb     and   \u2202   Q   ab     \u2202   T   a          (TL) Determine    S   a 0   b   (    e   a 0   b    ) and Q  ab , along with sensitivity quantities   C   a 0   =   \u2202   S   a 0   b     \u2202   e   a 0   b     ,   \u2202   S   a 0   b     \u2202   T   a     ,   \u2202   Q   ab     \u2202   e   a 0   b     and   \u2202   Q   ab     \u2202   T   a          (TL)Determine relative stresses     S   ab   \u22c6 b   =   1     J   b 0       V   S   (    F   b 0   b    )   S   a 0   b        (TL) Determine relative sensitivities     C   ab   =   1     J   b 0       V   S   (    F   b 0   b    )   C   a 0     V   E   (   F   b 0   bT   )          \u2202   S   ab   \u22c6 b     \u2202   T   a     =   1     J   b 0       V   S   (    F   b 0   b    )   \u2202   S   a 0   b     \u2202   T   a              \u2202   Q   ab     \u2202   e   ab   b     =   \u2202   Q   ab     \u2202   e   a 0   b       V   E   (    F   b 0   bT    )     Update temperature sensitivity     \u2202   S   ab     \u2202   T   a       \u2202   S   ab     \u2202   T   a     + \u03b1   C   ab   I     Determine strain in frame a      e   a 0   a   =   V   E   (    R   ab    )   e   a 0   b       Determine deformation gradient in frame a      F   a 0   a   =   R   ab     F   a 0   b     R   ab   T       Determine Cauchy stress in frame 0     \u03c3   a   0   =   1     J   ab       V   S   (    R   0 a    )   S   ab   \u22c6 b       Store   F   a 0   a   ,   \u03c3   a   0   ,   e   a 0   a       Return Q  ab ,   S   ab   \u22c6 b   ,   C   ab   ,   \u2202   S   ab   \u22c6 b     \u2202   T   a     ,   \u2202   Q   ab     \u2202   e   ab   b     and   \u2202   Q   ab     \u2202   T   a              We determine the relevant constitutive quantities by solving a general nonlinear constitutive system. Omitting the frame superscript, it reduces to the root finding for the following nonlinear system:  (23)  \u03c6 (            S   ab   ,   Q   ab     \ufe37     Governing     \ufe38     Unknown   ;       e   ab   K   ,   e   ab   ,   T   a     \ufe38     Known   ;       \u03c7   a     \ufe38     Internalvar .    ) = 0   where   \u03c7   a   is the internal variable vector. For the present application, it is defined as  (24)    \u03c7   a   = {       \u03b5   p         f   a       }   where \u03b5  p is the effective plastic strain and f  a is the void fraction variable. Newton iteration for (23) provides, in general, the solution for the constitutive unknowns   S   ab   , Q  ab , and   \u03c7   a   . For the present application, system (23) has   Q   ab   = 0 ,   T   a   = 0 ,   e   ab   K   = \u2205 . A smoothed version of (23) is introduced by using the Chen\u2013Mangasarian replacement functions, which depend on a parameter Error such that (cf. [3])  (25)    lim   Error \u2192 0     \u03c6   Error   = \u03c6      Newton iteration on (23), using   \u03c6   Error   as a replacement provides the following scheme:  (26)      [       \u2202   \u03c6   Error     \u2202   S   ab         \u2202   \u03c6   Error     \u2202   \u03c7   a         ]   \ufe38     J   {     \u0394   S   ab       \u0394   \u03c7   a       } = \u2212   \u03c6   Error     After achieving a solution using the Newton scheme (26), we calculate the sensitivities from the following equation:  (27)  {     d   S   ab       d   \u03c7   a       } = \u2212   J   \u2212 1   [    \u2202   \u03c6   Error     \u2202   e   ab      ]    d   e   ab        Specifically (with further details being provided in [3]), the present elasto-plastic system is therefore given as  (28)    \u03c6   Error   (   S   ab   ;   e   ab   ,   \u03c7   a   ) = {       e   ab   \u2212   C   linear   \u2212 1   \u0394     S   \u02c7     ab   \u2212 n \u0394 \u03b3       \u03bc   \u22c6   \u0394 \u03b3 \u2212   \u3008    \u03bc   \u22c6   \u0394 \u03b3 + \u03d5  \u3009   Error       \u0394   \u03c7   a   \u2212 \u0394 \u03b3 \u03c9 (   \u03c7   a   )     }   where \u0394 \u03b3 is the plastic multiplier increment,   \u03bc   \u22c6   is a dimensional parameter described in [3] and the smooth ramp function of Chen and Mangasarian [14] is used for the third equation, which depends on Error . Function \u03d5 in (28) is the yield function. In addition, the flow vector n is also required for the flow rule, and it is defined as  (29)  n =   \u2202 \u03d5   \u2202   S   ab           Fig. 1 shows the effect of Error in the satisfaction of the complementarity condition (see also [3]). In (28), function \u03c9 (   \u03c7   a   ) is the internal variable evolution function, such that  (30)      \u03c7   \u0307     a   =   \u03b3   \u0307   \u03c9 (   S   ab   ,   \u03c7   a   )      The motivation for a unique treatment for all yield functions is that any particular yield function is inserted by means of \u03d5, n and derivatives of n . This is accomplished with Mathematica and the AceGen add-on [29,17].  Functions \u3008  \u2022  \u3009 and   \u3008  \u2022  \u3009   Error   are respectively given by  (31)  \u3008  \u2022  \u3009 =   \u2022 + | \u2022 |   2        (32)    \u3008  \u2022  \u3009   Error   = \u2022 +   Error   ln ( 2 )    ln [  1 +  exp (  \u2212   ln ( 2 )   Error   \u2022  )  ]   where   \u3008  \u2022  \u3009   Error   is an approximation of \u3008  \u2022  \u3009 .  With the objective of uniquely defining the element frame compatible with the concept of polar decomposition, use is made of the symmetric orthogonalization formula by Per-Olov L\u00f6wdin (cf. [19]). With that purpose, we resort to the singular value decomposition (SVD). Given a real 3\u00d73 matrix J , there exists a decomposition with the form  (33)  J = U \u03a3   V   T     where U is a 3\u00d73 unit matrix,   U   T   U = I , \u03a3 is a 3\u00d73 diagonal matrix and V is a 3\u00d73 unit matrix with   V   T   V = I . Columns of U are normalized eigenvectors of   JJ   T   and columns of V are normalized eigenvectors of   J   T   J . The diagonal matrix \u03a3 contains the singular values of J in its principal diagonal. Singular values are nonnegative reals. Columns of U are the left singular vectors and columns of V are the right singular vectors. The non-zero singular values of J are the square roots of the non-zero eigenvalues of   J   T   J . In the present case columns of J form a basis. L\u00f6wdin\u05f3s formula provides the following orthogonal frame:  (34)  R =   UV   T        It was proved by Carlson and Keller [12] that R obtained by this formula (34) is the proper orthogonal matrix whose columns have the minimum Euclidean distance to the corresponding columns of J . A more concise formula for R is  (35)  R = JV   \u03a3   \u2212 1     V   T     and, since \u03a3 is a diagonal matrix, we have the following index notation:  (36)    R   ij   =   1       \u03bb   l         J   ik     V   kl     V   jl     where \u03bb  l , l = 1 , \u2026 , n , are the eigenvalues of   J   T   J and columns of V are the corresponding eigenvectors. In our case, and for a tetrahedron, we have the following specialization:  (37)    R   0 a   =   J   a     V   a     \u03a3   a   \u2212 1     V   a   T     where   J   a   is the element Jacobian for configuration \u03a9  a ,   V   a   are the eigenvectors of   J   a   T     J   a   . For the configuration \u03a9  b , we have  (38)    R   0 b   =   J   b     V   b     \u03c3   b   \u2212 1     V   b   T        The following notation is used for the Jacobian matrices:  (39)    J   a   =   \u2202   x   a     \u2202 \u03be        (40)    J   b   =   \u2202   x   b     \u2202 \u03be     where \u03be is the vector of parent-domain coordinates. The motivation for the use of   R   0 a   and   R   0 b   to obtain a rotation can be summarized as follows: In problems where local frames are required (anisotropic laws, fracture, shells), rotation can be obtained by multiplication   R   ab   =   R   0 a   T     R   0 b   . For uniformity, we use the L\u00f6wdin local frames in all problems.    The version of the Gurson\u2013Tvergaard\u2013Needleman model introduced by Reis et al. [28] is rewritten here in non-dimensional form:  (41)    \u03d5   GTN   (  y , S ,   f   \u22c6    ) =   3   S   T     I   6     T   dev   S   2   y   2     \u2212 [  1 +   q   3     f   \u22c6   2   \u2212 2   q   1     f   \u22c6    cosh (      q   2     S   T     I   3     2 y    )  ]      The effective void fraction   f   \u22c6   is a function of the void fraction f . We use the nucleation part of the void fraction following the work of Chu and Needleman [15] using the normal distribution:  (42)      f   \u0307     N   =     f   N       S   N     2 \u03c0      exp [  \u2212   1   2     (      \u03b5   p   \u2212   \u03b5   N       S   N      )   2    ]     \u03b5   \u0307     p     where f  N , S  N and \u03b5  N are constitutive properties for the nucleation (N) part of the void fraction law. The classical void growth term of Gurson (cf. [16]) is adopted:  (43)    f   G   = 1 \u2212 exp ( \u2212   \u03b5   v   )   where \u03b5  v is the trace of deformation. In addition, the shear part of Xue and Nahshon (cf. [37,24,25]) are combined to obtain the following term:  (44)    f   S   =   3   q   6     2     (    6   \u03c0    )   1 / 3   (  1 \u2212 54      det   2   [    S   dev    ]     (    S   T     I   6     T   dev   S  )   3      )   f   1 / 3     \u03b5   pa   2        Including the initial void fraction, f 0, then the total f follows the following closed-form laws from the above classical relations:  (45)  f =       f   0   +     f   N     2   [  ERF (      \u03b5   N       S   N     2      ) \u2212 ERF (      \u03b5   N   \u2212   \u03b5   p       S   N     2      )  ] + 1 \u2212  exp (  \u2212   \u03b5   v    )   \ufe38       f   \u00af          (46)  +       3   q   6     2     (    6   \u03c0    )   1 / 3   (  1 \u2212 54      det   2   [    S   dev    ]     (    S   T     I   6     T   dev   S  )   3      )     f   \u00af     1 / 3     \u03b5   pa   2     \ufe38       f   S       The additional property q 6 controls the void growth in shear. A depiction of (41) with is shown in Fig. 2 . In contrast with the Rousselier model the GTN model is symmetric with respect to the trace of S . The effect of increasing f can be observed as a uniform reduction in radius of the yield surface.  The error function ERF ( \u2022 ) results from closed-form integration of the Gaussian curve and is available in several open-source libraries and is defined as  (47)  ERF ( \u2022 ) =   2     \u03c0       \u222b   0   \u2022     e   \u2212   t   2      d t      Two distinct types of effective plastic strain are adopted, 3   3 No power-consistent closed-form solution exists for the effective plastic strain in the classical Gurson model.  \u03b5  v and \u03b5  p . The latter being given as  (48)      \u03b5   \u0307     p   =     \u03b3   \u0307     ( 1 \u2212 f ) y     S   ab   T   n      Integration of constitutive quantities follow the unconditionally stable backward-Euler scheme:  (49)    \u03b5   pa   =   \u03b5   pb   +   \u0394 \u03b3   ( 1 \u2212 f ) y     S   ab   T   n      In addition, we have the trace of the flow vector, which is used to obtain \u03b5  v :  (50)      \u03b5   \u0307     v   =   \u03b3   \u0307   (    n   T     I   3    )      It is straightforward to obtain the critical f  f , corresponding to collapse, which is given by:  (51)    f   f   =     q   1   +     q   1   2   \u2212   q   3         q   3          The effective void fraction   f   \u22c6   is calculated according to the additional property f  c , using the Tvergaard\u2013Needleman modification (cf. [35]):  (52)    f   \u22c6   = {     f ,   f <   f   c         f   c   +      f   f   \u2212   f   c       f   m   \u2212   f   c      (  f \u2212   f   c    ) ,     f   c   \u2264 f \u2264   f   m         f   f   ,   f >   f   m         The effective void fraction (52) is used in the yield function, and is not updated as is the case of f.  The Rousselier [31] model for porous metals is characterized by the following yield function in non-dimensional form:  (53)    \u03d5   R   (  y , S ,   f   \u22c6    ) =       3   2     S   T     I   6     T   dev     S   T       (  1 \u2212   f   \u22c6    ) y   +     \u03c3   1     f   \u22c6     y   D  exp [      S   T     I   3     3 (  1 \u2212   f   \u22c6    )   \u03c3   1      ] \u2212 1   in which   f   \u22c6   is the effective void fraction in configuration \u03a9  a and y is the yield stress. In addition to the hardening characteristics reflected in y, the only additional properties are \u03c3 1, D and the initial porosity f 0. The property \u03c3 1 can be estimated from the original yield stress,   y   0   = y ( 0 ) and the ultimate tensile strength,   y   max   =   max     \u03b5   p     y as  (54)    \u03c3   1   estimate   =    1   3    (    y   0   +   y   max    )   Note that   y   max   must be provided by the actual hardening curve in the porous case. The effective void fraction   f   \u22c6   depends on the corresponding constitutive void fraction f. A depiction of (53) is shown in Fig. 3 . Note that the Rousselier model is asymmetric with respect to the trace of S . The effect of increasing f can be observed. Void fraction follows from volume change and is calculated exactly as in the previous section. Fracture value f  f coincides with the zero stress condition fulfilling the condition \u03d5 = 0 :  (55)    f   f   =   y   D   \u03c3   1          It can be observed that D indirectly controls the void fraction rate. We can force the growth near the critical value of void fraction to model coalescence as in the GTN model, but with a slight difference (see [35]):  (56)    f   \u22c6   = {     f ,   f <   f   c         f   c   +      f   f   \u2212   f   c       f   m   \u2212   f   c      (  f \u2212   f   c    ) ,     f   c   \u2264 f \u2264   f   m         f   f   ,   f >   f   m         with f  m , f  c and f  f being additional properties. An mentioned, initial void fraction f 0 must also be provided. The equivalent plastic strain increment is computed based on the power equivalence relation:  (57)    S   ab   T       \u03b5   \u0307     p   =     (  1 \u2212 f  ) {  y \u2212 3   \u03c3   1   W [    1   3     Df   \u22c6    exp (    y   3   \u03c3   1      )  ]  }   \ufe38       y   \u00af         \u03b5   \u0307     p     where W ( \u2022 ) is the Lambert W function. The effective plastic strain rate is given by this power equivalence (see also [4]):  (58)      \u03b5   \u0307     p   =     \u03b3   \u0307       y   \u00af       S   ab   T   n   and  (59)      \u03b5   \u0307     v   =     \u03b3   \u0307     ( 1 \u2212 f ) y   (    S   ab   T     I   3    ) (    n   T     I   3    )      Integration of constitutive quantities follow the unconditionally stable backward-Euler scheme:  (60)    \u03b5   pa   =   \u03b5   pb   +   \u0394 \u03b3     y   \u00af       S   ab   T   n      Time stepping is adapted so that \u0394   \u03b5   p   =   \u03b5     p   n + 1     \u2212   \u03b5     p   n     is kept below 5%. This measure is necessary for accuracy reasons in problems with localization.  For Error = 1 \u00d7   10   \u2212 3   we test the two porous plasticity models, along with the classical von-Mises yield criterion. Properties are shown in Table 1 for the two presented models. Von-Mises is a particularization.  Isoerror maps are shown in Fig. 4 for the three yield functions. We use the properties shown in Table 2 for the runs of the isoerror maps. Plane strain condition is assumed (4 direct stress components and 1 shear stress component). For each strain increment a single step is used. The following two conclusions are drawn:  \u2022 Very small integration errors are observed for the von-Mises yield function. This is well known since in a simpler case an exact solution exists.  The Rousselier yield function exhibits a larger error than the GTN yield function. This is now relatively well known since this yield function is not smooth for all stress states. It is also acknowledgedly difficult to integrate (cf. [4]).  To estimate the properties for the Rousselier model from known properties of the GTN model, we can obtain D, \u03c3 1 from q 1, q 2 and q 3 at a given void-fraction level f  c . Using least-squares, we solve the following least-squares minimization problem Cf. Table 3 :  (61)    min     \u03c3   1   , D     1   2   [    (    q   GTN   \u2212   q   Rousselier    )   2   +   (    p   GTN   \u2212   p   Rousselier    )   2    ]   where  (62)    q   GTN   = y   1 +   f   c   (    q   3   \u2212 2   q   1    )        (63)    q   Rousselier   = ( 1 \u2212   f   c   ) (  y \u2212   \u03c3   1     Df   c    )      (64)    p   GTN   =   2 y     q   2     arccosh (    1 +   f   c   2     q   3     2   f   c     q   1      )      (65)    p   Rousselier   = 3 ( 1 \u2212   f   c   )   \u03c3   1   log (    y     Df   c     \u03c3   1      )      Quasi-incompressible constitutive laws severely reduce the performance of displacement-based elements. Usually, mixed elements are a solution for avoiding locking in quasi-incompressible problems. The low-order MINI element by Arnold [5], see also Bathe [7] and Cao [11], is based on a two-field formulation where:  \u2022 Pressure is linearly interpolated using the corner nodes.  An internal shape function, named a bubble, enriches the velocity or displacement fields.  We can therefore write   S   ab   \u22c6 b   in Voigt form as a sum of deviatoric and pressure terms:  (68)    S   ab   \u22c6 b   = \u2212   J   ab     p   a     I   3   +   T   dev     S   ab   \u22c6 b     where   T   dev   is the following sparse matrix:  (69)    T   dev   = [       2   3     \u2212   1   3     \u2212   1   3     0   0   0     \u2212   1   3       2   3     \u2212   1   3     0   0   0     \u2212   1   3     \u2212   1   3       2   3     0   0   0     0   0   0   1   0   0     0   0   0   0   1   0     0   0   0   0   0   1     ]      In terms of power balance, we use the following relation, where     S   \u02dc     ab   \u22c6 b   depends on the independent pressure   p   \u02dc   . It corresponds to a classical two-field variational principle:  (70)        \u222b     \u03a9   b       (      S   \u02dc     ab   \u22c6 b    )   T       e   \u0307     ab   b    d   \u03a9   b   +   \u222b     \u03a9   b     (    J   ab     p   \u02dc   +     (    S   ab   \u22c6 b    )   T     I   3     3    )     p   \u02dc     \u0307    d   \u03a9   b     \ufe38         W   \u0307     int     =     W   \u0307     ext     where the relative Jacobian J  ab is used to ensure correct volume calculation. We note that the product   J   ab     p   \u02dc   cannot be used as an unknown field. In (70), we have the following quantities:  (71)      S   \u02dc     ab   \u22c6 b   = \u2212   J   ab     p   \u02dc     I   3   +   T   dev     S   ab   \u22c6 b        Discretization follows the standard MINI formulation:  (72)  u ( \u03be ) =   \u2211   K = 1   5     N   K   (  \u03be  )   u   K        Independent pressure   p   \u02dc   is interpolated using the corner nodes:  (73)    p   \u02dc   ( \u03be ) =   \u2211   K = 1   4     N   K   (  \u03be  )     p   \u02dc     K        (74a)    N   1   ( \u03be ) = 1 \u2212   \u03be   1   \u2212   \u03be   2   \u2212   \u03be   3        (74b)    N   2   ( \u03be ) =   \u03be   2        (74c)    N   3   ( \u03be ) =   \u03be   3        (74d)    N   4   ( \u03be ) =   \u03be   1        The bubble function, for tetrahedra, is given by  (5)    N   5   ( \u03be ) =   \u03be   1     \u03be   2     \u03be   3   (  1 \u2212   \u03be   1   \u2212   \u03be   2   \u2212   \u03be   3    )      For the calculation of the stiffness matrix, the variation of (70) is required. Not all quantities are determined by hand-derivation, and we use Mathematica [29] with the AceGen (cf. [17]) add-on to calculate some derivatives. Using (70), we obtain  (75)  d     W   \u0307     int   =   \u222b     \u03a9   b     [    (  d     S   \u02dc     ab   \u22c6 b    )   T       e   \u0307     ab   b   +   (      S   \u02dc     ab   \u22c6 b    )   T   d   e   ab   b    ] d   \u03a9   b        (76)  +   \u222b     \u03a9   b     [  d   J   ab     p   \u02dc   +   J   ab   d   p   \u02dc   +     (  d   S   ab   \u22c6 b    )   T     I   3     3    ]     p   \u02dc     \u0307    d   \u03a9   b     where the following notation was used:  (77)  d   S   ab   \u22c6 b   =   C   ab    d   e   ab   b        (78)  d     S   \u02dc     ab   \u22c6 b   =   T   dev     C   ab    d   e   ab   b   \u2212 d   J   ab     p   \u02dc     I   3   \u2212   J   ab    d   p   \u02dc     I   3     Specifically, the terms d   e   ab   b   and d   J   ab   are determined by AceGen. In terms of rotation tensor, we use the following process to obtain     e   \u00af     1   ,     e   \u00af     2   and     e   \u00af     3   .  Dimensional reduction for plane-strain requires careful consideration of out-of-plane stress, which is in general non-null. We therefore explicitly enforce the plane-strain condition by setting 13 and 23 components of both stress and strain as zero, but including the out-of-plane stress   [      S   \u02dc     ab   \u22c6 b    ]   33   as active. Therefore, for plane strain, we only omit out-of-plane shear components of stress and strain. In the axisymmetric case, we use reduced integration, which is sufficient to remove locking in the near-incompressible case.  All examples are run in the SIMPLAS framework, cf. [1] with the present formulations. MINI elements were implemented to comply with the L\u00f6wdin frames and the relative Green\u2013Lagrange strains. Internal degrees-of-freedom of mixed elements are condensed out.  An axisymmetric idealization of a simple tension test with smooth geometry (cf. [6] for a complete testing program) is made, with the relevant dimensions shown in Fig. 5 . The corresponding properties are shown in Table 1. Also shown in Fig. 5 are the contour plots for the effective plastic strain and void fraction in both models. Rousselier yield function produces earlier failure due to a steeper void fraction growth in the early nucleation stages. We can observe that no hourglass or mesh instabilities are visible and contour plots are relatively smooth.  We compare the void fraction evolution for the two models, separating the nucleation and void growth terms, in Fig. 6 . It can be observed that the growth term in Rousselier model 4   4 Note that properties have been fitted so that intersections in p- and q-axes for both models coincide at f =   f   c   . is much quicker to develop and tends to localize strain in a sharper form (see also Fig. 5).  Evolution of void fraction and effective plastic strain for the GTN yield function is shown in Fig. 7 . Reaction\u2013displacement results are also shown in the same figure. We obtain two conclusions:  \u2022 Effective plastic strain and void fraction evolution are close (however not perfectly close in the case of the effective plastic strain) to the ones reported by Malcher et al. [21]. Reaction\u2013displacement results are very similar to the reported experimental curve (cf. [21])  Some mesh sensitivity is observed, however it can be considered mild and acceptable.  This test, introduced by Bai and Wierzbicki [6] is required to assess the performance in shear of both yield functions. A description of this test is shown in Fig. 9 with the corresponding geometrical data. Both [21,22] perform extensive testing with this test to calibrate the constitutive properties. In this work, and for this test, Aluminum 2024-T351 is used and both mesh size and time step size sensitivities are inspected.  For the coarse mesh (due to size constraints), we show a sequence of relevant contour plots in Fig. 10 . Since the MINI mixed element technology is employed, severe deformations are possible without volumetric locking. In addition, we note that a shear band is formed at the specimen weak region. Effect of step size is shown in Fig. 11 for the GTN model and in Fig. 12 for the Rousselier model. Only mild dependence on step size is observed. A complete depiction of the dependence on mesh size is shown in Fig. 13 where again only slight dependence is observed. We note that, if stronger localization is required, then the mesh size has a serious effect in the results and regularization will be required. Mesh size effect on the effective plastic strain and void fraction evolution at the monitored node are shown in Fig. 14 . In this case some effect is noted, which is not sufficient to detract from the overall very robust results.  To inspect the mesh dependence with full localization (until collapse), we use the geometry from Norris tension test [26] (see also [32]). Fig. 15 shows the tension test specimen with effective plastic strain and void fraction contour plots. Two meshes are used: a coarse one with 3175 nodes and a finer one with 5409 nodes (the latter is used in the contour plots). A fixed displacement step of \u0394 w = 0.02 is adopted for this problem. We use the constitutive properties described in Table 4 which produce full localization. Regularization is performed by introducing a length-scale l  c ratio in Eq. (42) with   \u03b5   p   \u2192   l   c     \u03b5   p   , and Eq. (43) with   \u03b5   v   \u2192   l   c     \u03b5   v   for the GTN model and similarly for the Rousselier model. This is sufficient to produce nearly mesh-insensitive results. The length-scale ratio is defined as follows:  (79)    l   c   =   min    l   e       l   f       where l  e is the edge length and l  f is the fixed length size, a constitutive property (given in Table 4). Relatively smooth effective plastic strain and void fraction contour plots are obtained. In terms of displacement/reaction results for the GTN problem, we test the unregularized (   l   c   = 1 ) and regularized cases with the two meshes (see Fig. 16 for the GTN case). The length scale is sufficient to obtain insensitive results. For the Rousselier model, see Fig. 16, the same conclusion is obtained.   CONCLUSIONS   We presented a general semi-implicit constitutive algorithm and specialized it for the integration of porous plasticity yield functions. New contributions and distinctive features of the proposed algorithm are:  \u2022 The combination of relative Green\u2013Lagrange strains with the exact corotational method. Quadratic strains are used during iteration whereas a local frame is updated after convergence of Newton iteration.  The use of L\u00f6wdin algorithm to calculate orthogonal frames based on the Jacobians of configurations \u03a9  b and \u03a9  a . This corresponds to a definition of orthogonal frames consistent with the polar decomposition.  The use of a local constitutive system which is smooth and nonlinear. This is achieved in two steps by replacing the complementarity condition for a non-smooth equation and subsequently by the Chen\u2013Mangasarian replacement function (cf. [13,14]). Local Newton iteration is performed without concerns with the complementarity condition.  The GTN and Rousselier constitutive models are explored in detail, with the determination of intersections with axes of pressure\u2013shear diagram ( p \u2013 q ). We include isoerror maps and the explicit determination of the void fraction in both models.  The use of finite strain versions of the MINI element (cf. [5]) in triangles and tetrahedra to avoid locking due to quasi-incompressibility in the early stages of void fraction evolution. Specializations and the second variation of the variational principle, required to calculate the stiffness matrix.  The use of a length-scale in the stress measures and effective plastic strain present in the void growth laws, which was found to be sufficient to produce mesh-insensitive results. This is shown in the 3D tension test, where both models were tested with two meshes.   REFERENCES", "highlights": "Two porous plasticity models, Rousselier and Gurson\u2013Tvergaard\u2013Needleman (GTN), are integrated with a new semi-implicit integration algorithm for finite strain plasticity. It consists of using relative Green\u2013Lagrange during the iteration process and incremental frame updating corresponding to a polar decomposition. Lowdin\u05f3s method of orthogonalization is adopted to ensure incremental frame-invariance. In addition, a smooth replacement of the complementarity condition is used. Since porous models are known to be difficult to integrate due to the combined effect of void fraction growth, stress and effective plastic strain evolution, we perform a complete assessment of our semi-implicit algorithm. Semi-implicit algorithms take advantage of different evolution rates to enhance the robustness in difficult to converge problems. A detailed description of the constitutive algorithm is performed, with the key components comprehensively exposed. In addition to the fully detailed constitutive algorithms, we use mixed finite strain elements based on Arnold\u05f3s MINI formulation. This formulation passes the inf\u2013sup test and allows a direct application with porous models. Isoerror maps for two common initial stress states are shown. In addition, we extensively test the two models with established benchmarks. Specifically, the cylindrical tension test as well as the butterfly shear specimen are adopted for validation. A 3D tension test is used to investigate mesh dependence and the effect of a length scale. Results show remarkable robustness."}