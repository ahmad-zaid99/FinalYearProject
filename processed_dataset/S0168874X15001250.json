{"id": "S0168874X15001250", "article": "MAIN-TITLE Modeling contact of pipes within elliptic and spiralled wellbores using finite element analysis   HIGHLIGHTS          A static 3D nonlinear finite element engine capturing mechanics of drillpipes inside wellbores with friction and contact presented.      Formulations to model contact of circular pipes within elliptical and spiralled wellbores presented.      Proposed formulation enables to capture the difference between micro and macro tortuosity of wellbores in terms of mechanical damage done on the drillpipe.          KEYPHRASES   Nonlinear finite element analysis  Contact modeling  Drilling applications   The finite element (FE) method is probably the most widely used tool for structural analysis of various engineering applications. In this regard, drilling and completion operations within oil industry are no exception. For these cases, one could be interested in calculating the static equilibrium of drillpipes in wellbores. This would reveal the equilibrium configuration of the pipe and all the forces acting on it. To achieve this, these models must handle the so-called \u201ccontact problem\u201d, since we are dealing with pipes in very tight boreholes. This implies calculating the maximum allowed movement of the pipe within its confined space. One should note that an accurate description of the wellbore would be the core component in that sense. If available, such a description would allow us to determine the effect of the hole more realistically and estimate the success of the planned operations, such as running pipe, cementing, logging, and performing completions. We should keep in mind that no matter how complex or advanced the model, the output is heavily dependent on the accuracy and detail of the modelled wellbore, which eventually determines the mechanical condition of the pipe inside the hole. Therefore, it is crucial to have the capability of capturing the effect of irregular hole shapes in our model, since we might not always end up with perfectly smooth circular holes.  This work presents the formulation and implementation to enable modeling drillpipes within irregular (noncircular or oscillatory) borehole shapes using an FE engine. First, a brief background on the basics of the FE model will be provided. Then, the problem at hand will be described mathematically for which analytical solutions will be provided. The details on the implementation will be also reported. Finally, the model will be used to understand the effect of wellbore irregularities on the positioning and bending moments of the pipe.  Various models are used in oil industry to estimate the forces on drillpipes [1\u20136]. These tools provide various benefits, such as estimating torsional and axial drag, bending moments, load distribution along the drillpipe and critical buckling loads for a given hole-pipe-wellbore combination. Such a model has been developed in Schlumberger Gould Research center, where 3D beam elements are used within a static nonlinear FE formulation. It is worth mentioning that the model employs the so-called Co-rotational formulation [7], where the motion of every element is decomposed into rigid body motion and pure deformations through the use of an additional reference system. This reference system is called CR reference, which continuously rotates and translates with the element. By doing so, the small deformations are captured in local (element) coordinate system, while the geometric nonlinearities are handled by extracting the rigid body motion from the overall displacements. Hence, this approach has been recognized to be especially suitable for structures with large displacements and rotations, but with small strains. Considering the drillpipe, one can note that it will be often subjected to large displacements and rotations in order to fit within the drilled wellbore, while the deformations at local element level will be low. This enables the use of high performing local element formulations. For the sake of completeness, we will describe some basic aspects of the nonlinear FE model used in the following (see Appendix B for the details on the Co-rotational FE formulation and [8,9] for details on nonlinear FE analysis).  The FE analysis of a drillpipe starts with the description of the wellbore profile as shown in Fig. 1 on the left. Usually, one is provided with the description of the trajectory, which are obtained from measurements during and/or after drilling. This information is then used the determine coordinates of well points (shown with dark blue stars), which represent the drilled hole in a discretized manner. It is important to note that these well points construct the reference coordinate system for the FE analysis, i.e., the displacements are solved with respect wellbore center, using the following equilibrium condition,  (1)    f   int   = Ku =   f   ext     where K is the n \u00d7 n stiffness matrix (n being the number of degrees of freedom),   f   int   and   f   ext   are the n\u00d71 internal and external force vectors, respectively, and finally u is the n \u00d7 1 displacement vector to be solved. Here, the stiffness matrix is assembled for the deformed shape of the structure and hence is a function of displacements,  (2)  K ( u ) =   \u2202   f   int     \u2202 u        Consequently, the solution of the nonlinear FE analysis is performed iteratively using a Newton\u2013Raphson algorithm, where the stiffness and the internal forces are re-calculated for every change in the displacement vector. The iterations are continued until the equilibrium between the internal and external forces of the structure is achieved or the incremental change in the displacements are negligible. This procedure can be summarized as follows:  1. Assemble the external force vector   f   ext   considering the weight of the pipe and applied loads.  Calculate   K   e   ( u ) and   f   int   e   ( u ) for every element and assemble the stiffness matrix and internal force vector for the whole structure.  Apply boundary conditions.  Check contact for every node and apply contact force if necessary.  Solve for incremental displacements \u0394   u   i      (3)  K (   u   i   ) \u0394   u   i   =   f   int   (   u   i   ) \u2212   f   ext        Update the total displacement vector as  (4)    u   i + 1   =   u   i   + \u0394   u   i        Check convergence by comparing the norms of the incremental displacements \u2225 \u0394   u   i   \u2225 and residual force \u2225   f   res   =   f   int   \u2212    f   ext    \u2225 to pre-set threshold values  Repeat steps 2\u20137 until convergence is achieved  From a geometrical point of view, there are three main components required for a complete wellbore description: the location of hole centerline, hole size, and hole shape. Such an input to any related model would improve the quality of its output substantially. This is, of course, provided that the FE model can process the detailed wellbore input. In this regard, one critical feature missing in current FE models used in oil industry is taking the variable clearance (due to the noncircular hole shape) into account.  The reason for this is simply the additional complication introduced into the contact algorithm as explained in the following. To start with, let us define some basic concepts for the simple case. Within contact mechanics, clearance is defined as the maximum amount of distance over which a structure is allowed to move in a certain direction before contact occurs. Considering our problem, in which the drillpipe is represented using beam elements with circular cross sections, the calculation of clearance poses no difficulty for circular wellbores. That is, the clearance (marked with symbol c in Fig. 2 ) for any node can be easily deducted from the dimensions of the pipe and wellbore at the considered location. This clearance will be a single value, independent of the direction of the pipe movement. As a result, the contact can be easily detected by comparing the total lateral displacement of the pipe (u) against the clearance and the resulting contact force can be calculated using a penalty formulation (see Appendix C for the details), which is a commonly used approach among many other contact force formulations available in the literature [10]. Furthermore, the direction of the contact force introduces here no additional issues, since it will be simply aligned with the displacement direction of the pipe (as shown in Fig. 2).  One can immediately see however that this assumption falls apart, if the wellbore is not circular. For noncircular hole shapes, one needs to calculate the clearance depending on the pipe movement, as the pipe can move different distances towards different directions before contacting the wellbore. In the following section, two formulations to consider such cases, one for elliptical and one for spiralled wellbores, will be introduced. These two wellbore types have been selected in this study since they are representative cases encountered in the field. To be more clear, breakouts in certain formations might result in oval or elliptical looking cross sections [11], whereas spiralled wellbores might be drilled due to nature of the drilling mechanism in use [12].  The problem we consider in this work is shown graphically in Fig. 3 , in which the blue ellipse represents the wellbore and red circle stands for the pipe. The coordinates of any point on the circle representing drillpipe (   x   p   ,   y   p   ) and on the ellipse representing wellbore (   x   w   ,   y   w   ) can be calculated easily, either using the polar coordinate system  (5)    x   p   ( \u03b8 ) =   r   p     cos  ( \u03b8 ) ,    y   p   ( \u03b8 ) =   r   p     sin  ( \u03b8 )   x   w   ( \u03b8 ) = a   cos  ( \u03b8 ) ,    y   w   ( \u03b8 ) = b   cos  ( \u03b8 )   or with respect to the Cartesian coordinate system  (6)    x   p   2   +   y   p   2   =   r   p   2     (      x   w     a    )   2   +   (      y   w     b    )   2   = 1   Imagine now that the pipe is moving towards an arbitrary direction (\u03b1). To determine which point on the circle will touch the wellbore first, we must find out which distance between circle and ellipse towards the movement direction is minimum (see the parallel lines in Fig. 3). This implies, mathematically, solving the following optimization problem with nonlinear constraints:  (7)   min   f =     (    x   w   \u2212   x   p    )   2   +   (    y   w   \u2212   y   p    )   2     subject  to  1 =   (      x   w     a    )   2   +   (      y   w     b    )   2      r   p   2   =   x   p   2   +   y   p   2     tan  ( \u03b1 )     y   w   \u2212   y   p       x   w   \u2212   x   p       To simplify the algorithm and the implementation, the solution of the above is done in a crude manner. That is, we simply calculate all the distances between the points A and B as shown in Fig. 3 within one quadrant ([0\u00b0, 90\u00b0]) using one degree increments. Then, we simply find the minimum of all these calculated distances, which corresponds to the clearance value. This approach is suggested mainly due to its simplicity compared to a potentially more involved optimization algorithm. It should be noted that the calculation of all distances poses no computational burden since an explicit analytical solution is provided.  The procedure is explained in more detail as follows. First, we start by formulating the line passing through point A. Note that the slope of this line is equal to the pipe movement direction  (8)  y =  tan  ( \u03b1 ) x + d   Since this equation has to be satisfied at point A on the circle, we can obtain the coefficient d by plugging Eq. (5) into (8),  (9)  y =  tan  ( \u03b1 ) x +   r   p     sin  ( \u03b8 ) \u2212  tan  ( \u03b1 )   r   p     cos  ( \u03b8 )   Also using (6), we can write y  w in terms of x  w as  (10)    y   w   =     b   2   \u2212   (      x   w   a   b    )   2       Plugging the above expression of y  w into Eq. (9) results in  (11)      b   2   \u2212   (      x   w   a   b    )   2     \u2212  tan  ( \u03b1 )   x   w   \u2212   r   p     sin  ( \u03b8 ) +  tan  ( \u03b1 )   r   p     cos  ( \u03b8 ) = 0   Note that for Eq (11), we assume that the dimensions of the elliptical wellbore (a and b) and the radius of the pipe (r  p ) are known. This leaves x  w as the only unknown and it must be solved for all \u03b8 angles within \u03b8 \u2208 [ 0 \u00b0 , 90 \u00b0 ] for any given movement direction (\u03b1) of the pipe. The solution for this can be evaluated analytically and is given as follows:  (12)    x   w   = \u00b1   a ( b   ( F + G + H )   1 / 2   \u2212 K + L )     a   2       tan   2    ( \u03b1 ) +   b   2     F =   a   2       tan   2    ( \u03b1 ) \u2212   r   p   2       sin   2    ( \u03b8 ) G =   b   2   \u2212   r   p   2       tan   2    ( \u03b1 )     cos   2    ( \u03b8 ) H = 2   r   p   2     tan  ( \u03b1 )   cos  ( \u03b8 )   sin  ( \u03b8 ) K =   ar   p     tan  ( \u03b1 )   sin  ( \u03b8 ) L =   ar   p       tan   2    ( \u03b1 )   cos  ( \u03b8 )   Once x  w is calculated, y  w can be obtained easily using (10). These coordinates (   x   w   ,   y   w   ) will define the first touch point, and the corresponding distance will be the clearance for the considered pipe movement.  It should be also noted that for the contact algorithm, in addition to calculating clearance, the direction of the contact force is needed. This is trivial to obtain for circular holes because it is simply in the same direction as the pipe movement. However, this will generally not be the case for noncircular holes. Hence, we need to calculate the tangent and the normal to it at the point of contact. This can be done easily by calculating the tangent of the ellipse at x  w as  (13)       dy   dx    |   x =   x   w     = \u2212   (    b   a    )   2       x   w         b   2   \u2212 (       b   2     x   w   2       a   2       )       Eq (13) will provide the slope of the tangent at the contact point, and the contact force should be applied simply in the vertical direction to this tangent.  The formulations derived up to this point can be used also for a more general case, where the elliptical wellbore is tilted. In this case, the general form of ellipse equation in polar coordinates becomes  (14)    x   w   ( \u03b8 ) = a   cos  ( \u03b8 )   cos  ( \u03b8 ) \u2212 b   sin  ( \u03b8 )   sin  ( \u03b2 )   y   w   ( \u03b8 ) = a   cos  ( \u03b8 )   sin  ( \u03b2 ) + b   cos  ( \u03b8 )   sin  ( \u03b2 )   where \u03b2 denotes the rotation of the ellipse axis in the counter-clockwise direction. In this case, the clearance can be calculated again as described so far, e.g., considering only \u03b8 \u2208 [ 0 \u00b0 , 90 \u00b0 ] . However, this time, \u03b8 would be defined with respect to the tilted ellipse axes. Hence, necessary transformations between the coordinate systems need to be carried out. The details of these transformations are omitted here for brevity.  The implementation for the proposed clearance model is summarized here. These steps are to be performed for every FE node on the drillpipe within the contact algorithm:  1. Get the radius of the pipe at the considered node (larger radius to be taken of the two neighbouring elements sharing the same node).  Identify the closest well point.  Obtain the description of the well at that point (a, b, and \u03b2).  Extract the displacement (u) and its direction (\u03b1) of the considered node.  Calculate distances by solving (12) for all \u03b8 = 0 \u00b0 , 1 \u00b0 , 2 \u00b0 , \u2026 , 90 \u00b0 .  Assign the minimum distance as the clearance c and compare against | u | .  If | u | > c , then calculate the contact force and its direction (using (13)).  To model clearance for spiralled holes, we will assume offset wellbore sections. The argument for this approach is as follows. Consider a spiralled wellbore section as shown in Fig. 5 (left). Note that one can construct such a trajectory once the period and amplitude of the oscillations are known. That is, one can calculate the offset of the center line using the following equation:  (15)  y ( m ) =   A   2     sin   (   2 \u03c0 m   P   )  z ( m ) =   A   2     cos   (   2 \u03c0 m   P   )    where A stands for the amplitude, P refers to the period of the spiral, y and z are the perpendicular directions defining the wellbore cross section and m is the measured depth. It should be noted that this offset is defined with respect to the wellbore center, which is the reference coordinate system for the solution of the FE analysis.  The implication of this approach is described in Fig. 5 (right). If we would see the wellbore from the pipes' perspective (assume you are descending into the spiralled section of the wellbore), the wellbore center would be offset with respect to the pipe center. And the amount of this offset can be calculated at any measured depth using (15). This would allow us to calculate the gap between the pipe and spiralled wellbore at any point in the trajectory for any given movement of the pipe. In fact, the methodology followed is very similar to one applied for the elliptical hole.  We start again by formulating the clearance as an optimization problem:  (16)   min   f =     (    x   w   \u2212   x   p    )   2   +   (    y   w   \u2212   y   p    )   2     subject  to    r   w   2   =   (   x   w   \u2212   x   w   o   )   2   +   (   y   w   \u2212   y   w   o   )   2      r   p   2   =   x   p   2   +   y   p   2     tan  ( \u03b1 ) =     y   w   \u2212   y   p       x   w   \u2212   x   p       where x  o   w and y  o   w refer to the coordinates of the wellbore center (O  w ). And, once again, instead of solving the optimization problem, we calculate the distances between the points A and B as shown in Fig. 6 . To do this, we combine the straight line passing through A with the definition of y  w , which is given as  (17)    y   w   = \u00b1     r   w   2   \u2212   (   x   w   \u2212   x   w   o   )   2     +   y   w   o     Then we can work our way towards an expression to be solved for every \u03b8 in [ 0 \u00b0 , 180 \u00b0 ] , where x  w is the only unknown:  (18)      r   w   2   \u2212   (   x   w   \u2212   x   w   o   )   2     +   y   w   o   \u2212  tan  ( \u03b1 )   x   w   \u2212   r   p     sin  ( \u03b8 ) +  tan  ( \u03b1 )   r   p     cos  ( \u03b8 ) = 0   An analytical solution is available for this expression as in the case for elliptical holes and is given as follows:  (19)    x   w   =     x   w   o   \u00b1   ( F \u2212 G + H + K \u2212 L \u2212 M + N )   1 / 2   + P + O   tan   ( \u03b1 )   2   + 1     F = r   w   2     tan    ( \u03b1 )   2   \u2212     x   w   o     2     tan    ( \u03b1 )   2   G =   r   p   2     sin    ( \u03b8 )   2   +   r   w   2   \u2212     y   w   o     2   \u2212   r   p   2     tan    ( \u03b1 )   2     cos    ( \u03b8 )   2   H = 2    x   w   o      y   w   o     tan  ( \u03b1 ) K = 2    r   p      y   w   o     sin  ( \u03b8 ) + 2   r   p   2     tan  ( \u03b1 )  cos  ( \u03b8 )   sin  ( \u03b8 ) L = 2    r   p      y   w   o     tan  ( \u03b1 )   cos  ( \u03b8 ) M = 2    r   p      x   w   o     tan  ( \u03b1 )   sin  ( \u03b8 ) N = 2    r   p      x   w   o    tan    ( \u03b1 )   2    cos  ( \u03b8 ) O =   r   p    tan    ( \u03b1 )   2    cos  ( \u03b8 ) P =   y   w   o    tan  ( \u03b1 ) \u2212   r   p    tan  ( \u03b1 )  sin  ( \u03b8 )   Note that both Eqs. (17) and (19) have two solutions, negative and positive. In the implementation, the appropriate one (depending on the movement direction of the pipe) must be considered. Also one should keep in mind that this time \u03b8 covers the interval [ 0 \u00b0 , 180 \u00b0 ] and is defined with respect to the line S\u2013S\u2032, which is perpendicular to the movement direction \u03b1 of the pipe (see Fig. 6).  Once again for the completeness of the contact algorithm, we must also consider the direction of the contact force, which can be obtained by calculating the tangent at x  w ,  (20)       dy   dx    |   x =   x   w     =   \u00b1 (   x   w   o   \u2212   x   w   )       r   w   2   \u2212   (   x   w   o   \u2212   x   w   )   2            The implementation for the proposed clearance model is summarized in the following. These steps are to be performed for every FE node on the drillpipe within the contact algorithm:  1. Get the radius of the pipe at the considered node (larger radius to be taken of the two neighbouring elements sharing the same node).  Identify the closest well point.  Obtain the radius of the wellbore (r  w ) and the offset of the wellbore center due to spiralling at that point (x  o   w and y  o   w ).  Extract the displacement (u) and its direction (\u03b1) of the considered node.  Calculate distances by solving (19) for all \u03b8 = 0 \u00b0 , 1 \u00b0 , 2 \u00b0 , \u2026 , 180 \u00b0 .  Assign the minimum distance as the clearance c and compare against | u | .  If | u | > c , then calculate the contact force and its direction (using (13)).  Before proceeding to the case study, it should be noted that the proposed approach to account for elliptical and spiralled holes can be extended to more general hole shapes. The essential ingredient required is to detect the occurrence of contact for a given displacement. As seen in this work, this problem can be defined mathematically by formulating the minimum distance between the outer edge of the moving body and its confined surrounding for the calculated movement direction. Here this logic has been applied to two cases, namely to elliptic and spiralled holes. The argument for the selection of these two cases is first of all their relevance to drilling applications (remember that formation breakouts might lead to oval shaped boreholes and drilling mechanisms sometimes cause spiralled trajectories). Furthermore, these two types of irregularities can be defined easily mathematically, which leads to neat analytical solutions to calculate the minimum distances. In conclusion, the same logic could be applied for more generic borehole irregularities, by only updating the calculation of the minimum distance (clearance) within the FE engine. The implications for this extension would be more elaborated derivations for the cases where an analytical solution exist. If this is not the case, then one would have to employ an appropriate optimization algorithm to calculate the minimum distance, which would translate as more involved implementations and longer computation times.  The benefits of the developed clearance models are shown with a numerical example in this section. In this example, a 100m long pipe with a uniform circular section (outer diameter=6in, inner diameter=5in) is assumed to be sitting on the bottom of a 100m straight horizontal wellbore with 8in diameter. Between 20m and 80m depth in the wellbore, a spiralled section has been defined with different periods and amplitudes using Eq. (15). The resulting wellbores for each of the considered spirals are shown in Fig. 8 with a zoomed 3D view. The aim in this numerical study is to analyse how the static equilibrium of the pipe varies with respect to the severity of the spiral defined by its amplitude and period. The aforementioned in-house FE engine using 3D beam elements with the Co-rotational formulation (see Appendix A for details) has been employed to the perform this study, where the proposed clearance algorithms are implemented and tested.  The results are summarized in Fig. 9 , in which each of the four plots consists of two sections. The bottom subplots show the deformed shape of the pipe (the blue line represents the centerline of the deformed pipe in static equilibrium, note that 3D views of these deformations are provided separately in Fig. 10 for better visualization), and the upper subplot represents the corresponding calculated bending moments. It can be observed from the results that if we take the first case as reference, i.e., where the period of the spiral is 5m and the amplitude is 1cm, increasing the period from 5 to 10m smooths the bending moments (see the difference in bending moments between first and second cases). Increasing the amplitude, on the other hand, although keeping the period at 10m, seems to make the case worse, since the bending moments increase (compare the second and third cases). Based on these result, one would be tempted to draw the conclusion that decreasing the period or increasing the amplitude would increase the resulting bending moments on the drillpipe, hence making the situation undesirable in terms of structural damage.  However, we can observe that this is not necessarily the case. In fact, for the fourth scenario we considered, in which the period is decreased to 1m and the amplitude is kept at 2cm, our model predicts that the pipe will simply run through an effectively smaller diameter hole, without bending with the oscillations in the wellbore. This is quite an important result in terms of proving the benefit of the proposed clearance model, since it can differentiate between damaging and harmless tortuosity in terms of the mechanical damage to the pipe.   CONCLUSIONS   In this work, two novel formulations to model contact for drillpipes within elliptical and spiralled boreholes are derived. These proposed algorithms are generic in the sense that they can be easily added to any FE model including contact and friction. The proposed models have been implemented within a multipurpose FE engine and tested. The presented numerical example revealed that the model can capture the mechanical effects of these irregularities. Most importantly, the model shows that different levels of tortuosities could differ in terms of severity, considering the mechanical damage they cause on the pipe.   ACKNOWLEDGEMENTS   The author thanks Schlumberger for the opportunity to publish this paper.  In this section, a brief summary of the Co-rotational (CR) formulation [7] will be given. As mentioned within the main text of the paper, the main idea behind the CR method is to decompose the motion of every element into rigid body motion and pure deformations through the use of an additional reference system. This reference system is called CR reference, which continuously rotates and translates with the element. By doing so, the small deformations are captured in local (element) coordinate system, while the geometric nonlinearities are handled by extracting the rigid body motion from the overall displacements. It should be noted that CR formulation makes use of the mathematical theory behind the 3D rotations, which will be skipped here for brevity (see [13,14] for more details).  Let us start by defining the kinematics of the beam elements as shown in Fig. A1 , where  \u2022     R   o   : Global rotation matrix defining initial position      R   r   : Global rotation matrix defining rigid rotation of elements      R   i   g   : Global rotation matrix of node i         R   \u00af     i   : Local rotation matrix of node i   Rotating the beam element from the global frame to the initial position using   R   o   and then rotating node i to its final configuration using   R   g   i      Rotating the same beam element from the global frame to its current position using   R   r   and then considering the local rotation     R   \u00af     i   to its final configuration.  For each node i let us now define   q   i   =    R   g   i      R   0     [ 0  1  0 ]   T   . Physically,   q   i   represents the rotation of the cross section director of the beam   [ 0  1  0 ]   T   from the global coordinate system to the node i deformed shape. We can then take the mean director in the deformed shape as q =    1   2    (   q   1   +    q   2    ) . From there, we can express the rotation   R   r   as  (A.4)    R   r   = [   r   1      r   2       r   3    ]   r   1   =     x   g   2   +   u   g   2   \u2212   x   g   1   \u2212   u   g   1       l   n       r   2   =   r   3   \u00d7    r   1      r   3   =     r   1   \u00d7 q   \u2225   r   1   \u00d7 q \u2225     Now, once the rotation matrices     R   \u00af     i   are calculated using (A.2), the corresponding element rotations can be retrieved using the matrix logarithm which is the inverse of the exponential mapping, i.e.   \u03d1   i   =  log  (      R   \u00af     i    ) . Now we can use these rotations to define the deformed shape of the beam. Knowing already its rigid body motion, we have a system with 7 Degrees Of Freedom (DOFs), i.e. taking node 1 as reference, we just need the elongation of node 2 compare to the node 1 and the 3D rotations at nodes 1 and 2. This leads to the definition of the element displacement vector in element coordinate system as   u   e   (7\u00d71), which is used to calculate element internal forces vector   f   e   (7\u00d71):  (A.5)    u   e   = [ u    \u03d1   1      \u03d1   2   ]   f   e   = [ n    m   1      m   2   ]   where u is the axial elongation u =   l   n   \u2212   l   0   (   l   0   : initial length,   l   n   : current length) and n is the corresponding axial force. Similarly,   \u03d1   1   ( 3 \u00d7 1 ) and   \u03d1   2   ( 3 \u00d7 1 ) denote the local rotations at nodes 1 and 2, where   m   1   and   m   2   are the corresponding moments. Once the internal forces vector and stiffness matrix are calculated according to the local displacements and rotations for every element, the system of equations is assembled to be solved for the overall structure.  In the presented FE model, contact between the pipe and the wellbore is handled using the penalty method. In this approach, the contact forces are proportional to the penetration and estimated as  (B.1)    f   c   =   k   c     ( d \u2212 c )   +     where k  c is the contact stiffness (usually set to a high value such as   10   7    N / m ), c is the clearance and d denotes the total lateral displacement calculated as d =     u   y   2   +   u   z   2     . The total contact force can be decomposed to its components in y- and z-axis as  (B.2)    f   c   y   =    k   c        u   y     d   ( d \u2212 C )   f   c   z   =    k   c        u   z     d   ( d \u2212 C )   Contact is checked for every node by comparing the total lateral displacement to the clearance value, i.e. if d > c . In case contact is detected, the stiffness matrix is updated with the following terms:  (B.3)  \u0394   K   yy   =   \u2202   f   c   y     \u2202   u   y     =   k   c    ( 1 \u2212     Cu   z   2       d   3     )  \u0394   K   zz   =   \u2202   f   c   z     \u2202   u   z     =   k   c    ( 1 \u2212      Cu   y   2       d   3      )  \u0394   K   yz   =   \u2202   f   c   y     \u2202   u   z     =    k   c         Cu   y     u   z       d   3      \u0394   K   zy   =   \u2202   f   c   z     \u2202   u   y     =    k   c         Cu   y     u   z       d   3        where   K   yy   ,   K   zz   ,   K   yz   ,   K   zy   are the appropriate stiffness terms corresponding to the node in contact. Similarly, the related entries in the internal force vector for that node are updated accordingly,  (B.4)  \u0394   f     int   y     =    k   c         u   y     d    ( d \u2212 C ) \u0394   f     int   z     =    k   c         u   z     d    ( d \u2212 C )      See Fig. C1 .   REFERENCES", "highlights": "This paper addresses the formulation and implementation of a contact algorithm for circular pipes within elliptic and spiralled wellbores using nonlinear finite element analysis. The need for such a capability originates from drilling applications in oil industry. Normally, the drilling bits have circular cross sections and the intention is to drill perfectly circular holes. However, it is quite common that the drilled wellbores show irregularities. This study derives the formulations to calculate the clearances between the pipes and such boreholes, which are essential to detect contact and calculate the associated contact forces. The formulations are described in detail and the implementations and flowcharts are provided as well. A case study is presented to reveal the implications to have such capabilities within a finite element engine, such as capturing the damage on the drillpipes in terms of bending moments."}