@&#MAIN-TITLE@&#Automatic detection of epileptic seizures in long-term EEG records

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           It is developed to reduce the visual inspection time spent by physicians.


                        
                        
                           
                           It is based on simple and low computational costs methods.


                        
                        
                           
                           It uses thresholds instead of complex classifier. So, no training step is required.


                        
                        
                           
                           It can be applied to new records that have not been presented to the algorithm.


                        
                        
                           
                           It is simpler than other algorithms, similar or superior performances were achieved.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Epilepsy

Intracranial EEG records (iEEG)

Power spectrum

EEG frequency bands

Wavelet decomposition

@&#ABSTRACT@&#


                  Epilepsy is a neurological disorder which affects nearly 1.5% of the world׳s total population. Trained physicians and neurologists visually scan the long-term electroencephalographic (EEG) records to identify epileptic seizures. It generally requires many hours to interpret the data. Therefore, tools for quick detection of seizures in long-term EEG records are very useful. This study proposes an algorithm to help detect seizures in long-term iEEG based on low computational costs methods using Spectral Power and Wavelet analysis. The detector was tested on 21 invasive intracranial EEG (iEEG) records. A sensitivity of 85.39% was achieved. The results indicate that the proposed method detects epileptic seizures in long-term iEEG records successfully. Moreover, the algorithm does not require long processing time due to its simplicity. This feature will allow significant time reduction of the visual inspection of iEEG records performed by the specialists.
               

@&#INTRODUCTION@&#

Epilepsy is a neurological disorder that affects people of all ages all over the world [1]. This disorder is characterized by recurrent seizures, which are clinical manifestations of sudden and brief electrical shocks of a group of brain cells. Different brain areas may be the source of these seizures. Approximately, 0.5–1.5% of the world׳s population suffers from epilepsy [2].

Electroencephalography (EEG) is the standard procedure to record electrical brain activity in patients with neuro-pathologies. The rhythmic activity of EEG signals is typically characterized by frequency bands, such as: Delta (δ; 0.5–4Hz), Theta (θ; 4–8Hz), Alpha (α; 8–12Hz), Beta (β; 12–30Hz) and Gamma (γ;>30Hz) [3]. When epileptic activity begins, synchronized and abnormal electrical activities in small areas of the brain are observed [3]. Consequently, this process is reflected in the EEG record and characterized as a seizure.

Surgery is often prescribed for refractory epilepsy where patients have high chances to reduce the amount of seizures. The typical procedure for these patients is hospitalization due to the necessary evaluation of localization and main source of seizure. The pre-surgical procedure consists in placing an intracranial grid of electrodes on the suspected epileptogenic zone to record the brain activity during the seizures. This recording practice usually lasts between 24 to 72h obtaining EEG records to be analyzed. Medical specialists and neurologists visually scan the EEG records looking for epileptic seizures to identify the epileptogenic zone to be removed. This visual inspection has some negative effects, is quite complex, highly time consuming and, more often than not, it leads to disagreement between the physicians. Taking into account that some patients have intracranial grids in the brain it is vital to diagnose due to the risk of infections or even death. Once these steps are completed, the source resection surgery can be performed. Therefore, it is necessary to improve the exactitude often diagnostic stage and expedite the procedure.

In order to provide clinical tools to contribute to more accurate diagnosis, several EEG signal processing algorithms have been developed. Some recent studies perform the analysis for single-channel EEG signals [4,5] while others carry out a multichannel analysis evaluating the synchronization between the EEG channels [6]. These detection methods are based on different features calculated from time and frequency domains [7,8]. Time domain features are usually combined with other parameters in seizure detection algorithms. The relative average amplitude, the relative average duration and the coefficient of variation of the amplitude were implemented in a commercial seizure detection monitor [9,10]. The Welch method and the Short Time Fourier Transform (STFT) are commonly used to estimate the power spectrum of a time sequence in EEG [11,12]. Some common features extracted from the frequency domain are maximum power [12,13]; the central, mean and peak frequencies [14] and the dominant frequency [7]. Besides, time-frequency (T-F) analysis has been used to calculate energy distribution in the T-F plane [14–16]. In the post, feature extraction by Principal Component Analysis (PCA) was done by De Lucia et al. [17], and Acharya et al. [18]. On the other hand, wavelet features [19–23] and chaotic features such as entropies [5,24] were also used. Generally, those authors performed combination of two or more techniques. Then, they test the same set of features with more than one classifier [25–27].

The Empirical Mode Decomposition (EMD) is another method used for epileptic seizure detection [14,19,28,29] but EMD has a high computational cost and requires excessive processing time.

The present work presents an automatic algorithm that is capable of detecting segments with epileptic seizures in long term iEEG records. The proposed method is based on the relative energy of the iEEG bands extracted from the power spectrum and the wavelet decomposition of such iEEG bands. Specifically, the relative energies of the iEEG bands (Theta, Alpha and Beta) are used to detect the seizure and, then the wavelet decomposition is used to obtain the time position of the seizure in the iEEG record.

The proposed algorithm is simpler than other related algorithms and achieves similar or even better performances. Hence, this algorithm could be used to facilitate the work of physicians in analyzing long-term iEEG records and it can be implemented on a personal computer since the methods used require low computational cost.

The iEEG database was recorded during invasive pre-surgical epilepsy monitoring at the Epilepsy Center of the University Hospital of Freiburg [30]. The iEEG database contains invasive EEG recordings of 21 patients (13M, 8F, age=29.9±11.9 years) suffering from medically intractable focal epilepsy. In nine patients the source of epilepsy was located in the temporal lobe; another six suffered from frontal focal epilepsy and one of parietal epilepsy. The other five patients had two different epileptic sources, three with temporo-occipital epilepsy and two with fronto-temporal and temporo-parietal each. There are 196 iEEG segments available in the database (only 89 of them with epileptic seizures). In order to obtain a high signal-to-noise ratio, fewer artifacts, and to record directly from focal areas, intracranial grid-, strip- and depth-electrodes were used. The iEEG data were acquired using a Neurofile NT digital video EEG system with 128 channels, 256Hz sampling rate, and a 16 bits A/D converter. Notch or band pass filters have not been applied in the acquisition stage.

The iEEG recordings were divided into segments of 1h. The 89 iEEG segments that have epileptic seizure contain only one seizure per segment. The available data only include six intracranial EEG channels. This database contains annotations done by trained experts of the starting and ending times of the seizures.

@&#METHODS@&#

The proposed method is designed to detect epileptic seizure in long-term iEEG records acquired in pre-surgery studies. It is based on the estimation and average of energies from β, α and θ bands. The proposed algorithm consists of three main blocks (
                     Fig. 1). The first block shows the preprocessing of the iEEG signal, the second block presents the seizure detection and onset/offset time points of the seizure are computed in the third block. A description of each block is presented:

The iEEG signals were band-pass filtered with a bi-directional Butterworth second order filter with a bandwidth between 0.5 and 60Hz.This bandwidth contained the useful information to detect the epileptic seizure in iEEG [31]. The line frequency interference was removed with a 50Hz notch filter.

The epileptic seizure detection was performed in three steps. They are described in the following sections.

The power spectral density of each iEEG channel was estimated by means of the Welch periodogram. It was implemented using a 1s (256 samples) Hamming window and 50% overlapping.

Then, the relative power of theθ (4–8Hz),α (8–12Hz) and β (12–30Hz) bands were computed using the following expression. Let S(f) be the value of the periodogram at frequency f (in Hz), then the relative power of Theta (P
                           
                              θ
                           ), Alpha (P
                           
                              α
                           ) and Beta (P
                           
                              β
                           ) bands are:
                              
                                 (1)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          θ
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                f
                                                =
                                                4
                                             
                                             8
                                          
                                          
                                             s
                                             (
                                             f
                                             )
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    ;
                                    
                                    
                                       
                                          p
                                       
                                       
                                          α
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                f
                                                =
                                                8
                                             
                                             
                                                12
                                             
                                          
                                          
                                             s
                                             (
                                             f
                                             )
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    ;
                                    
                                    
                                       
                                          P
                                       
                                       
                                          β
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                f
                                                =
                                                12
                                             
                                             
                                                30
                                             
                                          
                                          
                                             s
                                             (
                                             f
                                             )
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                              
                           Where P
                           
                              T
                            is the total power of the iEEG. It is calculated as:
                              
                                 (2)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          f
                                          =
                                          0.5
                                       
                                       
                                          60
                                       
                                    
                                    
                                       S
                                       (
                                       f
                                       )
                                    
                                 
                              
                           
                        

Then, for each iEEG channel, three series (P
                           
                              θ
                           
                           (n), P
                           
                              α
                           
                           (n) and P
                           
                              β
                           
                           (n)) were obtained, one per each relative power (P
                           
                              θ
                           , P
                           α and P
                           
                              β
                           , respectively). These series describe the variations of P
                           
                              θ
                           , P
                           
                              α
                            and P
                           
                              β
                            across the records. Therefore, as six channels were considered, 18 series were obtained.


                           
                           Fig. 2 shows 9 series of the 18 obtained for channels #4, #5 and #6 for patient #14, segment #19. This segment has epileptic seizure.

First, smoothed versions of the 18 series were calculated using a moving median filter. It was implemented as a window of 30s (7680 samples) moved in steps of 1s (256 samples).

The derivative was estimated by the Newton׳s difference quotient. It is a simple two-point estimation of the slope by a nearby secant line through these points. The derivatives of the time-series (P
                           
                              θ
                           
                           (n), P
                           
                              α
                           
                           (n) and P
                           
                              β
                           
                           (n)) were performed in order to emphasize their changes. They were calculated as [32]:
                              
                                 (3)
                                 
                                    
                                       
                                          
                                             P
                                             
                                                
                                                   ′
                                                
                                                
                                                   θ
                                                
                                             
                                             (
                                             n
                                             )
                                             ≈
                                             
                                                
                                                   P
                                                
                                                
                                                   θ
                                                
                                             
                                             (
                                             n
                                             +
                                             1
                                             )
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   θ
                                                
                                             
                                             (
                                             n
                                             )
                                             ;
                                          
                                       
                                       
                                          
                                             P
                                             
                                                
                                                   ′
                                                
                                                
                                                   α
                                                
                                             
                                             (
                                             n
                                             )
                                             ≈
                                             
                                                
                                                   P
                                                
                                                
                                                   α
                                                
                                             
                                             (
                                             n
                                             +
                                             1
                                             )
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   α
                                                
                                             
                                             (
                                             n
                                             )
                                             ;
                                          
                                       
                                       
                                          
                                             P
                                             
                                                
                                                   ′
                                                
                                                
                                                   β
                                                
                                             
                                             (
                                             n
                                             )
                                             ≈
                                             
                                                
                                                   P
                                                
                                                
                                                   β
                                                
                                             
                                             (
                                             n
                                             +
                                             1
                                             )
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   β
                                                
                                             
                                             (
                                             n
                                             )
                                             ;
                                          
                                       
                                    
                                 
                              
                           Where, P’
                              θ
                           
                           (n), P’
                           
                              α
                           
                           (n) and P’
                           
                              β
                           
                           (n) are the derivatives per each channel (
                           Fig. 3).

Further, the 18 derived series (P’(n)) were summarized into one final series, which represented the seizure in only one series. The final series (FSE(n)) was obtained by absolute value of the average process of P’
                           
                              θ
                           
                           (n), P’
                           
                              α
                           
                           (n) and P’
                           
                              β
                           
                           (n) per each channel (ch), according to the following expression:
                              
                                 (4)
                                 
                                    F
                                    S
                                    E
                                    (
                                    n
                                    )
                                    =
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      c
                                                      h
                                                      =
                                                      1
                                                   
                                                   6
                                                
                                                
                                                   P
                                                   
                                                      
                                                         ′
                                                      
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   n
                                                   )
                                                   +
                                                   
                                                      ∑
                                                      
                                                         c
                                                         h
                                                         =
                                                         1
                                                      
                                                      6
                                                   
                                                   
                                                      P
                                                      
                                                         
                                                            ′
                                                         
                                                         
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      n
                                                      )
                                                      +
                                                      
                                                         ∑
                                                         
                                                            c
                                                            h
                                                            =
                                                            1
                                                         
                                                         6
                                                      
                                                      
                                                         
                                                            
                                                               P
                                                               ′
                                                            
                                                            
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         n
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                18
                                             
                                          
                                       
                                       |
                                    
                                 
                              
                           
                        

The epileptic seizure was observed almost simultaneously in every channel and, in the FSE(n) the seizure is represented as a power increase. Moreover, the rest of the electrical brain activity is not identical in every channel and thus, it is canceled or reduced on the average process. This average process has been used in electrocardiographic signals to emphasize events in the QRS complex [33].

In order to smooth very short duration electrical activity, the FSE(n) is re-filtered with a moving median filter of 30s (7680 samples).In 
                           Fig. 4 the final time series obtained from the data base for one patient can be observed.

In this stage two thresholds were used, both were evaluated over the FSE(n) (eq. (4)).One threshold evaluated the power of the seizure and the other one evaluated the duration of the seizure. Hence, a seizure is detected when FSE(n) exceeds both thresholds. The first threshold was determined as three times the average power of the FSE(n). It was empirically estimated in order to obtain the maximum values of sensitivity and specificity over the database. A ROC curve was performed with all tested threshold values (from 1 to 6, with and increment of 0.1). 
                           Fig. 5 shows some of the tested values as threshold.

The second threshold was defined as 30s (7680 samples), it was based on the typical duration of seizures (between 30s and 180s) [3].

Once a seizure was detected, the onset and offset time points of the epileptic seizure were traced. Therefore, these points are traced on a window beginning 30s (7680 samples) before and finishing 30s after of the previous seizure detection (time points where the threshold was exceeded). The detection procedure was based on the integration of the power of the Beta, Alpha and Theta rhythms obtained from the Wavelet decomposition. 
                        Fig. 6
                     

The Wavelet Transform (WT) allows the discrimination of non-stationary signals with different frequency features[34].The Daubechies 2 stationary WT was used to separate the 2s iEEG segments in five scales. Subasi demonstrated that Daubechies wavelet of 2nd order achieves better classification efficiency than some of the other common wavelets [19]. At the sampling rate of the database (256Hz), the frequency ranges of scales 3, 4 and 5 of the Wavelet decomposition were D3:16–32Hz; D4: 8–16Hz andD5: 4–8Hz. Note, these scales have approximately the same bandwidth of Beta, Alpha and Theta rhythms, respectively. Then, the energy of each one of these three scales were calculated as:
                              
                                 (5)
                                 
                                    I
                                    i
                                    E
                                    E
                                    
                                       
                                          G
                                       
                                       
                                          S
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       |
                                       
                                          
                                             
                                                d
                                             
                                             
                                                S
                                             
                                          
                                          (
                                          k
                                          )
                                       
                                       |
                                    
                                 
                              
                           Where, IiEEG
                           
                              S
                            is the energy of the S scale (S= 3, 4, 5); d
                           
                              S
                           
                           (k) are the wavelet coefficients of S scale obtained from decomposition of the iEEG segment and N is the total number of coefficients. The IiEEG
                           
                              S
                            is closely related to the energy of each brain rhythm (Beta, Alpha and Theta). The three IiEEG
                           
                              S
                            was calculated on the six iEEG channels.

First, a moving median filter was used to smooth the IiEEG
                           
                              S
                           
                           of each band. The filter was calculated using a window of 30s (7680 samples) duration, which was moved in steps of 1s (256 samples).

Then, a threshold was empirically determined as the double of the median value of the IiEEG
                           
                              S
                           . Hence, when the energy of the IiEEG
                           
                              S
                            exceeded this threshold an onset/offset point was set. In other words, the onset/offset point was determined as the intersection of the IiEEG
                           
                              S
                            with the threshold. Thus, 18 onset and offsettime points were obtained from the 18 IiEEG
                           
                              S
                           . Consequently, the definitive onset and offset time points were obtained by averaging those 18 onset and offset points.

@&#RESULTS@&#

The algorithm was tested on 196 iEEG segments of 1h duration each (89 segments with and 109 without epileptic seizures). These iEEG segments were extracted from the 21 patients with epilepsy in the Freiburg database.

A positive detection is reported when flagged by the algorithm, but all (the) detections within a 60s period are grouped so that continuous bursts of positive detections are not over represented [35].

The values of the results are shown in 
                     Table 1 for each patient of the database. The results are presented as: True Positive (TP: is reported when a positive detection occurs within the time marked as a seizure by human expert) [35], True Negative (TN: segments without epileptic seizure that the algorithm correctly recognizes), False Positive (FP: segments without epileptic seizure that the algorithm detects erroneously), False Negative (FN: segments with epileptic seizure that the algorithm does not detect). Note that the database contains only one seizure per iEEG segment. Then, the total number of segments TP+FP+TN+FN is 196, where TP+FN (76+13=89) represent the segments with epileptic seizures and TN+FP (89+18=107) represent the segments with no seizure. The algorithm detected 76 of 89 segments with seizure and 89 out of the 107 segments without epileptic seizure.

Additionally, some statistical parameters were calculated in order to determine the performance of the algorithm: False Detections (FD:FP+FN), sensitivity (SEN:TP/(TP+FN)), specificity (SPE:TN/(TN+FP)) and positive predictive value (PPV:TP/(TP+FP)),[36]. The results for each patient and the statistical parameters are shown in Table 1 along with other details as gender, age and epilepsy type.

The differences between the onset-offset time points calculated by the proposed algorithm and the ones provided by the database are: Onset point detection (24 +/− 14s) and Offset point detection (15 +/− 8s). In 
                     Table 2 the values of seizure onset and offset detection points are shown. For example, in Fig. 3a the onset and offset points marked by experts in an iEEG segment (Patient #14, segment #19 channel #1) are presented. In Fig. 3b the points obtained by the algorithm are presented as well. The difference between these points for patient #14 are 19s in the onset point and 3s in the offset point.

@&#DISCUSSION@&#

In this article we proposed an algorithm which is a clinical tool that helps experts achieve more accurate and faster diagnosis. Besides, the capability of the algorithm to correctly detect an epileptic seizure is measured by the SEN value; as well, the SPE value measures the proportion of negatives which are correctly identified as such. Therefore, it is essential to detect seizures with a high SEN, that is, the algorithm should detect all the seizures. However, a high SPE is not essential because the physician will reject any false detection. Note that low SPE will produce too much false detection and thus, more effort from the physician is required. The SEN of the method from 11 patients was 100%. These results demonstrate high accuracy for epileptic seizure detection since the average SEN and SPE for all patients was 85.39% and 83.17%, respectively. The average PPV of the method is 80.85%. In Table 1, from 87 segments with epileptic seizures, 76 were correctly identified by the algorithm. This method is based on the average process of multiple channels, thus the SEN would be higher if additional channels were available for analysis.

In epileptic detection research, interpretation of the performance depends on the application. Hence, the exact onset and offset point detection is important for a system designed to stop a seizure once it has started as in seizure prediction algorithms, but not indispensable for a clinical review of the iEEG. Varsavsky et al. proposed a detection strategy that deals with the ambiguity of onset/offset marks. They stated that a TP is reported when a positive detection occurs within 60s of the onset/offset marked as a seizure by a trained expert [35]. The marks of the proposed algorithm differ from the ones provided by the database in 24±14s (onset point) and 15±8s (offset point). For example, Fig. 3 shows the differences of 19s in the onset point and 3
                     s in the offset point between the database marks and the points detected by the algorithm. Therefore, the latency achieved in the present work is acceptable for seizure detection in visual inspection of iEEG records.

In the epileptic seizure detection area some researchers used the same database (FSPEEG) to extract features and classify iEEG segments [7,14,37–39], those results are presented in 
                     Table 3.The SEN obtained in those papers is lower than the 85.39% obtained in the current work, except for Raghuatham, et al.[37] and Zhang et al. [39]. The former, achieved a slightly higher SEN(87.5%), but they only evaluated five patients of the database. Zhang et al. tested the entire database, however, a higher computational cost methods was used. Moreover, Zhang et al. applied a different approach based on patient-specific seizure detection, that is, the method required previous training for each patient. The algorithm proposed in this article does not require any previous training.

The proposed algorithm detects the epileptic seizures with more sensitivity than other reviewed articles[7,14,37–39], evaluated over the same database.

Short-term EEG records are visually inspected by the physicians; however, long-term records required many hours for the visual inspection process. The method developed here is useful for long iEEG records, because it is a simple and quick algorithm. However, the specialist is still needed in order to validate the results. In this sense, the physician is required to pay attention only to those segments detected by the algorithm. Note that the purpose of the method is to facilitate the work of physicians in analyzing long-term iEEG records.

The proposed algorithm is self-tuned to each patient, that is, all parameters are adjusted at the beginning of the iEEG record for each patient. Therefore, the current algorithm can be evaluated in other databases and its performance should be suitable for clinical applications.

@&#CONCLUSIONS@&#

This article presents an automatic algorithm that is able to detect epileptic seizures in long-term iEEG records for clinical applications.

The proposed algorithm is based on simple and low computational costs methods. Therefore, it reduces the visual inspection time spent by physicians in pre-surgical studies analysis from hours to minutes.

The proposed algorithm uses thresholds instead of complex classifier such as neural networks, or support vector machines. Therefore, no training step is required because the threshold is calculated automatically from the records. Consequently, the proposed algorithm can be applied to new records that have not been previously presented to the algorithm. Additionally to its simplicity, the achieved performance is similar or superior compared to other related and more complex algorithms.

In summary, an iEEG signal processing algorithm has been developed in order to provide physicians with clinical tools that may help in achieving faster and more accurate diagnosis in pre-surgical studies.

None Declared.

@&#ACKNOWLEDGMENTS@&#

This work has been supported by grants from Consejo Nacional de Investigaciones Científicas y Técnicas (CONICET), Agencia Nacional de Promoción Científica y Técnológica (ANPCyT) and Universidad Nacional de San Juan (UNSJ), all institutions from Argentina.

The authors are extremely grateful to the Epilepsy Center of the University Hospital of Freiburg, Germany, for their permission to use the invasive EEG recordings in this work.

@&#REFERENCES@&#

