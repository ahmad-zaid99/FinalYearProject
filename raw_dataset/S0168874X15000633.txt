@&#MAIN-TITLE@&#A time increment control for return mapping algorithm applied to cyclic viscoplastic constitutive models

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Algorithms are proposed to control the time increment in viscoplastic FE analyses.


                        
                        
                           
                           Algorithms avoid important increase of time step during large viscoplastic evolutions.


                        
                        
                           
                           Control protocol enables an efficient computation of fatigue stress–strain loop.


                        
                        
                           
                           Control methods are positively tested for multi-axial and athermal loading conditions.


                        
                        
                           
                           Control algorithms are successfully tested for volume elements and structures.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Constitutive Model

Viscoplasticity

FEM Analysis

@&#ABSTRACT@&#


                  This paper proposes two algorithms for better controlling the size of time increment in case of return-mapping integration scheme for elasto-viscoplastic constitutive models. Computation errors in terms of local stress–strain loops in Finite Element Analyses could indeed have a very strong impact on fatigue lifetime estimation protocol if time increment size are freely chosen by the FE solver. Proposed algorithm enables both to precisely describe the transition between elasticity and viscoplasticity and to avoid too important increase of time step during large viscoplasticity evolutions. The precision of the computed mechanical answer has been successfully tested for different kinds of multi-axial and anisothermal loading conditions on simple finite element and more complex meshed structures. Fatigue lifetime estimation errors have also been investigated for stabilized stress–strain cycle and common criteria and the proposed algorithm show very precise results with a limited computation time increase and without drastic limitation of the time increment size.
               

@&#INTRODUCTION@&#

For the past ten years, most of automotive manufacturers have adopted strategies mixing engine downsizing and mass reduction to answer to new environmental regulations and to decrease both polluting emission and fuel consumption. Engine parts, such as cylinder heads, exhaust manifolds and engine blocks, have therefore experienced higher operating temperatures induced by the increase of the combustion fluxes. They are therefore particularly sensitive to the superposition of a severe thermal loading and strong mechanical constraints that leads to thermal–mechanical fatigue cracks initiation.

Thermal–mechanical fatigue (TMF) design requires not only a good knowledge of the loading and boundary conditions [1,2] or of the thermal and mechanical environment of the studied structures but also advanced constitutive models which enable to precisely describe materials elasto-viscoplastic behaviors [3]. These models have to cope with various variable loading conditions and to describe complex anisothermal evolutions [4]. Consequently a higher level of sophistication and a greater number of parameters are often required to adequately represent the response induced by thermal–mechnanical loadings. In the framework of small perturbations and for metallic materials, lots of efforts have therefore been made to correctly describe the behavior of classic automotive alloys such as aluminiums, cast-irons or stainless steels with models taking into account ageing effects, stresses recovery or complex viscous behavior [5–9]. Moreover, the development of representative fatigue criterion remains an important research field as it constitutes the final step of a performant design process. Recent advances have been made by taking into account mean-stress effects [10,11] or by exploring the statistical influence of the microstructure [12].

The use of all of these models is standardly based on a Finite Element description of thermal–mechanical problems. Complex constitutive models must most of the time be integrated into commercial computation code as Abaqus in order to facilitate fatigue design operations within industrial engineering offices. The related evolution problem has received much attention mostly between the late seventies and the eighties, resulting in significant advances in the integration schemes [13–18]. For practical industrial applications and in the case of viscoplasticity, return mapping algorithms represent a very common scheme to integrate the rate constitutive equations [13, 19–23]. In this process, associated with a Newton iterative procedure, an elastic predictor is first estimated before being corrected onto a suitably updated yield surface. In order to obtain a quadratic rate of convergence, a consistent tangent operator [14,16,24] must also be used. Even if this class of algorithms has proven its numerical performance [25,2], it appears to be sensitive to the size of the chosen time increment. Others proposals such as substepping algorithms [26] have proved to be more accurate for large time increments but no relevant solution is proposed in the literature to efficiently control the increment size within the framework of radial return algorithm.

This paper proposes two algorithms for controlling the time step and thus better control both the calculated stress–strain loop for elasto-viscoplastic constitutive models [27] in the case of anisothermal thermomechanical loads and with a good compromise between CPU time and reliability of results. Drifts in terms of mechanical behavior are evaluated for different types of multiaxial loadings first on an volumic finite element and then a more complex structure. Constitutive models are developed for design of structures against thermomechanical fatigue and errors in terms of dissipated energy density, a commonly used indicator to assess the damage associated with this type of fatigue, are also estimated. The contribution of the proposed algorithms in terms of accuracy and computation time savings is finally considered in comparison with an excessive limitation of the time increment.

In order to describe the behavior of metallic body-centered cubic alloy over a wide range of strain, strain rate and temperature, a constitutive model was proposed by Szmytka et al. [27]. This model is here taken as reference for the proposed algorithms which can easily be extended to other constitutive laws. Basic assumptions are small strains, isotropic elastic-viscoplastic behavior and unified elastic-viscoplasticity thermodynamic framework. Consequently, the total strain tensor is divided additively into elastic, inelastic and and thermal parts,
                        
                           (1)
                           
                              
                                 
                                    ε
                                    ̲
                                 
                                 ̲
                              
                              =
                              
                                 
                                    
                                       
                                          ε
                                          ̲
                                       
                                       ̲
                                    
                                 
                                 e
                              
                              +
                              
                                 
                                    
                                       
                                          ε
                                          ̲
                                       
                                       ̲
                                    
                                 
                                 
                                    i
                                    n
                                    e
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          ε
                                          ̲
                                       
                                       ̲
                                    
                                 
                                 
                                    t
                                    h
                                 
                              
                           
                        
                     
                  

The thermal strain is 
                        
                           
                              
                                 
                                    ε
                                    ̲
                                 
                                 ̲
                              
                           
                           
                              t
                              h
                           
                        
                        =
                        
                           
                              α
                           
                           
                              T
                           
                        
                        
                           (
                           
                              T
                              −
                              
                                 
                                    T
                                 
                                 
                                    r
                                    e
                                    f
                                 
                              
                           
                           )
                        
                        
                           
                              1
                              ̲
                           
                           ̲
                        
                     , while the elastic strain is given by Hooke׳s law,
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          ε
                                          ̲
                                       
                                       ̲
                                    
                                 
                                 e
                              
                              =
                              
                                 
                                    ℂ
                                 
                                 
                                    −
                                    1
                                 
                              
                              :
                              
                                 
                                    σ
                                    ̲
                                 
                                 ̲
                              
                           
                        
                     where T is the temperature, 
                        
                           
                              T
                           
                           
                              r
                              e
                              f
                           
                        
                      is the reference temperature, 
                        
                           
                              σ
                              ̲
                           
                           ̲
                        
                      is the stress tensor. 
                        
                           
                              α
                           
                           
                              T
                           
                        
                      is the thermal expansion coefficient and 
                        ℂ
                      is the fourth-order elastic tensor. In our isotropic case, 
                        ℂ
                        =
                        λ
                        
                           
                              1
                              ̲
                           
                           ̲
                        
                        ⊗
                        
                           
                              1
                              ̲
                           
                           ̲
                        
                        +
                        2
                        μ
                        I
                     , with λ and μ are the Lamé constants dependent of the temperature. 
                        
                           
                              1
                              ̲
                           
                           ̲
                        
                      and I are respectively the second and the fourth order unit tensors. A viscoplastic equation with back stress is used to describe the evolution of the viscoplastic strain tensor,
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             ε
                                             ̲
                                          
                                          ̲
                                       
                                       ̇
                                    
                                 
                                 
                                    vp
                                 
                              
                              =
                              
                                 3
                                 2
                              
                              
                                 p
                                 ̇
                              
                              
                                 
                                    
                                       
                                          s
                                          ̲
                                       
                                       ̲
                                    
                                    −
                                    
                                       
                                          X
                                          ̲
                                       
                                       ̲
                                    
                                 
                                 
                                    
                                       
                                          J
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          s
                                          ̲
                                       
                                       ̲
                                    
                                    −
                                    
                                       
                                          X
                                          ̲
                                       
                                       ̲
                                    
                                    )
                                 
                              
                           
                        
                     where ( ) denotes the differentiation with respect to time, 
                        
                           
                              s
                              ̲
                           
                           ̲
                        
                      is the deviator of the stress tensor 
                        
                           
                              σ
                              ̲
                           
                           ̲
                        
                      and 
                        
                           
                              X
                              ̲
                           
                           ̲
                        
                      is the back stress tensor. 
                        
                           
                              J
                           
                           
                              2
                           
                        
                        (
                        
                           
                              s
                              ̲
                           
                           ̲
                        
                        −
                        
                           
                              X
                              ̲
                           
                           ̲
                        
                        )
                      is the second invariant of the tensor 
                        
                           
                              s
                              ̲
                           
                           ̲
                        
                        −
                        
                           
                              X
                              ̲
                           
                           ̲
                        
                      and is defined by using (:) as the inner product between second rank tensors,
                        
                           (4)
                           
                              
                                 
                                    J
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    s
                                    ̲
                                 
                                 ̲
                              
                              −
                              
                                 
                                    X
                                    ̲
                                 
                                 ̲
                              
                              )
                              =
                              
                                 
                                    
                                       3
                                       2
                                    
                                    (
                                    
                                       
                                          s
                                          ̲
                                       
                                       ̲
                                    
                                    −
                                    
                                       
                                          X
                                          ̲
                                       
                                       ̲
                                    
                                    )
                                    :
                                    (
                                    
                                       
                                          s
                                          ̲
                                       
                                       ̲
                                    
                                    −
                                    
                                       
                                          X
                                          ̲
                                       
                                       ̲
                                    
                                    )
                                 
                              
                           
                        
                     while 
                        
                           p
                           ̇
                        
                      is the accumulated viscoplastic strain or viscoplastic multiplier. Its evolution, represented by a flow rule, follows the rule proposed by [27]
                     
                        
                           (5)
                           
                              
                                 p
                                 ̇
                              
                              =
                              
                                 
                                    
                                       ε
                                       ̇
                                    
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 
                                    1
                                    +
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   f
                                                   (
                                                   
                                                      
                                                         s
                                                         ̲
                                                      
                                                      ̲
                                                   
                                                   −
                                                   
                                                      
                                                         X
                                                         ̲
                                                      
                                                      ̲
                                                   
                                                   ,
                                                   R
                                                   )
                                                
                                                H
                                             
                                          
                                          )
                                       
                                       2
                                    
                                 
                                 )
                              
                              sinh
                              
                              
                                 
                                    [
                                    
                                       
                                          
                                             f
                                             (
                                             
                                                
                                                   s
                                                   ̲
                                                
                                                ̲
                                             
                                             −
                                             
                                                
                                                   X
                                                   ̲
                                                
                                                ̲
                                             
                                             ,
                                             R
                                             )
                                          
                                          K
                                       
                                    
                                    ]
                                 
                                 
                                    +
                                 
                              
                              
                                 (
                                 
                                    1
                                    −
                                    exp
                                    
                                       
                                          [
                                          
                                             −
                                             
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            f
                                                            (
                                                            
                                                               
                                                                  s
                                                                  ̲
                                                               
                                                               ̲
                                                            
                                                            −
                                                            
                                                               
                                                                  X
                                                                  ̲
                                                               
                                                               ̲
                                                            
                                                            ,
                                                            R
                                                            )
                                                         
                                                         
                                                            β
                                                            R
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   +
                                                
                                             
                                          
                                          ]
                                       
                                       m
                                    
                                 
                                 )
                              
                           
                        
                     where 
                        
                           
                              
                                 ε
                                 ̇
                              
                           
                           
                              0
                           
                        
                     , H, K, m, β are temperature dependent parameters; 
                        
                           
                              [
                              .
                              ]
                           
                           
                              +
                           
                        
                      indicates the positive part. The yield function f is defined as
                        
                           (6)
                           
                              f
                              (
                              
                                 
                                    s
                                    ̲
                                 
                                 ̲
                              
                              −
                              
                                 
                                    X
                                    ̲
                                 
                                 ̲
                              
                              ,
                              R
                              )
                              =
                              
                                 
                                    J
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    s
                                    ̲
                                 
                                 ̲
                              
                              −
                              
                                 
                                    X
                                    ̲
                                 
                                 ̲
                              
                              )
                              −
                              R
                           
                        
                     
                  


                     R is the isotropic hardening term, and is considered here as following a conventional non-linear rule [28]:
                        
                           (7)
                           
                              R
                              =
                              
                                 
                                    R
                                 
                                 
                                    0
                                 
                              
                              +
                              Q
                              
                                 (
                                 
                                    1
                                    −
                                    exp
                                    (
                                    −
                                    b
                                    p
                                    )
                                 
                                 )
                              
                           
                        
                     where 
                        
                           
                              R
                           
                           
                              0
                           
                        
                     , Q and b are the three temperature-dependant parameters. Finally, for the evolution of the kinematic hardening term 
                        
                           
                              X
                              ̲
                           
                           ̲
                        
                     , the conventional non-linear Armstrong and Frederick׳s law is adopted [28],
                        
                           (8)
                           
                              
                                 
                                    X
                                    ̲
                                 
                                 ̲
                              
                              =
                              
                                 
                                    2
                                    C
                                 
                                 3
                              
                              
                                 
                                    α
                                    ̲
                                 
                                 ̲
                              
                              =
                              C
                              
                                 (
                                 
                                    
                                       2
                                       3
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ε
                                                   ̲
                                                
                                                ̲
                                             
                                             ̇
                                          
                                       
                                       
                                          i
                                          n
                                          e
                                       
                                    
                                    −
                                    
                                       D
                                       C
                                    
                                    
                                       
                                          X
                                          ̲
                                       
                                       ̲
                                    
                                    
                                       p
                                       ̇
                                    
                                 
                                 )
                              
                           
                        
                     where C and D are two material parameters. The constitutive model was shown in [27] to accurately reproduce the behavior of spheroidal graphite cast iron.

The solution of non-linear evolution problems such as cyclic viscoplasticity is performed, during implicit finite element analysis, over discrete sequence of time steps [25]. For each time step, predictor-corrector algorithms are used. In fact, the return mapping algorithm uses an operator split approach and an iterative Newton procedure consisting in solutions of global linear problem (elastic prediction) followed by local integrations of the constitutive model (plastic correction). A fully implicit integration scheme (backward Euler) associated with a radial return is adopted by Szmytka et al. [2] to successfully perform the numerical integration of the previous law in a material behavior user subroutine UMAT which is written and used in the commercial software Abaqus.

The main assumption of this scheme is that the viscoplastic strains evolution over the increment can be calculated from the stress state at the end of the increment. This is however theoretically incorrect as the viscoplastic response and in particular the viscoplastic flow direction is a function of the current stress state corrected by the kinematic hardening term. If the viscoplastic flow direction does not change over an increment, the return algorithm solutions will be accurate. However, although the time step is fixed sufficiently small to avoid viscoplastic direction variations, standard commercial finite element software tend to steadily increase it if convergence of the overall mechanical problem required only few iterations, introducing computations errors.

In fact, if one considers the evolution of the accumulated viscoplastic strain over a time step between 
                        
                           
                              t
                           
                           
                              n
                           
                        
                      and 
                        
                           
                              t
                           
                           
                              n
                              +
                              1
                           
                        
                     :
                        
                           (9)
                           
                              Δ
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              =
                              
                                 ∫
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                                 p
                                 ̇
                              
                              (
                              u
                              )
                              d
                              u
                           
                        
                     the flow rule, as a continuous fonction of time, becomes
                        
                           (10)
                           
                              Δ
                              
                                 
                                    
                                       
                                          ε
                                          ̲
                                       
                                       ̲
                                    
                                 
                                 
                                    v
                                    p
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ε
                                          ̲
                                       
                                       ̲
                                    
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    v
                                    p
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          ε
                                          ̲
                                       
                                       ̲
                                    
                                 
                                 
                                    n
                                 
                                 
                                    v
                                    p
                                 
                              
                              =
                              
                                 ∫
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ε
                                             ̲
                                          
                                          ̲
                                       
                                    
                                    
                                       v
                                       p
                                    
                                 
                              
                              (
                              u
                              )
                              d
                              u
                              =
                              
                                 3
                                 2
                              
                              
                                 ∫
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                                 p
                                 ̇
                              
                              =
                              (
                              u
                              )
                              
                                 
                                    
                                       
                                          s
                                          ̲
                                       
                                       ̲
                                    
                                    (
                                    u
                                    )
                                    −
                                    
                                       
                                          X
                                          ̲
                                       
                                       ̲
                                    
                                    (
                                    u
                                    )
                                 
                                 
                                    
                                       
                                          J
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          s
                                          ̲
                                       
                                       ̲
                                    
                                    (
                                    u
                                    )
                                    −
                                    
                                       
                                          X
                                          ̲
                                       
                                       ̲
                                    
                                    (
                                    u
                                    )
                                    )
                                 
                              
                              d
                              u
                           
                        
                     
                     
                        
                           (11)
                           
                              =
                              
                                 3
                                 2
                              
                              
                                 ∫
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                                 p
                                 ̇
                              
                              (
                              u
                              )
                              
                                 
                                    N
                                    ̲
                                 
                                 ̲
                              
                              (
                              u
                              )
                              d
                              u
                           
                        
                     where 
                        
                           
                              N
                              ̲
                           
                           ̲
                        
                        (
                        u
                        )
                     is the tensor normal to the convex surface of visoplasticity. If 
                        
                           
                              N
                              ̲
                           
                           ̲
                        
                        (
                        u
                        )
                      does not vary over 
                        [
                        
                           
                              t
                           
                           
                              n
                           
                        
                        ;
                        
                           
                              t
                           
                           
                              n
                              +
                              1
                           
                        
                        ]
                     , the integration scheme is perfectly accurate and no error are introduced. However, if 
                        
                           
                              N
                              ̲
                           
                           ̲
                        
                        (
                        u
                        )
                      varies during the time increment, there is a difference between the continuous definition of 
                        Δ
                        
                           
                              
                                 
                                    ε
                                    ̲
                                 
                                 ̲
                              
                           
                           
                              i
                              n
                              e
                           
                        
                      and its discrete value 
                        Δ
                        
                           
                              
                                 
                                    ε
                                    ̲
                                 
                                 ̲
                              
                           
                           
                              i
                              n
                              e
                           
                        
                        =
                        Δ
                        
                           
                              p
                           
                           
                              n
                           
                        
                        
                           3
                           2
                        
                        
                           
                              N
                              ̲
                           
                           ̲
                        
                        (
                        
                           
                              t
                           
                           
                              n
                              +
                              1
                           
                        
                        )
                     , which leads to an integration error 
                        
                           e
                           ˜
                        
                     :
                        
                           (12)
                           
                              
                                 e
                                 ˜
                              
                              =
                              
                                 3
                                 2
                              
                              
                                 ∫
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                                 p
                                 ̇
                              
                              (
                              u
                              )
                              
                                 [
                                 
                                    
                                       
                                          N
                                          ̲
                                       
                                       ̲
                                    
                                    (
                                    u
                                    )
                                    −
                                    
                                       
                                          N
                                          ̲
                                       
                                       ̲
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 ]
                              
                              d
                              u
                           
                        
                     
                  

It is then necessary to observe and quantify the errors produced by this integration scheme for various loads and for different time increments as performed for example by [29,30] using the concept of iso-error maps. While the tested constitutive model is often used for thermal–mechanical fatigue design, errors in terms of dissipated energy density will also be investigated with the analyses of the variable 
                        Δ
                        W
                     :
                        
                           (13)
                           
                              Δ
                              W
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    l
                                    o
                                    d
                                    i
                                    n
                                    g
                                    
                                    c
                                    y
                                    c
                                    l
                                    e
                                 
                              
                              
                                 
                                    σ
                                    ̲
                                 
                                 ̲
                              
                              :
                              
                                 
                                    ε
                                    ̲
                                 
                                 ̲
                              
                           
                        
                     
                  

In order to estimate errors induced by the integration scheme proposed by [2], several finite element simulations are performed on a single 10-node quadratic tetrahedric element (C3D10 in Abaqus). These calculations on a Representative Elementary Volume (REV) are identical to those that could be achieved on a test laboratory specimen with a gauge area presenting a homogeneous behavior. Using a single element, only the discrepancies related to the integration scheme are therefore observed.

Isothermal computations are performed for a SG SiMo cast-iron at 500°C. Model parameters are summed up in 
                     Table 1 while model accuracy is detailed in [27].

To measure differences in mechanical responses related to the time step, calculations are performed in Abaqus first with a time step evolution left free. Thus, the parameters controlling the way time increment size increases or decreases are those that are considered standard by the FE solver:
                        
                           •
                           If the solution has not converged after 16 iterations of the Modified Newton–Raphson algorithm or if the evolution of the residual force vector seems to diverge, the time increment is automatically multiplied by 0.25. This modification can be repeated 5 times in a row after which, in the absence of convergence, the computation stops.

If, for two consecutive time increments, there is a solution convergence in less than 5 iterations, the size of the next time increment is automatically increased by 50%.

The initial size of the time increment is requested by the FE solver. In the following, it is arbitrarily set for all computations to 0.2s. This first computation (with the time increment evolution set free without any limitation) is considered as our reference. Thereafter, a maximum time increment size is included as control parameter in the simulation. This maximum time increment is first set to 5s. This value is then decreased until obtaining a convergence of the numerical solution, i.e. it no longer evolves even though time step size keeps decreasing. Differences in terms of mechanical stress strain loops, dissipated energy densities and CPU time are finally investigated, first for 4 types of cyclic loading:
                        
                           •
                           In 
                              Fig. 1a, an uniaxial tension–compression test with 
                                 
                                    
                                       R
                                    
                                    
                                       σ
                                    
                                 
                                 =
                                 −
                                 1
                               and 
                                 
                                    
                                       σ
                                    
                                    
                                       11
                                       ,
                                       m
                                       a
                                       x
                                    
                                 
                                 =
                                 350
                                 
                                 MPa
                              .

In Fig. 1b, an in-phase biaxial tension–compression test with 
                                 
                                    
                                       R
                                    
                                    
                                       σ
                                    
                                 
                                 =
                                 −
                                 1
                               and 
                                 
                                    
                                       σ
                                    
                                    
                                       
                                       v
                                       o
                                       n
                                       
                                       
                                       M
                                       i
                                       s
                                       e
                                       s
                                       
                                       ,
                                       m
                                       a
                                       x
                                    
                                 
                                 =
                                 210
                                 
                                 MPa
                              .

In Fig. 1c, a pure shear test with 
                                 
                                    
                                       R
                                    
                                    
                                       σ
                                    
                                 
                                 =
                                 −
                                 1
                               and 
                                 
                                    
                                       σ
                                    
                                    
                                       12
                                       ,
                                       m
                                       a
                                       x
                                    
                                 
                                 =
                                 125
                                 
                                 MPa
                              .

In Fig. 1d, an out-of-phase thermal–mechanical test where temperature varies between 500°C and 750°C while mechanical strain 
                                 
                                    
                                       ε
                                    
                                    
                                       11
                                    
                                 
                               varies between 1% and 0%.

Each loading is repeated until a viscoplastic shakedown which occurs after 3 cycles.

A thermal–mechanical test is also performed on a “real” complex structure and not only a REV in order to estimate the influence of the time step during complex loading implying thermal and stress gradients. The experimental set-up described by Constantinescu et al. [1] is therefore used as it deals with very severe thermo-mechanical loadings. In this experimental protocol, axial symmetric clamped specimens are heated by the Joule effect. The heating procedure produces a thermal gradient along the specimen axis, which also induces a variation of the mechanical fields in the same direction. This experimental machine is presented in 
                     Fig. 2.

Temperatures vary between 40°C and 700°C with a heating rate of 20°Cs−1. The maximum temperature is obtained in a region of approximately 10mm in the center of the specimen with a maximum temperature gradient of 40°Cmm. The clamp value due to the variable stiffness (proportional to the flexural moment of the beams) is here fixed at 183,000N/mm and the dwell time at 700°C at 60s. The thermal load of this experiment was numerically estimated by an electric and a thermal FEM computation on Abaqus. The results of the thermal-electrical computation is then introduced in a mechanichal computation. The FE model is here constituted of 43,934 nodes and 28,805 C3D10 10-node quadratic tetrahedric elements.

As the limitation of the time increment is clearly incompatible with achieving fast computation time, two simple algorithms are proposed to complete the integration scheme of the constitutive model and to control the evolution of the time increment size. The goal is to have a free evolution when the behavior shows little or no non-linearity and to automatically reduce the size of the increment and keep it low for evolutions involving strong viscoplasticity. In the following, n and 
                        n
                        +
                        1
                      index represent a value of a variable (tensor or scalar) at respectively 
                        
                           
                              t
                           
                           
                              n
                           
                        
                      and 
                        
                           
                              t
                           
                           
                              n
                              +
                              1
                           
                        
                     .

If a cyclic finite element computation shows long elastic phases (several seconds or stress ranges greater than 100MPa which is for instance very common at low temperature for steels or cast-irons), FE solvers usually tends to significantly and logically increase time increments as convergence is easy. This computing strategy involves sometimes long time increments when first non-linearities (plasticity) related to the material behavior occur. There is therefore a tendency to misjudge the elastic/viscoplastic transition and to generate errors that can later increase. Linear elastic analysis can indeed be performed in a single step provided you exactly know the length of this step, which is possible for a single finite element but never the case for structures under complex loading like thermal–mechanical ones. In this case, complex thermal loadings are combined with strong mechanical constraints and the local mechanical response is therefore the result of the combination of several factors such as thermal gradient, mechanical constraints, local geometry, etc. In this case, it is fairly impossible to a priori estimate the time and the localization of the first element reaching the yield surface. The integration scheme proposed by [2] begins with an assumption of elastic evolution of the structure for the time step; the internal variables 
                           (
                           
                              
                                 
                                    
                                       ε
                                       ̲
                                    
                                    ̲
                                 
                              
                              
                                 n
                              
                              
                                 v
                                 p
                              
                           
                           ,
                           
                              
                                 
                                    
                                       α
                                       ̲
                                    
                                    ̲
                                 
                              
                              
                                 n
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 n
                              
                           
                           )
                         are frozen. Thus at time 
                           
                              
                                 t
                              
                              
                                 n
                                 +
                                 1
                              
                           
                        , the hardening parameter R is given by
                           
                              (14)
                              
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             0
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       Q
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       1
                                       −
                                       exp
                                       (
                                       −
                                       
                                          
                                             b
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    )
                                 
                              
                           
                        and the stress tensor by
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             σ
                                             ̲
                                          
                                          ̲
                                       
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             σ
                                             ̲
                                          
                                          ̲
                                       
                                    
                                    
                                       n
                                    
                                 
                                 +
                                 Δ
                                 
                                    
                                       
                                          
                                             σ
                                             ̲
                                          
                                          ̲
                                       
                                    
                                    
                                       e
                                       l
                                       a
                                       s
                                       t
                                       i
                                       c
                                    
                                 
                              
                           
                        with
                           
                              (16)
                              
                                 Δ
                                 
                                    
                                       
                                          
                                             σ
                                             ̲
                                          
                                          ̲
                                       
                                    
                                    
                                       e
                                       l
                                       a
                                       s
                                       t
                                       i
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 :
                                 Δ
                                 
                                    
                                       ε
                                       ̲
                                    
                                    ̲
                                 
                                 +
                                 Δ
                                 C
                                 :
                                 (
                                 
                                    
                                       
                                          
                                             ε
                                             ̲
                                          
                                          ̲
                                       
                                    
                                    
                                       n
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             ε
                                             ̲
                                          
                                          ̲
                                       
                                    
                                    
                                       n
                                    
                                    
                                       i
                                       n
                                       e
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       s
                                       ̲
                                    
                                    ̲
                                 
                              
                              
                                 n
                                 +
                                 1
                              
                              
                                 ⁎
                              
                           
                         the deviatoric part of 
                           
                              
                                 
                                    
                                       σ
                                       ̲
                                    
                                    ̲
                                 
                              
                              
                                 n
                                 +
                                 1
                              
                              
                                 ⁎
                              
                           
                        , and the yield function 
                           f
                           (
                           
                              
                                 
                                    
                                       s
                                       ̲
                                    
                                    ̲
                                 
                              
                              
                                 n
                                 +
                                 1
                              
                              
                                 ⁎
                              
                           
                           −
                           
                              
                                 
                                    
                                       X
                                       ̲
                                    
                                    ̲
                                 
                              
                              
                                 n
                              
                           
                           ,
                           
                              
                                 R
                              
                              
                                 n
                                 +
                                 1
                              
                              
                                 ⁎
                              
                           
                           )
                         are estimated to check the validity of the elastic evolution assumption, more precisely:
                           
                              •
                              If 
                                    f
                                    (
                                    
                                       
                                          
                                             
                                                s
                                                ̲
                                             
                                             ̲
                                          
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          ⁎
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                X
                                                ̲
                                             
                                             ̲
                                          
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          R
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          ⁎
                                       
                                    
                                    )
                                    <
                                    0
                                 , the evolution is elastic and the internal variables are constant in the step.

If 
                                    f
                                    (
                                    
                                       
                                          
                                             
                                                s
                                                ̲
                                             
                                             ̲
                                          
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          ⁎
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                X
                                                ̲
                                             
                                             ̲
                                          
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          R
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          ⁎
                                       
                                    
                                    )
                                    0
                                 , the evolution is visco-elastoplastic and an inelastic correction must be done.

If it is the first inelastic correction afer an elastic evolution, the first proposed control is activated.

The current increment, the size of which is 
                                    Δ
                                    
                                       
                                          t
                                       
                                       
                                          e
                                          l
                                          a
                                       
                                    
                                  is stopped as soon as the first element presenting the first inelastic evolution is detected.

The increment is restarted with an optimized time value, which have to enable to exactly reach the moment for the first inelastic occurence. With a simple linear approximation, the proposed new time increment becomes
                                    
                                       (17)
                                       
                                          Δ
                                          
                                             
                                                t
                                             
                                             
                                                n
                                                e
                                                w
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            s
                                                            ̲
                                                         
                                                         ̲
                                                      
                                                   
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                   
                                                      ⁎
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ̲
                                                         
                                                         ̲
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                             
                                          
                                          Δ
                                          
                                             
                                                t
                                             
                                             
                                                e
                                                l
                                                a
                                             
                                          
                                       
                                    
                                 
                              

This evolution allows completing this new increment just before or just after the first occurrence of plasticity.

Finally, a new reduced time increment is defined for the following computation step. One chooses to take the same increment as the initial one, thereby generating a new artificial calculation stage from the first viscoplastic increment. In this way, the time increment during the first viscoplastic increments is mastered and thus helps to better represent the behavior transition. Moreover, this method avoids the introduction of too large errors associated with the often quick evolution of the normal tensor 
                                    
                                       
                                          N
                                          ̲
                                       
                                       ̲
                                    
                                  during the first moments of visco-plasticity.

The calculation of the consistent tangent operator [16,24] is of primary importance in order to assure a rapid convergence of the integration scheme and its values tend to change significantly during increment with large viscoplastic evolutions. Significant differences in terms of behavior are observed[25,26], depending on the time step, when drastic changes of material behavior occur. At constant temperature and for uniaxial loadings, these evolutions can be easily characterized by the concavity of the stress–strain loop. The variation of the tangent operator, as the derivative of the stress increment with respect to the strain, is in fact directly related to the curvature of the stress–strain curve and, as it is computed at each increment, can be easily used to control the time increment. The second proposed control algorithm is therefore based on the variation of the tangent operator with time. For each increment, its curvature is computed following the equation:
                           
                              (18)
                              
                                 
                                    c
                                    ˜
                                 
                                 =
                                 
                                    1
                                    
                                       Δ
                                       
                                          
                                             t
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   ∂
                                                   Δ
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     n
                                                                     +
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               ̲
                                                            
                                                         
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   Δ
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     n
                                                                     +
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               ̲
                                                            
                                                         
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                
                                             
                                          
                                          ‖
                                       
                                       −
                                       
                                          ‖
                                          
                                             
                                                
                                                   ∂
                                                   Δ
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     n
                                                                  
                                                               
                                                            
                                                            
                                                               ̲
                                                            
                                                         
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   Δ
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     n
                                                                  
                                                               
                                                            
                                                            
                                                               ̲
                                                            
                                                         
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    1
                                    
                                       Δ
                                       
                                          
                                             t
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   ∂
                                                   Δ
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     n
                                                                  
                                                               
                                                            
                                                            
                                                               ̲
                                                            
                                                         
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   Δ
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     n
                                                                  
                                                               
                                                            
                                                            
                                                               ̲
                                                            
                                                         
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                
                                             
                                          
                                          ‖
                                       
                                       −
                                       
                                          ‖
                                          
                                             
                                                
                                                   ∂
                                                   Δ
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     n
                                                                     −
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               ̲
                                                            
                                                         
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   Δ
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     n
                                                                     −
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               ̲
                                                            
                                                         
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    )
                                 
                              
                           
                        where 
                           Δ
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                         and 
                           Δ
                           
                              
                                 t
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         are respectively the current and the former time increment. 
                           |
                           |
                           .
                           |
                           |
                         is the norm of a 4th-rank tensor 
                           A
                           
                        defined as
                           
                              (19)
                              
                                 
                                    |
                                    
                                       |
                                       A
                                       |
                                    
                                    |
                                 
                                 =
                                 
                                    
                                       A
                                       :
                                       :
                                       A
                                    
                                 
                              
                           
                        
                     

This value is compared to a reference elastic value throughout a criteria:
                           
                              •
                              If 
                                    
                                       c
                                       ˜
                                    
                                    <
                                    
                                       β
                                       
                                          Δ
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    ℂ
                                 , the computation step is validated.

If 
                                    
                                       c
                                       ˜
                                    
                                    ≥
                                    
                                       β
                                       
                                          Δ
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    ℂ
                                 , the current computation step is stopped and begins again with the same time increment as the initial one,

with β, a material-dependant parameter. Its value has been here optimized to obtain the better compromize between computation time and accuracy. The complete algorithm for time step control is summarized in 
                        Fig. 3.

@&#RESULTS AND ANALYSIS@&#


                     
                     
                     
                     
                     Figs. 4–7 sum up the analysis of the the time increment influence for test on REV element. Part a shows the loading condition in terms of stress, strain or even temperature. Parts b, c and d help to compare results obtained with or without time increment control and for a given maximal time increment.

The uniaxial tension–compression test, presented in Fig. 4, implies very severe loading conditions as the maximal stress is 350MPa while the elastic limit of the constitutive model has a stabilized value of 49MPa. As seen in Fig. 4b, if no time increment limit is provided to the FE solver, the corresponding computed strain amplitude is 2% with a stabilized stress–strain loop centered on 0% of strain. This converged value tends to drastically decrease when a maximal value of 5s is imposed for the time increment. In this case, the strain amplitude reaches only 1.4%. A maximal value of 0.2s enables the FE solver to reach the numerically converged evolution of strain with an amplitude of only 1%. The proposed control algorithm with an optimized value of 0.005 for β gives the same converged results but with a reduced number of total increment (172 vs 404 for the last cycle) and CPU time as seen in 
                     Table 2. As seen in Fig. 5c and d, the proposed controls let the time increment size increase during the elastic phase while its size is maintained small (0.1/0.2s) during the non-linear evolutions.

The stabilized stress–strain curve obtained with or without control are very different. Letting the FE solver master the increment size leads here to a very bad description of the elastic/viscoplastic transition. Moreover, the lack of small increments during a very severe viscoplastic loading implies a strong overestimation of the strain amplitude and a poor description of the viscoplastic evolution. The dissipated energy density is here represented by the area of the stabilized loop. One can notice that this area is divided by 2 in the case of the converged solution compared to the “free” time increment computation as seen in 
                     Table 3.

The in-phase biaxial tension–compression test, presented in Fig. 5, implies less severe loading condition as here the maximal von Mises equivalent stress reaches only 225MPa. As seen in Fig. 5b, differences in stabilized strain evolution are also slighter. If no time increment limit is provided to the FE solver, the corresponding computed von Mises equivalent strain amplitude is 0.4%. Once again, a maximal value of 0.2s for the time increment enables the FE solver to reach the numerically converged evolution of strain with an amplitude of only 0.38%. In this loading case, a maximal value of 0.5s also gives very satisfying results. The proposed control algorithms with β=0.005 give once again the same converged results but with a computation time 1.6 times shorter than the one obtained with a 0.2s maximal time increment as seen in Table 2. Computation time and results with the 0.5 maximal value time increment simulations are quite identical. As seen in Fig. 6c and d, the proposed control allows to perfectly represent the stabilized stress–strain loop. Differences with non-controlled simulations are here lighter which can explain the relative misestimating of the dissipated energy density.

Analysis of shear loading allows to achieve the same conclusions. We note here more limited differences between simulations with and without control. As it can be seen in Fig. 6 and Tables 2 and 3, deviations in terms of dissipated energy or CPU times are of the same order as the biaxial loading.

Simulation of thermo-mechanical fatigue testing does not generate significant differences between the tested kind of calculations. Indeed, as noticed in Fig. 7, there are only very slight shifts in the stress evolutions between the non-controlled computation and the 2s-limited time increment one. These differences appear for the most significant strain levels (in absolute value) and at maximum temperature. One might think that it is the strong variations in the mechanical behavior as well as the tendency to present a substantial viscoplastic flow, which are at the origin of these gaps. Indeed, in this case, even a small strain increment leads to important stress increments and thus implies a higher risk of changing the tensor 
                        
                           
                              N
                              ̲
                           
                           ̲
                        
                     .

Finally, this 2s limitation is sufficient to obtain a numerically-converged solution and no difference exists with more severe restrictions, particularly in terms of dissipated energy density as seen on Table 3. Again, control algorithms allow to obtain the converged solution with β=0.005. However, the CPU time is this time slightly higher. It should be noted, however, that the control is done automatically without the need for an a priori choice of a maximum time increment.

The proposed tested structure is a clamped specimen and its loading is meanwhile severe enough to not allow a viscoplastic shakedown after 8 cycles of loading. The focus here is to estimate the differences between controlled and non-controlled calculations regarding the strain evolutions. In 
                     Fig. 8a, it seems as if the first 5 cycles are quite identical but the initial small shifts tend to increase and lead to significant differences at the 8th cycle. Fig. 8b presents the strain evolution on this cycle for a non-controlled computation compared to simulation with a maximal time increment of 5s, 0.2s and finally controlled by the proposed algorithms. If strain amplitude is very close, the mean strain values differ. Moreover, the strain evolutions are slightly different and lead, as seen in Fig. 8c, to very dissimilar stress–strain evolution. Loading here is very severe in terms of stresses and pseudo-loops of very different forms are then observed.

These differences, which of course have a significant impact on the mechanical description of the test, are mainly due to large variations of the tensor 
                        
                           
                              N
                              ̲
                           
                           ̲
                        
                      during the quick heating and cooling phases. The numerically converged solution is obtained by limiting the time step at 0.1s while the other simulations give only degraded results (even 0.2s). In contrast, the proposed algorithms enable a evolution conform to the converged solution with a gain of time, however limited to 20% of CPU time.

@&#CONCLUSIONS@&#

Two algorithms have been proposed for controlling the time step and thus better estimate the calculated stress–strain loop for elasto-viscoplastic constitutive models in the case of thermomechanical loads. Drifts in terms of mechanical behavior have been evaluated for different types of multiaxial loadings first on an volume element and then on a more complex structure. Implied differences in terms of lifetime have also been investigated. Strong differences first appear between problem with strain or stress loading control. Computations errors are much more limited when loading conditions are expressed in terms of strain and in these cases, time control seems to be unuseful. Very important computations errors appears when forces or stresses are imposed to the volume element or to loaded structure.

The proposed algorithms enable to correctly control the time increment size with an accurate description of very strong viscoplastic evolutions for different kinds of loading conditions. Their main advantage is to manage to avoid a time increment limitation which has a tremendous impact on the computation time, especially for problem with a high number of degrees of freedom. In fact, with a limited increase of the computation time, the developed control algorithms provide a converged stress–strain solution and a correct lifetime estimation. The proposed control strategy however needs both a careful identification of the β parameter which seems to depend on the material behavior and a smart choice of the size of the first time increment which is taken as a reference for the control.

@&#REFERENCES@&#

