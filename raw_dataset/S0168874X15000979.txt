@&#MAIN-TITLE@&#Method for the explicit insertion of microstructure in Cellular Automata Finite Element (CAFE) models based on an irregular tetrahedral Finite Element mesh: Application in a multi-scale Finite Element Microstructure MEshfree framework (FEMME)

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The novel methodology presented creates the cells for cellular automata (CA) models.


                        
                        
                           
                           It proceeds through the subdivision of an irregular tetrahedral finite element (FE) mesh.


                        
                        
                           
                           Complex heterogeneous microstructures can be simulated using mathematical descriptions of their features.


                        
                        
                           
                           The method is coupled with a FEMME simulation of the strain field in a porous microstructure.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Cellular-automata

Finite elements

Multiscale model

Microstructure

Tetrahedron

Meshfree

@&#ABSTRACT@&#


                  Multiscale models are needed in simulations of mechanical and thermal properties that consider the microstructural heterogeneity of materials, in which a coupling is essential between the numerical models that deal with the different scales. In the class of cellular automata-finite element (CA-FE) or CAFE models, the use of a regular FE mesh restricts the model versatility due to the limited variety of engineering problems that can be simulated with such meshes. A novel methodology is proposed to create the homogeneous cells of the CA model from a mesh that is formed by irregular tetrahedrons. The result is more versatile and capable of modelling complex geometries, improving its applicability. The problem is solved through a subdivision algorithm that creates homogeneous tetrahedral cells, using a methodology to insert microstructures that can be described by particles, pores or fibres. Its use is demonstrated in a multi-scale Finite Element Microstructure MEshfree (FEMME) framework to calculate the elastic strains caused by microstructural features (pores); the method is shown to have a significantly lower computational cost than finite element simulations of equivalent levels of discretization.
               

@&#INTRODUCTION@&#

The importance of multi-scale models has grown in recent years, achieving increasing complexity in the problems addressed; these aim, for instance, to consider mechanical or thermal effects on the macrostructure that arise from the microstructural features. Prior to this, the effect of the microstructure has generally been neglected, or treated in a very limited manner, due to the high computational cost of introducing microstructure fidelity into large scale models; consequently, continuum material properties have been commonly used [1]. Multi-scale models address this problem by compensating for the use of a coarse discretization in the macrostructural model via the insertion of detailed microstructure only in those zones that require this refinement; for example, the damaged regions within fracture models. Various methods have been proposed, such as the stochastic multiscale model for fracture [2] that involves a statistical description of particles; the multiscale cohesive zone model [3], in which the bulk material is modelled as a quasi-continuum and the adaptive concurrent multiscale model [4], which utilizes an explicit description of microstructural features near the crack tip. Recently, a cellular automata (CA) finite element (FE) model with a microstructural adaptive meshfree framework [5] has inserted a high fidelity description of the microstructure into a Finite Element Microstructure MEshfree (FEMME) multiscale model of damage development, using the methodology that is explained here.

Cellular Automata Finite Element (CAFE) [6] models insert a detailed description of the microstructural material properties locally using CA within a larger scale FE model, coupling the macro and microstructural problems efficiently. The complexity of this approach lies in the achievement of continuity between the CA and FE layers, where the geometry of the cells in the CA model is embedded in the FE mesh. Traditionally, the solution to this problem is to split the regular three-dimensional finite elements into cubes of equal size representing the CA layer; this is very convenient for CA methods that are based on images [7–9]. Each cube of the discretization can be related to an image pixel, thus inserting the microstructure in the model from a description of the microstructure, which might be derived from a 2-dimensional or 3-dimensional image. The problem for CAFE is the limited versatility of regular FE meshes in the solution of engineering problems.

In our case we use irregular tetrahedrons instead of regular elements in the FE mesh, which gives much greater versatility; such elements are optimal for the modelling of structures with a complex geometry. There are two problems to be addressed: the first is the homogenization of the two layers through their element geometries, because as the Finite Elements that host them, the cells of the CA layer should be based on irregular tetrahedrons; the second problem is the insertion of the microstructure, which can be done in the same way as the classical cubic-based CA (i.e. with high fidelity from an image or through a statistical description of the material) if the volumes of the different tetrahedral cells are of the same order. The method proposed here solves both of these problems and so allows insertion of the microstructure into CAFE models that are based on an irregular tetrahedral FE mesh.

The methodology described here allows one to describe, with computational efficiency, a complex graded microstructure with a generic Finite Element Model (FEM with irregular tetrahedrons) to simulate complex sample geometries [5]. A general CAFE method with hexahedron FE elements and a microstructure formed by one phase with variable material properties was first presented by Shterenlikht and Howards [6], achieving successful simulations of the fracture of steel. Following that methodology, in order to model fracture in materials with a complex microstructure, we insert variations in its discretization and the relationship between the CA and FE layers through the introduction of a Meshfree framework as another layer between them.

The paper is structured as follows: the subdivision algorithm to create tetrahedral cells with a homogeneous size from an irregular tetrahedral mesh is first presented, then the insertion of the microstructure through ellipsoids with different dimensions and orientations is explained. Some examples of its application are then described, creating graded microstructures with different phases and distributions, and also combining elliptical particles with straight and curve fibres. Its application is described in a simulation of the stress distribution within a porous body; in this Finite Element Microstructure MEshfree (FEMME) multiscale approach, FE are used to model the engineering scale problem, the microstructural adaptive meshfree (MAM) framework computes the displacements of the microstructural features from the displacements of the FE nodes, and the CA layer uses the displacements of the MAM layer to compute the strains in the cells, which typically have a size that is 2 orders of magnitude smaller than the FE mesh size. Here microstructural features are used as the discretization of the MAM framework to compute the internal displacements. A comparison is made, in terms of strain field and computational cost, at different levels of discretization against standard FE models that describes the same microstructure.

The first step is the subdivision of the irregular tetrahedron Finite Elements into smaller cells. The problem associated with this element geometry is that the cells also must be irregular tetrahedrons with homogeneous volumes. This homogeneity is essential to have a uniform distribution of the strain energy in the cells, since it depends on the cell volume. The subdivision algorithm is applied iteratively, subdividing each tetrahedron in 4. It starts with an irregular tetrahedron of the Finite Element mesh, dividing it in 4 tetrahedrons that will be subdivided as well in the next iteration of the algorithm. The number of tetrahedrons produced is 4
                        n
                     , where n is the iteration number. This process is independent for each tetrahedron, and can be parallelized, perhaps it׳s computational cost is low, growing linearly as (10−5
                     N
                     
                        tet
                     +0.908) seconds, being N
                     
                        tet
                      the number of tetrahedrons at the end of the process. It means that the subdivision of a tetrahedron in 1024 tetrahedrons takes 1s, and in 4,194,304 tetrahedrons 43s running as a serial code in a MacBook Air (2GHz Intel Core i7). The main algorithm is applied to each tetrahedron (1–2–3–4 in 
                     Fig. 1) independently, and can be divided in 4 steps:
                        
                           −
                           
                              Step 1: Evaluate the area of each face and choose the largest one (i.e. 2–3–4 in Fig. 1).


                              Step 2: Take the vertex located opposite to the selected face and use it as a reference vertex (i.e. 1 in Fig. 1).


                              Step 3: Subdivide the selected face (i.e. 2–3–4 in Fig. 1) in 4 triangles (i.e. 2–5–7, 5–6–7, 3–6–7 and 4–5–6 in Fig. 1), inserting nodes at the middle of each edge of the face as an average of the vertex associated with this edge (i.e. x
                              
                                 node7
                              =0.5(x
                              
                                 node3
                              +x
                              
                                 node2
                              ), x
                              
                                 node6
                              =0.5(x
                              
                                 node3
                              +x
                              
                                 node4
                              ), x
                              
                                 node5
                              =0.5(x
                              
                                 node4
                              +x
                              
                                 node2
                              ) in Fig. 1)

This is applied iteratively to each tetrahedron separately, replacing the reference tetrahedral set by a new one with all the tetrahedrons produced in the subdivision. It was entirely implemented in Python 3.3, without the use of any other software. This is continued iteratively on each tetrahedron until all the tetrahedrons are smaller than a predefined critical size (see 
                     Fig. 2a); this might be the resolution of the experimental characterization of the microstructure, such as the pixel size in an image.

The application of the algorithm to a single tetrahedron over several iterations is shown in Fig. 2a; each iteration decreases the cell size and increases the number of tetrahedrons by a factor of 4
                        n
                     , where n is the number of iterations. The subdivision algorithm results in a quite homogeneous cell size distribution with a standard deviation of the 8.5% after 5 iterations; the data in Fig. 2a are sorted in order of size of the longest edge of each cell. The cells are visualized in Fig. 2b, in which the body centre of each cell is marked. After the subdivision of a FEM mesh it remains structured, respecting exactly the same nodal coordinates and connectivity.

The cells can then be used to provide a discretized description of the microstructure within the finite element by assigning to each cell the properties of its material phase. Each material phase is treated as a particle, simplified as a 3D ellipsoid with an assigned orientation and dimensions; a pore is simply an empty particle, or one with negligible properties. To insert each particle, a seed cell is chosen that is at its centre.

Each ellipsoid i is defined by Eq. (3).
                        
                           (1)
                           
                              
                                 [
                                 
                                    
                                       
                                          A
                                       
                                       i
                                    
                                 
                                 ]
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                cos
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                sin
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                −
                                                
                                                sin
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                cos
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                cos
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             0
                                          
                                          
                                             
                                                −
                                                
                                                sin
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                sin
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             0
                                          
                                          
                                             
                                                cos
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                cos
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                sin
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                −
                                                
                                                sin
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                cos
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          A
                                       
                                       i
                                    
                                 
                                 ]
                              
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   1
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 2
                              
                              +
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   2
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 2
                              
                              +
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   3
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   3
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 2
                              
                              ≤
                              1
                           
                        
                     Where α
                     1, α
                     2 and α
                     3 are respectively the Euler angles (pitch, roll and yaw) that define the ellipsoid orientation; l
                     1, l
                     2 and l
                     3 are the lengths of the ellipsoid along its principal axes; d
                     1, d
                     2 and d
                     3 are the rotated distances between the centre of the ellipsoid defined by the coordinates x
                     1
                     
                        e
                     , x
                     2
                     
                        e
                     , x
                     3
                     
                        e
                     , and the centre of the cell at x
                     1
                     
                        c
                     , x
                     2
                     
                        c
                     , x
                     3
                     
                        c
                     . An ellipsoid with labelled parameters is shown in 
                     Fig. 3a. Applying Eqs. (1)–(3), cell 1 of Fig. 3b is inside the ellipsoid and so is added to the set of cells in that represent the ellipsoid; cell 2 is shown to be outside and is not included.

Rules are enforced in the application of Eq. (1) to guarantee the optimum design of the microstructure for application in multi-scale models [5,10]. In general, superposition of ellipsoids is not permitted (i.e. a cell cannot be inside more than one ellipsoid). Each ellipsoid inserted is characterized by 6 key points, one at the end of each axis. When a new ellipsoid is inserted, its key points are evaluated using Eqs. (1)–(3) against the ellipsoids previously inserted. If any of those key points lies inside other ellipsoid, the ellipsoids have an overlap and the centre is moved to other random location to avoid it. This is done until the new ellipsoid inserted finds a centre that does not cause overlapping. Secondly, if part of an ellipsoid extends beyond the boundary of the FE that contains its seed, the ellipsoid is allowed to use cells from the neighbouring FE to define its set of cells. These rules ensure the continuity of the model and its independence with respect to the FE mesh. Continuous graded microstructures with multiple phases can be therefore produced without any influence of the FE mesh. A microstructure may be created using data originating from 2D optical characterization or 3D tomography; this can be done either by direct representation of microstructure features using ellipsoids defined via processing of a segmented image [7–9], or simulation using a statistical description that is obtained from such data. An example of the flexibility of this approach is shown in 
                     Fig. 4a, which shows a slice of a graded microstructure created in a prism of 20 finite elements. The microstructure comprises 3 different phases; each may have different properties and is characterized by individual distributions of size, orientation and position (Fig. 4b and c). To model this example, each tetrahedron has a different number density for every particle, varying with its position. The tetrahedrons are subdivided in order from left to right, the particles are inserted randomly inside them according to the local density of each one, and the continuity of the microstructure is ensured through the sharing of particles between tetrahedrons. If during the insertion of a particle its centre causes it to lie partially outside the tetrahedron, this particle is automatically considered in the tetrahedron that shares the face with the first one (or faces in the case that the particle is close to a vertex and it cuts more than one face). If one tetrahedron shares one or more of its faces with others that have been subdivided previously, the algorithm does not allow any particle to be partially outside the tetrahedron through this face. This is done using the key points of the particles and evaluating whether they are inside or outside the tetrahedron.

A specific example is shown in 
                     Fig. 5; this is a 1×1×1mm3 cube of a material that comprises a matrix, aggregate particles and porosity; these have average sizes of 0.15mm and 0.1mm respectively, each with standard deviations of 15%. Their proportions can be readily altered; the material with a total porosity of 40% by volume and the 15% aggregate by volume is shown in Fig. 5a, while Fig. 5b has a porosity of the 15% and the 30% content of aggregate particles. Both are defined from a cube that is described using 5 tetrahedral elements.

Fibres, which are required for simulations of composite structures, can be inserted into a microstructure by treating them similarly; both straight and curved fibres can be readily defined (
                     Fig. 6). Each straight fibre is defined as a cylinder, with a known centre, diameter, length and orientation. If the distance between the centre of the cell and the line that defines the fibre is less than half of the fibre diameter, and the distance between the centre of the cell and the centre of the fibre is less than half of its length, the cell belongs to the fibre and has its properties. The method to insert curved fibres is similar, with the axis of the fibre defined by a segment of a 3-dimensional sine curve, which has an orientation defined by Eq. (1); this is arbitrarily projected onto the x
                     1
                     –x
                     2 plane using Eq. (4), as well as the centre of the cell with Eq. (5). With this method, the introduction of particles defined by 3D oriented sine curves is quite straightforward. The conditions defined by Eqs. (6) and (7) are applied to determine if the cell belongs to the fibre.
                        
                           (4)
                           
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          
                                             A
                                          
                                          i
                                       
                                    
                                    ]
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      c
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      c
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      c
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          
                                             A
                                          
                                          i
                                       
                                    
                                    ]
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              T
                              h
                              i
                              c
                              k
                              n
                              e
                              s
                              
                                 
                                    s
                                 
                                 
                                    y
                                 
                              
                              ≥
                              
                                 |
                                 
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                       
                                          c
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    
                                    sin
                                    (
                                    a
                                    [
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                       
                                          f
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                       
                                          c
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ]
                                    )
                                 
                                 |
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              T
                              h
                              i
                              c
                              k
                              n
                              e
                              s
                              
                                 
                                    s
                                 
                                 
                                    z
                                 
                              
                              ≥
                              
                                 |
                                 
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                       
                                          f
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                       
                                          c
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 |
                              
                           
                        
                     where [A
                     
                        i
                     ]-1 is the inverse of the rotation matrix (Eq. (1)), x
                     
                        f
                     
                     1, x 
                     
                        f
                     
                     2, x 
                     
                        f
                     
                     3 are the coordinates of the centre of the fibre and x
                     
                        c
                     
                     1, x 
                     
                        c
                     
                     2, x 
                     
                        c
                     
                     3 the centre of the cell evaluated. The wavelength of the fibre׳s curve is defined using the parameter a.

Curved and straight fibres can be combined with other particles in order to create a complex microstructure, again using rules to ensure the non-penetration of particles and fibres (i.e. evaluating the key points of the ellipsoids using Eqs. (4)–(7)); these rules can be ignored in order to reproduce microstructures with fibres that bridge pores, for instance. The example shown in Fig. 6a is for set of straight fibres with random radii and a predominant orientation; a slice of the microstructure created with two sets of particles is shown. In Fig. 6b, a combination of curved fibres with random orientation and radius and two different sets of particles is presented. These figures illustrate the versatility of the technique to model complex graded microstructures.

The computational time, quantified with a parameter that is proportional to the number of operations (
                     Fig. 7c), can be reduced significantly in finite element simulations of fracture and damage development if the cell description of microstructure is used within a Microstructural Adaptive Meshfree framework (MAM). The fracture model using this methodology [5] is a multiscale solution to release the spurious fracture energy that arises from the use of an over-coarse FE mesh; this is done by introducing the microstructure as a local enrichment in the damaged zone. It is a novel variation of the Cellular Automata integrated with Finite Elements (CAFE) [6], improved by the development of a Microstructural Adaptive Meshfree (MAM) model that uses the iso-geometry of the microstructural features to construct its local shape functions. This makes the multi-scale Finite Element Microstructure MEshfree (FEMME) method faster and more detailed compared with alternative approaches [14].

As described above, the microstructure is simulated explicitly by its subdivision into smaller cells. The evaluation of the relative positions of the cells and the microstructural features is used within the MAM model. Three layers represent (i) the macromechanical model (i.e. FE), (ii) the microstructural features (i.e. MAM), and (iii) the material of the different phases (i.e. CA). In common with other damage models, such as Cohesive FE [12] or X-FEM [13], these features are developed locally only within the damaged, or potentially damaged, finite elements of the macro-mechanical model. The damage ‘information’ is shared between the layers using the Hill–Mandell theorem [11] of energy homogenization to change the stiffness of every layer according to the damage in the microstructure. This can be illustrated in an example to show the improvement in computational costs; in this case the non-linearity arising from the damage is not considered, and the model presented is purely elastic. However, non-linear effects are readily incorporated [10].

The example is a cube of 1×1×1mm3, which contains 70 pores and is defined by 5 tetrahedron elements (Fig. 7b), embedded into a larger finite element model (FEM) (Fig. 7a) composed by 135 elements and 700 micropores. This method of embedding in larger FEM is used to ensure that the boundary conditions applied to the FEMME volume are close to those of the equivalent volume modelled in an FEM of the same microstructure; this is needed as the boundary condition displacements are applied only to the nodes of the coarse mesh of the FEMME model. Iterative subdivision of the elements inside the cube produced 32,768 and 522,720 cells; the approximately equivalent resolution FEM have 40,000 and 625,000 tetrahedral elements, each with a single integration point and also embedded into a larger FE model. The arbitrary material properties are a Poisson׳s ratio of 0.2 and a Young moduli of 12GPa for the matrix and 0GPa for the pores. In the FEM, a null displacement is applied to all the nodes of the bottom face, and a vertical displacement is applied to the top face to achieve a net strain of 0.06. The method of strain calculation in the model is described in some detail in Ref. [5], so it is not reproduced here. The number of operations needed to achieve a solution is presented in Fig. 7c, which clearly shows the FEMME model can reach an equivalent solution to the FEM with a number of operations between 2 and 4 orders of magnitude lower, depending on the discretization. In the FEM the complexity to assign the microstructure is O(n
                     
                        e
                     ) and that to solve the problem is O(n
                     
                        e
                     
                     2), in comparison, in the FEMME model the microstructure is automatically assigned with the discretization, and its displacements are computed with a complexity of O(n
                     
                        m
                     
                     2), where the number of microstructural nodes (n
                     
                        m
                     ) is very low compared with the number of nodes used in the FEM (n
                     
                        e
                     ). Finally the displacements of the microstructure are mapped into the cells with a complexity of O(n
                     
                        c
                     ), where n
                     
                        c
                      is the number of nodes in the cell set that determines the final discretization given by the FEMME model.

The elastic strains obtained in the example of Fig. 7 are shown in 
                     Fig. 8 for the FEMME and FE cases at the two levels of equivalent discretization; the data are for a vertical section near the centre of the cube, which is marked in Fig. 7b. The strains in this section are presented in Fig. 8a–d. Further detail is provided in the horizontal (
                     Fig. 9a) and vertical (Fig. 9b) line profiles within this section, i.e. along the traces indicated by white lines. The strains in both models are sensitive to the level of discretization, but the agreement between the two methods of the strain concentrating effect of the pores is regarded as quite acceptable, particularly in the magnitude of the strain concentrations close to the pores. The calculated strains may then be combined with a damage-model to simulate the effects of microstructure on local damage development; the application of this is described in more detail in Ref. [14].

The zones with the higher strains in the FEM are reproduced well by the MAM model (Fig. 8c). These are the zones with a higher concentration of pores. These regions are larger in the FEMME model (Fig. 8a and d), compared with the FEM analysis, due to the large size of the MAM domains. The strains of the cells are directly influenced by the strain of the MAM domain in which they are contained. This causes the wide range of higher strains in the FEMME model. There are zones with negligible strain at the borders of the modelled volume (in blue in Fig. 8a and d); these occur as some of the cells in the border region are excluded from the calculation because they belong to MAM domains that are centred outside the cube studied, this is also the reason why the MAM model has the shape that is shown in Fig. 8c. These effects would not occur in a larger model, and are essentially an artefact of the special case studied here.

It is noticeable that in the FE model the strains are more equally distributed, whilst in the FEMME model the higher strains are concentrated around the pores, this decreases the strains within zones that have lower porosity due to conservation of the total strain energy of the volume. The FE model provides a more accurate description of the strain distribution, but the general patterns of strains in the microstructure is reproduced satisfactorily by the FEMME model at a considerably lower computational cost than the FEM. The agreement between the FE and FEMME models is best in the zones with higher strains where damage occurs. Also the results are stable with different discretizations, as shown in Figs. 8 and 9. As a consequence, the FEMME approach is well suited to fracture calculations, since it is strain concentrations that control damage. The significant reduction of the number of operations in the FEMME model is especially important in fracture modelling, as several iterations would be needed to reach convergence in every step of the simulation as damage propagates.

@&#CONCLUSION@&#

A methodology has been developed to create the cells of a Cellular Automata model from an irregular tetrahedral Finite Element mesh. This allows one to use CAFE based methodologies in complex geometries, representing the properties of complex microstructures with cells of homogeneous sizes. This methodology has successfully implemented in the Finite Element Microstructure MEshfree (FEMME) framework to simulate the effect of microstructure on the elastic strain distribution with a significant improvement in computational cost, when compared to a FE solution of equivalent discretization.

@&#ACKNOWLEDGEMENTS@&#

This work was carried out within UK EPSRC-supported project “QUBE: Quasi-Brittle fracture: a 3D Experimentally-validated approach” (EP/J019992/1).

Supplementary data associated with this article can be found in the online version at doi:10.1016/j.finel.2015.07.001.


                     
                        
                           
                              Supplementary data
                           
                           
                        
                     
                  

@&#REFERENCES@&#

