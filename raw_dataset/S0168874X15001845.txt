@&#MAIN-TITLE@&#Closed-form representation of matrix functions in the formulation of nonlinear material models

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Derivation of closed-form representation of 3×3 matrix functions.


                        
                        
                           
                           Closed form representation includes first and second derivatives.


                        
                        
                           
                           Solution to the ill-conditioning in the vicinity of multiple equal eigenvalues.


                        
                        
                           
                           Derivation based on symbolic description, automatic coding and automatic differentiation.


                        
                        
                           
                           Application includes finite strain Cam-Clay model.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Matrix functions

Nonlinear materials

Automatic differentiation

Closed-form

Cam-Clay model

@&#ABSTRACT@&#


                  The paper presents new approach to the evaluation of matrix functions operating over tensors that are essential part of formulation of complex nonlinear material models in mechanics of solids. A method is presented how to automatically derive numerically efficient closed-form representation of an arbitrary matrix function and its first and second derivatives for 3×3 matrices with real eigenvalues. The method offers an unique solution to the standard problem of ill-conditioning in the vicinity of multiple equal eigenvalues which is characteristic for all closed-form representations. A compiled library of subroutines with derived closed-form representation of most commonly used matrix functions along with their first and second derivatives has been created and is available for the use in general finite element environments. Consequently, the matrix functions can become as accurate, efficient and commonly available as their scalar counterparts, resulting in more common use of advanced strain and stress measures, such as Hencky strain measure which have so far been considered difficult for implementation. Accuracy and efficiency of the derived closed-form representations was compared with corresponding truncated series expansion and a speed up between 20 and 80 times has been observed depending on the matrix. The proposed methodology was tested on a set of selected nonlinear material models where matrix functions play an essential part in nonlinear finite element formulation.
               

@&#INTRODUCTION@&#

Many commonly used inelastic material models exhibit highly non-linear behavior. Solving such problems without appropriate formulation can cause large errors accumulating with each incremental step. One such example is incremental finite strain formulation of multiplicative elasto-plasticity where an exact preservation of the plastic incompressibility condition relies on appropriate time integration. It has been shown that an appropriate integration can be achieved by using exponential map integrators [1–3] with the exact matrix exponential as an essentials part of the algorithm. Additionally, derivatives of matrix exponential must be known, to derive consistent tangent matrix. Strain energy functions for finite strain elements can sometimes also be expressed with matrix functions. One example of inelastic model is finite strain Cam-Clay model [4], which has strain energy expressed with the logarithm of deformation tensor. In this case, the first derivative of the matrix logarithm is required to derive governing equations and the second derivatives of matrix logarithm to derive consistent tangent matrix. In all these cases the accuracy and numerical efficiency of the resulting finite elements depend strongly on the accuracy and numerical efficiency of the evaluation of matrix function and its derivatives. Accurate first derivatives of matrix functions can in theory be calculated with the use of finite differences method, but calculating accurate second order derivatives with the use of finite differences method is in general an ill-conditioned problem.

Let us assume that there exists a numerical library of subroutines that numerically efficiently evaluates and returns selected matrix function and its first and second derivatives, calculated with machine precision accuracy on its whole definition interval. Then the matrix functions can be used in the same way as their scalar counterparts or any other elementary function. Consequently, the formulation and numerical implementation of complex non-linear material models where the use of matrix functions is essential can be greatly simplified. Machine precision accurate evaluation of matrix functions also improves the overall accuracy of numerical procedures. The paper presents a way how to automatically generate such a library by the means of an advanced automatic code generator AceGen 
                     [5], where an automatic differentiation technique [6] and automatic code optimization and generation are combined with symbolic system Mathematica 
                     [7].

The calculation of a general matrix function of general n×n matrix is not a simple task. As a special case, Moler and Loan [8] have shown numerous possibilities of calculating matrix exponential. There is no general method which is completely satisfactory that would meet all demands regarding the numerical efficiency and accuracy of the results. Most commonly the methods for the evaluation of matrix functions are based on spectral decomposition [9–11] of the argument or its series expansion [12,10,13]. Spectral decomposition introduces the problem of accurate evaluation of eigenvalues and eigenvectors of a matrix, because they exhibit ill-conditioning and non-uniqueness in the vicinity of multiple equal eigenvalues. These areas require special treatment. Contrary to that the machine precision series expansion can be numerically inefficient, especially when higher order derivatives of matrix functions are also required. Among other possibilities, an arbitrary matrix function can be evaluated by differentiating an appropriate scalar generating function of eigenvalues of argument [14,15]. Since our interests lies with application in solid mechanics, we can limit ourselves to matrices of dimension 3×3. In this case the closed-form eigenvalues can be formulated analytically with trigonometric functions [16,3]. When eigenvalues are exactly equal, it is relatively easy to derive closed-form representation, but when they are nearly equal, ill-conditioning requires complicated asymptotic expansion of generating function.

The approach where the matrix exponential is evaluated by differentiating an appropriate scalar generating function and the points of multiple equal eigenvalues are treated by series expansion of generating function was first introduced by Korelc and Stupkiewicz [3]. The use of matrix functions is in [3] focused on the use of matrix exponent as a part of volume preserving integration of evolution equations in finite strain plasticity. However, the benefits of the use of efficient and accurate closed form representation of matrix functions can be extended to other problems as well. For example, matrix logarithm can used to evaluate Hencky strain and matrix square root can be used to obtain stretch tensor without the use of polar decomposition. It turns out that the extension of the method presented in [3] for the evaluation of matrix exponential and its first derivative to general matrix functions and higher order derivatives is neither certain nor trivial. This is manly due to the two reasons. The coefficients of the expansion of a generating function in vicinity of multiple equal eigenvalues can only be obtained in closed form by a lengthy and complicated limiting process. In the case of matrix exponent, the generating function can be split into volumetric and deviatoric part which simplifies the series expansion. This is not the case for other matrix functions. In this work, the method is extended to matrix logarithm, matrix square root and matrix power. In [3] the consistent linearization of elasto-plastic problem only needed accurate evaluation of first derivative of matrix exponent. If the matrix function appears as a apart of strain energy function then the consistent linearization of the problem requires also second derivative of matrix function. In this work, the method is extended to include accurate closed-form representation of second order derivatives of all considered matrix functions.

The program code for matrix function and its first order derivative can be automatically generated with AceGen at the same time as the rest of the element code. However, the second derivative of matrix function is a sixth order tensor and the derivation time of the closed form representation of the second derivative is too long for the real time code generation. The problem was solved in this work by creation of a compiled library of all matrix functions. The combination of ADB formulation, automatic code generator AceGen and compiled matrix functions library leads to the process that generates moderate size codes for complex material models in real time. The usual problem associated with automatic code generation, which is extremely large code sizes, is avoided with the proposed combination of tools.

The closed-form representations of the mentioned matrix functions and their first and second derivatives will be derived for an arbitrary 3×3 matrix with real eigenvalues. Accuracy and efficiency of the derived closed-form matrix functions will be compared in the vicinity of multiple eigenvalues with its series expansion. Errors are in the range of machine precision for all matrix functions. The error grows with each derivative and is below 10−13 for the first derivatives, while errors of the second derivatives are below 10−10 on ill-conditioned areas.

Finally, the numerical efficiency of the closed-form representation of matrix functions will be compared on various hyper-elastic and finite strain elasto-plastic models where the use of matrix functions and its derivatives is required including standard isotropic Neo-Hookean and Hencky hyper-elastic models and finite strain elasto-plastic model. At the end the use of several closed-form matrix functions within the same material model will be shown on an example of modified Cam-Clay soil model. Its strain energy can be expressed with matrix logarithm and the plastic evolution equation with matrix exponential.

The presented closed-form representations of matrix function enable accurate, stable and numerically effective implementation of complex material models. The described procedure can be generalized to any matrix function, whether it be a simple square root of left or right Cauchy-Green tensor to calculate the stretch tensor or deformation or to calculate a tensor of logarithmic Hencky strains.

Development of the closed-form representations of matrix functions and their first and second derivatives will be shown for 3×3 matrices that exhibit 3 real eigenvalues. Thus, the matrix in general does not need to be symmetric. However, the derived closed-form representation does not include the case where the matrix exhibits complex eigenvalues. Closed-form representations of the selected matrix functions and their first and second derivatives will be derived using AceGen 
                     [5] automatic code generation system and computer algebra system Mathematica 
                     [7].

According to Lu [14], where an appropriate theoretical background of the method is given, a general matrix function 
                           F
                           (
                           A
                           )
                         can be formulated as derivative of an appropriate generating function 
                           G
                           (
                           A
                           )
                         with respect to the elements of the transposed matrix. Generating function 
                           G
                           (
                           A
                           )
                         is defined as sum of auxiliary functions 
                           g
                           (
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           )
                           =
                           ∫
                           f
                           (
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           )
                           
                           d
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        , which are integrals of an equivalent scalar function 
                           f
                           (
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           )
                         applied on eigenvalues λ
                        
                           i
                         of matrix 
                           A
                        . The general form of arbitrary matrix function is thus written as
                           
                              (1)
                              
                                 g
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 ∫
                                 f
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                 d
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (2)
                              
                                 G
                                 (
                                 A
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 g
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (3)
                              
                                 F
                                 (
                                 A
                                 )
                                 =
                                 
                                    
                                       ∂
                                       G
                                       (
                                       A
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             A
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

In order to obtain a closed-form representation of matrix function, a closed-form representation of eigenvalues λ
                        
                           i
                         of 3×3 matrix 
                           A
                         as a function of components of 
                           A
                         is needed first. Eigenvalues correspond to the roots of the cubic characteristic polynomial that can be easily obtained in various closed forms. However, as discussed in detail in [16] and [3], a special closed-form representation of eigenvalues is required in order to obtain machine precision matrix functions on the whole definition interval. The procedure to determine an appropriate closed-form representation of eigenvalues of 3×3 matrix is given in [3] and summarized here. First matrix 
                           A
                         is split into volumetric 
                           
                              A
                              
                                 ׳
                                 ׳
                              
                           
                           =
                           
                              λ
                              v
                           
                           I
                         and deviatoric 
                           
                              A
                              ׳
                           
                           =
                           A
                           -
                           
                              A
                              
                                 ׳
                                 ׳
                              
                           
                         parts, where 
                           
                              
                                 λ
                              
                              
                                 v
                              
                           
                           =
                           
                              
                                 1
                              
                              
                                 3
                              
                           
                           
                           tr
                           (
                           A
                           )
                         represents eigenvalues of volumetric part. The volumetric-deviatoric split is performed here, to reduce round-off errors present in the vicinity of multiple eigenvalues [16]. The characteristic polynomial of matrix 
                           
                              
                                 A
                              
                              
                                 ′
                              
                           
                         is then written in the following form:
                           
                              (4)
                              
                                 
                                    
                                       
                                          λ
                                          ׳
                                       
                                    
                                    3
                                 
                                 -
                                 
                                    1
                                    2
                                 
                                 p
                                 
                                    λ
                                    ׳
                                 
                                 -
                                 q
                                 =
                                 0
                                 ,
                                 
                                 p
                                 =
                                 tr
                                 
                                    
                                       
                                          A
                                          ׳
                                       
                                       
                                          
                                             A
                                             ׳
                                          
                                          T
                                       
                                    
                                 
                                 ,
                                 
                                 q
                                 =
                                 det
                                 
                                 
                                    A
                                    ׳
                                 
                                 .
                              
                           
                        
                     

The eigenvalues of 
                           
                              
                                 A
                              
                              
                                 ′
                              
                           
                         can be written in closed-form using trigonometric functions as
                           
                              (5)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 t
                                 
                                 cos
                                 
                                 ϕ
                                 ,
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 t
                                 
                                 cos
                                 (
                                 
                                    ϕ
                                    −
                                    
                                       
                                          2
                                          π
                                       
                                       
                                          3
                                       
                                    
                                 
                                 )
                                 ,
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 t
                                 
                                 cos
                                 (
                                 
                                    ϕ
                                    +
                                    
                                       
                                          2
                                          π
                                       
                                       
                                          3
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        where
                           
                              (6)
                              
                                 t
                                 =
                                 
                                    
                                       
                                          
                                             2
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                 r
                                 =
                                 3
                                 
                                    
                                       6
                                    
                                 
                                 
                                 
                                    
                                       q
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             3
                                             /
                                             2
                                          
                                       
                                    
                                 
                                 
                                 and
                                 
                                 ϕ
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       3
                                    
                                 
                                 
                                 arccos
                                 
                                 r
                                 .
                              
                           
                        The eigenvalues of matrix 
                           A
                         are then defined as 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 λ
                              
                              
                                 v
                              
                           
                           +
                           
                              
                                 λ
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                        .

Closed-form representation of eigenvalues leads to the closed-form representation of generating function G. However, in the vicinity of multiple equal eigenvalues, Eqs. (6) become singular or ill-posed. The nature of eigenvalues can be determined from the sign of the determinant 
                           Δ
                           =
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           
                              
                                 p
                              
                              
                                 3
                              
                           
                           −
                           27
                           
                              
                                 q
                              
                              
                                 2
                              
                           
                        :
                           
                              1.
                              if 
                                    Δ
                                    >
                                    0
                                 , then 
                                    A
                                  has three distinct real eigenvalues;

if 
                                    Δ
                                    =
                                    0
                                 , then 
                                    A
                                  has multiple (one or two) real eigenvalues;

if 
                                    Δ
                                    <
                                    0
                                 , then 
                                    A
                                  has one real and two complex conjugate eigenvalues.

Since an application in solid mechanics is considered, 
                           Δ
                           ≥
                           0
                         must hold to ensure that matrix 
                           A
                         has three real eigenvalues. This condition is equivalent to condition 
                           −
                           1
                           ≤
                           r
                           ≤
                           1
                         and also implies condition 
                           p
                           ≥
                           0
                        . When p and r are approaching boundary values, the equations become ill-conditioned. Additionally, when finite precision arithmetic is used, a small perturbation of p over 0 or perturbation of r over 
                           ±
                           1
                         can cause eigenvalues to become complex, which leads to numerical problems.

The basic idea behind the proposed method is that, contrary to the ill-conditioned eigenvalues, the generating functions G 
                        (2) are everywhere smooth and numerically stable functions. Therefore, the above mentioned numerical problems can be avoided by replacing G with its appropriate asymptotic expansion in the vicinity of critical values of parameters p and r. The vicinity is defined by appropriate tolerances ε
                        
                           p
                         and ε
                        
                           r
                         that depend on the chosen matrix function. In order to illustrate this property, a generating function of matrix power defined according to Eq. (2) as 
                           
                              
                                 G
                              
                              
                                 pow
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 3
                              
                           
                           
                              
                                 λ
                              
                              
                                 i
                              
                              
                                 η
                                 +
                                 1
                              
                           
                           /
                           (
                           η
                           +
                           1
                           )
                         is plotted alongside eigenvalues 
                           
                              
                                 λ
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                         for constant values of 
                           
                              
                                 λ
                              
                              
                                 v
                              
                           
                           =
                           3
                         and 
                           η
                           =
                           −
                           2.5
                        . In Fig. 1
                         the region where 
                           p
                           →
                           0
                         is plotted for constant value of q=0 and in Fig. 2
                         the region where 
                           r
                           →
                           ±
                           1
                         is plotted for constant value of t=2. Note that the imaginary part of G is zero and real part of G is smooth and well defined on the whole interval of interest 
                           (
                           p
                           ≥
                           0
                           ∧
                           |
                           r
                           |
                           ≤
                           1
                           )
                         in both cases.

The presented critical cases require special treatment. For the first special case, where the parameter p reaches 0, the generating function is expanded around p=0 and denoted by G
                        
                           p
                        . It can be easily shown that when the first condition 
                           Δ
                           ≥
                           0
                         is satisfied, 
                           p
                           ≥
                           0
                         and 
                           −
                           
                              
                                 1
                              
                              
                                 3
                                 
                                    
                                       6
                                    
                                 
                              
                           
                           
                              
                                 p
                              
                              
                                 3
                                 /
                                 2
                              
                           
                           <
                           q
                           <
                           
                              
                                 1
                              
                              
                                 3
                                 
                                    
                                       6
                                    
                                 
                              
                           
                           
                              
                                 p
                              
                              
                                 3
                                 /
                                 2
                              
                           
                        . It follows that for 
                           p
                           <
                           
                              
                                 ε
                              
                              
                                 p
                              
                           
                        , when tolerance 
                           
                              
                                 ε
                              
                              
                                 p
                              
                           
                           >
                           0
                         is sufficiently small, q also approaches zero. Therefore, a multivariate asymptotic expansion of G around p=0 and q=0 is chosen. The series expansion of general generating function then follows as
                           
                              (7)
                              
                                 
                                    
                                       G
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                0
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      q
                                                   
                                                
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          j
                                          ≤
                                          
                                             
                                                n
                                             
                                             
                                                pq
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      i
                                                      +
                                                      j
                                                   
                                                
                                                G
                                                (
                                                p
                                                ,
                                                q
                                                ,
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      v
                                                   
                                                
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ∂
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   →
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   q
                                                   →
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       i
                                       !
                                       j
                                       !
                                    
                                 
                                 .
                              
                           
                        where the minimum number of terms n
                        
                           p
                         and n
                        
                           q
                         and the maximum combined power n
                        
                           pq
                         depend on the chosen matrix function.

For the second special case, where parameter r reaches ±1, the generating function is expanded around r=±1 and denoted as G
                        
                           r
                         as follows:
                           
                              (8)
                              
                                 
                                    
                                       G
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      i
                                                   
                                                
                                                G
                                                (
                                                r
                                                ,
                                                t
                                                ,
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      v
                                                   
                                                
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       →
                                       ±
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             (
                                             
                                                r
                                                +
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       i
                                       !
                                    
                                 
                                 ,
                                 
                                 where
                                 
                                 
                                    
                                       s
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if
                                             
                                             r
                                             <
                                             −
                                             1
                                             +
                                             
                                                
                                                   ε
                                                
                                                
                                                   r
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             −
                                             1
                                          
                                          
                                             if
                                             
                                             r
                                             >
                                             1
                                             −
                                             
                                                
                                                   ε
                                                
                                                
                                                   r
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 ε
                              
                              
                                 r
                              
                           
                           >
                           0
                         is a sufficiently small tolerance for the second special case. With 
                           
                              
                                 s
                              
                              
                                 r
                              
                           
                           =
                           ±
                           1
                        , two special cases of 
                           r
                           →
                           −
                           1
                         and 
                           r
                           →
                           1
                         are covered simultaneously. The generating function can then be written for all special regions for all matrix functions as:
                           
                              (9)
                              
                                 G
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   p
                                                
                                             
                                          
                                          
                                             for
                                             
                                             p
                                             <
                                             
                                                
                                                   ε
                                                
                                                
                                                   p
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   r
                                                
                                             
                                          
                                          
                                             for
                                             
                                             r
                                             <
                                             −
                                             1
                                             +
                                             
                                                
                                                   ε
                                                
                                                
                                                   r
                                                
                                             
                                             
                                             ⋁
                                             
                                             r
                                             >
                                             1
                                             −
                                             
                                                
                                                   ε
                                                
                                                
                                                   r
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             else
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The evaluation of matrix function 
                           F
                           (
                           A
                           )
                         requires the evaluation of the first derivative of generating function. If the evaluation of the first derivative 
                           (
                           D
                           F
                           (
                           A
                           )
                           )
                         or the second derivative 
                           (
                           
                              
                                 D
                              
                              
                                 2
                              
                           
                           F
                           (
                           A
                           )
                           )
                         of matrix function is required, the evaluation of higher order derivatives of generating function is also required, which increases the expansion order needed to ensure machine precision accuracy of higher derivatives. The values of tolerances ε
                        
                           p
                         and ε
                        
                           r
                         and the expansion order are determined for each matrix function individually and are presented later.

The automation of derivation of matrix functions is done by means of the advanced automatic code generator AceGen 
                        [5], where automatic differentiation technique [6] and automatic code optimization and generation are combined with symbolic system Mathematica 
                        [7]. Automation procedure consists of two parts. First, the general form of generating function (2) and the coefficients of expansions (7) and (8) have to be derived in closed-form. Next, the first, the second and the third derivative of the generating function (9) with respect to matrix 
                           A
                         have to be obtained in closed-form.

Coefficients of expansion (7) 
                        
                           (
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                i
                                                +
                                                j
                                             
                                          
                                          G
                                       
                                       
                                          ∂
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          ∂
                                          
                                             
                                                q
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 |
                              
                              
                                 
                                    
                                       
                                          
                                             p
                                             →
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             q
                                             →
                                             0
                                          
                                       
                                    
                                 
                              
                           
                           )
                         are in general a function of λ
                        
                           v
                         and coefficients of expansion (8) 
                        
                           (
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                i
                                             
                                          
                                          G
                                       
                                       
                                          ∂
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 |
                              
                              
                                 r
                                 →
                                 ±
                                 1
                              
                           
                           )
                         are in general a function of λ
                        
                           v
                         and t. Consequently, the coefficients can be obtained only with a rather lengthy and complicated limiting process. For that purpose symbolic tool Mathematica 
                        [7] was successfully used in order to automatize the first part of procedure.

Direct use of Mathematica for the second part of procedure leads to uncontrollable growth of expressions and consequently slow program code. Thus, a more sophisticated algorithm has to be used. Let us assume that we have a computer code that evaluates the generating function 
                           G
                           (
                           A
                           )
                        . From the computer code for the evaluation of generating functions the computer code for the evaluation of matrix function and its first and second derivatives with respect to matrix 
                           A
                         can be obtained using automatic differentiation technique (see e.g. [6,17]) and the corresponding automatic differentiation tools, e.g. AceGen. If the backward mode (also named adjoint) of automatic differentiation technique is combined with code-to-code implementation (see e.g. [6]) of automatic differentiation technique, as is the case with AceGen, then the resulting code is also numerically efficient. Following the notation introduced in [18], 
                           
                              
                                 δ
                              
                              
                                 ^
                              
                           
                           f
                           (
                           x
                           )
                           /
                           
                              
                                 δ
                              
                              
                                 ^
                              
                           
                           x
                         is here used as an automatic differentiation operator. This leads to the following automatic differentiation based formulation of matrix function and its derivatives:
                           
                              (10)
                              
                                 F
                                 (
                                 A
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ^
                                             
                                          
                                          G
                                          (
                                          A
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   ^
                                                
                                             
                                             A
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 D
                                 F
                                 (
                                 A
                                 )
                                 =
                                 
                                    
                                       ∂
                                       F
                                       (
                                       A
                                       )
                                    
                                    
                                       ∂
                                       A
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ^
                                          
                                       
                                       F
                                       (
                                       A
                                       )
                                    
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ^
                                          
                                       
                                       A
                                    
                                 
                                 and
                                 
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 F
                                 (
                                 A
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          
                                             2
                                          
                                       
                                       F
                                       (
                                       A
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ^
                                          
                                       
                                       (
                                       D
                                       F
                                       (
                                       A
                                       )
                                       )
                                    
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ^
                                          
                                       
                                       A
                                    
                                 
                                 .
                              
                           
                        
                     

Eqs. (9) and (10) form together a basis for an algorithm for the automation of the formulation of matrix functions. The algorithm is presented in Algorithm 1. First the value of generation function is defined according to (9). The matrix function and its required derivatives are then derived according to (10). Based on the presented procedure codes for the evaluation of an arbitrary matrix functions can be written, such as matrix exponential, logarithm, power, square root and others. On examples at the end it will be shown that the combination of code-to-code transformation and backward mode of automatic differentiation leads to highly numerically efficient and machine precision accurate codes. Efficiency of the numerical code can be further improved when a structure of argument 
                           A
                         (e.g. sparsity or symmetry) is exploited. This is done automatically by the code optimization capabilities of code generator AceGen. 
                           Algorithm 1
                           Automation of calculation of matrix function and its derivatives. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                   ←
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                   tr
                                                   (
                                                   A
                                                   )
                                                ; 
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ←
                                                   A
                                                   −
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                   I
                                                ; 
                                                   p
                                                   ←
                                                   tr
                                                   (
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   .
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                         T
                                                      
                                                   
                                                   )
                                                ; 
                                                   q
                                                   ←
                                                   det
                                                   (
                                                   A
                                                   )
                                                ;
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Δ
                                                   ←
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   −
                                                   27
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                ;
                                          
                                          
                                             
                                                if 
                                                
                                                   Δ
                                                   <
                                                   0
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                      Exit
                                                      ;
                                                      
                                                      //
                                                      
                                                      
                                                         Matrix
                                                      
                                                      
                                                      A
                                                      
                                                      
                                                         has
                                                         
                                                         complex
                                                         
                                                         eigenvalues
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                end if
                                             
                                          
                                          
                                             If matrix function requires A to be positive definite 
                                                   (
                                                   det
                                                   (
                                                   A
                                                   )
                                                   >
                                                   0
                                                   )
                                                ,
                                          
                                          
                                             additional conditions are required;
                                          
                                          
                                             
                                                if 
                                                
                                                   p
                                                   <
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               G
                                                               ←
                                                               
                                                                  
                                                                     G
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                               (
                                                               p
                                                               ,
                                                               q
                                                               ,
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     v
                                                                  
                                                               
                                                               )
                                                               ;
                                                               
                                                               //
                                                               
                                                               
                                                                  G
                                                                  
                                                                  is
                                                                  
                                                                  symbolically
                                                                  
                                                                  expanded
                                                                  
                                                                  around
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               p
                                                               =
                                                               0
                                                               
                                                               
                                                                  and
                                                               
                                                               
                                                               q
                                                               =
                                                               0
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                else
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               t
                                                               ←
                                                               
                                                                  
                                                                     
                                                                        
                                                                           2
                                                                        
                                                                        
                                                                           3
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               ;
                                                               
                                                               r
                                                               ←
                                                               3
                                                               
                                                                  
                                                                     6
                                                                  
                                                               
                                                               
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                           
                                                                           
                                                                              3
                                                                              /
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               ;
                                                            
                                                         
                                                         
                                                            
                                                               if
                                                               
                                                               r
                                                               >
                                                               −
                                                               1
                                                               +
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                               
                                                               and
                                                               
                                                               r
                                                               <
                                                               1
                                                               −
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                               
                                                               then
                                                            
                                                         
                                                         
                                                            
                                                               |
                                                               
                                                                  
                                                                  G
                                                                  ←
                                                                  G
                                                                  (
                                                                  r
                                                                  ,
                                                                  t
                                                                  ,
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        v
                                                                     
                                                                  
                                                                  )
                                                                  ;
                                                                  
                                                                  //
                                                                  
                                                                     General
                                                                     
                                                                     case
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               else
                                                            
                                                         
                                                         
                                                            
                                                               |
                                                               
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           if
                                                                           
                                                                           r
                                                                           <
                                                                           −
                                                                           1
                                                                           +
                                                                           
                                                                              
                                                                                 ε
                                                                              
                                                                              
                                                                                 r
                                                                              
                                                                           
                                                                           
                                                                           then
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           |
                                                                           
                                                                              
                                                                              
                                                                                 
                                                                                    s
                                                                                 
                                                                                 
                                                                                    r
                                                                                 
                                                                              
                                                                              ←
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           else
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           |
                                                                           
                                                                              
                                                                              
                                                                                 
                                                                                    s
                                                                                 
                                                                                 
                                                                                    r
                                                                                 
                                                                              
                                                                              ←
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           end
                                                                           
                                                                           if
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           G
                                                                           ←
                                                                           
                                                                              
                                                                                 G
                                                                              
                                                                              
                                                                                 r
                                                                              
                                                                           
                                                                           (
                                                                           r
                                                                           ,
                                                                           t
                                                                           ,
                                                                           
                                                                              
                                                                                 λ
                                                                              
                                                                              
                                                                                 v
                                                                              
                                                                           
                                                                           ,
                                                                           
                                                                              
                                                                                 s
                                                                              
                                                                              
                                                                                 r
                                                                              
                                                                           
                                                                           )
                                                                           ;
                                                                           
                                                                           //
                                                                           
                                                                           
                                                                              G
                                                                              
                                                                              is
                                                                              
                                                                              symbolically
                                                                              
                                                                              expanded
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              around
                                                                           
                                                                           
                                                                           r
                                                                           =
                                                                           ±
                                                                           1
                                                                           .
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               end
                                                               
                                                               if
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                end
                                                
                                                if
                                             
                                          
                                          
                                             Calculation of matrix function and its derivatives using automatic differentiation;
                                          
                                          
                                             
                                                
                                                   F
                                                   (
                                                   A
                                                   )
                                                   ←
                                                   
                                                      
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                         G
                                                      
                                                      
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                   
                                                ; 
                                                   D
                                                   F
                                                   (
                                                   A
                                                   )
                                                   ←
                                                   
                                                      
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                         F
                                                         (
                                                         A
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                         A
                                                      
                                                   
                                                ; 
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   F
                                                   (
                                                   A
                                                   )
                                                   ←
                                                   
                                                      
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                         D
                                                         F
                                                         (
                                                         A
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                         A
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                return 
                                                
                                                   F
                                                   (
                                                   A
                                                   )
                                                , 
                                                   D
                                                   F
                                                   (
                                                   A
                                                   )
                                                , 
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   F
                                                   (
                                                   A
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The general formulation of matrix functions was presented in previous Sections 2.1 and 2.2. Here, some examples of the most common matrix functions will be presented. The most common matrix functions observed in solid mechanics are matrix exponential 
                           (
                           exp
                           
                           A
                           )
                        , logarithm 
                           (
                           log
                           
                           A
                           )
                        , square root 
                           (
                           
                              
                                 A
                              
                           
                           )
                         and arbitrary real power 
                           (
                           
                              
                                 A
                              
                              
                                 η
                              
                           
                           )
                        . Equivalent scalar function 
                           f
                           (
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           )
                        , corresponding auxiliary function 
                           g
                           (
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           )
                         according to Eq. (1) and the generating function 
                           G
                           (
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           )
                         according to Eq. (2) are for all considered matrix functions presented in Table 1
                        .

Two special regions have to be considered where the generating function is ill-conditioned and it has to be replaced by its series expansion. The necessary order of expansions and the border between the regions were determined after an extensive numerical experiments were preformed using the high-precision arithmetic in Mathematica. The largest numerical error appears in the evaluation of the second derivatives of matrix function. Consequently, the boundary of the regions and the necessary order of expansion cannot be determined by examining the error of the generating function alone.


                        Fig. 3
                         depicts a characteristic example of the error of the second derivative of matrix exponential, matrix power and matrix logarithm for the second special case 
                           r
                           →
                           1
                        . The error is shown for the general form of generating function G and the third-order (n
                        
                           r
                        =3) series expansion around r=1. A general third-order expansion of generating function G around 
                           r
                           =
                           ±
                           1
                         follows from (8) as
                           
                              (11)
                              
                                 
                                    
                                       G
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       
                                          G
                                       
                                       |
                                    
                                    
                                       r
                                       →
                                       ±
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                G
                                             
                                             
                                                ∂
                                                r
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       →
                                       ±
                                       1
                                    
                                 
                                 (
                                 r
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       r
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      2
                                                   
                                                
                                                G
                                             
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       →
                                       ±
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             (
                                             r
                                             +
                                             
                                                
                                                   s
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      3
                                                   
                                                
                                                G
                                             
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       →
                                       ±
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             (
                                             r
                                             +
                                             
                                                
                                                   s
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                          
                                          
                                             3
                                          
                                       
                                    
                                    
                                       6
                                    
                                 
                                 .
                              
                           
                        
                     

The third-order expansion has been chosen because it is the highest order for which we were able to derive closed form expressions of the coefficients of the series expansion. The error of the general form decreases with the distance from the critical point r=1 and the error of the series approximation increases with the distance from the critical point. Thus, the optimal choice for the border between the regions is where the two error curves intersect. In the case of matrix exponential the intersection appears approximately at 
                           
                              
                                 ε
                              
                              
                                 r
                              
                           
                           =
                           1
                           −
                           r
                           =
                           0.002
                         and for the other functions approximately at 
                           
                              
                                 ε
                              
                              
                                 r
                              
                           
                           =
                           0.001
                        . From Fig. 3 we can see that 
                           
                              
                                 ε
                              
                              
                                 r
                              
                           
                           =
                           0.002
                         leads to the maximum error of the second derivative of matrix exponential approximately 10−12 and for the other functions 
                           
                              
                                 ε
                              
                              
                                 r
                              
                           
                           =
                           0.001
                         leads to the maximum error of the second derivative approximately 10−11. It is obvious that by decreasing the value of ε
                        
                           r
                         the required order of series expansion n
                        
                           r
                         can be decreased, however the intersection point would then move closer to the critical point and the maximum error would be increased.

Similar analysis can also be done for the first critical region where 
                           p
                           →
                           0
                        . Series expansion is for the first special case defined by a maximum order derivative n
                        
                           p
                         of G with respect to p, maximum order derivative n
                        
                           q
                         with respect to q and the maximum combined power n
                        
                           pq
                         as defined by Eq. (7). Again the maximum order of expansion is chosen and the border between the regions is placed approximately at the intersection of the error curves. As opposed to the previous case, the closed form expressions of the coefficients of the series expansion (7) can be derived for an arbitrary order of expansion. For the chosen n
                        
                           p
                        =7, n
                        
                           q
                        =4 and 
                           
                              
                                 n
                              
                              
                                 pq
                              
                           
                           =
                           7
                         the matrix exponential leads to 
                           
                              
                                 ε
                              
                              
                                 p
                              
                           
                           =
                           0.2
                         while other matrix functions give 
                           
                              
                                 ε
                              
                              
                                 p
                              
                           
                           =
                           0.05
                         for chosen n
                        
                           p
                        =8, n
                        
                           q
                        =6 and 
                           
                              
                                 n
                              
                              
                                 pq
                              
                           
                           =
                           8
                        . The series expansion of generating function of matrix exponential is more accurate than of the other functions. Consequently, matrix exponential requires lover order of expansion and expansion accurately covers larger region. The series expansion of the generating function is a polynomial function, free of trigonometric functions and consequently numerically more efficient. This is shown on examples in Section 3. Thus, it is beneficial for ε
                        
                           p
                         to be as large as possible as long as the derived equations fulfill the condition for the machine precision accurate results.

The chosen order of expansion and the tolerances are summarized for all considered matrix function in Table 2
                        . The chosen values lead to the program codes that return machine precision accurate matrix functions on the whole definition interval. High precision is retained also for the first derivatives of matrix functions, while the error of the second derivatives remains below 10−10. Some characteristic results of the numerical experiments are for both special cases presented in Section 3. The derived formulas of generating function expansion for the both special cases and for all considered matrix functions are given in Appendix A.

Numerical efficiency and accuracy of derived codes for the evaluation of matrix functions and their first and second derivatives is analyzed in this chapter on a set of numerical examples.

The following matrices will be used for assessment:
                        
                           (12)
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              =
                              [
                              
                                 
                                    
                                       
                                          a
                                          +
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ]
                              
                              and
                              
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                              =
                              I
                              +
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              [
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          1
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          0
                                       
                                       
                                          a
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          1
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              ]
                           
                        
                     where a is a free parameter. By varying the value of a the matrices undergo transition between the general form of generating function (G) and the two special cases (G
                     
                        p
                      and G
                     
                        r
                     ). The generating functions of matrix 
                        
                           
                              M
                           
                           
                              1
                           
                        
                      undergo transition from the first special case (G
                     
                        p
                     ) into the second special case (G
                     
                        r
                     ), while the generating functions of matrix 
                        
                           
                              M
                           
                           
                              2
                           
                        
                      undergo transition from the second special case (G
                     
                        r
                     ) into the general form (G) as depicted in Fig. 4
                     . Since tolerances ε
                     
                        p
                      and ε
                     
                        r
                      are different for matrix exponential and other considered functions (see Table 2), the transition happens at different values of parameter a. For exponential, parameter a is taken from interval 
                        [
                        0
                        ,
                        0.8
                        ]
                      and for other functions from interval 
                        [
                        0
                        ,
                        0.4
                        ]
                     .

For the purpose of comparing accuracy and efficiency of the closed-form representation, matrix functions are alternatively defined by respective infinite power series expansion. The series expansions can be formulated from matrix functions׳ scalar counterparts. They are generally convergent on specific area and under certain conditions. The exponential of second-order tensor 
                           A
                         can be defined by the following infinite power series:
                           
                              (13)
                              
                                 exp
                                 
                                 A
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       i
                                       !
                                    
                                 
                                 
                                    
                                       
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 I
                                 +
                                 A
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    
                                       
                                       A
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 ⋯
                                 .
                              
                           
                        
                     

Series is absolutely convergent for arbitrary 
                           A
                        . The logarithm of second-order tensor 
                           A
                         can be defined by the following infinite power series:
                           
                              (14)
                              
                                 log
                                 
                                 A
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    
                                       2
                                    
                                    
                                       2
                                       i
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       (
                                       
                                          (
                                          A
                                          −
                                          I
                                          )
                                          ·
                                          
                                             
                                                (
                                                A
                                                +
                                                I
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       2
                                       i
                                       +
                                       1
                                       )
                                    
                                 
                                 =
                                 2
                                 (
                                 A
                                 −
                                 I
                                 )
                                 ·
                                 
                                    
                                       (
                                       A
                                       +
                                       I
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       2
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       (
                                       
                                          (
                                          A
                                          −
                                          I
                                          )
                                          ·
                                          
                                             
                                                (
                                                A
                                                +
                                                I
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       2
                                    
                                    
                                       5
                                    
                                 
                                 
                                    
                                       (
                                       
                                          (
                                          A
                                          −
                                          I
                                          )
                                          ·
                                          
                                             
                                                (
                                                A
                                                +
                                                I
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    
                                       5
                                    
                                 
                                 …
                                 .
                              
                           
                        Series is absolutely convergent for positive definite matrix 
                           A
                        . The power of second-order tensor 
                           A
                         can be defined by the following infinite power series:
                           
                              (15)
                              
                                 
                                    
                                       A
                                    
                                    
                                       η
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       ∞
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             η
                                          
                                       
                                       
                                          
                                             i
                                          
                                       
                                    
                                 
                                 )
                                 
                                    
                                       (
                                       A
                                       −
                                       I
                                       )
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 I
                                 +
                                 η
                                 (
                                 A
                                 −
                                 I
                                 )
                                 +
                                 (
                                 
                                    
                                       
                                          
                                             η
                                          
                                       
                                       
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                                 
                                    
                                       (
                                       A
                                       −
                                       I
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       
                                          
                                             η
                                          
                                       
                                       
                                          
                                             3
                                          
                                       
                                    
                                 
                                 )
                                 
                                    
                                       (
                                       A
                                       −
                                       I
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 ⋯
                                 .
                              
                           
                        
                     

Series is absolutely convergent for eigenvalues of matrix 
                           A
                         on interval 
                           0
                           <
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           <
                           2
                        .

A representative algorithm for the evaluation of the matrix logarithm series expansion is presented in Algorithm 2. Derivatives of matrix functions are derived directly with automatic differentiation techniques. The desired accuracy of increment 
                           
                              
                                 ε
                              
                              
                                 T
                              
                           
                         of the second derivative of the matrix function׳s approximation is prescribed, and each of the series terminates when the norm of increment of the second derivative falls below the desired tolerance. The number of terms needed for series is therefore guided by the accuracy of the second derivative, which is larger than the number of terms needed for matrix function. Therefore, the accuracy of matrix function and its first derivative is automatically satisfied, when the second derivative has the desired accuracy. 
                           Algorithm 2
                           Automation of code derivation for truncated series approximation of matrix logarithm and its first and second derivatives. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   n
                                                   ←
                                                   0
                                                , 
                                                   B
                                                   ←
                                                   (
                                                   A
                                                   −
                                                   I
                                                   )
                                                   ·
                                                   
                                                      
                                                         (
                                                         A
                                                         +
                                                         I
                                                         )
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                , 
                                                   C
                                                   ←
                                                   B
                                                 and 
                                                   F
                                                   (
                                                   A
                                                   )
                                                   ←
                                                   0
                                                ;
                                          
                                          
                                             
                                                repeat
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               B
                                                               ←
                                                               B
                                                               .
                                                               C
                                                               ;
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     F
                                                                  
                                                                  
                                                                     inc
                                                                  
                                                               
                                                               ←
                                                               
                                                                  
                                                                     
                                                                        2
                                                                     
                                                                     
                                                                        2
                                                                        n
                                                                        +
                                                                        1
                                                                     
                                                                  
                                                               
                                                               B
                                                               ;
                                                               F
                                                               (
                                                               A
                                                               )
                                                               ←
                                                               F
                                                               (
                                                               A
                                                               )
                                                               +
                                                               
                                                                  
                                                                     F
                                                                  
                                                                  
                                                                     inc
                                                                  
                                                               
                                                               ;
                                                            
                                                         
                                                         
                                                            
                                                               D
                                                               
                                                                  
                                                                     F
                                                                  
                                                                  
                                                                     inc
                                                                  
                                                               
                                                               ←
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              δ
                                                                           
                                                                           
                                                                              ^
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              F
                                                                           
                                                                           
                                                                              inc
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              δ
                                                                           
                                                                           
                                                                              ^
                                                                           
                                                                        
                                                                        A
                                                                     
                                                                  
                                                               
                                                               ;
                                                               D
                                                               F
                                                               (
                                                               A
                                                               )
                                                               ←
                                                               D
                                                               F
                                                               (
                                                               A
                                                               )
                                                               +
                                                               D
                                                               
                                                                  
                                                                     F
                                                                  
                                                                  
                                                                     inc
                                                                  
                                                               
                                                               ;
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     D
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     F
                                                                  
                                                                  
                                                                     inc
                                                                  
                                                               
                                                               ←
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              δ
                                                                           
                                                                           
                                                                              ^
                                                                           
                                                                        
                                                                        D
                                                                        
                                                                           
                                                                              F
                                                                           
                                                                           
                                                                              inc
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              δ
                                                                           
                                                                           
                                                                              ^
                                                                           
                                                                        
                                                                        A
                                                                     
                                                                  
                                                               
                                                               ;
                                                               
                                                                  
                                                                     D
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               F
                                                               (
                                                               A
                                                               )
                                                               ←
                                                               
                                                                  
                                                                     D
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               F
                                                               (
                                                               A
                                                               )
                                                               +
                                                               
                                                                  
                                                                     D
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     F
                                                                  
                                                                  
                                                                     inc
                                                                  
                                                               
                                                               ;
                                                            
                                                         
                                                         
                                                            
                                                               n
                                                               ←
                                                               n
                                                               +
                                                               1
                                                               ;
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                until 
                                                
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  inc
                                                               
                                                            
                                                         
                                                         ‖
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         T
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                ;
                                          
                                          
                                             
                                                return 
                                                
                                                   F
                                                   (
                                                   A
                                                   )
                                                , 
                                                   D
                                                   F
                                                   (
                                                   A
                                                   )
                                                 and 
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   F
                                                   (
                                                   A
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Approximations derived using Algorithm 2 are used for comparison with closed-form matrix functions derived using Algorithm 1. All program codes were generated using AceGen automatic code generator that can generate codes in various program languages. Codes for the evaluation of the closed-form representation of matrix functions 
                           F
                           (
                           M
                           )
                         and their derivatives 
                           D
                           F
                           (
                           M
                           )
                         and 
                           
                              
                                 D
                              
                              
                                 2
                              
                           
                           F
                           (
                           M
                           )
                         were generated in C language using standard machine precision.

The accuracy is compared with truncated series approximation of the corresponding matrix function 
                              F
                              
                                 
                                    (
                                    M
                                    )
                                 
                                 
                                    ref
                                 
                              
                            and its derivatives 
                              D
                              F
                              
                                 
                                    (
                                    M
                                    )
                                 
                                 
                                    ref
                                 
                              
                            and 
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                              
                              F
                              
                                 
                                    (
                                    M
                                    )
                                 
                                 
                                    ref
                                 
                              
                           . For the purpose of comparison of accuracy, codes for the evaluation of reference value were generated in Mathematica language and evaluated with 100-digit high precision arithmetics in Mathematica. The accuracy of the method is defined by the Frobenius matrix norm of the differences between the results of closed-form representation and the corresponding series approximation and shown successively in Figs. 5–8
                           
                           
                           
                           . The error of the functions is defined by 
                              ∥
                              F
                              (
                              M
                              )
                              −
                              F
                              
                                 
                                    (
                                    M
                                    )
                                 
                                 
                                    ref
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    F
                                 
                              
                           , of the first derivative by 
                              Δ
                              D
                              F
                              =
                              ∥
                              D
                              F
                              (
                              M
                              )
                              −
                              D
                              F
                              
                                 
                                    (
                                    M
                                    )
                                 
                                 
                                    ref
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    F
                                 
                              
                            and the second derivative by 
                              Δ
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                              
                              F
                              =
                              ∥
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                              
                              F
                              (
                              M
                              )
                              −
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                              
                              F
                              
                                 
                                    (
                                    M
                                    )
                                 
                                 
                                    ref
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    F
                                 
                              
                           . Only the error of the first and the second derivatives is shown. The error of matrix function itself is not shown on graphs, since it is in all cases below 10−14. With higher derivatives, the error increases. The error of the first derivatives is below 10−13, and the error of the second derivatives below 10−10 for both matrices considered (
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                           ) and all matrix functions considered. The errors are highest at the transition from various representations of generating functions (see Fig. 4). When distancing away, all errors fall below 10−14. It can be concluded that all matrix functions and their first and second derivatives are sufficiently numerically accurate.

For the test of numerical efficiency both codes, closed-form representation and truncated series, were derived in C language in order to maximize the objectivity of comparisons. Closed-form representations of matrix functions are compared with their truncated series counterparts evaluated with accuracy 
                              
                                 
                                    ε
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    10
                                 
                                 
                                    −
                                    16
                                 
                              
                           . The numerical efficiency is checked for both matrices 
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                           . Let us define with
                              
                                 (16)
                                 
                                    
                                       
                                          t
                                       
                                       
                                          F
                                       
                                    
                                    =
                                    time
                                    (
                                    F
                                    ,
                                    D
                                    F
                                    ,
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    F
                                    )
                                 
                              
                           the CPU time needed to evaluate matrix function 
                              F
                            together with its first and second derivatives 
                              D
                              F
                            and 
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                              
                              F
                           , where 
                              F
                            can be matrix exponent 
                              exp
                              
                              M
                           , matrix logarithm 
                              log
                              
                              M
                           , matrix square root 
                              
                                 
                                    M
                                 
                              
                            or matrix power 
                              
                                 
                                    M
                                 
                                 
                                    η
                                 
                              
                           . Similarly
                              
                                 (17)
                                 
                                    
                                       
                                          t
                                       
                                       
                                          F
                                          ,
                                          ser
                                       
                                    
                                    =
                                    time
                                    (
                                    
                                       
                                          F
                                       
                                       
                                          ser
                                       
                                    
                                    ,
                                    D
                                    
                                       
                                          F
                                       
                                       
                                          ser
                                       
                                    
                                    ,
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          ser
                                       
                                    
                                    )
                                 
                              
                           defines the CPU time needed to evaluate their truncated series counterparts. In the case of closed-form representation, time depends on the selected closed-form representation of generating function (G, G
                           
                              p
                            or G
                           
                              r
                           ) and is constant within the same region as presented in Fig. 4. In the case of truncated series, time depends on the convergence rate that in turn depends on the maximum eigenvalue of the matrix which in general grows with the growth of free parameter a.

First, the numerical efficiency is compared for different selected closed-form representations of generating functions (G, G
                           
                              p
                            or G
                           
                              r
                           ). The time needed to evaluate the selected matrix function 
                              F
                            together with its first and second derivative is normalized against 
                              
                                 
                                    t
                                 
                                 
                                    exp
                                    
                                    M
                                    ,
                                    G
                                 
                              
                           , which is the time needed to evaluate matrix exponential and its first and second derivative in the region where a general closed-form representation of generating function G is used. Results are presented in Figs. 9
                           a, 10
                           a, 11
                           a and 12
                           a for all matrix functions considered. From these figures, the relative numerical efficiency of the evaluation of particular matrix function can be estimated for all forms of generating function. We can see that all functions have similar evaluation times and that the evaluation of functions in the region 
                              p
                              ←
                              0
                            is approximately twice as fast as the general case. The only exception is the evaluation of matrix logarithm where the computational time is approximately the same for all regions.

Second, the numerical efficiency of closed-form representation against the numerical efficiency of truncated series approximations is depicted in Figs. 9b, 10b, 11b and 12b for all matrix functions considered. The time needed for the evaluation of matrix function together with its first and second derivative using truncated series approximation 
                              
                                 
                                    t
                                 
                                 
                                    F
                                    ,
                                    ser
                                 
                              
                            is in all cases normalized against the time needed for the evaluation of closed-form representation 
                              
                                 
                                    t
                                 
                                 
                                    F
                                 
                              
                           . It can be observed that there is a huge difference in time between closed-form representation and truncated series approximation in all cases. The series approximations have longer times for factors in the range from 10 to 20 times for matrix logarithm, 30 to 70 times for matrix exponential and from 15 to 40 times for matrix power and square root. In [3] it was shown that the time for the evaluation of matrix exponential without derivatives is similar for both implementations and that the truncated series are approximately 5 times slower when the first derivative must also be evaluated. The huge increase in the presented case is due to expensive evaluation of the second derivative. Additionally, the accuracy of the second derivative must be monitored, which is also a numerically expensive operation.

In order to eliminate the administrative time, the calculation of 
                              
                                 
                                    t
                                 
                                 
                                    F
                                 
                              
                            and 
                              
                                 
                                    t
                                 
                                 
                                    F
                                    ,
                                    ser
                                 
                              
                            was repeated 200,000 times. All simulations were performed on Intel i7-2700K 3.50GHz based PC with Microsoft Windows 7 64bit OS and MinGW 5.1.3 compiler with 16GB of DDR RAM. When evaluating the efficiency, a single thread was used.

The advantages of the closed-form representation of matrix functions will be shown on various hyperelastic and finite strain elasto-plastic models where the use of matrix functions and their derivatives is required. All the elements were derived following the automatic differentiation based formulation of nonlinear finite elements (or ADB formulation) proposed in [18] and extended to general finite strain plasticity in [3]. ADB combines symbolic description of basic equations and simultaneous code optimization with automatic differentiation based derivation of element contribution to the global equilibrium equations (also called element residual vector) and the element contribution to the global tangent matrix. The ADB formulation of hyperelasticity and finite strain plasticity is in detail explained in [18] and [3] and it will not be repeated here. Only the hyperelastic strain energy functions and plastic evolution equations specific for particular material model are presented here.

For the basic hyperelastic model the isotropic Hencky model [19] is chosen, where strain energy is expressed with the logarithm of stretches. Isotropic Hencky strain energy function is written as
                           
                              (18)
                              
                                 
                                    
                                       W
                                    
                                    
                                       Hencky
                                    
                                 
                                 =
                                 
                                    
                                       κ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 μ
                                 ∥
                                 
                                    
                                       e
                                    
                                    
                                       ^
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        where 
                           θ
                           =
                           log
                           (
                           
                              
                                 J
                              
                              
                                 F
                              
                           
                           )
                         is logarithm of Jacobian of deformation gradient 
                           
                              
                                 J
                              
                              
                                 F
                              
                           
                           =
                           det
                           
                           F
                         and μ and κ are shear and bulk moduli. The 
                           
                              
                                 e
                              
                              
                                 ^
                              
                           
                         is deviatoric part of Eulerian logarithmic deformation tensor 
                           e
                         that can be calculated directly from the left Cauchy-Green deformation tensor 
                           b
                           =
                           
                              
                                 FF
                              
                              
                                 T
                              
                           
                         by 
                           
                              
                                 e
                              
                              
                                 ^
                              
                           
                           =
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           
                           log
                           (
                           
                              
                                 J
                              
                              
                                 F
                              
                              
                                 −
                                 2
                                 /
                                 3
                              
                           
                           b
                           )
                        . Note that matrix logarithm is in code directly evaluated using closed-form matrix logarithm representation. The evaluation of the element residual vector requires the evaluation of the first derivative of the matrix logarithm and the evaluation of the element tangent matrix the second derivative of matrix logarithm.

For the comparison of efficiency, the standard hyperelastic Neo-Hookean material is chosen, since it does not require the use of matrix functions. The strain energy function of Neo-Hookean material is chosen as
                           
                              (19)
                              
                                 
                                    W
                                    NeoHooke
                                 
                                 =
                                 
                                    λ
                                    2
                                 
                                 
                                 
                                    
                                       
                                          
                                             J
                                             F
                                          
                                          -
                                          1
                                       
                                    
                                    2
                                 
                                 +
                                 μ
                                 
                                    
                                       
                                          1
                                          2
                                       
                                       
                                       
                                          
                                             tr
                                             
                                             b
                                             -
                                             3
                                          
                                       
                                       -
                                       log
                                       
                                       
                                          J
                                          F
                                       
                                    
                                 
                              
                           
                        where λ and μ are Lame׳s constants.

The standard multiplicative finite strain elastoplasticity framework (see e.g. [20]) is employed here. In this framework the strain energies (18) and (19) are expressed with elastic left Cauchy-Green deformation tensor 
                           
                              
                                 b
                              
                              
                                 e
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       b
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       e
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       e
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       FC
                                    
                                    
                                       p
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        and determinant of elastic deformation gradient 
                           
                              
                                 J
                              
                              
                                 F
                              
                              
                                 e
                              
                           
                           =
                           
                              
                                 
                                 det
                                 
                                 
                                    
                                       b
                                    
                                    
                                       e
                                    
                                 
                              
                           
                        . 
                           
                              
                                 C
                              
                              
                                 p
                              
                              
                                 −
                                 1
                              
                           
                         is an inverse of plastic right Cauchy-Green deformation tensor. The components of 
                           
                              
                                 C
                              
                              
                                 p
                              
                              
                                 −
                                 1
                              
                           
                         are internal variables of the problem defined separately for each material (integration) point. The evolution equations for 
                           
                              
                                 C
                              
                              
                                 p
                              
                              
                                 −
                                 1
                              
                           
                         are given as 
                           −
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           
                              
                                 L
                              
                              
                                 v
                              
                           
                           
                              
                                 b
                              
                              
                                 e
                              
                           
                           =
                           Δ
                           
                              
                                 γ
                              
                              
                                 ̇
                              
                           
                           n
                           
                              
                                 b
                              
                              
                                 e
                              
                           
                        , where 
                           
                              
                                 L
                              
                              
                                 v
                              
                           
                           
                              
                                 b
                              
                              
                                 e
                              
                           
                         is Oldroyd derivative of 
                           
                              
                                 b
                              
                              
                                 e
                              
                           
                        , 
                           n
                           =
                           
                              
                                 ∂
                                 ϕ
                              
                              
                                 ∂
                                 τ
                              
                           
                         is direction of flow and ϕ the yield function. Evolution equations can be written in discretized form as
                           
                              (21)
                              
                                 
                                    FC
                                    p
                                    
                                       -
                                       1
                                    
                                 
                                 -
                                 exp
                                 
                                    
                                       -
                                       2
                                       
                                          
                                             γ
                                             -
                                             
                                                γ
                                                n
                                             
                                          
                                       
                                       
                                          n
                                          
                                             n
                                             f
                                          
                                       
                                    
                                 
                                 
                                    FC
                                    
                                       p
                                       ,
                                       n
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 =
                                 0
                              
                           
                        where γ is plastic multiplier and n
                        
                           f
                         is normalizing factor that is usually 1. Note that matrix exponential is in code directly evaluated using closed-form representation of matrix exponential. Alternatively the evolution equations can also be integrated using standard backward-Euler scheme [20]
                        
                           
                              (22)
                              
                                 F
                                 
                                    
                                       
                                          C
                                          p
                                          
                                             -
                                             1
                                          
                                       
                                       -
                                       
                                          C
                                          
                                             p
                                             ,
                                             n
                                          
                                          
                                             -
                                             1
                                          
                                       
                                    
                                 
                                 
                                    F
                                    T
                                 
                                 +
                                 
                                    
                                       2
                                       
                                          
                                             γ
                                             -
                                             
                                                γ
                                                n
                                             
                                          
                                       
                                       
                                          n
                                          
                                             n
                                             f
                                          
                                       
                                    
                                 
                                 
                                    b
                                    e
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     

Two yield functions will be used, i.e. the standard Huber-von Mises and a more complex modified Cam-Clay yield function.

Standard Huber-von Mises yield function takes the form
                              
                                 (23)
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          Mises
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    ∥
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    ∥
                                    −
                                    
                                       
                                          σ
                                       
                                       
                                          y
                                       
                                    
                                    (
                                    γ
                                    )
                                 
                              
                           where 
                              
                                 
                                    τ
                                 
                                 
                                    ′
                                 
                              
                            is deviatoric part of Kirchoff stress tensor and 
                              
                                 
                                    σ
                                 
                                 
                                    y
                                 
                              
                              (
                              γ
                              )
                            yield stress. Kirchoff stress tensor can be evaluated directly from elastic strain energy function as 
                              τ
                              =
                              2
                              
                                 
                                    b
                                 
                                 
                                    e
                                 
                              
                              
                                 
                                    ∂
                                    W
                                    (
                                    
                                       
                                          b
                                       
                                       
                                          e
                                       
                                    
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          b
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                           . Isotropic exponential hardening law (see e.g. [20]) can be written as
                              
                                 (24)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          y
                                       
                                    
                                    (
                                    γ
                                    )
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          y
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          K
                                       
                                       
                                          h
                                       
                                    
                                    γ
                                    +
                                    
                                       
                                          R
                                       
                                       
                                          ∞
                                       
                                    
                                    (
                                    1
                                    −
                                    exp
                                    (
                                    −
                                    δ
                                    γ
                                    )
                                    )
                                 
                              
                           with material constants 
                              
                                 
                                    σ
                                 
                                 
                                    y
                                    0
                                 
                              
                           , 
                              
                                 
                                    K
                                 
                                 
                                    h
                                 
                              
                           , 
                              
                                 
                                    R
                                 
                                 
                                    ∞
                                 
                              
                            and δ.

As a more complex example an elasto-plastic modified Cam-Clay model at finite strains is chosen. Modified Cam-Clay model is a basic model for soil, the volumetric strain energy of which is expressed with logarithm of stretches and its plastic yield surface is ellipsoid, the radius of which changes with the change of porosity. The model will be formulated according to Ortiz and Pandolfi [4]. Elastic strain energy of Cam-Clay model is equal to Hencky strain energy, already given by Eq. (18). The Cam-Clay yield surface is given as
                              
                                 (25)
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          CamClay
                                       
                                    
                                    =
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    p
                                    (
                                    p
                                    −
                                    
                                       
                                          p
                                       
                                       
                                          c
                                       
                                    
                                    )
                                 
                              
                           where p
                           
                              c
                            is consolidation pressure, 
                              p
                              =
                              
                                 
                                    1
                                 
                                 
                                    3
                                 
                              
                              
                              tr
                              (
                              σ
                              )
                            is Cauchy hydrostatic pressure and 
                              q
                              =
                              
                                 
                                    
                                       
                                          2
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              ∥
                              
                                 
                                    σ
                                 
                                 
                                    ′
                                 
                              
                              ∥
                           , 
                              
                                 
                                    σ
                                 
                                 
                                    ′
                                 
                              
                              =
                              σ
                              −
                              p
                              
                              I
                            is deviatoric stresses and α defines the slope of critical state line. Cauchy stress 
                              σ
                              =
                              τ
                              /
                              
                                 
                                    J
                                 
                                 
                                    F
                                 
                              
                            can be derived from Kirchoff stress 
                              τ
                              =
                              2
                              
                                 
                                    b
                                 
                                 
                                    e
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          W
                                       
                                       
                                          Hencky
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          b
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    J
                                 
                                 
                                    F
                                 
                              
                              
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                           , where p
                           0 is initial pressure in soil. According to Ortiz and Pandolfi [4] the normalizing factor n
                           
                              f
                            for modified Cam-Clay model leads to 
                              
                                 
                                    n
                                 
                                 
                                    f
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                    tr
                                    
                                       
                                          (
                                          n
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          2
                                       
                                       
                                          3
                                       
                                    
                                    ∥
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    ∥
                                 
                              
                           . The hardening law for consolidation pressure is given as
                              
                                 (26)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          p
                                       
                                       
                                          ref
                                       
                                    
                                    
                                    exp
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   p
                                                
                                             
                                          
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   ref
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           where 
                              
                                 
                                    θ
                                 
                                 
                                    p
                                 
                              
                              =
                              log
                              (
                              
                                 
                                    J
                                 
                                 
                                    F
                                 
                              
                              /
                              
                                 
                                    J
                                 
                                 
                                    F
                                 
                                 
                                    e
                                 
                              
                              )
                            is plastic logarithmic volumetric strain, 
                              
                                 
                                    p
                                 
                                 
                                    ref
                                 
                              
                            is the reference consolidation pressure and 
                              
                                 
                                    θ
                                 
                                 
                                    ref
                                 
                                 
                                    p
                                 
                              
                            is the reference logarithmic volumetric strain. All together four material constants are needed.

The presented hyper-elastic strain energy functions and yield functions are combined in order to get elements with various combinations of matrix functions and their derivatives. The material models considered are defined in Table 3
                         and the actual appearance of matrix functions and their derivatives within the definition of element residual and tangent matrix in Table 4
                        .

All codes for the evaluation of matrix functions together with the first and second derivatives were derived and compiled in advance. A compiled numerical library was formed and included when all the object files were linked together to form single executable file.

All material models were implemented within a standard izoparametric, four noded, displacement based, axisymmetric finite element, integrated with a standard four point Gauss integration rule. For each material model a separate code was generated containing user subroutine that evaluates elements residual vector and tangent matrix. All codes were fully optimized according to particular model and automatically derived using the AceGen 
                        [5] automatic code generation system. The number of formulas derived during the code generation process and the physical size of the file containing the C code with the subroutine for the evaluation of element residual vector and tangent matrix are presented in Table 5
                        . Note that matrix functions are part of compiled numerical library, thus the code size and the code derivation time do not include derivation time and code size of matrix functions themselves. That is the reason why the code size does not differ much between the elasto-plastic elements based on exponential map and the elements based on standard backward-Eurler scheme.

We can see that the combination of ADB formulation, automatic code generator AceGen and compiled matrix functions libraries leads to the process that generates moderate size codes for complex material models in real time. The usual problem associated with automatic code generation, which is extremely large code sizes, is avoided with the proposed combination of tools.

Numerical efficiency of various elements will be compared on an example of axisymmetrical domain of dimension 1×1 discretized with 100×100 elements. The displacement 0.5 on top surface is prescribed and the displacement on vertical side is free. Simulation was done in 24 time steps so that at the end the domain is stretched by 50%. Due to the uniform strain-stress state all the integration points remain in either plastic or elastic regime. Initial yield stress was chosen so that all integration points remain in the same state during the whole simulation. The same elastic and plastic material parameters were used for all models and are presented in Table 6
                        .

The problem was solved using Newton–Raphson iterative procedure and consistently linearized tangent matrix. Thus, a quadratic convergence of the Newton–Raphson iterative procedure is expected. In Table 7
                         the norm of the increment of displacement for all Newton–Raphson iterations during a typical time step is presented. It can be seen that the quadratic convergence is achieved for all elements. Additionally, the total number of Newton–Raphson iterations performed during the simulation and the average number of Newton–Raphson iterations per time step are presented in Table 8
                        . As expected, the level of nonlinearity also affects the convergence. Elements based on Hencky strain energy function, thus employing matrix logarithm, converge more slowly than elements based on simple Neo-Hookean strain function, and the elements based on Cam-Clay yield function converge more slowly than the elements based on the simple Hubert-von Mises yield function.

For the assessment of numerical efficiency of automatically generated codes, the average time needed for the evaluation of element residual vector and element tangent matrix (or 
                           
                              
                                 K
                              
                              
                                 e
                              
                           
                         & 
                           
                              
                                 R
                              
                              
                                 e
                              
                           
                         time) are presented in Table 8 for hyperelastic elements and elasto-plastic elements based on exponential map and in Table 9
                         for elasto-plastic elements based on backward-Euler scheme. Parallelization of the code was disabled during the numerical efficiency test in order to get more objective comparisons.

It can be observed that there is a approximate increase by 7 times in 
                           
                              
                                 K
                              
                              
                                 e
                              
                           
                         & 
                           
                              
                                 R
                              
                              
                                 e
                              
                           
                         time for Hencky hyperelastic model when compared to Neo-Hokean hyperelastic model as a result of the evaluation of matrix logarithm together with its first and second derivatives. The same ratio is valid for the comparison of the 
                           
                              
                                 K
                              
                              
                                 e
                              
                           
                         & 
                           
                              
                                 R
                              
                              
                                 e
                              
                           
                         time between the Huber-von Mises elasto-plastic model based on Neo-Hooken and Hencky strain energy function. Also the average 
                           
                              
                                 K
                              
                              
                                 e
                              
                           
                         & 
                           
                              
                                 R
                              
                              
                                 e
                              
                           
                         time is about 40% longer if complex Cam-Clay compressible plasticity is used instead of Hubert-von Mises for the same strain energy function. The maximal difference in total evaluation time between the elasto-plastic elements based on exponential map and the same elements based on backward-Euler scheme is only 18%. This can be attributed to the fact that the backward-Euler scheme leads to asymmetric tangent matrix while the exponential map preserves the symmetry of the tangent matrix. Additional numerical cost for the formulation and solution of the asymmetric system of equations compensates the more costly integration scheme based on exponential map. The results presented in Tables 8 and 9 also show that in the case of incompressible elasto-plastic models the backward-Euler scheme does not fulfill the incompressibility condition 
                           det
                           
                           
                              
                                 F
                              
                              
                                 p
                              
                           
                           =
                           1
                        .

@&#CONCLUSIONS@&#

In this work, we have demonstrated a method for deriving a closed-form representation of an arbitrary matrix function and its first and second derivatives of 3×3 matrix with real eigenvalues. The presented method offers a unique solution to the standard problem of ill-conditioning in the vicinity of multiple equal eigenvalues. Numerical tests show that the error of matrix function itself is of the order of 10−14. The error of its first derivative is maximum 
                        5
                        ×
                        
                           
                              10
                           
                           
                              −
                              13
                           
                        
                      and the error of the second derivative is maximum 10−10.

The efficiency of the proposed closed-form representation of matrix functions together with its first and second derivatives was compared with the corresponding truncated series approximation. The results show that the truncated series approximations are from 20 to 80 times slower than the proposed closed forms, depending on the matrix.

A compiled numerical library of C subroutines was created which returns the evaluated matrix function and its first and second derivatives, defined with almost machine precision on whole definition area using AceGen automatic code generation system. Consequently, the matrix functions can be considered and used within the element formulation in the same way as other elementary functions and the formulation of complex non-linear materials can be greatly simplified.

The proposed methodology was tested on a set of selected hyperelastic and elasto-plastic material models where the matrix functions play an essential part of formulation. In all cases the derived C code was less than 200Kbytes large. The paper demonstrated that the combination of automatic differentiation based formulation of nonlinear finite elements, automatic code generator AceGen and a library of compiled matrix functions leads to the process that generates moderate size finite element codes for complex material models in real time.

@&#ACKNOWLEDGMENTS@&#

The financial support for this work was obtained from the Slovenian Research Agency within the PhD Grant Agreement no: 1000-11-310124.

The series expansion of matrix exponential generating function for the case when 
                           p
                           →
                           0
                         is derived according to Eq. (7) for n
                        
                           p
                        =7, n
                        
                           q
                        =4, 
                           
                              
                                 n
                              
                              
                                 pq
                              
                           
                           ≤
                           7
                         as:
                           
                              (A.1)
                              
                                 
                                    
                                       G
                                    
                                    
                                       exp
                                       ,
                                       p
                                    
                                 
                                 =
                                 exp
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          7
                                       
                                    
                                    /
                                    5579410636800
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          6
                                       
                                    
                                    (
                                    
                                       q
                                       /
                                       364
                                       +
                                       1
                                    
                                    )
                                    /
                                    15328051200
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       5
                                    
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    240240
                                    +
                                    q
                                    /
                                    264
                                    +
                                    1
                                 
                                 )
                                 /
                                 58060800
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       4
                                    
                                 
                                 /
                                 322560
                                 (
                                 
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    207567360
                                 
                                 
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    123552
                                    +
                                    q
                                    /
                                    180
                                    +
                                    1
                                 
                                 )
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    197604126720
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    72648576
                                 
                                 
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    55440
                                    +
                                    q
                                    /
                                    112
                                    +
                                    1
                                 
                                 )
                                 /
                                 2880
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 /
                                 48
                                 (
                                 
                                    
                                       
                                          q
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    43589145600
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    19958400
                                 
                                 
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    20160
                                    +
                                    q
                                    /
                                    60
                                    +
                                    1
                                 
                                 )
                                 +
                                 p
                                 /
                                 2
                                 (
                                 
                                    
                                       
                                          q
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    6227020800
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    3628800
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    5040
                                 
                                 
                                    
                                       +
                                       q
                                       /
                                       24
                                       +
                                       1
                                    
                                    )
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    159667200
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    120960
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    240
                                    +
                                    q
                                    /
                                    2
                                    +
                                    3
                                 
                                 )
                                 .
                              
                           
                        
                     

The coefficients of the third order expansion of generating function of matrix exponential for the case when 
                           r
                           →
                           ±
                           1
                         are
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                exp
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 exp
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                          
                                          t
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                          
                                          t
                                          /
                                          2
                                       
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      exp
                                                   
                                                
                                             
                                             
                                                ∂
                                                r
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 exp
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       
                                          1
                                       
                                       
                                          18
                                       
                                    
                                    
                                       
                                          te
                                       
                                       
                                          −
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                          
                                          t
                                       
                                    
                                    (
                                    
                                       
                                          
                                             e
                                          
                                          
                                             3
                                             
                                                
                                                   s
                                                
                                                
                                                   r
                                                
                                             
                                             t
                                             /
                                             2
                                          
                                       
                                       (
                                       
                                          3
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                          
                                          t
                                          −
                                          2
                                       
                                       )
                                       +
                                       2
                                    
                                    )
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (A.2)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      exp
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 exp
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       
                                          1
                                       
                                       
                                          1944
                                       
                                    
                                    
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                          
                                          t
                                       
                                    
                                    (
                                    
                                       8
                                       t
                                       (
                                       3
                                       t
                                       +
                                       8
                                       
                                          
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       +
                                       
                                          
                                             te
                                          
                                          
                                             3
                                             
                                                
                                                   s
                                                
                                                
                                                   r
                                                
                                             
                                             t
                                             /
                                             2
                                          
                                       
                                       (
                                       −
                                       64
                                       
                                          
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       +
                                       9
                                       t
                                       (
                                       8
                                       +
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       4
                                       
                                          
                                             ts
                                          
                                          
                                             r
                                          
                                       
                                       )
                                       )
                                    
                                    )
                                 
                                 )
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      3
                                                   
                                                
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      exp
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 exp
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       
                                          1
                                       
                                       
                                          349920
                                       
                                    
                                    
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                          
                                          t
                                       
                                    
                                    (
                                    
                                       
                                          
                                             te
                                          
                                          
                                             3
                                             
                                                
                                                   s
                                                
                                                
                                                   r
                                                
                                             
                                             t
                                             /
                                             2
                                          
                                       
                                       (
                                       3
                                       
                                          
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       t
                                       (
                                       3200
                                       +
                                       480
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       9
                                       
                                          
                                             t
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       )
                                    
                                 
                                 
                                    
                                       −
                                       10
                                       (
                                       896
                                       +
                                       480
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       27
                                       
                                          
                                             t
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       +
                                       160
                                       t
                                       (
                                       56
                                       +
                                       3
                                       t
                                       (
                                       t
                                       +
                                       8
                                       
                                          
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       )
                                       )
                                    
                                    )
                                 
                                 )
                                 .
                              
                           
                        
                     

The above values can then be inserted into Eq. (11) to derive 
                           
                              
                                 G
                              
                              
                                 exp
                                 ,
                                 r
                              
                           
                        .

The series expansion of matrix logarithm generating function for the case when 
                           p
                           →
                           0
                         is derived according to Eq. (7) for n
                        
                           p
                        =8, n
                        
                           q
                        =6, 
                           
                              
                                 n
                              
                              
                                 pq
                              
                           
                           ≤
                           8
                         as
                           
                              (A.3)
                              
                                 
                                    
                                       G
                                    
                                    
                                       log
                                       ,
                                       p
                                    
                                 
                                 =
                                 3
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 log
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                 
                                 )
                                 −
                                 1
                                 )
                                 +
                                 1
                                 /
                                 2
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    p
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       −
                                       q
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          /
                                          12
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 (
                                 
                                    −
                                    pq
                                    /
                                    4
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                       /
                                       60
                                       +
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       5
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          −
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          q
                                          /
                                          12
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   4
                                                
                                             
                                             /
                                             224
                                             +
                                             
                                                
                                                   pq
                                                
                                                
                                                   2
                                                
                                             
                                             /
                                             7
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    −
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    q
                                    /
                                    32
                                    −
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    12
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             5
                                          
                                       
                                       /
                                       720
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       12
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          −
                                          
                                             
                                                p
                                             
                                             
                                                4
                                             
                                          
                                          q
                                          /
                                          80
                                       
                                    
                                 
                                 −
                                 
                                    
                                       pq
                                    
                                    
                                       3
                                    
                                 
                                 /
                                 10
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          6
                                       
                                    
                                    /
                                    2112
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    22
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    22
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       −
                                       
                                          
                                             p
                                          
                                          
                                             5
                                          
                                       
                                       q
                                       /
                                       192
                                       −
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             3
                                          
                                       
                                       /
                                       12
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          7
                                       
                                    
                                    /
                                    5824
                                    +
                                    
                                       
                                          pq
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    13
                                    +
                                    5
                                    
                                       
                                          p
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    208
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       −
                                       
                                          
                                             p
                                          
                                          
                                             6
                                          
                                       
                                       q
                                       /
                                       448
                                       −
                                       5
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             3
                                          
                                       
                                       /
                                       84
                                    
                                 
                                 −
                                 
                                    
                                       q
                                    
                                    
                                       5
                                    
                                 
                                 /
                                 35
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          8
                                       
                                    
                                    /
                                    15360
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          5
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    80
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    12
                                    +
                                    q
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       −
                                       
                                          
                                             p
                                          
                                          
                                             7
                                          
                                       
                                       /
                                       1024
                                    
                                 
                                 −
                                 5
                                 
                                    
                                       p
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 /
                                 128
                                 −
                                 
                                    
                                       pq
                                    
                                    
                                       4
                                    
                                 
                                 /
                                 16
                                 +
                                 q
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    7
                                    
                                       
                                          p
                                       
                                       
                                          6
                                       
                                    
                                    /
                                    1088
                                    +
                                    5
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    68
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    51
                                    +
                                    pq
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                 
                                 (
                                 
                                    −
                                    7
                                    
                                       
                                          p
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    288
                                    −
                                    
                                       
                                          pq
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    12
                                    +
                                    q
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ·
                                    (
                                    
                                       35
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                       /
                                       608
                                       +
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       19
                                       +
                                       1
                                       /
                                       4
                                       pq
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          q
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          /
                                          3
                                       
                                    
                                 
                                 
                                    −
                                    7
                                    p
                                    /
                                    20
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                 
                                 )
                                 .
                              
                           
                        
                     

The coefficients of the third order expansion of generating function of matrix logarithm for the case when 
                           r
                           →
                           ±
                           1
                         are 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                log
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 
                                 log
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 2
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 
                                 log
                                 (
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                 
                                 )
                                 −
                                 3
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      log
                                                   
                                                
                                             
                                             
                                                ∂
                                                r
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       9
                                    
                                 
                                 (
                                 
                                    log
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    −
                                    log
                                    (
                                    
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       6
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      log
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       1944
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 (
                                 
                                    −
                                    51
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    36
                                    
                                       
                                          s
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    72
                                    t
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    96
                                    
                                       
                                          s
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          3
                                       
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       r
                                    
                                 
                                 t
                                 (
                                 
                                    log
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    −
                                    log
                                    (
                                    
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 )
                                 8
                                 /
                                 243
                                 ,
                              
                           
                        
                        
                           
                              (A.4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      3
                                                   
                                                
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      log
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       3
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       349920
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                          
                                             5
                                          
                                       
                                    
                                 
                                 (
                                 
                                    1081
                                    
                                       
                                          s
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          6
                                       
                                    
                                    +
                                    1638
                                    
                                       
                                          t
                                       
                                       
                                          5
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                    
                                    −
                                    714
                                    
                                       
                                          s
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    −
                                    6020
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    5040
                                    
                                       
                                          s
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          4
                                       
                                    
                                    +
                                    3360
                                    t
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          5
                                       
                                    
                                    +
                                    4480
                                    
                                       
                                          s
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          6
                                       
                                    
                                 
                                 )
                                 +
                                 t
                                 (
                                 
                                    log
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    −
                                    log
                                    (
                                    
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 )
                                 56
                                 /
                                 2187
                                 ,
                              
                           
                        where 
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           =
                           −
                           
                              
                                 s
                              
                              
                                 r
                              
                           
                           t
                           +
                           
                              
                                 λ
                              
                              
                                 v
                              
                           
                         and 
                           
                              
                                 s
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 r
                              
                           
                           t
                           /
                           2
                           +
                           
                              
                                 λ
                              
                              
                                 v
                              
                           
                        . The above values are then inserted into Eq. (11) to derive 
                           
                              
                                 G
                              
                              
                                 log
                                 ,
                                 r
                              
                           
                        .

The series expansion of matrix square root generating function for the case when 
                           p
                           →
                           0
                         is derived according to Eq. (7) for n
                        
                           p
                        =8, n
                        
                           q
                        =6, 
                           
                              
                                 n
                              
                              
                                 pq
                              
                           
                           ≤
                           8
                         as:
                           
                              (A.5)
                              
                                 
                                    
                                       G
                                    
                                    
                                       sqrt
                                       ,
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                                 (
                                 
                                    2
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    4
                                    (
                                    
                                       p
                                       −
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       /
                                       2
                                       (
                                       
                                          q
                                          −
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          /
                                          16
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             5
                                             
                                                
                                                   λ
                                                
                                                
                                                   v
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             /
                                             2
                                             (
                                             
                                                pq
                                             
                                          
                                       
                                    
                                 
                                 −
                                 7
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 /
                                 10
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    12
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    3
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    4
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       q
                                       /
                                       2
                                       −
                                       11
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       /
                                       14
                                       (
                                       
                                          
                                             
                                                p
                                             
                                             
                                                4
                                             
                                          
                                          /
                                          32
                                          +
                                          
                                             
                                                pq
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 −
                                 13
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 /
                                 8
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    q
                                    /
                                    2
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    3
                                    −
                                    5
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    8
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             5
                                          
                                       
                                       /
                                       120
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       2
                                       −
                                       17
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       /
                                       6
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          4
                                       
                                    
                                    q
                                    /
                                    40
                                    +
                                    
                                       
                                          pq
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    5
                                    −
                                    19
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    44
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             6
                                          
                                       
                                       /
                                       480
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       5
                                       +
                                       
                                          
                                             q
                                          
                                          
                                             4
                                          
                                       
                                       /
                                       5
                                       −
                                       7
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       /
                                       4
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          5
                                       
                                    
                                    q
                                    /
                                    80
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    5
                                    −
                                    23
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    26
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             7
                                          
                                       
                                       /
                                       2240
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       16
                                       +
                                       
                                          
                                             pq
                                          
                                          
                                             4
                                          
                                       
                                       /
                                       5
                                       −
                                       25
                                    
                                 
                                 ·
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 /
                                 2
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          6
                                       
                                    
                                    q
                                    /
                                    2240
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    84
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          5
                                       
                                    
                                    /
                                    175
                                    −
                                    27
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    80
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             8
                                          
                                       
                                       /
                                       26880
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       5
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 /
                                 140
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       4
                                    
                                 
                                 /
                                 21
                                 −
                                 29
                                 q
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 /
                                 24
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          7
                                       
                                    
                                    /
                                    2240
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    56
                                    +
                                    
                                       
                                          pq
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    35
                                 
                                 −
                                 31
                                 q
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 /
                                 34
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          6
                                       
                                    
                                    /
                                    320
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    28
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    105
                                    −
                                    11
                                    pq
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    4
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             4
                                          
                                       
                                       /
                                       240
                                    
                                 
                                 +
                                 
                                    
                                       pq
                                    
                                    
                                       2
                                    
                                 
                                 /
                                 70
                                 −
                                 35
                                 q
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 /
                                 114
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    32
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    35
                                    −
                                    37
                                    pq
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    800
                                 
                                 
                                    ·
                                    (
                                    
                                       p
                                       −
                                       13
                                       q
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       /
                                       14
                                    
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                 
                                 )
                                 .
                              
                           
                        The coefficients of the third order expansion of generating function of matrix square root for the case when 
                           r
                           →
                           ±
                           1
                         are 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                sqrt
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       2
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                       
                                          3
                                       
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      sqrt
                                                   
                                                
                                             
                                             
                                                ∂
                                                r
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       9
                                    
                                 
                                 (
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                          
                                          t
                                          −
                                          4
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                          
                                       
                                       
                                          4
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      sqrt
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 t
                                 (
                                 
                                    
                                       
                                          16
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                          
                                          −
                                          13
                                          t
                                       
                                       
                                          486
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          71
                                          
                                             
                                                t
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                          
                                          24
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                          
                                          −
                                          480
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                          t
                                          −
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                          
                                          512
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          15552
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                5
                                             
                                          
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                         
                        
                           
                              (A.6)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      3
                                                   
                                                
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      sqrt
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 t
                                 (
                                 
                                    
                                       
                                          56
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          2187
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          16
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                          
                                          −
                                          17
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                             
                                                3
                                             
                                          
                                          2916
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2239488
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                9
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       3329
                                       
                                          
                                             t
                                          
                                          
                                             5
                                          
                                       
                                    
                                 
                                 
                                    +
                                    8276
                                    
                                       
                                          t
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                    
                                    −
                                    
                                       
                                          s
                                       
                                       
                                          r
                                       
                                    
                                    10624
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    74240
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          s
                                       
                                       
                                          r
                                       
                                    
                                    112640
                                    t
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          4
                                       
                                    
                                 
                                 
                                    
                                       −
                                       57344
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             5
                                          
                                       
                                    
                                    )
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 −
                                 
                                    
                                       s
                                    
                                    
                                       r
                                    
                                 
                                 t
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                 
                              
                           
                         and 
                           
                              
                                 s
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       r
                                    
                                 
                                 t
                                 /
                                 2
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                 
                              
                           
                        .

The series expansion of matrix power generating function for the case when 
                           p
                           →
                           0
                         is derived according to Eq. (7) for n
                        
                           p
                        =8, n
                        
                           q
                        =6 and 
                           
                              
                                 n
                              
                              
                                 pq
                              
                           
                           ≤
                           8
                         as:
                           
                              (A.7)
                              
                                 
                                    
                                       G
                                    
                                    
                                       pow
                                       ,
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       η
                                    
                                 
                                 (
                                 
                                    3
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                    
                                    /
                                    (
                                    η
                                    +
                                    1
                                    )
                                    +
                                    η
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    2
                                    (
                                    
                                       p
                                       +
                                       
                                          
                                             η
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          q
                                          +
                                          
                                             
                                                η
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          /
                                          24
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                          
                                       
                                    
                                 
                                 
                                    
                                       η
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    pq
                                    +
                                    
                                       
                                          η
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    5
                                    (
                                    
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                       /
                                       12
                                       +
                                       
                                          
                                             η
                                          
                                          
                                             5
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       /
                                       6
                                       (
                                       
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          q
                                          /
                                          2
                                          +
                                          
                                             
                                                η
                                             
                                             
                                                6
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          /
                                          7
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   4
                                                
                                             
                                             /
                                             32
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       pq
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       η
                                    
                                    
                                       7
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 /
                                 4
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    q
                                    /
                                    8
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    3
                                    +
                                    
                                       
                                          η
                                       
                                       
                                          8
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    12
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             
                                                p
                                             
                                             
                                                3
                                             
                                          
                                          /
                                          120
                                          +
                                          
                                             
                                                q
                                             
                                             
                                                2
                                             
                                          
                                          /
                                          2
                                       
                                       )
                                       +
                                       
                                          
                                             η
                                          
                                          
                                             9
                                          
                                       
                                       /
                                       3
                                    
                                 
                                 ·
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          4
                                       
                                    
                                    q
                                    /
                                    40
                                    +
                                    
                                       
                                          pq
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    5
                                    +
                                    
                                       
                                          η
                                       
                                       
                                          10
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    22
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             6
                                          
                                       
                                       /
                                       480
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       5
                                       +
                                       
                                          
                                             q
                                          
                                          
                                             4
                                          
                                       
                                       /
                                       5
                                       +
                                       
                                          
                                             η
                                          
                                          
                                             11
                                          
                                       
                                       /
                                       6
                                    
                                 
                                 ·
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          5
                                       
                                    
                                    q
                                    /
                                    80
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    5
                                    +
                                    
                                       
                                          η
                                       
                                       
                                          12
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    13
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             7
                                          
                                       
                                       /
                                       2240
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       16
                                       +
                                       
                                          
                                             pq
                                          
                                          
                                             4
                                          
                                       
                                       /
                                       5
                                       +
                                       
                                          
                                             η
                                          
                                          
                                             13
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       
                                          q
                                       
                                       
                                          5
                                       
                                    
                                    /
                                    175
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          6
                                       
                                    
                                    q
                                    /
                                    2240
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          3
                                       
                                    
                                    /
                                    84
                                    +
                                    
                                       
                                          η
                                       
                                       
                                          14
                                       
                                    
                                    /
                                    40
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             8
                                          
                                       
                                       /
                                       26880
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             5
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       140
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       4
                                    
                                 
                                 /
                                 21
                                 +
                                 
                                    
                                       η
                                    
                                    
                                       15
                                    
                                 
                                 q
                                 
                                    
                                       λ
                                    
                                    
                                       v
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 /
                                 12
                                 ·
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          7
                                       
                                    
                                    /
                                    2240
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    56
                                    +
                                    
                                       
                                          pq
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    35
                                    +
                                    
                                       
                                          η
                                       
                                       
                                          16
                                       
                                    
                                    q
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    17
                                 
                                 ·
                                 (
                                 
                                    
                                       
                                          p
                                       
                                       
                                          6
                                       
                                    
                                    /
                                    320
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    28
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          4
                                       
                                    
                                    /
                                    105
                                    +
                                    
                                       
                                          η
                                       
                                       
                                          17
                                       
                                    
                                    pq
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    /
                                    6
                                    (
                                    
                                       
                                          
                                             p
                                          
                                          
                                             4
                                          
                                       
                                       /
                                       240
                                       +
                                       
                                          
                                             pq
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       70
                                       +
                                       
                                          
                                             η
                                          
                                          
                                             18
                                          
                                       
                                       q
                                       /
                                       57
                                    
                                 
                                 
                                    
                                       ·
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             
                                                p
                                             
                                             
                                                3
                                             
                                          
                                          /
                                          32
                                          +
                                          
                                             
                                                q
                                             
                                             
                                                2
                                             
                                          
                                          /
                                          35
                                          +
                                          
                                             
                                                η
                                             
                                             
                                                19
                                             
                                          
                                          pq
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          /
                                          400
                                          (
                                          
                                             p
                                             +
                                             
                                                
                                                   η
                                                
                                                
                                                   20
                                                
                                             
                                             q
                                             
                                                
                                                   λ
                                                
                                                
                                                   v
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             /
                                             21
                                          
                                          )
                                       
                                       )
                                    
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                    )
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 η
                              
                              
                                 i
                              
                           
                           =
                           (
                           η
                           −
                           i
                           )
                        . The coefficients of the third order expansion of generating function of matrix power for the case when 
                           r
                           →
                           ±
                           1
                         are
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                pow
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                          
                                             η
                                             +
                                             1
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                          
                                             η
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       η
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      pow
                                                   
                                                
                                             
                                             
                                                ∂
                                                r
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       9
                                    
                                 
                                 (
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                       
                                          η
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                             
                                                η
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       (
                                       3
                                       η
                                       −
                                       1
                                       )
                                       
                                          
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       t
                                       −
                                       2
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                       
                                    
                                    )
                                 
                                 )
                                 ,
                              
                           
                         
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      pow
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 t
                                 (
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                       
                                          η
                                          −
                                          3
                                       
                                    
                                    (
                                    
                                       (
                                       t
                                       (
                                       
                                          24
                                          (
                                          3
                                          η
                                          −
                                          4
                                          )
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          t
                                          (
                                          
                                             (
                                             
                                                9
                                                η
                                                (
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   5
                                                   η
                                                   +
                                                   6
                                                
                                                )
                                                −
                                                8
                                             
                                             )
                                             t
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          −
                                          12
                                          (
                                          
                                             3
                                             
                                                
                                                   η
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             9
                                             η
                                             +
                                             4
                                          
                                          )
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                r
                                             
                                          
                                       
                                       )
                                    
                                    )
                                    −
                                    64
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          r
                                       
                                    
                                 
                                 )
                                 
                                    +
                                    8
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                       
                                          η
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       8
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       +
                                       (
                                       3
                                       η
                                       −
                                       8
                                       )
                                       t
                                    
                                    )
                                 
                                 )
                                 /
                                 1944
                                 ,
                              
                           
                         
                        
                           
                              (A.8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      3
                                                   
                                                
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      pow
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       r
                                       =
                                       ±
                                       1
                                    
                                 
                                 =
                                 t
                                 (
                                 
                                    8960
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                       
                                          η
                                       
                                    
                                    +
                                    480
                                    η
                                    
                                       
                                          ts
                                       
                                       
                                          1
                                       
                                       
                                          η
                                          −
                                          2
                                       
                                    
                                    (
                                    
                                       8
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       +
                                       (
                                       η
                                       −
                                       9
                                       )
                                       t
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                    
                                       η
                                       −
                                       5
                                    
                                 
                                 (
                                 
                                    
                                       
                                          s
                                       
                                       
                                          r
                                       
                                    
                                    t
                                    (
                                    
                                       3200
                                       (
                                       3
                                       η
                                       −
                                       7
                                       )
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       (
                                       
                                          27
                                          
                                             
                                                η
                                             
                                             
                                                5
                                             
                                          
                                          −
                                          405
                                          
                                             
                                                η
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          2115
                                          
                                             
                                                η
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             −
                                             4515
                                             
                                                
                                                   η
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             3378
                                             η
                                             −
                                             280
                                          
                                          )
                                          
                                             
                                                t
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          160
                                          (
                                          
                                             9
                                             
                                                
                                                   η
                                                
                                                
                                                   3
                                                
                                             
                                             −
                                             72
                                             
                                                
                                                   η
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             153
                                             η
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          −
                                          70
                                       
                                       )
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                    )
                                    −
                                    10
                                    
                                       
                                          λ
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       896
                                       
                                          
                                             λ
                                          
                                          
                                             v
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       (
                                       
                                          27
                                          
                                             
                                                η
                                             
                                             
                                                4
                                             
                                          
                                          −
                                          306
                                          
                                             
                                                η
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          1089
                                          
                                             
                                                η
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             −
                                             1290
                                             η
                                             +
                                             280
                                          
                                          )
                                          
                                             
                                                t
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          160
                                          (
                                          
                                             3
                                             
                                                
                                                   η
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             15
                                             η
                                             +
                                             14
                                          
                                          )
                                          
                                             
                                                λ
                                             
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 )
                                 /
                                 349920
                                 ,
                              
                           
                        where 
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           =
                           −
                           
                              
                                 s
                              
                              
                                 r
                              
                           
                           t
                           +
                           
                              
                                 λ
                              
                              
                                 v
                              
                           
                         and 
                           
                              
                                 s
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 r
                              
                           
                           t
                           /
                           2
                           +
                           
                              
                                 λ
                              
                              
                                 v
                              
                           
                        . If 
                           η
                           =
                           1
                           /
                           2
                        , then the equation simplifies into those of square root function.

@&#REFERENCES@&#

