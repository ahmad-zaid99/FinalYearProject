@&#MAIN-TITLE@&#Adaptive zooming method for the analysis of large structures with localized nonlinearities

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A method for reducing the dimension of large-scale mechanics problems is proposed.


                        
                        
                           
                           The method condenses linear areas in the problem and simulates only nonlinear areas.


                        
                        
                           
                           The method adapts to simulate more areas when damage is detected in new areas.


                        
                        
                           
                           On classical structural simulations, the computational load is reduced.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Structural zooming

Static condensation

Concrete cracking

Reduced-order modeling

@&#ABSTRACT@&#


                  Simulating concrete cracking requires nonlinear modeling applied on a refined mesh if a correct evaluation of crack properties needs to be achieved. Therefore, it is rather costly and even sometimes impossible when large reinforced concrete structures are considered. Alternative solutions have therefore to be proposed. This contribution presents a structural zooming method for the simulation of large reinforced concrete structures with localized nonlinearities. Our method is based on static condensation (Guyan [1]) and provides an adaptive framework for performance-oriented use of this method in nonlinear simulations. In particular, it only simulates the behavior of nonlinear interesting zones (detected by adapted criteria). The areas where refined modeling is not required are replaced by their equivalent stiffnesses. The linearity criteria, depending on the chosen mechanical models, are also used to activate new interesting zones during the simulation. This method substantially decreases the computational cost on both presented test cases (a two-dimensional concrete beam and a three-dimensional reinforced concrete building).
               

@&#INTRODUCTION@&#

With recent improvements in numerical and behavior models and new features of simulation software, the complexity of models used by physicists and engineers is rising. Scalability of models and computations has become a key issue, as simulation of local small-scale phenomenon on large-scale problems seems to be the next frontier in computing. The interaction between different scales and different physics raises new questions, such as the localization and quantification of cracking risk (civil engineering, aeronautics …).

In this contribution, the specific physical phenomenon to be predicted is the cracking of large-scale concrete and reinforced concrete structures. A damage mechanics approach is used to model the behavior of concrete with the finite elements method. Simulating this phenomenon requires refined nonlinear models of the behavior of concrete (for instance, a damage mechanics approach), applied on meshes fine enough to match the physical phenomena. Those models are hardly applicable to large-scale civil engineering structures with a mesh fine enough to adequately represent cracking. However, concrete cracking is a phenomenon that is localized on large structures, and therefore, realizing a fully refined simulation of a large structure is unnecessary to obtain data on cracking: a method for simulating localized nonlinearities on large problems with accurate local information is required. Several techniques bring answers to this scalability need.

For instance, global–local analysis methods are mainly used in multi-scale simulations where physical phenomena appear at different scales of the problem. They allow separating the scales and therefore limit the complexity of the global problem [2]. These methods combine a coarse simulation at the large scale and a fine simulation at the small scale. Boundary conditions are exchanged between both simulations and an iterative scheme allows finding a solution satisfying both scales. Separating scales however requires the definition of a REV (Representative Elementary Volume), small enough to be considered as representative of the material behavior seen as homogenous at the large scale and large enough to represent a mean behavior at the small scale. To our knowledge, the definition of a REV for a cracked material is still under discussion. Also some variations on this methodology exist [3–6], eventually combining different models but also different numerical methods, such as Confinement-Shear-Lattice [7] or discrete elements [8]. A zooming method using global–local methodology has been introduced in 2003 by Haidar et al. to simulate cracking of concrete [9].

Another approach to solve large structural problems in limited computation time is the use of parallel computing and domain decomposition method, that decompose a large problem in smaller subproblems solved independently [10,11]. Those methods divide the computing load to take advantage of parallel architectures and solve problems faster. However, they do not affect the global computing load, and will not allow finer simulations for a given computing power [12–14].

Model reduction methods, and zooming method which derived from them, are used when complex phenomena operate in a localized manner on a large dimension problem. These methods aim to simplify at most the modeling of the areas that present no complex phenomenon, and focus the computational effort where it is the most necessary, to limit the global computing load [15]. One of the most widely used model reduction technique is orthogonal decomposition, e.g. using Karhunen–Loève expansion. It was introduced in structural mechanics by Spanos and Ghanem, based on the method previously used in fluid [16–18]. It consists in analyzing by the method of principal component analysis the mechanical responses depending on solicitations and parameters to build a predictive model. Applying this technique to a substructure allows to replace its model by a linearized model and focuses the computational effort on other substructures [19]. Possible applications include fluid mechanics, shape optimization, nuclear structure dynamic analysis [20], and stochastic structural simulation with finite elements [21]. However, those methods require previous knowledge on the localization of nonlinearities (and specifically the cracks in concrete) and are unable to detect the appearance of new cracks out of the zoomed areas.

The static condensation method, or superelements method, was introduced by Guyan [1]. It simplifies the solving of large-scale linear problems by eliminating a well-chosen subsystem of degrees of freedom. Several developments have been made on the static condensation method, such as adaptation to dynamic problems. Dynamic condensation was introduced to reduce computational cost of the dynamical analysis of large structures [15,22]. Applications are found in various fields, such as earthquake engineering, or vehicle suspension-tires systems simulation [23].

The first structural zooming method was introduced by Hirai et al. [24,25]. It combines static condensation with the reanalysis methods introduced by Wang and Pilkey [26] and remeshing techniques to locally improve the quality of numerical simulation. Starting with a relatively coarse mesh, it can be locally refined (on a substructure) with a remeshing technique. A new stiffness is calculated with the new mesh (and degrees of freedom) on the substructure, which is then condensed on the coarse mesh by Guyan reduction, and reintroduced in the global problem. Solving the problem gives the condensed solution on the original mesh, and the local subproblem can be solved from there. Only the stiffness of the area of interest is then condensed in this method. This method can also be used to combine different models at different scales, such as beam theory with nonlinear mechanics in aeronautical structural mechanics [27].

Several of the previously cited methods allow limiting the computational cost on problems similar to the cracking prediction on large concrete structures. However, all focus on obtaining the correct global behavior for the structure. Since an accurate simulation of the cracked areas is required, a new method has been developed, that focuses the computational effort on the local simulation. The proposed structural zooming method aims at reproducing at the local scale the results of a full nonlinear simulation for a fraction of the computation cost. This adaptive structural zooming method is presented in Section 2. Finally, the method is applied to a bending concrete beam and a reinforced concrete building under pressure.

This paragraph describes the first-level Guyan reduction technique used in this zooming method for structural mechanics. The discretized problem of continuum mechanics to be solved at each area is formulated as follows:
                           
                              (1)
                              
                                 K
                                 U
                                 =
                                 F
                              
                           
                        
                     

In the field of mechanics, with 
                           n
                         degrees of freedom, 
                           K
                         represents the structural stiffness matrix (
                           K
                           ∈
                           
                              
                                 ℝ
                              
                              
                                 n
                                 ,
                                 n
                              
                           
                        ), 
                           U
                         the nodal displacement (
                           U
                           ∈
                           
                              
                                 ℝ
                              
                              n
                           
                        ), and 
                           F
                         the equivalent external nodal force vector (
                           F
                           ∈
                           
                              
                                 ℝ
                              
                              n
                           
                        ). All stiffness matrices are supposed invertible, that simplifies the formulation, and computational methods allow bringing properly-formulated problems back to this case. In particular, in the simulation software used in this study, Cast3M [28], boundary conditions are treated using the double Lagrange multiplier method: this method allows to keep invertible stiffness matrices that contains the boundary conditions (of the form 
                           C
                           
                              
                                 U
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 d
                              
                           
                        ) if the Lagrange multiplier vectors are added to the degrees of freedom 
                           U
                         of the system [29].

By using two subdomains (s and m), the system becomes
                           
                              (2)
                              
                                 F
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 U
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 K
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         s
                                                         ,
                                                         s
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         s
                                                         ,
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         m
                                                         ,
                                                         s
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         m
                                                         ,
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        with 
                           
                              
                                 F
                              
                              
                                 s
                              
                           
                           ,
                           
                           
                              
                                 U
                              
                              
                                 s
                              
                           
                           ∈
                           
                              
                                 ℝ
                              
                              p
                           
                           ,
                           
                           
                              
                                 F
                              
                              
                                 m
                              
                           
                           ,
                           
                              
                                 U
                              
                              
                                 m
                              
                           
                           ∈
                           
                              
                                 ℝ
                              
                              q
                           
                           ,
                           
                           
                              
                                 K
                              
                              
                                 s
                                 ,
                                 s
                              
                           
                           ∈
                           
                              
                                 ℝ
                              
                              
                                 p
                                 ,
                                 p
                              
                           
                           ,
                           
                           
                              
                                 K
                              
                              
                                 s
                                 ,
                                 m
                              
                           
                           ∈
                           
                              
                                 ℝ
                              
                              
                                 p
                                 ,
                                 q
                              
                           
                           ,
                           
                           
                              
                                 K
                              
                              
                                 m
                                 ,
                                 s
                              
                           
                           ∈
                           
                              
                                 ℝ
                              
                              
                                 q
                                 ,
                                 p
                              
                           
                           ,
                           
                           
                              
                                 K
                              
                              
                                 m
                                 ,
                                 m
                              
                           
                           ∈
                           
                              
                                 ℝ
                              
                              
                                 q
                                 ,
                                 q
                                 
                              
                           
                           ,
                           
                           n
                           =
                           p
                           +
                           q
                           .
                        
                     

The system is rewritten to solve the equation of the m subdomain, using the “condensed”, or “equivalent stiffness” 
                           
                              K
                              ^
                           
                         of both subdomains [1]
                        
                           
                              (3)
                              
                                 
                                    
                                       U
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       s
                                       ,
                                       s
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       F
                                    
                                    
                                       s
                                    
                                 
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       s
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       m
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    K
                                    ^
                                 
                                 
                                    
                                       U
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    F
                                    ^
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   K
                                                   ^
                                                
                                                =
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      m
                                                      ,
                                                      m
                                                   
                                                
                                                −
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      m
                                                      ,
                                                      s
                                                   
                                                
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      s
                                                      ,
                                                      s
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      s
                                                      ,
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                
                                                   F
                                                   ^
                                                
                                                =
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      m
                                                   
                                                
                                                −
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      m
                                                      ,
                                                      s
                                                   
                                                
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      s
                                                      ,
                                                      s
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Eq. (4) is called the condensed problem. Considered independently, this q-dimensional condensed problem (
                           q
                           <
                           n
                        ) is simplified and therefore faster to solve than the initial n-dimensional system. It solves the problem for subdomain m, and its result allows deducing the solution for subdomain s from Eq. (3). A term of “equivalent loading” 
                           (
                           −
                           
                              
                                 K
                              
                              
                                 m
                                 ,
                                 s
                              
                           
                           
                              
                                 K
                              
                              
                                 s
                                 ,
                                 s
                              
                              
                                 −
                                 1
                              
                           
                           
                              
                                 F
                              
                              
                                 s
                              
                           
                           )
                         appears in the condensed problem (Eq. 5). It contains the influence of the external forces 
                           
                              
                                 F
                              
                              
                                 s
                              
                           
                         applied on the 
                           s
                         subdomain over the 
                           m
                         subdomain: the subdomains have therefore been decoupled in terms of degrees of freedom but not in terms of forces and stiffnesses.

This method provides a framework for an adaptive, local-scale oriented use of a two-level Guyan condensation method when solving nonlinear structural problems. It follows several steps. 
                        Fig. 1 describes the different steps of the method applied to a 2D plate problem decomposed in 6 areas. It illustrates the general principle of the method on a small academic problem. Two phases can be distinguished: a pre-computing phase and an adaptive zooming phase, which takes place during the simulation.

The structural problem is first partitioned in 
                                 N
                               subdomains: each of these areas will either be zoomed or condensed depending on the expected behavior. The problem decomposition in subproblems is the most critical parameter for the structural zooming method׳s performance. It has no impact on the results of the simulation, but it is critical for the computational load. This decomposition defines directly the dimension of the problem solved at each increment: the number and shape of the areas define which part of the model is zoomed during the simulation. The closer the area decomposition matches the nonlinearities localization and their evolution in the structure, the most efficient the zooming method will be. For instance, with only one area, the full structure is systematically zoomed: this implies a null gain in computational load compared to a standard simulation. On the other hand, a model dividing the nonlinear areas in a very large number of substructures would require more updates when nonlinearities would spread, hence a large computation cost during the adaptive zooming phase. The decomposition must then be the result of a compromise between model size and update frequency, and match as close as possible the areas where nonlinear behavior is expected.

This approach, with fixed subdomains has been chosen instead of flexible areas following nonlinearities and dynamically reshaping (as in other methods of structural zooming) because it presents several advantages
                                 
                                    •
                                    The equivalent stiffness of each zone only needs to be computed once: the cost of computing and inverting stiffness matrices is then reduced.

The interface between the areas only needs to be determined once, before the simulation.

However, its main drawback is the dependency of the computational performance on the area decomposition: the method will be as efficient to reduce computational load as the shape of the zoomed areas is able to match the damaged part of the structure through the loading.

Using the Guyan reduction technique described, each area is condensed on its boundaries: the equivalent stiffness and equivalent loading are calculated (and will be useful during the simulation). It is to be noted that the equivalent stiffness of each area takes into account the material stiffnesses, the additional stiffnesses (multi-material adhesion, etc.), and the boundary conditions applied to the area. It is to be noted that only force-formulated loadings are also condensed on the same masternodes. Displacement-formulated loadings are not condensed (modeling the usually small areas where they are applied appears to be a simpler implementation).

A linear pre-calculus determines which areas are activated (or zoomed) at the start of the simulation, and which areas are condensed: areas with expected nonlinear behavior are zoomed, while areas with expected linear behavior will be condensed (
                              Fig. 2). This pre-calculus is the linear resolution of the complete (uncondensed) structure, and has two objectives
                                 
                                    •
                                    Determine the first area to be zoomed (localization of the first appearance of nonlinear regime).

Compute the time (loading increment) t
                                       1 when this area first obeys nonlinear behavior.

The pre-calculus consists in a linear resolution of the full (uncondensed) simulation. After the solution is obtained, it computes the value of the nonlinearity outbreak criterion on each area for the given loading (with a nonlocal treatment if the simulation is nonlocal). This value determines both where and when nonlinearities will first occur, and therefore the starting nonlinear problem, which is why the zooming criteria and their zooming threshold have to be well suited to the problem and the models used (criteria are detailed in Section 2.3). The initial zoomed and condensed areas are then obtained. The computational cost of this pre-calculus is equivalent to a linear iteration on the full structure, and becomes negligible in the case of a nonlinear simulation as the number of steps and iterations becomes large. Another approach would be to use the first-level condensed problem to solve the structure and then apply the criteria on each area independently. This would be more computational-efficient on large-scale problems, especially if a single iteration is time-consuming.

All subproblem associated to the condensed areas are combined, using assembly stiffness matrices. For the sake of clarity, only one condensed area will be considered. A second level of static condensation is then performed on the condensed problem. The masternodes of this second-level condensation are the masternodes of the first-level condensation on the interface with the zoomed areas (
                              Fig. 3).

The domain formed by the masternodes (
                                 m
                              ) can be partitioned again in two subdomains 
                                 M
                               and 
                                 E
                              , corresponding to the second-level masternodes and the eliminated masternodes
                                 
                                    (6)
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            m
                                                            ,
                                                            s
                                                         
                                                      
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            s
                                                            ,
                                                            s
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      =
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              F
                                                                           
                                                                           
                                                                              E
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              F
                                                                           
                                                                           
                                                                              M
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      =
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              U
                                                                           
                                                                           
                                                                              E
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              U
                                                                           
                                                                           
                                                                              M
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            m
                                                            ,
                                                            m
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            m
                                                            ,
                                                            s
                                                         
                                                      
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            s
                                                            ,
                                                            s
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            s
                                                            ,
                                                            m
                                                         
                                                      
                                                      =
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              K
                                                                           
                                                                           
                                                                              E
                                                                              ,
                                                                              E
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              K
                                                                           
                                                                           
                                                                              E
                                                                              ,
                                                                              M
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              K
                                                                           
                                                                           
                                                                              M
                                                                              ,
                                                                              E
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              K
                                                                           
                                                                           
                                                                              M
                                                                              ,
                                                                              M
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              with 
                                 
                                    
                                       F
                                    
                                    
                                       E
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       U
                                    
                                    
                                       E
                                    
                                 
                                 ∈
                                 
                                    
                                       ℝ
                                    
                                    r
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       M
                                    
                                 
                                 ,
                                 
                                    
                                       U
                                    
                                    
                                       M
                                    
                                 
                                 ∈
                                 
                                    
                                       ℝ
                                    
                                    s
                                 
                                 ,
                                 
                                 
                                    
                                       K
                                    
                                    
                                       E
                                       ,
                                       E
                                    
                                 
                                 ∈
                                 
                                    
                                       ℝ
                                    
                                    
                                       r
                                       ,
                                       r
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       K
                                    
                                    
                                       E
                                       ,
                                       M
                                    
                                 
                                 ∈
                                 
                                    
                                       ℝ
                                    
                                    
                                       r
                                       ,
                                       s
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       K
                                    
                                    
                                       M
                                       ,
                                       E
                                    
                                 
                                 ∈
                                 
                                    
                                       ℝ
                                    
                                    
                                       s
                                       ,
                                       r
                                    
                                 
                                 ,
                                 
                                    
                                       K
                                    
                                    
                                       E
                                       ,
                                       E
                                    
                                 
                                 ∈
                                 
                                    
                                       ℝ
                                    
                                    
                                       s
                                       ,
                                       s
                                       
                                    
                                 
                                 ,
                                 
                                 q
                                 =
                                 r
                                 +
                                 s
                                 .
                              
                           

The system is condensed again to eliminate the displacement variables 
                                 
                                    
                                       U
                                    
                                    
                                       E
                                    
                                 
                              . A system condensed on the second-level masternodes is obtained. The system size is then reduced to 
                                 s
                               (number of second-level masternodes), compared to the q-dimensional system (4)
                              
                                 
                                    (7)
                                    
                                       (
                                       
                                          
                                             K
                                          
                                          
                                             M
                                             ,
                                             M
                                          
                                       
                                       −
                                       
                                          
                                             K
                                          
                                          
                                             M
                                             ,
                                             E
                                          
                                       
                                       
                                          
                                             K
                                          
                                          
                                             E
                                             ,
                                             E
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             K
                                          
                                          
                                             E
                                             ,
                                             M
                                          
                                       
                                       )
                                       
                                          
                                             U
                                          
                                          
                                             M
                                          
                                       
                                       =
                                       
                                          
                                             F
                                          
                                          
                                             M
                                          
                                       
                                       −
                                       
                                          
                                             K
                                          
                                          
                                             M
                                             ,
                                             E
                                          
                                       
                                       
                                          
                                             K
                                          
                                          
                                             E
                                             ,
                                             E
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             E
                                          
                                       
                                    
                                 
                              
                           

This system is still equivalent to Eqs. (1) and (4). Its stiffness matrix is called the second-level equivalent stiffness. It can then be combined with the problem modeling the zoomed areas (Fig. 1), using assembly matrices. The combination of those problems forms the full condensed problem.

The principle of this zooming method raises the question of the propagation of zoomed zones but also of the apparition of new zones. Zooming on new areas includes changes in the model (mesh, behavior, properties, etc.) but also in the definition of the mechanical state of these new zoomed zones. In particular, this implies to modify the formulation of the problem when a new nonlinear behavior is detected. In our approach, when an adapted criterion is fulfilled, identified condensed areas are replaced by explicitly modeled areas. A change in the zoomed zones also implies a change in the applied equivalent stiffness, as the second-level masternodes change: the second-level condensation must be recalculated. However, the equivalent stiffness of each condensed area is never recalculated.


                              
                              Fig. 4 describes the simulation of the 2D plate problem with the adaptive zooming method, starting with only one zoomed area, and expanding the zoom to other areas when nonlinearities appear or propagate.

In order to obtain a condensed problem that is both correct and light to solve, new areas must be detected and zoomed as soon as nonlinearities occur in their behavior. Therefore a set of criteria (and the associated zooming thresholds) has to be defined to identify the linear and nonlinear areas.

The zooming criteria are defined as follows and detailed in Section 2.3:
                                 
                                    •
                                    The outbreak criterion detects the end of the linear phase of the behavior in an area: for instance multiple cracks in a structure under loading. This criterion applies to the condensed areas (and requires computing those areas).

The propagation criterion detects the nonlinearity propagation from a nearby area: for instance crack propagation in a fragile material or damage propagation alongside rebars in reinforced concrete. This criterion applies to the already zoomed areas (and requires no additional operations).

The zooming criteria depend on the nonlinear model chosen. The only common assumption is the presence of an elastic phase in the material models. It is to be noted that the zooming operation is currently irreversible: an area that has been zoomed is not condensed again (irreversible phenomena appear at the material level, such as permanent strain or changes in its mechanical properties).

The zooming method is adapted to nonlinear problems approximated by numerical methods (such as FEM), discretized in time and solved incrementally, using an iterative method (such as the Newton–Raphson algorithm) at each loading increment [28]. The complete nonlinear problem is then considered as a large set of time steps problems solved sequentially. The full condensed problem is solved at each step, providing the solution of the nonlinear part of the full problem.

At the end of each loading step, the propagation zooming criterion is checked for all condensed areas and those areas can be zoomed if the criterion is met.

Since it is computationally more expensive (especially in damage mechanics simulations using nonlocal models), the outbreak criterion is usually checked less regularly. To guarantee that the condensation is valid, the condensed areas must stay in their linear phase between two criterion checks.

A first approach could consist in zooming slightly before the end of the linear phase (by lowering the zooming threshold on the outbreak criterion), to prevent nonlinearities from appearing between two checks. However, this method would need more empirically chosen parameters for the outbreak threshold and might be too conservative: because of the margin taken, areas may be zoomed although it would not be absolutely necessary.

The “just-in-time zooming method” introduces a principle of retroactivity in the zooming method, by checking the zooming criteria after solving the full condensed problem on a step. 
                              Fig. 5 describes the solving of a time step with the just-in-time zooming method. The criteria then behave differently
                                 
                                    •
                                    The propagation criterion (immediate checking) directly causes zooming on the concerned areas.

The outbreak criterion (postponed checking) causes a return to the last verified step if needed, and zooming on the concerned areas.

This method runs on a hypothesis: it is assumed that a nonlinearity outbreak between steps 
                                 (
                                 n
                                 +
                                 1
                                 )
                               and 
                                 (
                                 n
                                 +
                                 p
                                 )
                               will cause the outbreak criterion to match his threshold at step 
                                 (
                                 n
                                 +
                                 p
                                 )
                              . This particularly implies that outbreak criterion checks must remain regular (p low). Choosing the value of this checking frequency p then becomes a compromise between the cost of solving several time steps twice and the cost of solving the condensed subproblems. If the major part of the structure is condensed, strongly nonlinear simulations might be faster with lower values of p (even 
                                 p
                                 =
                                 1
                              ) because the cost of solving steps would be high, whereas “almost linear” simulations might be faster with higher values of p, as the steps would be solved at low cost. Also, if nonlinearities are likely to appear in several distinct areas, lower values of p should be used to detect those nonlinearities quickly. On the contrary, if nonlinearities are unlikely to appear in different areas, higher values of p would increase computational performance.

This approach has been chosen because it eliminates the need to take margins on the zooming thresholds and compromise between computational efficiency (small margins) and safety on the linearity hypotheses (high margins). The major drawback of this approach is due to its retroactive framework: increments that lead to the outbreak of nonlinearities in condensed areas need to be computed again. This can cause higher computational cost: the frequency of outbreak criterion check must therefore be wisely chosen. Based on the cases presented in this contribution and other tests of concrete and reinforced concrete structures, values of p chosen between 1 (strongly nonlinear problems) and 10 (weakly nonlinear problems) provide a good compromise.

The outbreak criterion is a direct application of the model definition on condensed areas. Solving the linear subproblems of those areas and obtaining displacements of their internal degrees of freedom allows applying the numerical model on it (
                           Fig. 6). For instance on concrete mechanics modeled with the Mazars model [30], the criterion would be the equivalent strain 
                              
                                 
                                    ε
                                 
                                 
                                    e
                                    q
                                 
                              
                           , with the yield limit 
                              
                                 
                                    ε
                                 
                                 
                                    0
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          e
                                          q
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                〈
                                                
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                〉
                                             
                                             
                                                +
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                〈
                                                
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                〉
                                             
                                             
                                                +
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                〈
                                                
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                〉
                                             
                                             
                                                +
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    〈
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                       
                                    
                                    〉
                                 
                                 
                                    +
                                 
                              
                            are the principal positive values of the strain.

The outbreak zooming criterion is matched if the equivalent strain exceeds the elastic limit. If the simulation uses a nonlocal integral method (such as [31,32]), the zooming criterion shall be nonlocal (with the Mazars model, nonlocal equivalent strain). In this case, all the condensed subproblems are solved independently, giving the displacement and strain values, and eventually applying the model to compute additional variables, such as the equivalent strain. A nonlocal domain is then built, by reducing the global nonlocal domain (and connectivity matrices) of the full problem to its condensed part (which contains all condensed areas). Therefore, the nonlocal domain is not fractioned along the interface between two condensed areas (Fig. 6): this avoids creating nonphysical strain localization on the interfaces (and therefore over-estimating the outbreak criterion [33,34]). The regularized variable (such as nonlocal equivalent strain) can then be calculated using the previously obtained values of the strain, and applying the regularization function on the nonlocal domain.

The purpose of this computation is solely to determine whether the elastic criterion is fulfilled. Thus, a linear computation is performed for the deformations. If the elastic criterion based on the nonlocal equivalent strain is met, the solution is acceptable, if not the zone is zoomed in.

The linear solving and model integration can easily be parallelized to speed up the simulation. However, solving the subproblems, applying the model and the nonlocal treatment can become computationally time-consuming operations on large problems, and that criterion must therefore be used parsimoniously.

The propagation criterion is applied directly on the already zoomed areas. “Interface bands” are considered in the zoomed areas around each interface with a condensed area. The propagation criterion is measured on those bands and allows zooming on the condensed areas whose interface bands match the criterion (
                           Fig. 7). The interface bands are defined by a thickness L, and include all nodes whose distance to a zoomed-condensed interface is smaller than L. If a nonlocal method is used with an internal length 
                              
                                 
                                    l
                                 
                                 
                                    C
                                    0
                                 
                              
                           , the value of L can be chosen depending on 
                              
                                 
                                    l
                                 
                                 
                                    C
                                    0
                                 
                              
                           . This avoids disequilibrium in the regularization domain near damaged areas, as nonlocal methods are known to be less accurate around the borders of the nonlocal domain. If no regularization technique is used, a value can be chosen depending on the mesh size. The propagation criterion applied in those interface bands then depends on the model. In the case of concrete modeled with the Mazars model, a good choice is the damage variable D, with a null threshold. As this criterion is applied on already zoomed areas, and therefore on already computed variables, it has almost no computational cost, and can be applied very regularly.

The following examples illustrate the principle of the method and its usage on typical concrete and reinforced concrete structures. They show that the results of a full simulation are reproduced. The processor time (reflecting global computing load) is compared between simulations using the zooming method and reference simulations. The obtained speed-ups do not represent the point of the method, which is to allow access to finer simulations of large problems with limited computation resources. However, they provide a proof of concept for the structural zooming method, which has still to be optimized in order to obtain the best performance.


                           
                           Fig. 8 presents the finite element mesh of a notched plain concrete beam undergoing three-point bending, on which both reference simulations and experimental results are available. Both the experimental results, simulation hypotheses and model parameters are obtained from previous work published in work by Dufour et al. [35]. All simulations are run with Cast3M [28].

The beam is 40cm long and 10cm high (Fig. 8). It is modeled in two dimensions under the hypothesis of plane stresses (the experimental beam is 5cm wide). A notch is included at mid-span along the bottom of the beam, it is 2mm large and 20mm high (Fig. 8). A regular quadrilateral mesh of size 2.5mm is used with bilinear finite elements (6464 elements).

The material is modeled with the Mazars isotropic damage model [29], using the same parameters as in [34]. Those parameters give a compressive strength at 28 days 
                              
                                 
                                    f
                                 
                                 
                                    c
                                 
                              
                            equal to 41.4MPa and a tensile strength 
                              
                                 
                                    f
                                 
                                 
                                    t
                                 
                              
                            equal to 3.03MPa. To avoid mesh dependency, a nonlocal method is used: the stress-based regularization method [32], with the internal length l
                           
                              C0
                           =7.5mm has been chosen to limit the spreading of nonlocal damage and get the right damage location initiation at the notch tip. The stress-based weighting function writes
                              
                                 (9)
                                 
                                    ϕ
                                    (
                                    x
                                    −
                                    s
                                    )
                                    =
                                    exp
                                    
                                       (
                                       
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         2
                                                         
                                                            ‖
                                                            
                                                               x
                                                               −
                                                               s
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         ρ
                                                         (
                                                         x
                                                         ,
                                                         σ
                                                         (
                                                         s
                                                         )
                                                         )
                                                      
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        

The loading is applied at a point of a small area on the top of the beam (
                           Fig. 9). This small triangle-shaped area (2.5mm×12mm) avoids the stress concentration around the loading point. At each support point, a similar rectangular-shaped elastic area (2.5mm×10mm) is added to avoid geometrical singularities (Fig. 9). Vertical displacement is blocked at each support point. The loading is an increasing vertical displacement up to 2×10−4
                           m. Horizontal displacement is free (except at the loading point).

The just-in-time structural zooming method is applied to this test case: the mesh of the beam is divided in 16 areas of equivalent dimension (
                           Fig. 10). An additional substructure is constituted with the elastic loading area. It is modeled from the start of the simulation, to support the displacement-driven loading. Although displacement-driven loadings are applied on the Lagrange multipliers, and could theoretically be condensed as displacement boundary conditions [29], it appears to be much simpler in terms of implementation (and has negligible computational cost) to model the loading area. On the contrary, the support areas are considered zoomable or condensable areas and associated to the adjacent zoomable zone. Boundary conditions are included in the equivalent structural stiffness.

For the propagation criterion, a new adjacent zone is zoomed when damage is non-null in any element included (totally or partially) in a band 1.5 l
                           
                              C0 thick from the boundary (numerical damage tolerance of 0.01, to avoid over-zooming when areas are small). For the outbreak criterion, if the nonlocal Mazars equivalent strain reaches 
                              
                                 
                                    ε
                                 
                                 
                                    0
                                 
                              
                            in a condensed zone, it will be zoomed. The outbreak criterion, which implies a costly computation on the condensed areas, is checked every four loading increments (p=4), while the damage propagation criterion evaluation, which has negligible computing cost, is done at the end of every increment.


                           
                           Fig. 11 presents the load–deflection evolutions obtained with the zooming method and with the reference simulation (run with the same data but without the zooming method). The deflection corresponds to the displacement of the central point of the beam.

Both curves follow the same evolution
                              
                                 •
                                 At point 1, damage initiates at the center of the beam.

At point 2, the load peak is reached.

Point 3 is the last loading increment (and end of the simulations).


                           
                           Fig. 12 presents the Load–CMOD evolutions of our simulations (with the zoomed method), the experimental measures, and the simulation made in [35] with the same model and parameters (Fig. 12). The CMOD is numerically calculated as the relative lateral displacement of the two points at the mouth of the notch.

The Load–CMOD evolution shows that our simulation reproduces the experimental results quite correctly. Our simulation gives results closer to the experiment than [35]: this effect is due to the use of the stress-based regularization method, which allows better modeling of the behavior around the notch than the Gaussian regularization method.


                           
                           Fig. 13 presents the damage profile evolutions for the reference simulation and the simulation using just-in-time zooming. For a given time step, both damage profiles are identical, with in both cases and evolution of the damage from the crack to the top of the beam. Some nonlinearities also appear near the supports. The structural zooming method models correctly the reference behavior of both condensed and zoomed area, including at the local scale.

The computation times are also compared between the full simulation and the zoomed simulation. To observe the effect of the decomposition of the problem in zones, another zoomed simulation using the same dataset has been run, this time with the problem decomposed in 64 zoomable areas. All have been run on the same computer (a standard dual-core workstation) with Cast3M. 
                           Table 1 presents the processor times for all three simulations.

These processor times show an economy of respectively 26%, 35% and 52% when using the just-in-time zooming method with 16, 32 and 64 zoomable areas (Table 1). The better results obtained with the 64 areas configuration can be explained by the shape and localization of the damage in the structure, leading the 64 areas simulation to run with a lower part of the beam modeled (
                           Fig. 14). This clearly demonstrates the interest of this area-condensation approach. Although the absolute speed-up values may seem low compared to other zooming or model reduction methods, it must be kept in mind that the results are identical to those of the full simulation.

Even with better optimization of the method and its parameters, what appears from the damage profiles (Fig. 14) is that the shape of the zoomed area matches the damage distribution in the beam. With the finest decomposition (64 areas), the speed-up is therefore limited only by the distribution of damage in the structure. The ratio of zoomed to condensed areas is expected to be much higher on large structures since the damaged areas are supposed to be small. The economy in computational load, and thus the ability to access more refined simulation with given computational power, is expected to scale.

This test case aims to evaluate the applicability of the method to a structure which represents a reinforced concrete containment building mock-up. The structure is a reinforced concrete cylinder with a hemispherical dome. The displacements at the bottom of the cylinder are blocked and the structure undergoes an internal pressure loading.


                           
                           Fig. 15 presents the mesh and geometry of the reinforced concrete structure. 
                           Table 2 presents its dimensions.

The concrete cylinder is meshed with rectangle parallelepipeds (50cm×50cm×40cm, one element in the thickness), and the dome with prismatic elements, both with tri-linear finite elements. The steel rebars are modeled with truss finite elements (50cm). Those truss elements have an equivalent section S=8.04cm2 (corresponding to a steel diameter of 32mm). All 12 horizontal circular rebars are inserted at 17.5cm thickness (from inside) in the cylinder, 40 vertical rebars are inserted at 22.5cm thickness in the cylinder, and 80 in the dome. The link between rebars and the concrete volume is ensured by kinematic relations on nodal displacement.

The concrete is modeled using the Mazars isotropic damage model, with the parameters given in 
                           Table 3. For a mean Young׳s modulus of 
                              
                                 
                                    E
                                 
                                 
                                    M
                                 
                              
                              =
                              30
                              
                              GPa
                           , this gives a compressive strength at 28 days 
                              
                                 
                                    f
                                 
                                 
                                    c
                                 
                              
                            of 26.9MPa and a tensile strength 
                              
                                 
                                    f
                                 
                                 
                                    t
                                 
                              
                            of 3.0MPa. A random auto-correlated field is used to represent heterogeneity in the concrete Young׳s modulus at the structural scale. Although it is not technically required for this analysis, this random field modeling has two functions: firstly, it gives a closer representation of the physics of a nuclear containment building, where mechanical properties are known to vary spatially [36]; secondly, using heterogeneous properties allows to break the problem׳s rotational invariance, and creates weaker points where damage can localize. The distribution follows a Gaussian law with a mean value 
                              
                                 
                                    E
                                 
                                 
                                    M
                                 
                              
                            equal to 30GPa and a standard deviation 
                              
                                 
                                    E
                                 
                                 
                                    σ
                                 
                              
                            equal to 3.0GPa (Fig. 15). The chosen spatial autocorrelation function is arbitrarily Gaussian with an autocorrelation length 
                              
                                 
                                    l
                                 
                                 
                                    i
                                 
                              
                              =
                           1m. The steel rebars are modeled using the Von Mises plasticity model with linear hardening (see parameters given in 
                           Table 4).

To avoid mesh dependency, a nonlocal method is used: the stress-based regularization method [32], with the internal length l
                           
                              C0
                           =0.5m has been chosen to limit the spreading of nonlocal damage. The loading is a uniform pressure applied on the internal surface of the cylinder and the dome, up to 1.73×105
                           Pa.

The structural zooming method is applied on this simulation: the mesh of the structure is divided in 6 zoomable areas of equivalent dimension (Fig. 15). All boundary conditions applicable are condensed in the equivalent stiffness. The applied loading is also condensed when necessary.

The zooming criteria used on the concrete model are the same as the plain concrete beam case, since the same mechanical model is used. No zooming criterion is applied for the steel model since its degrees of freedom are kinematically linked to the concrete nodes, and its mechanical model will allow larger values of strain in the linear-elastic phase: therefore, the steel will be zoomed or condensed following the concrete of the area.

@&#RESULTS@&#


                           
                           Fig. 16 presents pressure–displacement evolutions for the reference and zoomed simulations. In both cases, the same field is considered for the concrete Young׳s modulus.


                           Fig. 16 shows a total agreement between both simulations. This confirms the results on the concrete beam, and the applicability of the method to a tridimensional problem with reinforcement bars (and therefore, multiple mechanical models).

The damage profiles (
                           Fig. 17) at the last step also show a total agreement between the zoomed simulation and the reference simulation, on both localization and values of the damage variable. The results of the reference simulation are then correctly reproduced by the simulation using the structural zooming method. The computation times are compared. Both simulations have been run on the same computer (a 16-core computing node).

Those processor times show an economy induced by the use of the zooming method of 50% (
                           Table 5). Zooming method׳s applicability and usefulness is therefore confirmed on that type of simulations. The observation of the simulation׳s evolution reveals that the outbreak criterion is matched only once. However, given the small number of steps effectively computed (27 steps), higher values of p would most likely induce a lower performance, as a large part of the simulation would be computed twice. However, with finer meshes, new problem decompositions could be proposed to keep the computational cost low while refining the simulation.

@&#CONCLUSIONS@&#

An adaptive condensation method for the nonlinear simulation of large structures has been presented. It uses Guyan degree of freedom elimination to reduce the dimension of a large problem with localized nonlinear behavior. When the system evolves during the loading, our method allows an evolution of the zoomed areas (propagation or outbreak). This method can be applied to any model and material with suitable zooming criteria. The more localized the nonlinearities are, the more efficient the method will be.

This method has been applied on two computational test cases. The first case is a plain concrete notched beam under a three-point bending. On this case the method can reproduce the results of a reference simulation with accuracy and provides a speed-up greater than 2 in computation time with standard and non-optimized parameters. The performance is expected to be higher with optimal parameters (initial zone decomposition especially) and an optimized implementation. The second test case is a reinforced concrete structure model whose geometry corresponds to the simplified shape and dimensions of a nuclear confinement building mock-up. On this case, the zooming method can also reproduce the reference computation with accuracy. An economy of 50% computation time is observed, thus confirming the efficiency of the method.

However, the computational efficiency of the method can only be measured for given test cases, since it is highly dependent on the subproblems decomposition, and most of all, on the localization of nonlinearities on a small area. The structural zooming method reduces the size of the problem solved to that of the sole nonlinear area (and not of the full problem): for a given size of nonlinear area, the efficiency of the method will increase with the size of the problem. Small- and intermediate-scale problems are therefore intrinsically unfavorable to the method. On strongly localized nonlinear problems, such as concrete cracking in large structures including several heterogeneities, a higher performance is expected, giving access to the solution of larger problems.

Ongoing research will focus on a method to condense again the damaged areas in which the stiffness does not evolve anymore due to damage saturation and parametric studies on both the problem decomposition and the criterion checking frequency in order to find some optimal values for the method parameters.

@&#ACKNOWLEDGMENTS@&#

The authors gratefully acknowledge the funding support from France׳s National Research Agency through “MACENA” project (ANR-11-RSNR-012).

@&#REFERENCES@&#

