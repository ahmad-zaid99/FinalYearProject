@&#MAIN-TITLE@&#A fracture-controlled path-following technique for phase-field modeling of brittle fracture

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           The phase-field fracture-surface area is used as a path-following control equation.


                        
                        
                           
                           A staggered path-following algorithm is derived from the monolithic formulation.


                        
                        
                           
                           A detailed comparison of the monolithic and staggered schemes is presented.


                        
                        
                           
                           The influence of phase-field tip enrichment on snap-back behavior is demonstrated.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Brittle fracture

Phase-field modeling

Path-following methods

Staggered solution procedures

@&#ABSTRACT@&#


                  In the phase-field description of brittle fracture, the fracture-surface area can be expressed as a functional of the phase field (or damage field). In this work we study the applicability of this explicit expression as a (non-linear) path-following constraint to robustly track the equilibrium path in quasi-static fracture propagation simulations, which can include snap-back phenomena. Moreover, we derive a fracture-controlled staggered solution procedure by systematic decoupling of the path-following controlled elasticity and phase-field problems. The fracture-controlled monolithic and staggered solution procedures are studied for a series of numerical test cases. The numerical results demonstrate the robustness of the new approach, and provide insight in the advantages and disadvantages of the monolithic and staggered procedures.
               

@&#INTRODUCTION@&#

In many problems in brittle-fracture mechanics, phenomena such as nucleation, propagation, branching and merging occur. Complex crack patterns appear as a consequence of e.g. the presence of multiple cracks, anisotropy and heterogeneity. Using discrete fracture models it is generally difficult to capture such topologically complex crack patterns, which has led to the development of smeared or continuum crack models, including phase-field models [1,2]. In phase-field models the crack surface is regularized by a smeared damage (or phase-field) function, which avoids the need for the explicit tracking of fracture surfaces. Over the past years phase-field modeling of fracture has been applied to a wide range of problems, including dynamic fracturing [3,4], large deformation fracturing [5], fracturing of electromechanical materials [6], cohesive fracturing [7], and fluid-driven fracture propagation [8].

In this work we consider the quasi-static evolution of brittle fractures in an elastic solid, where fractures are driven by gradual incrementation of the loading conditions. Since softening and snap-back behavior are frequently encountered in such situations, path-following control is required to adequately track the complete equilibrium path [9]. Path-following techniques have been an indispensable tool in non-linear solid mechanics since the pioneering works of Riks [10], Crisfield [11] and Ramm [12]. While these path-following techniques were developed in the context of snap-back behavior caused by geometrical non-linearities, over the past decades various enhancements to the original path-following procedures have been proposed in order to increase their versatility and computational efficiency.

A particularly interesting application of path-following techniques is their use to track snap-back behavior as a result of material non-linearities, especially localized failure phenomena. In such situations the original path-following constraints have proven to lack robustness by the fact that they fail to account for the localized nature of the source of non-linearity. Various modified techniques have been proposed to account for this localized behavior, among which are a series of (semi-)automatic procedures for selecting degrees of freedom that contribute to the nonlinear behavior of the system [13,14]. Our work builds on the idea that an appropriate path-following technique can be obtained by selecting a physically motivated constraint equation. In this regard the crack mouth opening displacement (CMOD) and crack mouth sliding displacement (CMSD) control equations proposed by De Borst [15] can be considered as pioneering works. Inspired by these control equations energy-release rate path-following control was developed for the simulation of localized failure phenomena, including discrete cracking, smeared damage and softening plasticity [16,17]. The versatility of the energy-release rate control has been demonstrated for a variety of applications, including cases in which geometrical and material nonlinearities are competing [18].

When applied in the context of discrete fracture simulations, the energy release-rate path-following technique has the ability to indirectly control the rate at which a fracture propagates by proper selection of the energy dissipation increment. In Ref. [19] it has been shown that the energy-release rate control can be successfully applied to phase-field simulations, where the dissipation increment is related to the fracture-surface area increment through the critical energy release rate. In the case of phase-field simulations the relation between the path-following constraint and the fracture-surface area increase can be made explicit, i.e. the fracture-surface area can be expressed as a functional of the phase-field solution. This allows for direct prescription of the surface-area increments. This explicit dependence allows for the selection of the path-following parameter increment based on a criterion that relates the crack surface growth to the size of the employed (finite element) mesh, which provides a natural way of controlling the accuracy of the path-following scheme. In this work we formulate and study such a fracture-based path-following technique, which – if used in combination with a monolithic incremental-iterative path-following procedure – allows for the parametrization of the equilibrium path by specified fracture-surface area increments.

Quasi-static phase-field simulations of brittle fracture phenomena have mostly relied on the use of a staggered solution strategy, in which the elasticity problem and phase-field problems are decoupled [2]. This staggered solution strategy has been proven to be computationally efficient. A drawback of this solution strategy is that the step sizes need to be selected appropriately in order to control the accuracy of the procedure. The currently available staggered schemes are not capable of representing snap-back behavior. In this work a staggered fracture-based path-following method is derived from the monolithic scheme, which has the possibility of reducing the computational effort of the monolithic scheme at the cost of only satisfying the path-following increments in an approximate sense. This fracture-controlled staggered scheme does, however, inherit the property of the underlying monolithic scheme that the fracture propagation increments can directly be controlled (albeit in an approximate sense). This simplifies the selection of the step size compared to e.g. the displacement-based staggered scheme.

In Section 2 we introduce the phase-field formulation for brittle fracture and its discretization using the finite element method. In Section 3 we derive the fracture-based path-following constraint. In this section we also discuss various aspects of the corresponding incremental-iterative path-following procedure. In Section 4 we systematically derive the staggered path-following scheme, after which the monolithic scheme and staggered scheme are studied in detail in terms of computational effort and accuracy in Section 5. In this section we also study the nature of the snap-back behavior encountered in phase-field simulations for brittle fracture. Finally, conclusions are drawn in Section 6.

We consider the evolution of a regularized fracture surface, 
                           
                              
                                 Γ
                              
                              
                                 
                                    
                                       l
                                    
                                    
                                       c
                                    
                                 
                              
                           
                           (
                           d
                           )
                        , in an 
                           
                              
                                 n
                              
                              
                                 dim
                              
                           
                           -dimensional
                         elastic medium, 
                           Ω
                           ⊂
                           
                              
                                 R
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       dim
                                    
                                 
                              
                           
                        , under quasi-static loading (see Fig. 1
                        ). The outward-pointing unit normal vector to the surface of the domain Ω is denoted by 
                           n
                           :
                           Γ
                           →
                           
                              
                                 R
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       dim
                                    
                                 
                              
                           
                        . Small deformations and deformation gradients are assumed, and the deformation of the medium is described by the displacement field 
                           u
                           :
                           Ω
                           →
                           
                              
                                 R
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       dim
                                    
                                 
                              
                           
                        . The fracture surface, 
                           
                              
                                 Γ
                              
                              
                                 
                                    
                                       l
                                    
                                    
                                       c
                                    
                                 
                              
                           
                           (
                           d
                           )
                        , is represented by the phase field 
                           d
                           :
                           Ω
                           →
                           [
                           0
                           ,
                           1
                           ]
                        , which approaches 1 inside a regularized crack and vanishes far away from the fracture surface. External tractions, 
                           
                              
                                 t
                              
                              
                                 ¯
                              
                           
                        , are applied along the Neumann boundary 
                           
                              
                                 Γ
                              
                              
                                 N
                              
                           
                         and prescribed displacements, 
                           
                              
                                 u
                              
                              
                                 ¯
                              
                           
                        , are considered at the Dirichlet boundary 
                           
                              
                                 Γ
                              
                              
                                 D
                              
                           
                        .

Under the above conditions, the strong form for the displacement and phase field is given by:
                           
                              (1)
                              
                                 (
                                 S
                                 )
                                 {
                                 
                                    
                                       
                                          
                                             ∇
                                             ·
                                             σ
                                             =
                                             0
                                          
                                          
                                             in
                                             
                                             Ω
                                          
                                          
                                             (
                                             1
                                             a
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                d
                                                −
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                Δ
                                                d
                                             
                                             )
                                             =
                                             2
                                             (
                                             1
                                             −
                                             d
                                             )
                                             H
                                          
                                          
                                             in
                                             
                                             Ω
                                          
                                          
                                             (
                                             1
                                             b
                                             )
                                          
                                       
                                       
                                          
                                             σ
                                             ·
                                             n
                                             =
                                             
                                                
                                                   t
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             on
                                             
                                             
                                                
                                                   Γ
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             c
                                             )
                                          
                                       
                                       
                                          
                                             u
                                             =
                                             
                                                
                                                   u
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             on
                                             
                                             
                                                
                                                   Γ
                                                
                                                
                                                   D
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             d
                                             )
                                          
                                       
                                       
                                          
                                             ∇
                                             d
                                             ·
                                             n
                                             =
                                             0
                                          
                                          
                                             on
                                             
                                             Γ
                                          
                                          
                                             (
                                             1
                                             e
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        In this strong form, 
                           
                              
                                 G
                              
                              
                                 c
                              
                           
                         is the Griffith type critical energy-release rate and 
                           
                              
                                 l
                              
                              
                                 c
                              
                           
                         is the length scale associated with the phase-field regularization of the fracture surface
                           1
                        
                        
                           1
                           Here the length scale 
                                 
                                    
                                       l
                                    
                                    
                                       c
                                    
                                 
                               is defined as in Ref. [2]. We note that in the literature sometimes use is made of the alternative length scale definition 
                                 ε
                                 =
                                 
                                    
                                       l
                                    
                                    
                                       c
                                    
                                 
                                 /
                                 2
                              , e.g. 
                              [1].
                         (i.e. the width of the cracks) [1,2]. In order to restrict the fracturing process to tensile stress states, the Cauchy stress tensor in the above problem is defined as
                           
                              (2)
                              
                                 σ
                                 (
                                 ε
                                 ,
                                 d
                                 )
                                 =
                                 g
                                 (
                                 d
                                 )
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                    
                                       +
                                    
                                 
                                 (
                                 ε
                                 )
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                    
                                       −
                                    
                                 
                                 (
                                 ε
                                 )
                                 ,
                              
                           
                        where 
                           g
                           (
                           d
                           )
                           =
                           
                              
                                 (
                                 1
                                 −
                                 d
                                 )
                              
                              
                                 2
                              
                           
                         is the degradation function, 
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 +
                              
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 −
                              
                           
                         are the tensile and compressive parts of the virgin (d=0) Cauchy stress tensor [2], and 
                           ε
                           =
                           
                              
                                 ∇
                              
                              
                                 s
                              
                           
                           u
                         is the infinitesimal strain tensor. From the above stress definition it evidently follows that this degradation function must satisfy the conditions 
                           g
                           (
                           0
                           )
                           =
                           1
                         and 
                           g
                           (
                           1
                           )
                           =
                           0
                        . The property that 
                           
                              
                                 g
                              
                              
                                 ′
                              
                           
                           (
                           1
                           )
                           =
                           0
                         ensures that the thermodynamic driving force for the phase-field model (i.e. the right-hand-side of the phase-field equation) vanishes once a fracture has completely evolved.

Irreversibility, i.e. the notion that the fracture surface can only extend (
                           
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 
                                    
                                       l
                                    
                                    
                                       c
                                    
                                 
                              
                           
                           ≥
                           0
                        ), is enforced in the strong form (1) by means of the history field 
                           H
                           :
                           Ω
                           →
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        . This history field satisfies the Kuhn–Tucker conditions for loading and unloading, defined as
                           
                              (3)
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       0
                                    
                                    
                                       +
                                    
                                 
                                 −
                                 H
                                 ≤
                                 0
                                 ,
                                 
                                 
                                    
                                       H
                                    
                                    
                                       ̇
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 
                                    
                                       H
                                    
                                    
                                       ̇
                                    
                                 
                                 (
                                 
                                    
                                       ψ
                                    
                                    
                                       0
                                    
                                    
                                       +
                                    
                                 
                                 −
                                 H
                                 )
                                 =
                                 0
                                 ,
                              
                           
                        with 
                           
                              
                                 ψ
                              
                              
                                 0
                              
                              
                                 +
                              
                           
                         the tensile part of the virgin elastic energy density.

To compute an approximate solution to the strong form (1) using the finite element method, the weak form is derived. Using the function spaces 
                           
                              
                                 V
                              
                              
                                 u
                              
                           
                           =
                           {
                           u
                           ∈
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           (
                           Ω
                           )
                           ∣
                           u
                           =
                           
                              
                                 u
                              
                              
                                 ¯
                              
                           
                           
                           on
                           
                           
                              
                                 Γ
                              
                              
                                 D
                              
                           
                           }
                         and 
                           
                              
                                 V
                              
                              
                                 d
                              
                           
                           =
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           (
                           Ω
                           )
                         for the trial functions, and 
                           
                              
                                 V
                              
                              
                                 0
                              
                              
                                 u
                              
                           
                           =
                           {
                           u
                           ∈
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           (
                           Ω
                           )
                           ∣
                           u
                           =
                           0
                           
                           on
                           
                           
                              
                                 Γ
                              
                              
                                 D
                              
                           
                           }
                         and 
                           
                              
                                 V
                              
                              
                                 d
                              
                           
                         for the test functions, we obtain:
                           
                              (4)
                              
                                 (
                                 W
                                 )
                                 {
                                 
                                    
                                       
                                          
                                             Find
                                             
                                             (
                                             u
                                             ,
                                             d
                                             )
                                             ∈
                                             
                                                
                                                   V
                                                
                                                
                                                   u
                                                
                                             
                                             ×
                                             
                                                
                                                   V
                                                
                                                
                                                   d
                                                
                                             
                                             
                                             such
                                             
                                             that
                                             :
                                          
                                          
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∫
                                                
                                                
                                                   Ω
                                                
                                             
                                             σ
                                             :
                                             
                                                
                                                   ∇
                                                
                                                
                                                   s
                                                
                                             
                                             w
                                             
                                             dV
                                             =
                                             
                                                
                                                   ∫
                                                
                                                
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   ¯
                                                
                                             
                                             ·
                                             w
                                             
                                             d
                                             S
                                          
                                          
                                             ∀
                                             w
                                             ∈
                                             
                                                
                                                   V
                                                
                                                
                                                   0
                                                
                                                
                                                   u
                                                
                                             
                                          
                                          
                                             (
                                             4
                                             a
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∫
                                                
                                                
                                                   Ω
                                                
                                             
                                             [
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  G
                                                               
                                                               
                                                                  c
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  c
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   2
                                                   H
                                                
                                                )
                                                d
                                                −
                                                2
                                                H
                                             
                                             ]
                                             e
                                             +
                                             
                                                
                                                   G
                                                
                                                
                                                   c
                                                
                                             
                                             
                                                
                                                   l
                                                
                                                
                                                   c
                                                
                                             
                                             ∇
                                             d
                                             ·
                                             ∇
                                             e
                                             
                                             d
                                             V
                                             =
                                             0
                                          
                                          
                                             ∀
                                             e
                                             ∈
                                             
                                                
                                                   V
                                                
                                                
                                                   d
                                                
                                             
                                          
                                          
                                             (
                                             4
                                             b
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        This weak form is discretized using a (Bubnov–) Galerkin finite element discretization, for which the displacement field and phase field are interpolated by
                           
                              (5)
                              
                                 u
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       I
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       I
                                    
                                    
                                       u
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                    
                                       a
                                    
                                    
                                       I
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                 d
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       I
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       I
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                    
                                       a
                                    
                                    
                                       I
                                    
                                    
                                       d
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 n
                              
                              
                                 u
                              
                           
                         and n
                        
                           d
                         denote the number of displacement and phase field degrees of freedom, respectively. The vector-valued shape functions 
                           
                              
                                 N
                              
                              
                                 I
                              
                              
                                 u
                              
                           
                           (
                           x
                           )
                           :
                           Ω
                           →
                           
                              
                                 R
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       dim
                                    
                                 
                              
                           
                         and scalar-valued shape functions 
                           
                              
                                 N
                              
                              
                                 I
                              
                              
                                 d
                              
                           
                           :
                           Ω
                           →
                           R
                         span subsets of 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           (
                           Ω
                           )
                         and 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           (
                           Ω
                           )
                        , respectively. The nodal displacement components and phase-field values are respectively represented by 
                           
                              
                                 a
                              
                              
                                 u
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       u
                                    
                                 
                              
                           
                         and 
                           
                              
                                 a
                              
                              
                                 d
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       d
                                    
                                 
                              
                           
                        . The degrees of freedom are assembled in a single vector of coefficients: 
                           
                              
                                 a
                              
                              
                                 T
                              
                           
                           =
                           [
                           
                              
                                 a
                              
                              
                                 
                                    
                                       u
                                    
                                    
                                       T
                                    
                                 
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 
                                    
                                       d
                                    
                                    
                                       T
                                    
                                 
                              
                           
                           ]
                        . The Dirichlet boundary conditions are enforced strongly by means of a constraints matrix 
                           C
                        , such that 
                           a
                           =
                           
                              
                                 Ca
                              
                              
                                 f
                              
                           
                           +
                           
                              
                                 a
                              
                              
                                 p
                              
                           
                        , with 
                           
                              
                                 a
                              
                              
                                 f
                              
                           
                         the free degrees of freedom and 
                           
                              
                                 a
                              
                              
                                 p
                              
                           
                         the prescribed degrees of freedom.

Using the finite element discretization (5), the weak form (4) can be written as a non-linear system of equations
                           
                              (6)
                              
                                 
                                    
                                       f
                                    
                                    
                                       int
                                    
                                 
                                 (
                                 a
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       ext
                                    
                                 
                                 ,
                              
                           
                        with
                        
                           
                              
                                 f
                              
                              
                                 int
                              
                              
                                 T
                              
                           
                           =
                           [
                           
                              
                                 f
                              
                              
                                 int
                              
                              
                                 
                                    
                                       u
                                    
                                    
                                       T
                                    
                                 
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 int
                              
                              
                                 
                                    
                                       d
                                    
                                    
                                       T
                                    
                                 
                              
                           
                           ]
                         and 
                           
                              
                                 f
                              
                              
                                 ext
                              
                              
                                 T
                              
                           
                           =
                           [
                           
                              
                                 f
                              
                              
                                 ext
                              
                              
                                 
                                    
                                       u
                                    
                                    
                                       T
                                    
                                 
                              
                           
                           ,
                           
                              
                                 0
                              
                              
                                 T
                              
                           
                           ]
                        , see Appendix A for the expressions of these force vectors.

Commonly, the solution to the quasi-static nonlinear problem (6) is computed through an incremental-iterative solution procedure. In such a procedure either the external loading (
                        
                           
                              f
                           
                           
                              ext
                           
                           
                              k
                           
                        
                     ) or the boundary displacement (
                        
                           
                              a
                           
                           
                              p
                           
                           
                              k
                           
                        
                     ) is prescribed in a stepwise incremental fashion, with index 
                        k
                        =
                        1
                        ,
                        …
                        ,
                        
                           
                              n
                           
                           
                              steps
                           
                        
                     . In every step, the corresponding solution increment, 
                        Δ
                        
                           
                              a
                           
                           
                              k
                           
                        
                        =
                        
                           
                              a
                           
                           
                              k
                           
                        
                        −
                        
                           
                              a
                           
                           
                              k
                              −
                              1
                           
                        
                     , is computed using Newton–Raphson iterations. The tangent stiffness matrices required by the Newton solution procedure can be found in Appendix A.

Evidently, force-controlled and displacement-controlled solution procedures break down in the case of softening or snap-back behavior, respectively; see e.g. 
                     [9]. Therefore, in order to track the complete equilibrium path we need to supplement the system of equations with a path-following control.

In this contribution we restrict ourselves to the case of proportional loading, i.e. we assume that the external force vector 
                        
                           
                              f
                           
                           
                              ext
                           
                           
                              k
                           
                        
                      can be written as a load level λ
                     
                        k
                      times a “unit” load vector 
                        
                           
                              f
                           
                           
                              ^
                           
                        
                      in the case of force loading, and the boundary displacements are expressed as 
                        
                           
                              a
                           
                           
                              p
                           
                           
                              k
                           
                        
                        =
                        
                           
                              λ
                           
                           
                              k
                           
                        
                        
                           
                              a
                           
                           
                              ^
                           
                        
                      in the case of displacement loading.

The monolithic path-following procedure is outlined in the pseudo-code Algorithm 1. This standard algorithm is here presented to place some specific algorithmic aspects of the current work in the proper perspective (see Section 3.3). Moreover, this algorithm will serve as the basis for the novel staggered path-following procedure to be derived in the next section.
                        Algorithm 1
                        Monolithic incremental-iterative path-following procedure.
                              
                                 
                                    
                                    
                                       
                                          
                                             Input: (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      0
                                                   
                                                
                                             ), 
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      0
                                                   
                                                
                                              
                                             # State vector, load level & history field
                                          
                                       
                                       
                                          
                                             Output: 
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             , 
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                ,
                                                …
                                                ,
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            steps
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            steps
                                                         
                                                      
                                                   
                                                
                                                )
                                              
                                             # Discrete eq. path
                                          
                                       
                                       
                                          
                                             # Initialization
                                          
                                       
                                       
                                          
                                             control=‘displacement’
                                       
                                       
                                          
                                             # Load steps
                                          
                                       
                                       
                                          
                                             for 
                                             
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      steps
                                                   
                                                
                                             :
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  0
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  k
                                                                  −
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  0
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  k
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                            
                                                               # Initialization
                                                            
                                                            
                                                            
                                                               of
                                                            
                                                            
                                                            
                                                               Newton
                                                            
                                                            
                                                            
                                                               iterations
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            #
                                                            Newton
                                                            
                                                            iterations
                                                         
                                                      
                                                      
                                                         
                                                            for
                                                            
                                                            m
                                                            =
                                                            1
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  max
                                                               
                                                            
                                                            :
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              f
                                                                           
                                                                           
                                                                              int
                                                                           
                                                                        
                                                                        ,
                                                                        K
                                                                        =
                                                                        
                                                                           assemble_augmented_system
                                                                        
                                                                        (
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              m
                                                                              −
                                                                              1
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                           
                                                                              λ
                                                                           
                                                                           
                                                                              m
                                                                              −
                                                                              1
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                           
                                                                              H
                                                                           
                                                                           
                                                                              k
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        ζ
                                                                        ,
                                                                        h
                                                                        ,
                                                                        
                                                                        q
                                                                        =
                                                                        
                                                                           assemble_control_equation
                                                                        
                                                                        (
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              m
                                                                              −
                                                                              1
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                           
                                                                              λ
                                                                           
                                                                           
                                                                              m
                                                                              −
                                                                              1
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                        control
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              m
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                           
                                                                              λ
                                                                           
                                                                           
                                                                              m
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        =
                                                                        
                                                                           solve_augmented_system
                                                                        
                                                                        (
                                                                        K
                                                                        ,
                                                                        
                                                                           
                                                                              f
                                                                           
                                                                           
                                                                              int
                                                                           
                                                                        
                                                                        ,
                                                                        ζ
                                                                        ,
                                                                        h
                                                                        ,
                                                                        q
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        converged
                                                                        =
                                                                        
                                                                           check_convergence
                                                                        
                                                                        (
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              m
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                           
                                                                              λ
                                                                           
                                                                           
                                                                              m
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        if
                                                                        
                                                                        converged
                                                                        :
                                                                        
                                                                        break
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            end
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            converged
                                                            :
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        =
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              m
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                           
                                                                              λ
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        =
                                                                        
                                                                           
                                                                              λ
                                                                           
                                                                           
                                                                              m
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        
                                                                           # Update
                                                                        
                                                                        
                                                                        
                                                                           state
                                                                        
                                                                        
                                                                        
                                                                           vector
                                                                        
                                                                        
                                                                        
                                                                           and
                                                                        
                                                                        
                                                                        
                                                                           load
                                                                        
                                                                        
                                                                        
                                                                           level
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              H
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        =
                                                                        
                                                                           update_history_field
                                                                        
                                                                        (
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                           
                                                                              H
                                                                           
                                                                           
                                                                              k
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        control
                                                                        =
                                                                        
                                                                           select_control_equation
                                                                        
                                                                        (
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                           
                                                                              H
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            else
                                                            :
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               restart_newton_iterations
                                                            
                                                            (
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            end
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             end
                                          
                                       
                                    
                                 
                              
                           
                        

Using a path-following technique, the equilibrium path is defined as the set of all points 
                           {
                           (
                           a
                           (
                           t
                           )
                           ,
                           λ
                           (
                           t
                           )
                           )
                           |
                           t
                           ∈
                           [
                           0
                           ,
                           T
                           ]
                           }
                         which are a solution to the non-linear system of equations (6), where t represents the time parameter ranging from 0 to the final time T. In practice the equilibrium path is represented by a finite sequence of equilibrium points 
                           
                              
                                 {
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 0
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       steps
                                    
                                 
                              
                           
                        , computed through the above-mentioned incremental-iterative solution procedure. In order to compute the discrete equilibrium points, the general idea of path-following techniques is to supplement the system of equations (6) with a path-following constraint of the form
                           
                              (7)
                              
                                 ζ
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 Δ
                                 
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 Δ
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 ;
                                 Δ
                                 τ
                                 )
                                 =
                                 0
                                 ,
                              
                           
                        where 
                           Δ
                           τ
                           >
                           0
                         is the positive increment of the path-following parameter τ, which can be regarded as a pseudo-time parameter. By the incremental-iterative solution of the non-linear system of equations (6) in combination with this constraint equation, a discrete parametrization of the equilibrium path in terms of the path-following parameter τ is obtained: 
                           
                              
                                 {
                                 a
                                 (
                                 
                                    
                                       τ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                                 λ
                                 (
                                 
                                    
                                       τ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 0
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       steps
                                    
                                 
                              
                           
                        . We note that the case of force control, i.e. 
                        
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 λ
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           +
                           
                              
                                 λ
                              
                              
                                 ̇
                              
                           
                           Δ
                           τ
                        , is in fact the most simple case of path-following control possible: 
                           ζ
                           =
                           Δ
                           
                              
                                 λ
                              
                              
                                 k
                              
                           
                           −
                           
                              
                                 λ
                              
                              
                                 ̇
                              
                           
                           Δ
                           τ
                           =
                           0
                        , where 
                           
                              
                                 λ
                              
                              
                                 ̇
                              
                           
                         represents a prescribed loading rate.

The choice for a particular path-following constraint is dictated by the existence of solutions to the non-linear system of equations (6) upon the incrementation of the path parameter τ. For example, force control will be unable to represent softening behavior, while displacement control will fail when snap-back occurs. In fracture mechanics problems various path-following constraints have been found to be very effective. The CMOD (or CMSD) control proposed in [15] has successfully been applied in many cases. Over the past decade the use of dissipation-based control has been studied extensively and was found to be very reliable for problems in which severe non-linear behavior is expected [17]. The rationale behind the dissipation-based control is that, from a physical perspective, dissipation has to be non-negative as a consequence of the irreversibility of fracture propagation. When fracture propagation is the dominant source of dissipation, this control is very effective in simulating the evolution of fractures.

Inspired by the idea of dissipation-control, in this contribution we propose a path-following constraint directly based on the fracture-surface area (or fracture length in 2D). This has become tractable only with the introduction of phase-field models for brittle fracture, due to the availability of an explicit functional expression for the fracture-surface area. We note that in the case of Griffith׳s theory of fracture, there is a direct relation between the fracture-surface area and the amount of dissipation, and hence, under specific assumptions, the control equation developed herein is identical to that developed in [16] (see Appendix B for details).

In the phase-field formulation for brittle fracture, the fracture surface area is expressed by
                           
                              (8)
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 (
                                 d
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       
                                          
                                             l
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       l
                                    
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       |
                                       
                                          ∇
                                          d
                                       
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 
                                 d
                                 V
                                 .
                              
                           
                        In this work we prescribe the rate of fracture propagation, 
                           
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 
                                    
                                       l
                                    
                                    
                                       c
                                    
                                 
                              
                           
                        , by means of the path-following constraint
                           
                              (9)
                              
                                 ζ
                                 =
                                 
                                    
                                       Γ
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 −
                                 
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 
                                    
                                       τ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       Γ
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 −
                                 
                                    
                                       Γ
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 )
                                 −
                                 
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 Δ
                                 τ
                              
                           
                        Note that this path-following constraint is a non-linear equation of the phase field. Since we apply this constraint in a Newton–Raphson solution procedure, it is required to compute the derivative of this constraint with respect to the nodal displacements, and nodal phase-field coefficients, which yields:
                           
                              (10)
                              
                                 
                                    
                                       h
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       ζ
                                    
                                    
                                       ∂
                                       
                                          
                                             a
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                                 =
                                 0
                                 
                                 
                                    
                                       h
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       ζ
                                    
                                    
                                       ∂
                                       
                                          
                                             a
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∫
                                       
                                       
                                          Ω
                                       
                                    
                                 
                                 d
                                 
                                    
                                       N
                                    
                                    
                                       d
                                    
                                 
                                 +
                                 
                                    
                                       l
                                    
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 ∇
                                 d
                                 ·
                                 ∇
                                 
                                    
                                       N
                                    
                                    
                                       d
                                    
                                 
                                 
                                 d
                                 V
                              
                           
                        with 
                           
                              
                                 N
                              
                              
                                 d
                              
                           
                         the column vector of phase-field shape functions. In the remainder we will consider the combined vector 
                           
                              
                                 h
                              
                              
                                 T
                              
                           
                           =
                           [
                           
                              
                                 h
                              
                              
                                 
                                    
                                       u
                                    
                                    
                                       T
                                    
                                 
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 
                                    
                                       d
                                    
                                    
                                       T
                                    
                                 
                              
                           
                           ]
                        . Since the constraint (9) does not depend on the load level explicitly, it follows that
                           
                              (11)
                              
                                 q
                                 =
                                 
                                    
                                       ∂
                                       ζ
                                    
                                    
                                       ∂
                                       λ
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     

The fracture-based path-following constraint (9) has two major benefits. First, it is evident that the path-following parameter is non-decreasing in time, and hence this constraint choice is anticipated to yield robust results, also in the case of material softening and/or snapback. The second advantage is that this choice for the constraint provides an intuitive way of selecting the appropriate step size. By requiring that the fracture surface should not propagate across multiple elements within in a single step, the irreverisibility condition can be adequately imposed. We will further study the choice of the step size in Section 5.

In this section we discuss three algorithmic aspects that are specific to the current work: (i) the solution of the augmented system of equations within each Newton–Raphson iteration; (ii) the convergence criterion employed for the phase-field model; and (iii) the initialization and selection procedure for the control equation and the restarting procedure for the Newton–Raphson iterations.

The solution-vector increment and load level increment in step k, 
                              Δ
                              
                                 
                                    a
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    a
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    a
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                            and 
                              Δ
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    λ
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                           , are computed using Newton–Raphson iterations. As a starting vector and load level for these iterations the solution to the previous step is used: 
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    a
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                            and 
                              
                                 
                                    λ
                                 
                                 
                                    0
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                           . Subsequently, the solution vector increment is iteratively updated by 
                              Δ
                              
                                 
                                    a
                                 
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                              =
                              Δ
                              
                                 
                                    a
                                 
                                 
                                    m
                                    −
                                    1
                                 
                                 
                                    k
                                 
                              
                              +
                              δ
                              
                                 
                                    a
                                 
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                            and 
                              Δ
                              
                                 
                                    λ
                                 
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                              =
                              Δ
                              
                                 
                                    λ
                                 
                                 
                                    m
                                    −
                                    1
                                 
                                 
                                    k
                                 
                              
                              +
                              δ
                              
                                 
                                    λ
                                 
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                           , where 
                              m
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    m
                                 
                                 
                                    max
                                 
                              
                            is the Newton–Raphson iteration counter. For the computation of the update vector 
                              δ
                              
                                 
                                    a
                                 
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                            and update load level 
                              δ
                              
                                 
                                    λ
                                 
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                            we distinguish between the cases of force loading and displacement loading. Note that for notational brevity we omit the step number k and iteration number m in the following paragraphs (
                              δ
                              
                                 
                                    a
                                 
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                              =
                              δ
                              a
                            and 
                              δ
                              
                                 
                                    λ
                                 
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                              =
                              δ
                              λ
                           ). All matrices and vectors are evaluated at the state 
                              (
                              
                                 
                                    a
                                 
                                 
                                    m
                                    −
                                    1
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    m
                                    −
                                    1
                                 
                                 
                                    k
                                 
                              
                              )
                              =
                              (
                              a
                              ,
                              λ
                              )
                           , i.e. the solution computed after 
                              m
                              −
                              1
                            iterations.


                           Force loading: The external force vector in the discrete equilibrium equations (6) is then given by 
                              
                                 
                                    f
                                 
                                 
                                    ext
                                 
                              
                              =
                              λ
                              
                                 
                                    f
                                 
                                 
                                    ^
                                 
                              
                            and the constraints are imposed by 
                              a
                              =
                              
                                 
                                    Ca
                                 
                                 
                                    f
                                 
                              
                              +
                              
                                 
                                    a
                                 
                                 
                                    p
                                 
                              
                           , where both the matrix 
                              C
                            and the vector 
                              
                                 
                                    a
                                 
                                 
                                    p
                                 
                              
                            are constant throughout the simulation. The solution update is then computed through
                              
                                 (12)
                                 
                                    (
                                    
                                       
                                          
                                             
                                                δ
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      f
                                                   
                                                
                                             
                                          
                                          
                                             
                                                δ
                                                λ
                                             
                                          
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      K
                                                      (
                                                      a
                                                      )
                                                      C
                                                   
                                                   
                                                      −
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      (
                                                      a
                                                      )
                                                      C
                                                   
                                                   
                                                      q
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      T
                                                   
                                                
                                                [
                                                
                                                   λ
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         int
                                                      
                                                   
                                                   (
                                                   a
                                                   )
                                                
                                                ]
                                             
                                          
                                          
                                             
                                                −
                                                ζ
                                                (
                                                a
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           and 
                              δ
                              a
                              =
                              C
                              δ
                              
                                 
                                    a
                                 
                                 
                                    f
                                 
                              
                           . We compute the solution to this augmented system by solving through the Sherman–Morrison procedure discussed in e.g. Ref. [17]. The two linear systems of equations encountered in this procedure are solved using a GMRES solver with sparse ILU pre-conditioning. Since both systems have the same left-hand-side, the pre-conditioner needs to be computed only once per Newton iteration.


                           Displacement loading: In this case the external force vector in Eq. (6) is equal to zero, and the constraints depend on the load level: 
                              a
                              =
                              
                                 
                                    Ca
                                 
                                 
                                    f
                                 
                              
                              +
                              
                                 
                                    a
                                 
                                 
                                    p
                                 
                              
                              +
                              λ
                              
                                 
                                    a
                                 
                                 
                                    ^
                                 
                              
                           . Note that the vector 
                              
                                 
                                    a
                                 
                                 
                                    p
                                 
                              
                            accounts for Dirichlet constraints that are not dependent on the load level λ. The solution update is then obtained by
                              
                                 (13)
                                 
                                    (
                                    
                                       
                                          
                                             
                                                δ
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      f
                                                   
                                                
                                             
                                          
                                          
                                             
                                                δ
                                                λ
                                             
                                          
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      K
                                                      (
                                                      a
                                                      )
                                                      C
                                                   
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      K
                                                      (
                                                      a
                                                      )
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      (
                                                      a
                                                      )
                                                      C
                                                   
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      (
                                                      a
                                                      )
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                      +
                                                      q
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                −
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      int
                                                   
                                                
                                                (
                                                a
                                                )
                                             
                                          
                                          
                                             
                                                −
                                                ζ
                                                (
                                                a
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           and 
                              δ
                              a
                              =
                              C
                              δ
                              
                                 
                                    a
                                 
                                 
                                    f
                                 
                              
                              +
                              δ
                              λ
                              
                                 
                                    a
                                 
                                 
                                    ^
                                 
                              
                           . As for the case of force loading we apply a Sherman–Morrison procedure to solve this augmented system of equations.

After each Newton–Raphson iteration, convergence is checked based on the residual of the displacement field solution and phase-field solution, i.e. the solution is accepted when
                              
                                 (14)
                                 
                                    ∥
                                    
                                       
                                          
                                             r
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             m
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    ∥
                                    ≤
                                    
                                       
                                          ϵ
                                       
                                       
                                          u
                                       
                                    
                                    ∥
                                    
                                       
                                          
                                             r
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    ∥
                                    
                                    and
                                    
                                    ∥
                                    
                                       
                                          
                                             r
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             m
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    ∥
                                    ≤
                                    
                                       
                                          ϵ
                                       
                                       
                                          d
                                       
                                    
                                    ∥
                                    
                                       
                                          
                                             r
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    ∥
                                    ,
                                 
                              
                           where 
                              
                                 
                                    ϵ
                                 
                                 
                                    u
                                 
                              
                            and ϵ
                           
                              d
                            are tolerances for the displacement residual 
                              
                                 
                                    r
                                 
                                 
                                    u
                                 
                              
                            and phase-field residual 
                              
                                 
                                    r
                                 
                                 
                                    d
                                 
                              
                           , respectively.

Consider the sensitivity of the load level to the path-following parameter:
                              
                                 (15)
                                 
                                    
                                       
                                          ∂
                                          λ
                                       
                                       
                                          ∂
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                Γ
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                c
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             h
                                             ·
                                             
                                                
                                                   ∂
                                                   a
                                                
                                                
                                                   ∂
                                                   λ
                                                
                                             
                                          
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                Γ
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                c
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   d
                                                
                                             
                                             ·
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   λ
                                                
                                             
                                          
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    .
                                 
                              
                           From this expression it is evident that the path-following constraint will fail if the vector 
                              h
                            in Eq. (10) is orthogonal to the sensitivity of the solution vector. One particular situation in which this occurs is when there is no damage present at all, and hence 
                              ∥
                              
                                 h
                              
                              ∥
                              =
                              0
                           . This is, however, not the only situation in which problems occur. Also in the case that the phase field is rather insensitive to the load level (
                              ∥
                              
                                 ∂
                                 
                                    
                                       a
                                    
                                    
                                       d
                                    
                                 
                                 /
                                 ∂
                                 λ
                              
                              ∥
                              ≈
                              0
                           ), the constraint equation fails. This situation is encountered in the case that elastic behavior occurs, which happens particularly in the cases of initial loading and unloading. For this reason, initially displacement control is used. The switch to the fracture-surface area constraint is made after a significant amount of fracture-surface area has been formed.

Depending on the number of Newton–Raphson iterations the path-parameter increment is adjusted [16]. To this end a target number of Newton–Raphson iterations, 
                              
                                 
                                    m
                                 
                                 
                                    targ
                                 
                              
                           , is specified. The path-parameter for the next increment is then scaled with a factor 
                              
                                 
                                    m
                                 
                                 
                                    targ
                                 
                              
                              /
                              m
                            with a maximum of 
                              Δ
                              
                                 
                                    τ
                                 
                                 
                                    max
                                 
                              
                           . Evidently, when the path-parameter increment is chosen too large, it can occur that the Newton–Raphson iterations do not converge within 
                              
                                 
                                    m
                                 
                                 
                                    max
                                 
                              
                            iterations. In that case the Newton–Raphson procedure for the same step is repeated with the path-parameter increment scaled by 
                              
                                 
                                    m
                                 
                                 
                                    targ
                                 
                              
                              /
                              
                                 
                                    m
                                 
                                 
                                    max
                                 
                              
                           .

Taking the monolithic path-following procedure in Algorithm 1 for the case of displacement loading (
                        
                           
                              a
                           
                           
                              p
                           
                        
                        =
                        λ
                        
                           
                              a
                           
                           
                              ^
                           
                        
                     ) as a starting point, we derive a staggered path-following procedure. The most notable difference of this staggered algorithm compared to the monolithic Algorithm 1 is that no Newton–Raphson iterations are conducted and that the associated convergence criterion is omitted. A consequence of this is that an additional source of error is introduced in the staggered scheme, which, in practice, needs to be compensated for by using smaller load step sizes. By virtue of the fact that no (Newton) iterations are performed within a single time step, this staggered approach is, however, considerably faster per load step than the Newton procedure.
                        Algorithm 2
                        Staggered path-following procedure.
                              
                                 
                                    
                                    
                                       
                                          
                                             Input: (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      0
                                                   
                                                
                                             ), 
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      0
                                                   
                                                
                                              
                                             # State vector, load level & history field
                                          
                                       
                                       
                                          
                                             Output: 
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             , 
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             , … , 
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            steps
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            steps
                                                         
                                                      
                                                   
                                                
                                                )
                                              
                                             # Discrete eq.
                                             
                                             path
                                          
                                       
                                       
                                          
                                             # Initialization
                                          
                                       
                                       
                                          
                                             control=‘displacement’
                                       
                                       
                                          
                                             # Load steps
                                          
                                       
                                       
                                          
                                             for 
                                             
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      steps
                                                   
                                                
                                             :
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            =
                                                            
                                                               staggered_solution_update
                                                            
                                                            (
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     k
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     k
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     H
                                                                  
                                                                  
                                                                     k
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 ∂
                                                                                 H
                                                                              
                                                                              
                                                                                 ∂
                                                                                 λ
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     |
                                                                  
                                                                  
                                                                     k
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               ,
                                                               
                                                               control
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ∂
                                                                              H
                                                                           
                                                                           
                                                                              ∂
                                                                              λ
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  |
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            =
                                                            
                                                               update_history_field
                                                            
                                                            (
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  k
                                                                  −
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            control
                                                            =
                                                            
                                                               select_control_equation
                                                            
                                                            (
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             end
                                          
                                       
                                    
                                 
                              
                           
                        

The staggered procedure developed herein is outlined in Algorithm 2. In the following sections we study the staggered_solution_update procedure. In Section 4.1 we show how the displacement-controlled staggered procedure as proposed by Miehe et al. [2] follows as a simplification of the incremental-iterative procedure in the previous section. This procedure is employed in the initial stage of loading, when fracture propagation does not yet occur. In Section 4.2 the staggered fracture-controlled path-following procedure is derived as a simplification of the monolithic fracture-controlled procedure outlined in the previous section.

Note that in Algorithm 2 the sensitivity of the history field with respect to the load parameter is evaluated along with the history field itself at the end of each load step. Evaluation of this sensitivity is required at the end of step k for the staggered fracture-controlled procedure and is given by
                        
                           (16)
                           
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             H
                                          
                                          
                                             ∂
                                             λ
                                          
                                       
                                    
                                    |
                                 
                                 
                                    k
                                 
                              
                              =
                              {
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               
                                                                  ψ
                                                               
                                                               
                                                                  e
                                                               
                                                               
                                                                  +
                                                               
                                                            
                                                         
                                                         
                                                            ∂
                                                            ε
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                k
                                             
                                          
                                          :
                                          
                                             
                                                ε
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                ψ
                                             
                                             
                                                e
                                             
                                             
                                                +
                                             
                                          
                                          (
                                          
                                             
                                                ε
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          ≥
                                          
                                             
                                                H
                                             
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          otherwise
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              ε
                           
                           
                              ^
                           
                        
                        =
                        
                           
                              ∇
                           
                           
                              s
                           
                        
                        (
                        
                           
                              
                                 ∑
                              
                              
                                 I
                                 =
                                 1
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       u
                                    
                                 
                              
                           
                           
                              
                                 N
                              
                              
                                 I
                              
                              
                                 u
                              
                           
                           (
                           x
                           )
                           
                              
                                 ∂
                                 
                                    
                                       a
                                    
                                    
                                       I
                                    
                                    
                                       u
                                    
                                 
                              
                              
                                 ∂
                                 λ
                              
                           
                        
                        )
                      is the strain field sensitivity to the load level λ, with:
                        
                           (17)
                           
                              K
                              
                                 
                                    ∂
                                    a
                                 
                                 
                                    ∂
                                    λ
                                 
                              
                              =
                              0
                              
                              and
                              
                              constraint
                              
                              
                                 
                                    ∂
                                    a
                                 
                                 
                                    ∂
                                    λ
                                 
                              
                              =
                              C
                              
                                 
                                    ∂
                                    
                                       
                                          a
                                       
                                       
                                          f
                                       
                                    
                                 
                                 
                                    ∂
                                    λ
                                 
                              
                              +
                              
                                 
                                    a
                                 
                                 
                                    ^
                                 
                              
                              .
                           
                        
                     In order to simplify notation, in the following sections we drop the superscript k indicating the load step. Instead, the initial state for a given load step is indicated by a subscript 0 (following the notation for the Newton–Raphson initial estimate) and the updated state is represented without sub- or superscripts, i.e. 
                     
                        a
                        =
                        
                           
                              a
                           
                           
                              0
                           
                        
                        +
                        Δ
                        a
                      and 
                        λ
                        =
                        
                           
                              λ
                           
                           
                              0
                           
                        
                        +
                        Δ
                        λ
                     .

A displacement-controlled simulation can be cast into the form of a path-following procedure by using the control equation 
                           ζ
                           =
                           Δ
                           λ
                           −
                           
                              
                                 λ
                              
                              
                                 ̇
                              
                           
                           Δ
                           τ
                         (and 
                           
                              
                                 a
                              
                              
                                 p
                              
                           
                           =
                           λ
                           
                              
                                 a
                              
                              
                                 ^
                              
                           
                        ), from which it follows that 
                           h
                           =
                           0
                         and q=1. The monolithic augmented system of equations (13) for the Newton–Raphson iterations is then given by
                           
                              (18)
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   uu
                                                
                                             
                                          
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   u
                                                   d
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   d
                                                   u
                                                
                                             
                                          
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   dd
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ]
                                 (
                                 
                                    
                                       
                                          
                                             δ
                                             
                                                
                                                   a
                                                
                                                
                                                   u
                                                
                                             
                                          
                                       
                                       
                                          
                                             δ
                                             
                                                
                                                   a
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                       
                                          
                                             δ
                                             λ
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   f
                                                
                                                
                                                   int
                                                
                                                
                                                   u
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   f
                                                
                                                
                                                   int
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ̇
                                                
                                             
                                             Δ
                                             τ
                                          
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        with the constraints 
                           δ
                           
                              
                                 a
                              
                              
                                 u
                              
                           
                           =
                           
                              
                                 C
                              
                              
                                 u
                              
                           
                           δ
                           
                              
                                 a
                              
                              
                                 f
                              
                              
                                 u
                              
                           
                           +
                           δ
                           λ
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 u
                              
                           
                         and 
                           δ
                           
                              
                                 a
                              
                              
                                 d
                              
                           
                           =
                           
                              
                                 C
                              
                              
                                 d
                              
                           
                           δ
                           
                              
                                 a
                              
                              
                                 f
                              
                              
                                 d
                              
                           
                        , where the constraints matrix 
                           C
                         has been decomposed in a displacement part 
                           
                              
                                 C
                              
                              
                                 u
                              
                           
                         and a phase-field part 
                           
                              
                                 C
                              
                              
                                 d
                              
                           
                        .

The system (18) can serve as the starting point for the derivation of a displacement-controlled staggered procedure. To this end, the updates after a single iteration are accepted as the solution increments, i.e. 
                        
                           Δ
                           a
                           =
                           δ
                           a
                         and 
                           Δ
                           λ
                           =
                           δ
                           λ
                        . An approximate solution to the system is then obtained in three steps. In Step 1 the phase-field sub-problem is solved with the load level, displacement field and history field resulting from the previous load step. In Step 2 the load level is updated, and finally in Step 3 the displacement sub-problem is solved with the phase field as computed in Step 1 and the load level as determined in Step 2. These three sub-problems can be written in total form as:
                           
                              (19a)
                              
                                 
                                    
                                       K
                                    
                                    
                                       dd
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 
                                    
                                       a
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       int
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       dd
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                    
                                       d
                                    
                                 
                                 
                                 
                                    
                                       a
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       f
                                    
                                    
                                       d
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       p
                                    
                                    
                                       d
                                    
                                 
                              
                           
                        
                        
                           
                              (19b)
                              
                                 λ
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       ̇
                                    
                                 
                                 Δ
                                 τ
                              
                           
                        
                        
                           
                              (19c)
                              
                                 
                                    
                                       K
                                    
                                    
                                       uu
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 
                                    
                                       a
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       int
                                    
                                    
                                       u
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       uu
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                    
                                       u
                                    
                                 
                                 
                                 
                                    
                                       a
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       u
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       f
                                    
                                    
                                       u
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       p
                                    
                                    
                                       u
                                    
                                 
                                 +
                                 λ
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       u
                                    
                                 
                              
                           
                        Further simplification using
                           
                              (20)
                              
                                 
                                    
                                       f
                                    
                                    
                                       int
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 0
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       int
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       dd
                                    
                                 
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 −
                                 2
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       d
                                    
                                 
                                 
                                 dV
                              
                           
                        and 
                           
                              
                                 f
                              
                              
                                 int
                              
                              
                                 u
                              
                           
                           (
                           
                              
                                 a
                              
                              
                                 0
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 d
                              
                           
                           )
                           =
                           
                              
                                 K
                              
                              
                                 uu
                              
                           
                           (
                           
                              
                                 a
                              
                              
                                 0
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 d
                              
                           
                           )
                           
                              
                                 a
                              
                              
                                 0
                              
                              
                                 u
                              
                           
                         finally results in the control==‘displacement’ conditional block in the staggered_solution_update function shown in Algorithm 3. We note that this algorithm is equivalent to the staggered algorithm presented in Ref. [2].

Using the fracture control equation (9), the monolithic augmented system of equations (13) for the Newton–Raphson iterations can be written as
                           
                              (21)
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   uu
                                                
                                             
                                          
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   u
                                                   d
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   d
                                                   u
                                                
                                             
                                          
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   dd
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ]
                                 (
                                 
                                    
                                       
                                          
                                             δ
                                             
                                                
                                                   a
                                                
                                                
                                                   f
                                                
                                                
                                                   u
                                                
                                             
                                          
                                       
                                       
                                          
                                             δ
                                             
                                                
                                                   a
                                                
                                                
                                                   f
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                       
                                          
                                             δ
                                             λ
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   f
                                                
                                                
                                                   int
                                                
                                                
                                                   u
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   f
                                                
                                                
                                                   int
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                             Δ
                                             τ
                                          
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        with the constraints 
                           δ
                           
                              
                                 a
                              
                              
                                 u
                              
                           
                           =
                           
                              
                                 C
                              
                              
                                 u
                              
                           
                           δ
                           
                              
                                 a
                              
                              
                                 f
                              
                              
                                 u
                              
                           
                           +
                           δ
                           λ
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 u
                              
                           
                         and 
                           δ
                           
                              
                                 a
                              
                              
                                 d
                              
                           
                           =
                           
                              
                                 C
                              
                              
                                 d
                              
                           
                           δ
                           
                              
                                 a
                              
                              
                                 f
                              
                              
                                 d
                              
                           
                        , and with 
                           
                              
                                 h
                              
                              
                                 d
                              
                           
                         as defined in Eq. (10).

Following the same procedure as for the case of staggered displacement control, the updates of the state vector and load level after a single Newton–Raphson iteration are accepted as the solution increments, i.e. 
                        
                           Δ
                           a
                           =
                           δ
                           a
                         and 
                           Δ
                           λ
                           =
                           δ
                           λ
                        . In contrast to the case of displacement control discussed in the previous section, in this case there is no natural decoupling of the phase-field and the load level. An approximate solution to the system (21) is therefore obtained in only two steps. In Step 1 the combined phase field and load level system is solved, with the displacement field and history field following from the previous load step. In Step 2 the displacement sub-problem is solved with the phase field and load level as computed in Step 1. In total form, this results in the following sub-problems:
                           
                              (22a)
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   dd
                                                
                                             
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      d
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               H
                                                            
                                                            
                                                               ∂
                                                               λ
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                             0
                                          
                                       
                                    
                                 
                                 ]
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                       
                                          
                                             λ
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   f
                                                
                                                
                                                   int
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             0
                                             ,
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      d
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               H
                                                            
                                                            
                                                               ∂
                                                               λ
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                             (
                                             τ
                                             −
                                             
                                                
                                                   τ
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   h
                                                
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   0
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (22b)
                              
                                 
                                    
                                       K
                                    
                                    
                                       uu
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       int
                                    
                                    
                                       u
                                    
                                 
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       uu
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                    
                                       u
                                    
                                 
                              
                           
                        with 
                           
                              
                                 a
                              
                              
                                 d
                              
                           
                           =
                           
                              
                                 C
                              
                              
                                 d
                              
                           
                           
                              
                                 a
                              
                              
                                 f
                              
                              
                                 d
                              
                           
                           +
                           
                              
                                 a
                              
                              
                                 p
                              
                              
                                 d
                              
                           
                         and 
                           
                              
                                 a
                              
                              
                                 u
                              
                           
                           =
                           
                              
                                 C
                              
                              
                                 u
                              
                           
                           
                              
                                 a
                              
                              
                                 f
                              
                              
                                 u
                              
                           
                           +
                           
                              
                                 a
                              
                              
                                 p
                              
                              
                                 u
                              
                           
                           +
                           λ
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 u
                              
                           
                         and where the unit driving force is defined as
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 
                                    
                                       
                                          a
                                       
                                       
                                          0
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   H
                                                
                                                
                                                   ∂
                                                   λ
                                                
                                             
                                          
                                          |
                                       
                                       
                                          0
                                       
                                    
                                 
                                 )
                                 =
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       d
                                       u
                                    
                                 
                                 (
                                 
                                    
                                       
                                          a
                                       
                                       
                                          0
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   H
                                                
                                                
                                                   ∂
                                                   ε
                                                
                                             
                                          
                                          |
                                       
                                       
                                          0
                                       
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 2
                                 (
                                 1
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 
                                    
                                       N
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          ^
                                       
                                    
                                    :
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   H
                                                
                                                
                                                   ∂
                                                   ε
                                                
                                             
                                          
                                          |
                                       
                                       
                                          0
                                       
                                    
                                 
                                 )
                                 
                                 d
                                 V
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 2
                                 (
                                 1
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 
                                    
                                       N
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                H
                                             
                                             
                                                ∂
                                                λ
                                             
                                          
                                       
                                       |
                                    
                                    
                                       0
                                    
                                 
                                 
                                 d
                                 V
                                 .
                              
                           
                        Using the fact that 
                           
                              
                                 h
                              
                              
                                 
                                    
                                       d
                                    
                                    
                                       T
                                    
                                 
                              
                           
                           
                              
                                 a
                              
                              
                                 0
                              
                              
                                 d
                              
                           
                           =
                           2
                           
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 
                                    
                                       l
                                    
                                    
                                       c
                                    
                                 
                              
                           
                           
                              
                                 τ
                              
                              
                                 0
                              
                           
                         this results in the control==‘fracture’ conditional block in the procedure shown in Algorithm 3. The augmented system of equations (22a) is solved using the Sherman–Morrison procedure. 
                           Algorithm 3
                           Staggered solution update procedure.
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

In this section the performance of the numerical algorithms outlined in the previous sections is studied. We will investigate the proposed numerical algorithms using two standard benchmark simulations: the single edge notched tension test (Section 5.1) and the single edge notched pure shear test (Section 5.2). Moreover, we will study the performance of the monolithic and staggered schemes for a tension test with multiple pre-existing fractures (Section 5.3). In contrast to the two benchmark tests, this simulation demonstrates the performance of the algorithms in the case of fracture interactions.

For all simulations we assume plane strain conditions. The first Lamé parameter is taken as 
                        λ
                        =
                        121.15
                        
                        kN
                        /
                        
                           
                              mm
                           
                           
                              2
                           
                        
                     , while the second Lamé parameter (or shear modulus) is 
                        μ
                        =
                        80.77
                        
                        kN
                        /
                        
                           
                              mm
                           
                           
                              2
                           
                        
                     . The critical energy release rate equals 
                        
                           
                              G
                           
                           
                              c
                           
                        
                        =
                        2.7
                        ·
                        
                           
                              10
                           
                           
                              −
                              3
                           
                        
                        
                        kN
                        /
                        mm
                     .

We consider a two-dimensional square specimen of size 
                           1
                           ×
                           1
                           
                           
                              
                                 mm
                              
                              
                                 2
                              
                           
                         with a horizontal notch starting at the left boundary and ending in the middle of the specimen (Fig. 2
                        a). The bottom boundary is constrained in the vertical direction and is free to move in the horizontal direction. In order to eliminate rigid body motions, the bottom-left corner point is also constrained in horizontal direction. The top boundary is stretched in vertical direction, and free to move horizontally. For all simulations in this section the phase-field length scale is taken as 
                           
                              
                                 l
                              
                              
                                 c
                              
                           
                           =
                           0.015
                           
                           mm
                        . Linear triangular meshes for both the displacement field and phase field have been used, with local mesh refinement along the anticipated crack path. The number of elements for the various meshes is reported in Fig. 2b, where h is the characteristic element size in the refinement region.

Below we will study the performance of three solution algorithms for this test case: the displacement-controlled staggered scheme as employed in e.g. Ref. [2], the fracture-controlled Newton–Raphson scheme as outlined in Section 3, and the fracture-controlled staggered scheme proposed in Section 4.

In this subsection we consider the solution obtained by the displacement-based staggered solution procedure as proposed by Miehe et al. [2]. The motivation for considering this solution procedure is to study the dependence of the solution on the selected displacement increment size and to enable direct comparison with fracture-controlled schemes. This study provides insight in the performance of staggered solution procedures compared to the monolithic scheme considered in this work.

In Fig. 3
                            we study the influence of the mesh size by consideration of meshes with characteristic element sizes of 
                              h
                              =
                              
                                 
                                    l
                                 
                                 
                                    c
                                 
                              
                              /
                              2
                           , 
                              
                                 
                                    l
                                 
                                 
                                    c
                                 
                              
                              /
                              4
                           , 
                              
                                 
                                    l
                                 
                                 
                                    c
                                 
                              
                              /
                              6
                            and 
                              
                                 
                                    l
                                 
                                 
                                    c
                                 
                              
                              /
                              8
                            in the region where the crack is anticipated to propagate. For all simulations a relatively large step size of 
                              Δ
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                              ·
                              
                                 
                                    10
                                 
                                 
                                    −
                                    5
                                 
                              
                              
                              mm
                            is used. Figures 3a and 3b depict the dependence of the response on the selected mesh size. As observed, the measured response converges upon mesh refinement. Based on these observations, in the remainder of this section we will employ a fixed mesh size with a characteristic element size of 
                              h
                              =
                              
                                 
                                    l
                                 
                                 
                                    c
                                 
                              
                              /
                              6
                            in the refinement region.

In Fig. 4
                            we study the dependence of the response on the selected step size, 
                              Δ
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                           . From the force–displacement curves we observe that the overall dissipation is overestimated when using too large step sizes. On one hand this is explained by the fact that a too large step size delays the instance of propagation, i.e. the phase field reaches a value of 1 at a later moment than for a smaller step size (Fig. 4c). On the other hand we observe that the overall crack length is considerably overestimated for too large step sizes (Fig. 4b). In Fig. 5
                            we illustrate the primary reason for this overestimation by considering the phase field at 
                              
                                 
                                    Γ
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          c
                                       
                                    
                                 
                              
                              ≈
                              0.4
                              
                              mm
                            for step sizes of 
                              Δ
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              4
                              ·
                              
                                 
                                    10
                                 
                                 
                                    −
                                    5
                                 
                              
                              
                              mm
                            and 
                              Δ
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              0.5
                              ·
                              
                                 
                                    10
                                 
                                 
                                    −
                                    5
                                 
                              
                              
                              mm
                           . As can be seen, the delay in the update of the phase field due to the use of the staggered solution procedure causes the crack to widen, and hence the total fracture length (
                              
                                 
                                    Γ
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          c
                                       
                                    
                                 
                              
                            at 
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              0.009
                              
                              mm
                           ) to be overestimated. In Table 1
                            we report the computed peak force values (
                              
                                 
                                    F
                                 
                                 
                                    peak
                                 
                              
                           ) and its corresponding displacement (
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    n
                                    ,
                                    peak
                                 
                              
                           ), as well as the crack length at 
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              0.009
                              
                              mm
                            (
                              
                                 
                                    Γ
                                 
                                 
                                    ult
                                 
                              
                           ). From the results in Table 1 it can be inferred that all reported quantities converge linearly under step size refinement.

Evidently, using uniform step sizes is not optimal in terms of computational effort versus step size error. For example, relatively large step sizes can be used in the elastic regime. As we will see in Section 5.1.3, the fracture-based scheme provides a natural adaptive refinement strategy.

In this section we study the monolithic fracture-controlled scheme (Algorithm 1) with and without adaptive crack size increments. As outlined in Section 3.3.3, we use displacement control to initiate the solution procedure. In this case 
                              Δ
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                              ·
                              
                                 
                                    10
                                 
                                 
                                    −
                                    4
                                 
                              
                              
                              mm
                            is used. When the crack length increment exceeds 
                              Δ
                              
                                 
                                    Γ
                                 
                                 
                                    switch
                                 
                              
                              =
                              1
                              ·
                              
                                 
                                    10
                                 
                                 
                                    −
                                    5
                                 
                              
                              
                              mm
                           , the switch is made to fracture control. This choice for 
                              Δ
                              
                                 
                                    Γ
                                 
                                 
                                    switch
                                 
                              
                            is based on the fact that it should be considerably larger than the machine precision, and considerably smaller than the representative element size h, since the switch to fracture control should be made well before the fracture starts to propagate. The obtained solution was observed to be insensitive to variations in this switching value.

In Fig. 6
                           a we show the force–displacement curves for the case in which the fracture surface increment 
                              Δ
                              Γ
                            is kept fixed. We observe that for all simulations the Newton–Raphson procedure with a tolerance of 
                              1
                              ×
                              
                                 
                                    10
                                 
                                 
                                    −
                                    5
                                 
                              
                            fails to converge at some point in the incrementation process after softening and/or snapback has occurred. This is caused by the fact that the initial estimate for the Newton procedure is outside the radius of convergence of the Newton procedure. In line with this is the observation that decreasing the step size increases – albeit moderately – the extend to which the equilibrium path can be computed. A notable difference between these monolithic results and the staggered results presented above is that the errors due to the staggered steps are completely eliminated, i.e. virtually the same result is obtained independent of the selected crack length increment.

In order to track the complete equilibrium path we have employed the adaptive scheme as discussed in Section 3.3.3 with 
                              
                                 
                                    m
                                 
                                 
                                    targ
                                 
                              
                              =
                              4
                           . The results are presented in Fig. 6b. With this adaptive step size increment, the same equilibrium path is recovered regardless of the maximum allowable increment. In fact, the maximum step size increment is ineffective as a result of the limitation imposed by the target number of Newton iterations. We observe that the monolithic solution procedure is very effective in capturing the peak load. The computed value of 
                              
                                 
                                    F
                                 
                                 
                                    peak
                                 
                              
                              =
                              715.26
                              
                              N
                            is free of the step size errors introduced by the staggered procedure in Section 5.1.1, and can be obtained in relatively few steps. In addition, the fracture-controlled Newton scheme is capable of tracking the snap-back part of the equilibrium path.

The origin of this snap-back behavior is that at the crack tip a phase field needs to nucleate. In the case that we enrich the tip of the pre-existing fracture with a phase field (see Appendix Appendix C) – thereby regularizing the stress field around the tip – this snap-back feature vanishes (Fig. 7
                           ).

As for the monolithic scheme discussed above, for the fracture-controlled staggered scheme we use an initial displacement step size of 
                              Δ
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                              ·
                              
                                 
                                    10
                                 
                                 
                                    −
                                    4
                                 
                              
                              
                              mm
                            and switch to the fracture-controlled scheme when the crack length increment exceeds 
                              Δ
                              
                                 
                                    Γ
                                 
                                 
                                    switch
                                 
                              
                              =
                              1
                              ·
                              
                                 
                                    10
                                 
                                 
                                    −
                                    5
                                 
                              
                              
                              mm
                           . In Fig. 8
                            the results are shown for various crack length increments, and some solution characteristics are collected in Table 2
                           .

It is observed that as for the displacement-controlled staggered solution procedure, an error is introduced by this staggered scheme. For the quantities in Table 2 this error is observed to decrease at least linearly with the selected step size. Compared to the displacement-based scheme, the fracture-controlled staggered scheme has two advantages. First, under step-size refinement it converges to the Newton–Raphson solution, including snap-back behavior. Such convergence is not observed for the displacement-based staggered scheme of Section 5.1.1. A second advantage is that the step size for the fracture controlled simulation can be selected conveniently by relating it to the representative element size (h). This permits us to allow for the gradual motion of a crack through the mesh, i.e. the crack is not permitted to propagate through multiple elements in a single step when 
                              Δ
                              Γ
                            is limited by the element size. As indicated above, the fracture-controlled procedure serves as an automatic displacement step size adjuster. This is shown in Fig. 9
                            where the displacement step size is plotted versus the step size number. As can be seen, the staggered scheme automatically accounts for a smaller (or even negative) displacement increment when crack propagation occurs.

In Table 2 we also compare the monolithic scheme with adaptive step size with the staggered scheme for various step sizes. We observe that the monolithic scheme on average has a step size, 
                              Δ
                              Γ
                           , comparable to the staggered scheme with 
                              Δ
                              Γ
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              h
                           . Also the number of steps to track the shown equilibrium path is similar (488 for the monolithic scheme vs. 529 for the staggered scheme), but evidently the number of linear system solves for the monolithic scheme is considerably higher (1210 for the monolithic scheme vs. 529 for the staggered scheme) and in addition each system solve in the monolithic scheme is computationally more expensive. The error related to the staggered procedure remains limited to a few percent for both the peak load and the overall crack length. When comparing with the displacement-controlled staggered scheme with 
                              Δ
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              2
                              ·
                              
                                 
                                    10
                                 
                                 
                                    −
                                    5
                                 
                              
                              
                              mm
                            (Table 1), for which a similar number of system solves is required (500), we observe that the fracture-controlled staggered scheme provides a better approximation of the peak load and total crack length than the displacement-controlled scheme. For the peak load the obtained improvement is moderate, and can be attributed to the fact that the fracture-controlled scheme automatically provides displacement step size adjustments. A significant improvement is obtained for the total crack length, which is a consequence of the fact that the displacement-controlled scheme fails to account for the snap-back behavior. For the staggered scheme with 
                              Δ
                              Γ
                              =
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              h
                            a similar number of system solves is required as for the monolithic scheme. In this case errors of less than 2% in the peak load and crack length are obtained.

In this section we investigate the setup represented in Fig. 10
                        a. The geometry is identical to that considered for the tension simulation discussed above, but pure shear boundary conditions are used. This means that the vertical displacement component is constrained on all four sides of the domain. Moreover, the bottom boundary is constrained horizontally, and a prescribed horizontal displacement, 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 s
                              
                           
                        , is applied to the top boundary. The same material parameters are used as for the tension simulation. The fracture length scale is equal to 
                           
                              
                                 l
                              
                              
                                 c
                              
                           
                           =
                           0.015
                           
                           mm
                        . In order to accurately capture the phase-field evolution, the mesh is refined along the anticipated crack path (Fig. 10b). The characteristic element size in this refinement region is 
                           h
                           =
                           
                              
                                 l
                              
                              
                                 c
                              
                           
                           /
                           4
                           =
                           0.00375
                           
                           mm
                        , which results in a mesh with 26472 elements.

In Fig. 11
                         we study the convergence of the displacement-based staggered solution procedure under step size refinement. We observe very close agreement with the results reported in literature [2]. Using the fracture-controlled Newton–Raphson procedure with adaptive step size and 
                           Δ
                           
                              
                                 Γ
                              
                              
                                 max
                              
                           
                           =
                           2
                           h
                         (Fig. 12
                        ) we observe that the bump in the force–displacement curve at crack nucleation is related to the occurrence of snap-back, a phenomenon not captured by the displacement-based staggered scheme. By comparison with the results with phase-field tip enrichment, we observe that this snap-back behavior is closely related to the nucleation of the phase-field fracture at the tip of the pre-existing fracture.

In Fig. 13
                         we study the influence of the crack-length increment size for the fracture-controlled staggered solution procedure. This figure conveys that the staggered procedure converges to the monolithic result as the step size decreases. In Table 3
                         we compare the monolithic and staggered scheme for various quantities of interest. The total crack length 
                           
                              
                                 Γ
                              
                              
                                 ult
                              
                           
                         is measured at 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 s
                              
                           
                           =
                           0.016
                           
                           mm
                        . The peak load and total crack length are observed to converge at least at a linear rate. As for the tensile test we observe that the crack path is predicted appropriately by the staggered scheme for relatively large step sizes. For 
                           Δ
                           Γ
                           =
                           h
                           /
                           2
                         we observe errors of a few percent, while the involved number of system solves is considerably smaller than for the monolithic scheme.

We finally study the performance of the fracture-based path-following schemes for a test case with complex fracture surface evolution. To this end we consider a 
                           1
                           ×
                           1
                           
                           
                              
                                 mm
                              
                              
                                 2
                              
                           
                         tensile test with six, randomly distributed, pre-existing cracks (Fig. 14
                        ). The discretized displacement field is discontinuous over the pre-existing cracks, which is established by aligning the elements of the bulk material with the pre-existing cracks and duplicating the nodes on the cracks. An irregular triangular finite element mesh with 28826 equal-sized linear elements and 14700 nodes is used to discretize the bulk material. The element length along the boundaries and pre-existing cracks is 
                           h
                           =
                           0.01
                           
                           mm
                        . The same material parameters as for the test cases discussed above have been used. The crack length scale is equal to 
                           
                              
                                 l
                              
                              
                                 c
                              
                           
                           =
                           0.025
                           
                           mm
                        .

In Fig. 15
                         we show the solutions obtained by the monolithic scheme, with and without tip enrichment. As for the above experiments we observe overshoots in the response curve in the case that the pre-existing tips are not regularized by a phase field. This effect is here more pronounced due to the fact that the elements around the tips are relatively coarse (the same element size is used throughout the complete domain). Evidently, due to the iteration-based step size adjustment strategy, the monolithic scheme is capable of tracking the snap-back paths.

In Fig. 16
                         we show six snapshots of the fracture evolution pattern. The labels (a)–(f) are reflected in the force–displacement diagram in Fig. 15b. Initially, the specimen is loaded elastically (a), until pre-existing crack 2 propagates toward the right edge of the specimen (b). When this happens, the specimen unloads, after which a secondary crack propagates from the bottom tip of pre-existing crack 2 (c) and merges with pre-existing crack 1 (d). After another unloading stage, finally pre-existing crack 1 propagates toward the left edge of the specimen (e) until it reaches the left edge and the specimen lost all its load-carrying capacity (f).

In Fig. 17
                         we show the force–displacement curves computed using the staggered path-following scheme with 
                           Δ
                           Γ
                           =
                           h
                        , 
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 h
                              
                              
                                 4
                              
                           
                        . We observe that already with a step size of h, the correct fracture pattern is predicted. The effect that the energy dissipation is increased is also observed here. As the step size decreases, the force–displacement curve converges toward the Newton–Raphson case. It is important to note here that since the fractures evolve in stages, during the fracture process there is always one dominant fracture. This allows for the interpretation that the crack extends by approximately a single element in the case that 
                           Δ
                           Γ
                           =
                           h
                         is used. In the case that the evolution of a secondary crack is non-negligible, effectively a smaller crack incrementation length (per crack) is used. In this sense, the choice of the crack length increment is a conservative choice, which permits its usage also in the case of complex fracture evolutions as considered here.

In Table 4
                         the monolithic scheme and staggered schemes with various fracture surface increments are compared in terms of the predicted fracture strength and total crack length. For all simulations regularized pre-existing crack tips are considered. We observe errors of a few percent for the staggered scheme with a step size of 
                           h
                           /
                           4
                        , which is in agreement with the observations of the benchmark simulations discussed above. In terms of the number of system solves, this staggered simulation requires approximately half the number of solves of the monolithic scheme.

@&#CONCLUSIONS@&#

In this contribution we studied the application of a fracture-based path-following constraint for the simulation of phase-field cracks. The employed constraint is closely related to the dissipation-based constraint proposed in [16], but is formulated in terms of the phase field instead of stresses and strains (and rates thereof). Formulation of this constraint in terms of the phase field invokes a natural decomposition of the phase-field problem and the elasticity problem. Based on this decomposition, we developed a fracture-controlled staggered solution procedure. The derivation of this staggered procedure proceeds in essentially the same manner as the derivation of the commonly used displacement-based staggered scheme [2] from a displacement-controlled monolithic solution procedure.

There are two advantages to the use of a fracture-controlled path-following constraint. First, this constraint permits for the simulation of snap-back phenomena. In the studied numerical examples we have observed that snap-back is typically encountered when a phase-field crack nucleates from a sharp crack tip. By enriching the tips of pre-existing fractures with a phase field, this snap-back behavior vanishes. The fracture-controlled constraint opens the doors to a systematic study of this snap-back behavior, but this study is considered beyond the scope of this manuscript. The second advantage of fracture-control is that it provides a natural way to select the step size increments, this in contrast to the displacement-controlled staggered procedure. By requiring that the cracks propagate gradually through the mesh, the step size can be related to the characteristic element size. We have demonstrated that also in the case of multiple cracks this way of selecting the fracture step sizes renders meaningful results.

We have studied the performance of the fracture-controlled monolithic and staggered solution procedures. Evidently, an advantage of the monolithic scheme is that in every step the non-linear system to compute the solution updates is solved exactly (up to the precision of the Newton–Raphson process). In contrast, the fracture-based staggered scheme introduces an additional source of errors by not resolving the non-linearities in every step. The advantage of the staggered scheme is, however, that it is computationally cheaper per load step by virtue of the fact that only a single decoupled elasticity problem and phase-field problem is solved. In the studied numerical examples we have found that the staggered scheme is capable of computing typical quantities of interest such as the peak load and total crack length with errors of a few percent when step sizes of half the representative element length scale are used. Overall it can be concluded that when a high accuracy is required, the monolithic scheme is preferred. When minor inaccuracies are acceptable, the staggered procedure can be expected to outperform the monolithic scheme in terms of computational effort.

We note that herein we have considered a staggered solution procedure with a single iteration per load step. It is possible to improve the accuracy of this staggered procedure by using multiple sub-iterations per load step. This will provide the opportunity to make a trade-off between computational effort and solution accuracy. A detailed study of a staggered solution procedure with sub-iterations is a topic of further study.

@&#ACKNOWLEDGMENTS@&#

This work is part of the Industrial Partnership Programme (IPP) ‘Computational sciences for energy research’ of the Foundation for Fundamental Research on Matter (FOM), which is part of the Netherlands Organisation for Scientific Research (NWO). This research programme is co-financed by Shell Global Solutions International B.V. The research of C.V. Verhoosel was funded by the NWO under the VENI scheme. All simulations in this work were performed using the open source software package Nutils (www.nutils.org).

For the phase-field fracture formulation introduced in Section 2 the internal and external force vectors follow directly from substitution of the finite element basis function (5) as test functions in the weak form problem (4). For the momentum equation, this yields:
                        
                           (A.1a)
                           
                              
                                 
                                    f
                                 
                                 
                                    int
                                    ,
                                    I
                                 
                                 
                                    u
                                 
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              σ
                              :
                              
                                 
                                    ∇
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    I
                                 
                                 
                                    u
                                 
                              
                              
                              dV
                              
                              I
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    u
                                 
                              
                           
                        
                     
                     
                        
                           (A.1b)
                           
                              
                                 
                                    f
                                 
                                 
                                    ext
                                    ,
                                    I
                                 
                                 
                                    u
                                 
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          Γ
                                       
                                       
                                          N
                                       
                                    
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                              ·
                              
                                 
                                    N
                                 
                                 
                                    I
                                 
                                 
                                    u
                                 
                              
                              
                              dS
                              
                              I
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    u
                                 
                              
                           
                        
                     For the phase-field equation the following discrete equations are obtained:
                        
                           (A.2a)
                           
                              
                                 
                                    f
                                 
                                 
                                    int
                                    ,
                                    I
                                 
                                 
                                    d
                                 
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              [
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                c
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                c
                                             
                                          
                                       
                                    
                                    +
                                    2
                                    H
                                 
                                 )
                                 d
                                 −
                                 2
                                 H
                              
                              ]
                              
                                 
                                    N
                                 
                                 
                                    I
                                 
                                 
                                    d
                                 
                              
                              +
                              
                                 
                                    G
                                 
                                 
                                    c
                                 
                              
                              
                                 
                                    l
                                 
                                 
                                    c
                                 
                              
                              ∇
                              d
                              ·
                              ∇
                              
                                 
                                    N
                                 
                                 
                                    I
                                 
                                 
                                    d
                                 
                              
                              
                              dV
                              
                              I
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    d
                                 
                              
                           
                        
                     
                     
                        
                           (A.2b)
                           
                              
                                 
                                    f
                                 
                                 
                                    ext
                                    ,
                                    I
                                 
                                 
                                    d
                                 
                              
                              =
                              0
                              
                              I
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    d
                                 
                              
                           
                        
                     The corresponding tangent stiffness matrices follow by differentiation of these forces with respect to the nodal solution vectors as:
                        
                           (A.3a)
                           
                              
                                 
                                    K
                                 
                                 
                                    IJ
                                 
                                 
                                    uu
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          int
                                          ,
                                          I
                                       
                                       
                                          u
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          a
                                       
                                       
                                          J
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              
                                 
                                    ∇
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    I
                                 
                                 
                                    u
                                 
                              
                              :
                              C
                              :
                              
                                 
                                    ∇
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    J
                                 
                                 
                                    u
                                 
                              
                              
                              dV
                           
                        
                     
                     
                        
                           (A.3b)
                           
                              
                                 
                                    K
                                 
                                 
                                    IJ
                                 
                                 
                                    u
                                    d
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          int
                                          ,
                                          I
                                       
                                       
                                          u
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          a
                                       
                                       
                                          J
                                       
                                       
                                          d
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              2
                              (
                              d
                              −
                              1
                              )
                              
                                 
                                    N
                                 
                                 
                                    J
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    
                                       ∇
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       I
                                    
                                    
                                       u
                                    
                                 
                                 :
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                    
                                       +
                                    
                                 
                              
                              )
                              
                              dV
                           
                        
                     
                     
                        
                           (A.3c)
                           
                              
                                 
                                    K
                                 
                                 
                                    IJ
                                 
                                 
                                    d
                                    u
                                 
                              
                              =
                              
                                 
                                    ∂
                                    
                                       
                                          f
                                       
                                       
                                          int
                                          ,
                                          I
                                       
                                       
                                          d
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          a
                                       
                                       
                                          J
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              2
                              (
                              d
                              −
                              1
                              )
                              
                                 
                                    N
                                 
                                 
                                    I
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    
                                       ∇
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       J
                                    
                                    
                                       u
                                    
                                 
                                 :
                                 
                                    
                                       ∂
                                       H
                                    
                                    
                                       ∂
                                       ε
                                    
                                 
                              
                              )
                              
                              dV
                           
                        
                     
                     
                        
                           (A.3d)
                           
                              
                                 
                                    K
                                 
                                 
                                    IJ
                                 
                                 
                                    dd
                                 
                              
                              =
                              
                                 
                                    ∂
                                    
                                       
                                          f
                                       
                                       
                                          int
                                          ,
                                          I
                                       
                                       
                                          d
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          a
                                       
                                       
                                          J
                                       
                                       
                                          d
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             c
                                          
                                       
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 +
                                 2
                                 H
                              
                              )
                              
                                 
                                    N
                                 
                                 
                                    I
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    J
                                 
                                 
                                    d
                                 
                              
                              +
                              
                                 
                                    G
                                 
                                 
                                    c
                                 
                              
                              
                                 
                                    l
                                 
                                 
                                    c
                                 
                              
                              ∇
                              
                                 
                                    N
                                 
                                 
                                    I
                                 
                                 
                                    d
                                 
                              
                              ·
                              ∇
                              
                                 
                                    N
                                 
                                 
                                    J
                                 
                                 
                                    d
                                 
                              
                              
                              dV
                           
                        
                     where 
                        C
                        =
                        ∂
                        σ
                        /
                        ∂
                        ε
                      is the material tangent, and 
                        
                           
                              σ
                           
                           
                              0
                           
                           
                              +
                           
                        
                      is the tensile part of the virgin Cauchy stress tensor. Note that the tangent stiffness matrix is generally not symmetric, since
                        
                           (A.4)
                           
                              
                                 
                                    ∂
                                    H
                                 
                                 
                                    ∂
                                    ε
                                 
                              
                              =
                              {
                              
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                0
                                             
                                             
                                                +
                                             
                                          
                                       
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ̇
                                             
                                          
                                          ≥
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ̇
                                             
                                          
                                          <
                                          0
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

Since in Griffith׳s theory for fracture the rate of dissipation is defined as the fracture toughness (
                        
                           
                              G
                           
                           
                              c
                           
                        
                     ) times the rate at which new fracture surface is created, the constraint equation derived in Section 3 relies on the same assumptions as the energy release rate path-following control in [16,17]. In this appendix the relation between the path-following constraint developed in this work and the constraint of [16,17] is examined.

Assuming infinitely small path-parameter increments, 
                        Δ
                        τ
                        →
                        0
                     , the constraint equation (9) can be used to obtain
                        
                           (B.1)
                           
                              
                                 
                                    
                                       
                                          Γ
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          c
                                       
                                    
                                 
                              
                              (
                              d
                              ,
                              
                                 
                                    d
                                 
                                 
                                    ̇
                                 
                              
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          c
                                       
                                    
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              d
                              
                                 
                                    d
                                 
                                 
                                    ̇
                                 
                              
                              +
                              
                                 
                                    l
                                 
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              ∇
                              d
                              ·
                              ∇
                              
                                 
                                    d
                                 
                                 
                                    ̇
                                 
                              
                              
                              d
                              V
                              ,
                           
                        
                     which corresponds to the time derivative of the fracture surface area (8). Using the weak form (4) in combination with the Kuhn–Tucker conditions (3), this expression can be rewritten as
                        
                           (B.2)
                           
                              
                                 
                                    
                                       
                                          Γ
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          c
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    2
                                 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          c
                                       
                                    
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              (
                              1
                              −
                              d
                              )
                              H
                              
                                 
                                    d
                                 
                                 
                                    ̇
                                 
                              
                              
                              d
                              V
                              =
                              
                                 
                                    2
                                 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          c
                                       
                                    
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              (
                              1
                              −
                              d
                              )
                              
                                 
                                    ψ
                                 
                                 
                                    0
                                 
                                 
                                    +
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    ̇
                                 
                              
                              
                              d
                              V
                              =
                              −
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          c
                                       
                                    
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    ̇
                                 
                              
                              
                                 
                                    ψ
                                 
                                 
                                    0
                                 
                                 
                                    +
                                 
                              
                              
                              d
                              V
                              ,
                           
                        
                     with degradation function 
                        g
                        (
                        d
                        )
                        =
                        
                           
                              (
                              1
                              −
                              d
                              )
                           
                           
                              2
                           
                        
                     . The rate of dissipation, defined as the external power minus the rate of elastic energy, can be written as:
                        
                           (B.3)
                           
                              
                                 
                                    D
                                 
                                 
                                    ̇
                                 
                              
                              =
                              P
                              −
                              
                                 
                                    W
                                 
                                 
                                    ̇
                                 
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          Γ
                                       
                                       
                                          N
                                       
                                    
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                              ·
                              
                                 
                                    u
                                 
                                 
                                    ̇
                                 
                              
                              
                              d
                              S
                              −
                              
                                 
                                    d
                                 
                                 
                                    dt
                                 
                              
                              [
                              
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 σ
                                 :
                                 ε
                                 
                                 d
                                 V
                              
                              ]
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              [
                              
                                 σ
                                 :
                                 
                                    
                                       ε
                                    
                                    
                                       ̇
                                    
                                 
                                 −
                                 
                                    
                                       σ
                                    
                                    
                                       ̇
                                    
                                 
                                 :
                                 ε
                              
                              ]
                              
                              d
                              V
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              {
                              
                                 [
                                 
                                    C
                                    :
                                    ε
                                 
                                 ]
                                 :
                                 
                                    
                                       ε
                                    
                                    
                                       ̇
                                    
                                 
                                 −
                                 [
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ̇
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          0
                                       
                                       
                                          +
                                       
                                    
                                    :
                                    ε
                                    +
                                    C
                                    :
                                    
                                       
                                          ε
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 ]
                                 :
                                 ε
                              
                              }
                              
                              d
                              V
                              =
                              −
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    ̇
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    0
                                 
                                 
                                    +
                                 
                              
                              :
                              ε
                              
                              d
                              V
                              =
                              −
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    ̇
                                 
                              
                              
                                 
                                    ψ
                                 
                                 
                                    0
                                 
                                 
                                    +
                                 
                              
                              
                              d
                              V
                              .
                           
                        
                     Combining with equation (B.2) shows that indeed 
                        
                           
                              D
                           
                           
                              ̇
                           
                        
                        =
                        
                           
                              G
                           
                           
                              c
                           
                        
                        
                           
                              
                                 
                                    Γ
                                 
                                 
                                    ̇
                                 
                              
                           
                           
                              
                                 
                                    l
                                 
                                 
                                    c
                                 
                              
                           
                        
                     .

When simulating the fracture process in specimens with pre-existing cracks, in principle the tip-stresses will be singular when these cracks are modeled as strong discontinuities. Evidently, in a finite element context, finite stresses are obtained due to the regularizing effect of the interpolation functions. However, in principle, this regularizing effect is merely a discretization error. In relation to phase-field modeling, the tip stress does influence the value of the phase field at the tip [4], which causes a significant grid size dependence of the phase-field nucleation at the tip. In order to moderate this mesh dependence, in this work we enrich the fracture tips of pre-existing cracks with a phase field, thereby regularizing the stress field at these tips.

In order to enrich the tips of pre-existing cracks, we compute the history field prior to loading, 
                        
                           
                              H
                           
                           
                              0
                           
                        
                        :
                        Ω
                        →
                        R
                     . In order to obtain this field, we first solve the weak form problem for the phase field 
                        
                           
                              d
                           
                           
                              0
                           
                        
                        :
                        Ω
                        →
                        R
                     :
                        
                           (C.1)
                           
                              {
                              
                                 
                                    
                                       
                                          Find
                                          
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                tip
                                             
                                             
                                                d
                                             
                                          
                                          
                                          such
                                          
                                          that:
                                       
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∫
                                             
                                             
                                                Ω
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                          
                                          e
                                          +
                                          
                                             
                                                l
                                             
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          ∇
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                          ·
                                          ∇
                                          e
                                          
                                          dV
                                          =
                                          0
                                       
                                       
                                          ∀
                                          e
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                tip
                                                ,
                                                0
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     with 
                        
                           
                              V
                           
                           
                              tip
                           
                           
                              d
                           
                        
                        =
                        {
                        
                           
                              d
                           
                           
                              0
                           
                        
                        ∈
                        
                           
                              H
                           
                           
                              1
                           
                        
                        (
                        Ω
                        )
                        |
                        
                           
                              d
                           
                           
                              0
                           
                        
                        =
                        1
                        
                        on
                        
                        
                           
                              Γ
                           
                           
                              tip
                           
                        
                        }
                     , with 
                        
                           
                              Γ
                           
                           
                              tip
                           
                        
                        ⊂
                        Ω
                      the set of crack tip points. Subsequently, we determine the corresponding history field, 
                        
                           
                              H
                           
                           
                              0
                           
                        
                        :
                        Ω
                        →
                        R
                     :
                        
                           (C.2)
                           
                              {
                              
                                 
                                    
                                       
                                          Find
                                          
                                          
                                             
                                                H
                                             
                                             
                                                0
                                             
                                          
                                          ∈
                                          
                                             
                                                H
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          Ω
                                          )
                                          such
                                          
                                          that:
                                       
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∫
                                             
                                             
                                                Ω
                                             
                                          
                                          2
                                          
                                             
                                                l
                                             
                                             
                                                c
                                             
                                          
                                          (
                                          1
                                          −
                                          d
                                          )
                                          
                                             
                                                H
                                             
                                             
                                                0
                                             
                                          
                                          J
                                          
                                          dV
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                Ω
                                             
                                          
                                          
                                             
                                                G
                                             
                                             
                                                c
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   0
                                                
                                             
                                             J
                                             +
                                             
                                                
                                                   l
                                                
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             ∇
                                             
                                                
                                                   d
                                                
                                                
                                                   0
                                                
                                             
                                             ·
                                             ∇
                                             J
                                          
                                          )
                                          
                                          dV
                                       
                                       
                                          ∀
                                          J
                                          ∈
                                          
                                             
                                                H
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          Ω
                                          )
                                       
                                    
                                 
                              
                           
                        
                     For the discretization of both weak form problems we employ linear finite element spaces.

We note that an alternative approach to this tip-enrichment strategy is to model the pre-existing fractures completely by phase-field fractures. An advantage of this approach is that there is no need to create sharp discontinuities in the mesh. However, the creation of such cracks is generally non-trivial when they do not align with the finite element grid.

@&#REFERENCES@&#

