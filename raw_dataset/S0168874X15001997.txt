@&#MAIN-TITLE@&#Combination of a non-local damage model for quasi-brittle materials with a mesh-adaptive finite element technique

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Fracture of quasi-brittle materials is treated via continuum damage mechanics.


                        
                        
                           
                           Strain localization is regularized through an integral-type non-local damage model.


                        
                        
                           
                           A mesh-adaptive finite element technique has been implemented to work along with the non-local damage model.


                        
                        
                           
                           Examples in 2D are given to illustrate the presented approach.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Quasi-brittle materials

Continuum damage mechanics

Non-local damage models

Finite element method

Mesh-adaptivity

@&#ABSTRACT@&#


                  Progressive fracture in quasi-brittle materials is often treated via strain softening models in continuum damage mechanics. Such constitutive relations favour spurious strain localization and ill-posedness of boundary value problems. The introduction of non-local damage models together with a characteristic length parameter controlling the size of the fracture process zone is known to regularize the problem. In order to account for the non-locality of these models, it is crucial to work with fine spatial discretizations at the damage progress zone. In this paper we present a non-local damage model in combination with a mesh-adaptive finite element technique that can help automatize the analysis of progressive fracture problems in an efficient manner. Classical two-dimensional examples are given to illustrate the presented approach.
               

@&#INTRODUCTION@&#

The analysis of the failure of engineering materials is a subject with high interest that has been studied in the last decades from different perspectives: discrete crack models [17], extended finite element method (XFEM) [5], discrete element method (DEM) [12] or continuum damage mechanics [18]. Since this work aims at modelling the initiation of failure and not the behaviour of the material after fracturing, here the latter approach has been used because of its greater simplicity.

Continuum damage mechanics is a branch of continuum mechanics that describes the progressive loss of material integrity due to the propagation and coalescence of micro-cracks, micro-voids, and similar defects. These changes in the micro-structure lead to an irreversible material degradation, characterized by a loss of stiffness that can be observed on the macro-scale.

The term “continuum damage mechanics” was first used by Hult [18], but the concept of damage was introduced by Kachanov in 1958 in the context of creep rupture [20]. In that work Kachanov introduced the concept of effective stress, and by using continuum damage he solved problems related to creep in metals. Rabotnov [37] gave the problem physical meaning by suggesting that the reduction of the sectional area was measured by means of the damage parameter. The thermodynamic formalism involved in the irreversible process of damage was developed by Lemaitre and Chaboche [23]. Other important contributions on damage mechanics include: Mazars and Pijaudier-Cabot [27], Simo and Ju [39], Oller et al. [31], Oliver et al. [29,30], and Cervera et al. [10,9], to name but a few.

The behaviour of brittle or quasi-brittle materials such as concrete, rocks, mortar or other geo-materials is particularly difficult to predict. In those cases failure is preceded by a gradual development of a non-linear fracture process zone and a localization of strain. Realistic failure analysis of such quasi-brittle structures requires the consideration of progressive damage due to micro-cracking, modelled by a constitutive law with strain softening. This typically results in highly non-linear structural responses and so efficient non-linear solvers based on arc-length control are needed for the numerical simulations [16].

If the damage parameter depends only on the strain state at the point under consideration, and no enriched kinematics are adopted to regularize the problem, numerical simulations exhibit a pathological mesh dependence and the energy consumed by the fracture process tends to zero as the mesh is refined. This is the typical behaviour of the so-called local damage models, which are not able to properly describe both the thickness of localization and the distance between damaged zones. They suffer from mesh sensitivity (for size and alignment) and produce unreliable results. Strains concentrate in one element wide zones and the computed force-displacement curves are mesh-dependent. The reason behind these misbehaviours is that the differential equations of motion change their type (from elliptic to hyperbolic in static problems) and the boundary value problem becomes ill-posed [2].

Classical constitutive models require an extension in the form of a characteristic length to properly model the thickness of localized zones. Such extension can be done by means of second gradient models [11], micro-polar [28], strain gradient [40], viscous [24] and non-local terms [19]. In our model we have worked with the latter approach using a weighted spatial averaging of the internal variables. In this manner the kinematic and equilibrium equations remain standard, and the notions of stress and strain keep their usual meaning.

The first non-local models of this type, proposed in the 1960s, aimed at improving the description of elastic wave dispersions in crystals. Non-local elasticity was further developed by Eringen [15] who later extended it to non-local elasto-plasticity [14]. Subsequently, it was found that certain non-local formulations could act as efficient localization limiters with a regularizing effect on problems with strain localization [36].

Non-local models lead to smooth solutions with a continuous variation of strain. However, to resolve narrow bands of highly localized strains using the finite element method it is necessary to use sufficiently fine computational grids. Fortunately, the mesh must be fine only in the damage progression zone, while the remaining part of the structure can be reasonably well represented by a coarser mesh. In general, the localization pattern is not known in advance, and it is actually tedious to suitably construct refined meshes by hand. Thereby, the efficiency of the analysis can be greatly increased by means of an adaptive mesh refinement technique, which automates the whole process [34,6].

In the present work we present a robust non-local isotropic damage model for quasi-brittle materials that works in a small deformation regime, along with an adaptive-mesh finite element technique that permits adapting the spatial discretization in an optimal manner.

The paper is organized as follows. First, the basic concepts on continuum damage mechanics are introduced. Details are given on the basic components of the isotropic damage theory, and on the equivalent strain forms and damage evolution laws that have been implemented in this work.

Next, we review the regularization technique that has been used to overcome the problems associated to strain localization. The fundamental aspects of the integral-type non-local damage model derived are presented, pointing out the most relevant aspects of its numerical implementation. The method for estimating the error of the numerical solution and the mesh-adaptive scheme are explained in some detail.

Finally, two examples are presented showing that the combination of the non-local damage model and the mesh-adaptive technique is a robust method to model the failure of quasi-brittle materials.

The simplest damage model for multiaxial stress states is the isotropic damage model with a simple scalar variable. This model is based on the assumption that the stiffness degradation is isotropic, i.e., the stiffness moduli corresponding to different directions decrease proportionally, independently of the direction of loading. Since an isotropic elastic material is characterized by two independent elastic constrains, a general isotropic damage model should deal with two damage variables. The model with a single variable makes use of the additional assumption that the relative reduction of all the stiffness coefficients is the same, in other words, that the Poisson׳s ratio is not affected by damage. The stress–strain law is postulated as
                        
                           (1)
                           
                              σ
                              =
                              (
                              1
                              −
                              d
                              )
                              E
                              :
                              ε
                              =
                              (
                              1
                              −
                              d
                              )
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                        
                     where 
                        σ
                      is the total stress tensor, 
                        ε
                      is the total strain tensor, 
                        
                           
                              σ
                           
                           
                              ¯
                           
                        
                      is the effective stress tensor, 
                        E
                      is the elastic constitutive tensor of the intact material, and d is the scalar damage variable.

A very simple measure of the damage amplitude in a given plane is obtained by measuring the area of the intersection of all defects with that plane. Thereby, we can define the damage variable at a generic section of a material as
                        
                           (2)
                           
                              d
                              =
                              1
                              −
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    S
                                 
                              
                              =
                              
                                 
                                    S
                                    −
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    S
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          d
                                       
                                    
                                 
                                 
                                    S
                                 
                              
                           
                        
                     where S and 
                        
                           
                              S
                           
                           
                              ¯
                           
                        
                      are respectively the total and the effective area of the section, and 
                        
                           
                              S
                           
                           
                              d
                           
                        
                        =
                        S
                        −
                        
                           
                              S
                           
                           
                              ¯
                           
                        
                      is the damaged part of the area. An undamaged material is characterized by d=0. Due to propagation and coalescence of micro-defects, the damage variable grows and at the late stages of degradation process it approaches asymptotically the limit value d=1, corresponding to a complete damaged material with effective area reduced to zero.

In order to properly determine the evolution of the damage variable regardless of the loading case we must introduce a loading function f specifying the elastic domain and the states at which damage grows. The loading function depends on the strain tensor 
                        ε
                     , and on a variable r that controls the evolution of the elastic domain. A typical definition for function f is
                        
                           (3)
                           
                              f
                              (
                              ε
                              ,
                              r
                              )
                              =
                              
                                 
                                    ε
                                 
                                 
                                    eq
                                 
                              
                              (
                              ε
                              )
                              −
                              r
                           
                        
                     where ε
                     
                        eq
                      is the equivalent strain, i.e., a scalar measure of the strain level, and r represents a scalar measure of the largest strain level ever reached in the previous deformation history of the material up to its current state, i.e.
                        
                           (4)
                           
                              r
                              (
                              t
                              )
                              =
                              max
                              {
                              
                                 
                                    
                                       r
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          max
                                       
                                       
                                          τ
                                          ≤
                                          t
                                       
                                    
                                 
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       eq
                                    
                                 
                                 (
                                 τ
                                 )
                              
                              }
                           
                        
                     The above expression implies that 
                        r
                        (
                        t
                        )
                        ≥
                        
                           
                              r
                           
                           
                              0
                           
                        
                     , where r
                     0 is the damage threshold, a material parameter that represents the value of equivalent strain at which damage starts. In this formula, t is not necessarily the physical time (it can be any monotonically increasing parameter controlling the loading process).

We also postulate the loading-unloading conditions in the Kuhn–Tucker form:
                        
                           (5)
                           
                              f
                              ≤
                              0
                              ;
                              
                              
                                 
                                    r
                                 
                                 
                                    ̇
                                 
                              
                              ≥
                              0
                              ;
                              
                              
                                 
                                    r
                                 
                                 
                                    ̇
                                 
                              
                              f
                              =
                              0
                           
                        
                     The first condition indicates that r can never be smaller than ε
                     
                        eq
                     , while the second one means that r cannot decrease. Finally, according to the third condition, r can grow only if the current values of ε
                     
                        eq
                      and r are equal.

The damage evolution law is defined as
                        
                           (6)
                           
                              d
                              =
                              g
                              (
                              r
                              )
                              
                              with
                              
                              {
                              
                                 
                                    
                                       
                                          g
                                          (
                                          r
                                          )
                                          =
                                          0
                                       
                                       
                                          if
                                          
                                          r
                                          =
                                          
                                             
                                                r
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                          <
                                          g
                                          (
                                          r
                                          )
                                          ≤
                                          1
                                       
                                       
                                          if
                                          
                                          r
                                          >
                                          
                                             
                                                r
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     which holds not only during monotonic loading but also during unloading and reloading.

There are various damage governing laws g(r) that can be effectively used to model damage growth in quasi-brittle materials. In this work we adopt the exponential law proposed in [26], which separates the damage in compression and tension as
                        
                           (7)
                           
                              g
                              (
                              r
                              )
                              =
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    t
                                 
                              
                              (
                              r
                              )
                              +
                              (
                              1
                              −
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                              )
                              
                                 
                                    g
                                 
                                 
                                    c
                                 
                              
                              (
                              r
                              )
                           
                        
                     with
                        
                           (8)
                           
                              
                                 
                                    g
                                 
                                 
                                    t
                                 
                              
                              (
                              r
                              )
                              =
                              1
                              −
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    1
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 
                                    r
                                 
                              
                              −
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                              
                              exp
                              {
                              −
                              
                                 
                                    B
                                 
                                 
                                    t
                                 
                              
                              (
                              r
                              −
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                              )
                              }
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    g
                                 
                                 
                                    c
                                 
                              
                              (
                              r
                              )
                              =
                              1
                              −
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    1
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          c
                                       
                                    
                                    )
                                 
                                 
                                    r
                                 
                              
                              −
                              
                                 
                                    A
                                 
                                 
                                    c
                                 
                              
                              
                              exp
                              {
                              −
                              
                                 
                                    B
                                 
                                 
                                    c
                                 
                              
                              (
                              r
                              −
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                              )
                              }
                           
                        
                     where parameters A
                     
                        t
                      and A
                     
                        c
                      are associated to residual strength, and parameters B
                     
                        t
                      and B
                     
                        c
                      control the slope of the softening branch at the peak of the stress–strain curve. The coefficient α
                     t in (7) ranges from 0 to 1 and takes into account the character of the stress state. It is evaluated from
                        
                           (10)
                           
                              
                                 
                                    α
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          ti
                                       
                                    
                                    〈
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                       
                                    
                                    〉
                                 
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          eq
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     where ε
                     
                        ti
                      are the principal strains due to positive effective stresses, i.e., the principal values of 
                        
                           
                              ε
                           
                           
                              t
                           
                        
                        =
                        
                           
                              E
                           
                           
                              −
                              1
                           
                        
                        :
                        〈
                        E
                        :
                        ε
                        〉
                     .

In the second example of this work, however, we use the simplified version of the previous exponential law as
                        
                           (11)
                           
                              g
                              (
                              r
                              )
                              =
                              1
                              −
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    1
                                    −
                                    A
                                    )
                                 
                                 
                                    r
                                 
                              
                              −
                              A
                              
                              exp
                              {
                              −
                              B
                              (
                              r
                              −
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                              )
                              }
                           
                        
                     
                  

Concerning the definition of the loading function f in (3), we must notice that the expression of the equivalent strain plays a role similar to the yield function in plasticity, because it directly affects the shape of the elastic domain.

Numerous forms of equivalent strain can be found in the literature. In this work, we have used two of them: the so-called Mazars definition [25]:
                        
                           (12)
                           
                              
                                 
                                    ε
                                 
                                 
                                    eq
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          〈
                                          
                                             
                                                ε
                                             
                                             
                                                i
                                             
                                          
                                          〉
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     and the modified version of the von Mises definition [13]:
                        
                           (13)
                           
                              
                                 
                                    ε
                                 
                                 
                                    eq
                                 
                              
                              =
                              
                                 
                                    κ
                                    −
                                    1
                                 
                                 
                                    2
                                    κ
                                    (
                                    1
                                    −
                                    2
                                    ν
                                    )
                                 
                              
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    2
                                    κ
                                 
                              
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   κ
                                                   −
                                                   1
                                                
                                                
                                                   1
                                                   −
                                                   2
                                                   ν
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          12
                                          κ
                                       
                                       
                                          
                                             
                                                (
                                                1
                                                +
                                                ν
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          J
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     where κ is a model parameter that sets the ratio between the uniaxial compressive strength and the uniaxial tensile strength, ν is the Poisson׳s ratio, I
                     1 is the first invariant of the strain tensor, and J
                     2 is the second invariant of the deviatoric strain tensor.

As one can see in Fig. 1
                     , the introduced forms of equivalent strain lead to non-symmetric damage surfaces in which the yield value in compression can be several times the value in tension. This is essential to account for the different strength in tension and compression of geo-materials such as concrete and rocks.

We summarize below the basic ingredients of the isotropic damage model:
                        
                           •
                           The stress–strain relation (1)
                           

The damage criterion, comprised by
                                 
                                    
                                       
                                          ○
                                       
                                    
                                    The loading function in (3)
                                    

The loading-unloading conditions in (5)
                                    

The law governing the evolution of the damage variable (6)
                           

The expression defining the equivalent strain

Although isotropic damage models are quite simple, they are often used to model the failure of concrete and other quasi-brittle materials that show important strain localization. If the damage parameter depends only on the strain state at the point under consideration, the numerical simulations exhibit a pathological mesh dependence, and physically unrealistic results are obtained.

The introduction of a characteristic length into the constitutive model, and the formulation of a non-local strain-softening model, have been shown to prevent the spurious localization of strain-softening damage, to regularize the boundary value problem, and to ensure numerical convergence to physically meaningful solutions [4].

Integral-type non-local models abandon the classical assumption of locality and admit that stress at a certain point depends, not only on the state variables at that point, but also on the distribution of the state variables over the whole body, or over a finite neighbourhood of the point under consideration.

In a general manner, the non-local integral approach consists in replacing a certain variable by its non-local counterpart, obtained by weighted averaging over a spatial neighbourhood of each point under consideration.

Let 
                        f
                        (
                        p
                        )
                      be some local field in a domain V, the corresponding non-local field is defined as
                        
                           (14)
                           
                              
                                 
                                    f
                                 
                                 
                                    ˜
                                 
                              
                              (
                              p
                              )
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    V
                                 
                              
                              α
                              (
                              p
                              ,
                              q
                              )
                              f
                              (
                              q
                              )
                              
                              d
                              q
                           
                        
                     where 
                        α
                        (
                        p
                        ,
                        q
                        )
                      is the chosen non-local weighting function.

In an infinite, isotropic and homogeneous medium, the weighting function depends only on the distance 
                        D
                        =
                        ∥
                        p
                        −
                        q
                        ∥
                      between the source point 
                        q
                     , and the receiver point 
                        p
                     . Thereby, we usually write 
                        α
                        (
                        p
                        ,
                        q
                        )
                        =
                        
                           
                              α
                           
                           
                              0
                           
                        
                        (
                        ∥
                        p
                        −
                        q
                        ∥
                        )
                     , where 
                        
                           
                              α
                           
                           
                              0
                           
                        
                        (
                        D
                        )
                      is usually chosen as a non-negative function monotonically decreasing for 
                        D
                        ≥
                        0
                     .

One possible choice for 
                        
                           
                              α
                           
                           
                              0
                           
                        
                        (
                        D
                        )
                      is the Gauss distribution function:
                        
                           (15)
                           
                              
                                 
                                    α
                                 
                                 
                                    0
                                 
                              
                              (
                              D
                              )
                              =
                              exp
                              [
                              
                                 −
                                 
                                    
                                       (
                                       
                                          
                                             
                                                2
                                                D
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                              ]
                           
                        
                     where the characteristic length l
                     
                        c
                      is a material parameter reflecting the internal length of the non-local continuum.

If a bounded support is preferred, one can also truncate the previous function as follows:
                        
                           (16)
                           
                              
                                 
                                    α
                                 
                                 
                                    0
                                 
                              
                              (
                              D
                              )
                              =
                              {
                              
                                 
                                    
                                       
                                          exp
                                          [
                                          
                                             −
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               2
                                                               D
                                                            
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     c
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          if
                                          
                                          |
                                          D
                                          |
                                          ≤
                                          R
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          if
                                          
                                          |
                                          D
                                          |
                                          >
                                          R
                                       
                                    
                                 
                              
                           
                        
                     where the interaction radius R is a parameter usually related to the characteristic length l
                     
                        c
                     . In the present work, we have considered 
                        R
                        =
                        
                           
                              l
                           
                           
                              c
                           
                        
                     .

In essence, the interaction radius R represents the smallest distance between points 
                        p
                      and 
                        q
                      at which the interaction weight 
                        
                           
                              α
                           
                           
                              0
                           
                        
                        (
                        ∥
                        p
                        −
                        q
                        ∥
                        )
                      vanishes (for weighting functions with a bounded support) or becomes negligible (for weighting functions with an unbounded support). It represents a very important parameter because it controls the size of the softening region.

The interval, circle, or sphere of radius R, centered at 
                        p
                     , is called the domain of influence of point 
                        p
                      (Fig. 2
                     ).

In the application to softening materials, it is often required that the non-local operator do not alter a uniform field (consistency of order 0) which means that the weighting function must accomplish the normalizing condition:
                        
                           (17)
                           
                              
                                 
                                    ∫
                                 
                                 
                                    V
                                 
                              
                              α
                              (
                              p
                              ,
                              q
                              )
                              d
                              q
                              =
                              1
                              
                              ∀
                              p
                              ∈
                              V
                           
                        
                     In order to satisfy (17), the weighting function is rescaled as
                        
                           (18)
                           
                              α
                              (
                              p
                              ,
                              q
                              )
                              =
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    ∥
                                    p
                                    −
                                    q
                                    ∥
                                    )
                                 
                                 
                                    
                                       
                                          ∫
                                       
                                       
                                          V
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    ∥
                                    p
                                    −
                                    x
                                    ∥
                                    )
                                    
                                    d
                                    x
                                 
                              
                           
                        
                     
                  

A suitable non-local damage formulation that restores well-posedness of the boundary value problem is obtained if damage is computed from the non-local equivalent strain [3].

In the loading function (3), the local equivalent strain ε
                     
                        eq
                      is replaced by its weighted spatial average:
                        
                           (19)
                           
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    eq
                                 
                              
                              (
                              p
                              )
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    V
                                 
                              
                              α
                              (
                              p
                              ,
                              q
                              )
                              
                                 
                                    ε
                                 
                                 
                                    eq
                                 
                              
                              (
                              q
                              )
                              
                              d
                              q
                           
                        
                     The internal state variable r is then the largest previously reached value of the non-local equivalent straIn:
                        
                           (20)
                           
                              r
                              
                                 t
                              
                              =
                              max
                              
                                 
                                    
                                       r
                                       0
                                    
                                    ,
                                    
                                       max
                                       
                                          τ
                                          ≤
                                          t
                                       
                                    
                                    
                                       
                                          ε
                                          ~
                                       
                                       
                                          eq
                                       
                                    
                                    
                                       τ
                                    
                                 
                              
                           
                        
                     It is important to note that the damage variable is evaluated from the non-local equivalent strain 
                        
                           
                              
                                 
                                    ε
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              eq
                           
                        
                     , whereas the strains 
                        ε
                      used in (1) to compute the stresses are considered as local. This way, during the elastic range, when the damage variable remains equal to zero, the stress–strain relation is fully local.

Numerical implementation of the non-local damage model based on averaging of the equivalent strain is relatively simple. The evaluation of the stresses remains explicit, and no internal iteration is needed. All that one needs is to implement the algorithm of weighted spatial averaging and, before damage is evaluated, replace the local equivalent strain by its non-local counterpart.

The values of the non-local equivalent strain must be traced at the individual Gauss integration points of the finite element mesh, because these are the points at which stresses are computed.

Thereby, the averaging integral in (19) is evaluated numerically. By considering the weighting function defined in (18) we can write:
                        
                           (21)
                           
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    eq
                                    ,
                                    p
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       q
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    q
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    pq
                                 
                              
                              
                                 
                                    ε
                                 
                                 
                                    eq
                                    ,
                                    q
                                 
                              
                           
                        
                     where w
                     
                        q
                      is a coefficient containing the product of the determinant of the Jacobian and the integration weights of Gauss point q, and α
                     
                        pq
                      is the weight of non-local interaction between points p and q, defined as
                        
                           (22)
                           
                              
                                 
                                    α
                                 
                                 
                                    pq
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    ∥
                                    p
                                    −
                                    q
                                    ∥
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    ∥
                                    p
                                    −
                                    x
                                    ∥
                                    )
                                 
                              
                           
                        
                     In the previous two equations, subscript p represents the receiver point under consideration, whereas indexes q and x correspond to source points. Since the chosen weighting function α
                     0 has bounded support (16), α
                     
                        pq
                      vanishes if the distance between points p and q is larger than the interaction radius R. Therefore, the sums in (21) and (22) do not need to be taken over all Gauss points, but only over those that are located inside the domain of influence of point p.

Note that at the damage process zone one must always use an element size smaller than the interaction radius in order to account for the non-local interaction. Otherwise the damage model would become local. In this regard, an interaction radius relatively small can restrict the applicability of non-local models to small or medium size domains because of very fine meshes being necessary. However, by using an adaptive mesh technique like the one presented in this work, one can partially overcome this inconvenience with smaller elements at the damage process zone and larger elements far from it.

Each Gauss point must have a non-local interaction table that gives access to its neighbours. This table must be constructed at the beginning of the problem from a search of non-local neighbours. In this work, the search of neighbours is performed by means of a grid-based algorithm. A general rectangular grid is defined in the entire domain and all the integration points are positioned in the cells. This way, the neighbour search that must be performed for each Gauss point is restricted to a limited number of cells, i.e., the ones that fall inside the domain of influence of the considered point (Fig. 3
                     ).

The stress evaluation procedure, repeatedly called during the incremental-iterative strategy, makes use of the non-local interaction tables when the non-local equivalent strain is computed. To obtain 
                        
                           
                              
                                 
                                    ε
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              eq
                           
                        
                      we first compute the local equivalent strains at all Gauss points, and then we calculate the non-local counterpart using (21).

If one aims to obtain an iterative solver with quadratic convergence when working with a non-local damage model, it is necessary to construct the tangent stiffness matrix in a consistent manner. Here we derive the analytical expression of the tangent matrix, but we also note that some authors report complete consistency when obtaining the global tangent operators by finite-differencing the residuals [35].

Let us start expressing the vector of internal forces as a numerical integration over the Gauss points. In order to make the explanation more understandable, from now on we will be using Voigt notation, i.e.
                        
                           (23)
                           
                              
                                 
                                    f
                                 
                                 
                                    int
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    p
                                 
                              
                           
                        
                     
                  

Using the stress–strain law (1) and the classic strain-displacement relation 
                        ε
                        =
                        Ba
                     , we expand (23) as follows:
                        
                           (24)
                           
                              
                                 
                                    f
                                 
                                 
                                    int
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              (
                              1
                              −
                              
                                 
                                    d
                                 
                                 
                                    p
                                 
                              
                              )
                              
                                 
                                    B
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    EB
                                 
                                 
                                    p
                                 
                              
                              a
                           
                        
                     
                  

The tangent stiffness matrix is obtained by differentiating the internal forces with respect to the vector of nodal displacements 
                        a
                     . Since the damage variable depends on the nodal displacements through the equivalent strain, we will compute first the derivative of the damage variable with respect to the displacement vector 
                        a
                     . Taking into account that 
                        d
                        =
                        g
                        (
                        r
                        )
                      
                     (6), r depends on 
                        
                           
                              
                                 
                                    ε
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              eq
                           
                        
                      
                     (20), and 
                        
                           
                              
                                 
                                    ε
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              eq
                           
                        
                      depends on 
                        a
                      through the interpolated strains, we use the chain rule to write the derivative of the damage variable for an integration point p as follows:
                        
                           (25)
                           
                              
                                 
                                    ∂
                                    
                                       
                                          d
                                       
                                       
                                          p
                                       
                                    
                                 
                                 
                                    ∂
                                    a
                                 
                              
                              =
                              
                                 
                                    dg
                                 
                                 
                                    
                                       
                                          dr
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          dr
                                       
                                       
                                          p
                                       
                                    
                                 
                                 
                                    d
                                    
                                       
                                          
                                             
                                                ε
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          eq
                                          ,
                                          p
                                       
                                    
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          
                                             
                                                ε
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          eq
                                          ,
                                          p
                                       
                                    
                                 
                                 
                                    ∂
                                    a
                                 
                              
                              =
                              
                                 
                                    g
                                 
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          
                                             
                                                ε
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          eq
                                          ,
                                          p
                                       
                                    
                                 
                                 
                                    ∂
                                    a
                                 
                              
                           
                        
                     where 
                        
                           
                              g
                           
                           
                              p
                           
                           
                              ′
                           
                        
                      is the derivative of the damage evolution law with respect to the internal state variable r, and t
                     
                        p
                      is the loading–unloading factor that is 0 in an elastic loading or in an unloading regime, and 1 in a loading regime with growing damage. Thus,
                        
                           (26)
                           
                              
                                 
                                    t
                                 
                                 
                                    p
                                 
                              
                              =
                              {
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          if
                                          
                                          
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                eq
                                                ,
                                                p
                                             
                                          
                                          <
                                          
                                             
                                                r
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          if
                                          
                                          
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                eq
                                                ,
                                                p
                                             
                                          
                                          =
                                          
                                             
                                                r
                                             
                                             
                                                p
                                             
                                          
                                          
                                          and
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                eq
                                                ,
                                                p
                                             
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                  

Using expression (21), we can differentiate the non-local equivalent strain of a Gauss point p with respect to the nodal displacements as
                        
                           (27)
                           
                              
                                 
                                    ∂
                                    
                                       
                                          
                                             
                                                ε
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          eq
                                          ,
                                          p
                                       
                                    
                                 
                                 
                                    ∂
                                    a
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       q
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    q
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    pq
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          ε
                                       
                                       
                                          eq
                                          ,
                                          q
                                       
                                    
                                 
                                 
                                    ∂
                                    a
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       q
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    q
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    pq
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          ε
                                       
                                       
                                          eq
                                          ,
                                          q
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          ε
                                       
                                       
                                          q
                                       
                                    
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          ε
                                       
                                       
                                          q
                                       
                                    
                                 
                                 
                                    ∂
                                    a
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       q
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    q
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    pq
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          ε
                                       
                                       
                                          eq
                                          ,
                                          q
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          ε
                                       
                                       
                                          q
                                       
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    q
                                 
                              
                           
                        
                     The derivative of the equivalent strain with respect to the strain vector 
                        ∂
                        
                           
                              ε
                           
                           
                              eq
                              ,
                              q
                           
                        
                        /
                        ∂
                        
                           
                              ε
                           
                           
                              q
                           
                        
                      is a row matrix that will depend on the chosen form of equivalent strain.

Let us now rewrite the expression of the internal forces in (24) as follows:
                        
                           (28)
                           
                              
                                 
                                    f
                                 
                                 
                                    int
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    EB
                                 
                                 
                                    p
                                 
                              
                              a
                              −
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    EB
                                 
                                 
                                    p
                                 
                              
                              a
                              
                                 
                                    d
                                 
                                 
                                    p
                                 
                              
                           
                        
                     At this point, we can already differentiate (28) and substitute (25) to get a first expression for the tangent stiffness matrix, as
                        
                           (29)
                           
                              
                                 
                                    K
                                 
                                 
                                    tan
                                 
                              
                              =
                              
                                 
                                    ∂
                                    
                                       
                                          f
                                       
                                       
                                          int
                                       
                                    
                                 
                                 
                                    ∂
                                    a
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              (
                              1
                              −
                              
                                 
                                    d
                                 
                                 
                                    p
                                 
                              
                              )
                              
                                 
                                    EB
                                 
                                 
                                    p
                                 
                              
                              −
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    EB
                                 
                                 
                                    p
                                 
                              
                              a
                              
                                 
                                    g
                                 
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          
                                             
                                                ε
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          eq
                                          ,
                                          p
                                       
                                    
                                 
                                 
                                    ∂
                                    a
                                 
                              
                           
                        
                     Note that the first term in the right hand side (r.h.s.) of (29) is the secant stiffness matrix, that coincides with the tangent matrix in an elastic loading or in an unloading regime (t
                     
                        p
                     =0). The second term in the r.h.s. is the non-local part of the tangent stiffness matrix. Substituting (27) into (29) yields
                        
                           (30)
                           
                              
                                 
                                    K
                                 
                                 
                                    tan
                                 
                              
                              =
                              
                                 
                                    K
                                 
                                 
                                    sec
                                 
                              
                              −
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              E
                              
                                 
                                    ε
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       q
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    q
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    pq
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          ε
                                       
                                       
                                          eq
                                          ,
                                          q
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          ε
                                       
                                       
                                          q
                                       
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    q
                                 
                              
                              =
                              
                                 
                                    K
                                 
                                 
                                    sec
                                 
                              
                              −
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ,
                                       q
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    q
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    pq
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          ε
                                       
                                       
                                          eq
                                          ,
                                          q
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          ε
                                       
                                       
                                          q
                                       
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    q
                                 
                              
                           
                        
                     Defining for convenience the column matrix 
                        
                           
                              β
                           
                           
                              p
                           
                           
                              c
                           
                        
                        =
                        
                           
                              B
                           
                           
                              p
                           
                           
                              T
                           
                        
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                           
                              p
                           
                        
                     , the row matrix 
                        
                           
                              β
                           
                           
                              q
                           
                           
                              r
                           
                        
                        =
                        (
                        ∂
                        
                           
                              ε
                           
                           
                              eq
                              ,
                              q
                           
                        
                        /
                        ∂
                        
                           
                              ε
                           
                           
                              q
                           
                        
                        
                           
                              B
                           
                           
                              q
                           
                        
                     ), and the coefficient 
                        
                           
                              w
                           
                           
                              pq
                           
                        
                        =
                        
                           
                              w
                           
                           
                              p
                           
                        
                        
                           
                              w
                           
                           
                              q
                           
                        
                        
                           
                              α
                           
                           
                              pq
                           
                        
                     , Eq. (30) can be rewritten like:
                        
                           (31)
                           
                              
                                 
                                    K
                                 
                                 
                                    tan
                                 
                              
                              =
                              
                                 
                                    K
                                 
                                 
                                    sec
                                 
                              
                              −
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ,
                                       q
                                    
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    pq
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    p
                                 
                                 
                                    c
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    q
                                 
                                 
                                    r
                                 
                              
                           
                        
                     
                  

The double index of the sum, caused by the non-local interaction, implies that the term on the right part of Equation (31) cannot be assembled from element contributions only. Essentially, each pair of Gauss points p and q contributes to the global stiffness matrix with a block of the same size as that of the classical element stiffness matrix. The difference is that the assembling routine differs from the usual one because in this case one needs to take into account the elements of both points p and q (Fig. 4
                     ). Consequently, the global stiffness matrix is always non-symmetric and its bandwidth increases due to the non-local interaction.

In order to avoid the additional non-zero entries that the non-local interaction introduces into the global stiffness matrix, one could neglect the non-local terms by using 
                        
                           
                              w
                           
                           
                              pq
                           
                        
                        =
                        
                           
                              δ
                           
                           
                              pq
                           
                        
                        
                           
                              w
                           
                           
                              q
                           
                        
                     , where δ
                     pq is the Kronecker delta. This way, Eq. (31) reduces to
                        
                           (32)
                           
                              
                                 
                                    K
                                 
                                 
                                    tan
                                 
                                 
                                    local
                                 
                              
                              =
                              
                                 
                                    K
                                 
                                 
                                    sec
                                 
                              
                              −
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                    
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    p
                                 
                                 
                                    c
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                           
                        
                     where the sum is performed over one index only. Note that the resulting local tangent matrix 
                        
                           
                              K
                           
                           
                              tan
                           
                           
                              local
                           
                        
                      is no longer consistent, and quadratic convergence is lost.

Probably the most important issue caused by non-locality is the evolutionary character of the profile of the stiffness matrix. For the simulation of quasi-brittle materials like concrete, the consistent stiffness matrix remains local through the elastic branch, and so the initial distribution of non-zero entries is the same as in the local case. However, when the damage threshold is exceeded and the damage zone starts propagating, new non-zero entries appear due to the non-local interaction between Gauss points belonging to different elements, and the profile of the stiffness matrix must be dynamically adapted. The number of additional non-zero entries will depend on each particular case, but if a finer mesh is used in the expected softening zones, this number can be relatively high.

The non-local averaging certainly increases the computational cost with respect to the corresponding local model. However, the non-local model completely removes the pathological sensitivity to the mesh size and partially alleviates the mesh-induced directional bias. Consequently, this extra computational effort is indeed worthwhile.

In this work we have used the error estimation and adaptive mesh refinement strategy presented by Oñate and co-workers [6,7,34,33,32].

The general algorithm of non-linear adaptive FEM analysis implemented in this work is described as follows. After reaching the equilibrium state and updating the solution, an error estimation is performed in order to evaluate the error distribution over the mesh. Then, a remeshing criterion uses the information about error distribution and determines the required mesh density. From this analysis, we obtain a new spatial discretization using a mesh generator interface.

In a truly adaptive approach, after generating a new discretization, the data structures corresponding to the newly generated mesh are created, and the transfer of displacements and internal variables from the old mesh to the new one is performed. After the mapping, the internal variables are used together with the strain computed from the mapped displacements to update the internal state of each integration point on the new mesh (to achieve local consistency). Once the transfer has finished, the old discretization is deleted and the mapped configuration is brought into global equilibrium through iteration. Afterwards, the solution continues with the next incremental-iterative step.

Another possibility is to restart the analysis from the initial state after the new discretization is generated. This approach does not require the transfer of the current state from the old discretization to the new one, but from the computational point of view is less efficient than the truly adaptive approach, especially if the remeshing is done frequently.

We present below the main stages of the implemented adaptive procedure.

The error estimator is based on the stress evaluation. We define the error as the difference between an exact value of the effective stresses 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 e
                              
                           
                         and an approximate one 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 a
                              
                           
                        :
                           
                              (33)
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       e
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       a
                                    
                                 
                              
                           
                        Note that we compute the error with the effective stresses 
                           
                              
                                 σ
                              
                              
                                 ¯
                              
                           
                         and not with the total stresses 
                           σ
                         because the latter tend to zero as damage grows.

A reasonably good value of the exact stresses is obtained from their extrapolation from the Gauss points to the nodes and a posterior smoothing [32]. The approximate value of stresses is simply the default evaluated stresses of the FEM solution. Therefore, the estimated error can be defined as the difference between the smoothed effective stresses 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 s
                              
                           
                        , and the calculated effective stresses 
                           
                              
                                 σ
                              
                              
                                 ¯
                              
                           
                        :
                           
                              (34)
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 ≈
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       s
                                    
                                 
                                 −
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                              
                           
                        
                     

We will work with integral measures of the error. The energy norm of the error over an element is defined as
                           
                              (35)
                              
                                 ∥
                                 
                                    
                                       ϵ
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       (
                                       e
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      (
                                                      e
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϵ
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                E
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                ϵ
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                          
                                          
                                          d
                                          Ω
                                       
                                       ]
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      (
                                                      e
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      s
                                                   
                                                
                                                −
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                ]
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                E
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          [
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                s
                                             
                                          
                                          −
                                          
                                             
                                                σ
                                             
                                             
                                                ¯
                                             
                                          
                                          ]
                                          
                                          d
                                          Ω
                                       
                                       ]
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                              
                           
                        The square of the global error can be obtained from the sum of the squares of all the elemental errors:
                           
                              (36)
                              
                                 ∥
                                 
                                    
                                       ϵ
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                       
                                    
                                 
                                 
                                    
                                       (
                                       ∥
                                       
                                          
                                             ϵ
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∥
                                          
                                          
                                             (
                                             e
                                             )
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                     

The smaller is the distance between the nodes of the mesh, the smaller will be the difference between the smoothed and non-smoothed stresses. Thereby, the presented energy norm tends to zero as the size of the element diminishes, i.e., 
                           ∥
                           
                              
                                 ϵ
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                              
                           
                           ∥
                           =
                           O
                           (
                           
                              
                                 h
                              
                              
                                 m
                              
                           
                           )
                         where h is the element size and m is the order of the polynomial defining the shape functions.

Determining whether a mesh must be refined or not requires to previously define some quality conditions based on the estimated error.

First, the energy norm of the global error should be smaller than a certain percentage of the deformation energy:
                           
                              (37)
                              
                                 ∥
                                 
                                    
                                       ϵ
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 ∥
                                 ≤
                                 η
                                 U
                              
                           
                        where η is the permissible percentage of global error, prescribed a priori, and the deformation energy is obtained from:
                           
                              (38)
                              
                                 
                                    
                                       U
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             U
                                          
                                          
                                             (
                                             e
                                             )
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        with
                           
                              (39)
                              
                                 
                                    
                                       U
                                    
                                    
                                       (
                                       e
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      (
                                                      e
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                s
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                E
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                s
                                             
                                          
                                          
                                          d
                                          Ω
                                       
                                       ]
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                              
                           
                        
                     

To determine whether condition (37) is fulfilled, it is convenient to work with a global error parameter defined as
                           
                              (40)
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       g
                                    
                                 
                                 =
                                 
                                    
                                       ∥
                                       
                                          
                                             ϵ
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       ∥
                                    
                                    
                                       η
                                       U
                                    
                                 
                              
                           
                        Thereby, when 
                           
                              
                                 ξ
                              
                              
                                 g
                              
                           
                           =
                           1
                         the global error condition is perfectly fulfilled. For 
                           
                              
                                 ξ
                              
                              
                                 g
                              
                           
                           >
                           1
                         the mesh should be refined, and for 
                           
                              
                                 ξ
                              
                              
                                 g
                              
                           
                           <
                           1
                         the average mesh size could be larger.

Taking into account that 
                           ∥
                           
                              
                                 ϵ
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                              
                           
                           ∥
                           =
                           O
                           (
                           
                              
                                 h
                              
                              
                                 m
                              
                           
                           )
                        , the new element size 
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 (
                                 e
                                 )
                              
                           
                         can be obtained with
                           
                              (41)
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       (
                                       e
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             (
                                             e
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   ξ
                                                
                                                
                                                   g
                                                
                                             
                                             )
                                          
                                          
                                             (
                                             1
                                             /
                                             m
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

If one aims at obtaining a selective refinement method, apart from (37), another condition concerning the error of each element must be simultaneously imposed. In this paper, we have chosen a remeshing criterion based on a global error equidistribution [33].

This criterion distributes the global error uniformly among all the elements of the mesh, and so the elemental error must accomplish the following condition:
                           
                              (42)
                              
                                 ∥
                                 
                                    
                                       ϵ
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    
                                       (
                                       e
                                       )
                                    
                                 
                                 ≤
                                 
                                    
                                       ∥
                                       
                                          
                                             ϵ
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       ∥
                                    
                                    
                                       
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        where n is the number of elements of the mesh.

Like for the global error, we can work with a local error parameter:
                           
                              (43)
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       l
                                    
                                    
                                       (
                                       e
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       ∥
                                       
                                          
                                             ϵ
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∥
                                          
                                          
                                             (
                                             e
                                             )
                                          
                                       
                                    
                                    
                                       ∥
                                       
                                          
                                             ϵ
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       ∥
                                    
                                 
                              
                           
                        with the same meaning that in the global case: 
                           
                              
                                 ξ
                              
                              
                                 l
                              
                              
                                 (
                                 e
                                 )
                              
                           
                           =
                           1
                         indicates an optimal element size, whereas 
                           
                              
                                 ξ
                              
                              
                                 l
                              
                              
                                 (
                                 e
                                 )
                              
                           
                           >
                           1
                         and 
                           
                              
                                 ξ
                              
                              
                                 l
                              
                              
                                 (
                                 e
                                 )
                              
                           
                           <
                           1
                         imply that the element is too large and too small, respectively.

This local parameter allows us to define the new element size that accomplishes (42):
                           
                              (44)
                              
                                 
                                    
                                       h
                                       ^
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       h
                                       
                                          e
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                ξ
                                                l
                                                
                                                   e
                                                
                                             
                                             )
                                          
                                          
                                             2
                                             /
                                             (
                                             2
                                             m
                                             +
                                             d
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        where d is the space dimension of the problem.

In the end, the remeshing criterion results from the combination of the global error condition (37) and the local one (42). In consequence, the final refinement parameter of the element can be defined as
                           
                              (45)
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       (
                                       e
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       ξ
                                    
                                    
                                       g
                                    
                                 
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       l
                                    
                                    
                                       (
                                       e
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       ∥
                                       
                                          
                                             ϵ
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∥
                                          
                                          
                                             (
                                             e
                                             )
                                          
                                       
                                    
                                    
                                       η
                                       U
                                    
                                 
                              
                           
                        And the new element size is obtained with
                           
                              (46)
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       (
                                       e
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             (
                                             e
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             (
                                             e
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        where
                           
                              (47)
                              
                                 
                                    γ
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          ξ
                                          g
                                       
                                       )
                                    
                                    
                                       1
                                       /
                                       m
                                    
                                 
                                 
                                    
                                       (
                                       
                                          ξ
                                          l
                                          
                                             e
                                          
                                       
                                       )
                                    
                                    
                                       2
                                       /
                                       (
                                       2
                                       m
                                       +
                                       d
                                       )
                                    
                                 
                              
                           
                        
                     

The mesh generator interface is the pre-processing and post-processing GiD software used to run the simulations [1]. Therefore, not only GiD meshes the geometry at the beginning of the numerical solution, but it is also GiD which allows to obtain the new spatial discretization every time we need to adapt the mesh.

Thereby, after the error estimator and the remeshing criterion are applied, a “background mesh” file is generated with the information of the new element sizes. Then, GiD allows us to load this background mesh file along with the original mesh file so as to generate a new mesh according to the refinement parameter of each old element.

Before one can continue with the solution of a problem, there is a last stage that must be performed in a truly adaptive approach: the mapping of primary unknowns and internal variables.

In essence, if one aims at continuing the analysis from the current state, instead of restarting it from scratch after every mesh refinement, it is necessary to apply some transfer algorithms for the displacements and internal history variables (in the present case, the state variable r governing the damage evolution).

Mapping of the primary unknowns (nodal displacements) is achieved by using the shape function projections. To do so, we must first place each new node inside an old element, by means of a grid-based search, and then we interpolate the displacements of the old nodes to the new ones (Fig. 5
                        (a)).

Mapping of the internal state variables is done through a weighted spatial averaging, similar to the one used for the computation of the non-local equivalent strain. The difference is that, in this case, the source points are the integration points of the old mesh, and the receiver points are the integration points of the new mesh (Fig. 5(b)). Once again, another grid-based search is performed in order to determine the Gauss points of the old mesh that fall inside the interaction radius R of each new Gauss point.

In this section we will present two examples of application of the non-local damage model and the mesh adaptive technique proposed. The examples are the three-point bending test and the four-point shear test. For each case we will first assess the robustness of the non-local damage model when working with different spatial discretizations, and then we will solve the problem again by applying the mesh-adaptive technique, in order to point out the strengths and limitations of the code in its current state.

The first example is solved with the Mazars non-local damage model, whereas the second example uses the modified von Mises. In doing so, we wanted to verify that the implemented non-local damage worked properly on two classical models well calibrated for these examples.

Regarding the solving strategy, we will be following the equilibrium path of the problem for a series of steps through a global arc-length method in an incremental-iterative process. Self weight will not be considered.

This test is performed with a notched beam subjected to three-point bending (TPB). The beam has a square cross section of 40 × 320mm, a span of 1280mm. The notch is 3mm thick and extends over one tenth of the beam depth (Fig. 6
                        ).

Plane stress conditions have been assumed. The geometry was meshed by 4-noded quadrilaterals with 2×2 integration points.

As it has been stated before, the non-local damage model was defined with the Mazars model, regarding the equivalent strain (12) and the damage evolution law (7). The material parameters were obtained from [21] and are summarized in Table 1
                           .

In order to assess the robustness of the non-local damage model, we have also solved the problem with a local damage model based on the damage evolution law of [29] and a modified definition of the equivalent strain presented by Simo and Ju in [39]. The parameters for this model are shown in Table 2
                           .

The problem was solved for different spatial discretizations. In this case we used three unstructured meshes of 4-noded quadrilaterals with a minimum size of 15mm, 7mm, and 3mm, respectively (Fig. 7
                           ).


                           Fig. 8
                            shows the relation between the applied load and the vertical deflection of the beam for each mesh. As one can see from the discontinued equilibrium curves, we had serious difficulties in tracing the response of a full test. The reason behind the convergence problems could be the use of a too global arc-length method. Indeed, to account for the localized nature of quasi-brittle failure, a more specific control parameter, like the Crack Mouth Opening Displacement (CMOD), could help improving the convergence near snap-back zones.

That aside, if we look at the curves in Fig. 8(a) we can see that, although there is no relevant difference between the response obtained with meshes 1 and 2, the peak load actually decreases with the finest mesh 3, and so the total dissipated energy. On the other hand, the response diagram in Fig. 8(b) shows practically the same peak load for the three meshes.


                           Fig. 9
                            shows clearly the different behaviour of the local and non-local approaches. While in the local model the thickness of the damage pattern is of the order of the element size, in the non-local case the damage pattern is controlled by the interaction radius R and so the response remains virtually unaltered regardless of the mesh.

Furthermore, in order to check whether the implemented model can properly reproduce the behaviour of the real test, we have compared the results obtained in the non-local model with experiments performed in [22].


                           Fig. 10
                            shows the force-vertical deflection diagram of the experimental solution and the computed solution with mesh 3.

As we can see, the peak load is properly captured, but the post peak branch of the numerical solution falls faster than in the experimental solution, and even shows a certain amount of snap-back behaviour. Looking at the elastic branch of the responses, it seems that the stiffness degradation starts before in the computed solution and, in consequence, the peak is slightly displaced to the right. Therefore, we can say that the behaviour of the numerical model seems more brittle than that observed in the experiment. The different slope of the post-peak region can be understood if one takes into account that here an arc-length method traces the equilibrium path, whereas in laboratory test the response is obtained by control of displacements.

The same problem was solved again, using the mesh-adaptive technique described along with the non-local damage model.

As mentioned in Section 5.2, we use a remeshing criterion based on the global error equidistribution. The objective of the example was to obtain efficient spatial discretizations for the changing damage states, limiting the global error to a 10% of the deformation energy 
                              (
                              η
                              =
                              10
                              %
                              )
                           . The initial mesh is an unstructured mesh of 4-noded quadrilaterals with an average size of 10mm.

In this case three refinements have been performed. In order to understand the mesh-adaptive process, it is interesting to see the evolution of damage for the different meshes (Fig. 11
                           ).

A quantitative measure of the suitability of the mesh is given by the global refinement parameter ξ
                           g. A value close to 1 means that the global error is similar to the goal percentage of error η. The value of 1.33 in Fig. 11(a) denotes that the mesh must be refined in those areas of the structure with higher stress variations, i.e., the zone near the notch, the point of application of the load, and the supports. On the other hand, since this procedure also optimizes the mesh enlarging the elements on those zones with smoother stresses, the number of elements can be reduced from 4453 to 2977.

In the subsequent meshes (Fig. 11(b)–(d)) the global refinement parameters are smaller than 1, showing that the mesh-adaptive technique properly keeps the error below the prescribed threshold.

Regarding the load – deflection curve in Fig. 12
                           , we note that the maximum applied load is almost the same as in the cases solved with a constant mesh and the peak load also falls in the same range of deflection. We see however a small step-like perturbation in the elastic loading branch, probably caused by little inaccuracies during the mapping of variables of the mesh adaptive process.

We can say that the main advantage of the adaptive mesh technique is that it automatically optimizes the mesh for the problem we are solving, so that the number of elements can be drastically reduced, and so the computational cost of the problem. However, this procedure still does not distinguish compressive stresses from tensile stresses when estimating the error. In materials like concrete, this can lead to excessively small elements in compressed zones, and so it could be convenient to give more weight to the tensile stresses.

The test will be performed with a single-edge notched beam subjected to four-point shear (FPS). The analysed beam has a square cross section of 100×200mm, a span of 840mm, and the notch is 10mm thick and 40mm depth (Fig. 13
                        ).

Plane stress conditions have been assumed. The geometry was meshed using standard linear 3-noded triangles with one integration point.

The non-local damage model is defined with the equivalent strain form of the modified von Mises model (13), and the simplified exponential damage evolution law (11). The material parameters for the non-local approach have been obtained from [38] and are summarized in Table 3
                           .

Like in the first example, we have compared the non-local damage model with a local damage model (Table 4
                           ).

In this case, we used three unstructured meshes of 3-noded triangles with a minimum size of 8mm, 5mm, and 3mm, respectively (Fig. 14
                           ).

In Fig. 15
                           , we represent the relation between the applied load and the Crack Mouth Sliding Displacement (CMSD) for each mesh. The curves in Fig. 15(a) show that in this case the peak and the dissipated energy also decrease as the mesh is refined. However, this reduction is not so clear as in the previous example. On the other hand, Fig. 15(b) shows virtually the same peak load for the three meshes. Also, although we can notice some oscillations in the post-peak regions of meshes 1 and 2, we can say that the residual force at the right part of the graph seems to be pretty similar for all cases. We note that the “bilinear” response obtained with mesh 3 in Fig. 15(b) is due to the lack of precision of the implemented arc-length strategy. Probably an arc-length method with an specific control parameter such as the CMSD procedure would be better suited in this case.


                           Fig. 16
                            shows the damage progression for both models stressing the more localized nature of the local damage model. Regarding the non-local model, if we compare this example with the three-point bending test, we can clearly see that the damage progression zone here is restricted to a narrower region than before. The reason is that now the characteristic length defining the interaction radius is quite smaller than before.


                           Fig. 17
                            shows the relation between the applied load and the Crack Mouth Sliding Displacement of a reference experimental solution [8] and the computed solution with the finest mesh.

We can see that the obtained response is very similar to the experimental solution. What should be noticed, though, is that the failure obtained in the computed solution is slightly more brittle as compared to the experimental one. This is possibly consequence of an imprecise tracing of the equilibrium path, caused by the global arc-length strategy used.

This example is performed with the same permissible percentage of global error as in the previous one 
                              (
                              η
                              =
                              10
                              %
                              )
                           , but the initial mesh is an unstructured mesh of triangles with an average size of 7mm.

In this case the number of refinements is four. The evolution of damage for the different spatial discretizations is represented in Fig. 18
                           .


                           Fig. 18 (a) shows no damage before the first refinement. It can be deduced then that the subsequent spatial discretization is mainly caused by the high compressive stresses at the loading points and at the supports.

However, from Fig. 18(c)–(e) it is clear that the adaptive procedure properly captures the damage process zone and adapts the mesh accordingly.

Another aspect to consider here is directly related to the abrupt failure of the computed solution seen in Fig. 17. Indeed, when damage grows abruptly the global refinement parameter ξ
                           g increases up to a value of 2.20 (Fig. 18(c)). Consequently, the adaptive technique refines excessively all the affected zone, leading to a considerably large number of elements and a much smaller global refinement parameter (Fig. 18(d)). Nonetheless, once damage progress stabilises, the adaptive procedure readjusts the spatial discretization and the resulting mesh is actually efficient (Fig. 18(e)).

Finally, we can notice that the damage pattern in Fig. 18(e) is a bit wider than the one shown in Fig. 16(f). The reason could be that some extra damage diffusion is introduced during the transfer of internal variables between meshes.

The response depicted in Fig. 19
                            shows local perturbations at some points of the equilibrium path coinciding with the different refinements of the mesh. The diffusion of damage after the mapping of variables is probably the main reason behind them.

Despite these oscillations, the implemented mapping algorithm allows capturing a reasonably good response with a peak load that virtually coincides with the value from the experiments (Fig. 17). However, for future works, it will be important to analyse the real effect of these errors in the global response of the structure, by using different mapping algorithms apart from the one implemented here, e.g. the closest point transfer, the shape function projection transfer or the least-square projection transfer.

@&#CONCLUSIONS@&#

The implemented non-local damage model has shown a robust behaviour for changing spatial discretizations, avoiding pathological mesh sensitivity and mesh-induced directional bias. It has also proved to properly capture the experimental peak load of the response diagrams in the two examples analysed: the three-point bending test and the four-point shear test. However, the numerical solution has shown a more brittle post-peak branch as compared to the experimental results. An important aspect to note about this integral-type non-local approach is that the averaging performed to account for the non-local interaction, considerably increases the computational cost of the solution, as compared to the classical local approach, and also modifies the traditional assembly process of the global tangent stiffness matrix.

That aside, it must be stated that the global arc-length strategy used in the simulations has shown an irregular success when tracing the non-linear solution, and so it is probably not the best approach for the kind of problems we have been solving. Indeed, the implementation of an advanced arc-length method with a specific control parameter (CMOD or CMSD) that accounts for the localized nature of quasi-brittle materials could help improving the accuracy of the converged solution.

The implemented mesh-adaptive technique allows one to capture the process damage zone and adjust the spatial discretization accordingly. This procedure generates large elements in zones with smooth stress distribution, and small elements in zones with strong variations of stresses. Hence, efficient mesh distributions can be obtained. Nevertheless, the mesh adaptive technique is still a recent implementation and there are some features that will be improved in subsequent work. For instance, the procedure does not distinguish compressive stresses from tensile stresses when estimating the error, which can result in excessively fine meshes at compressed zones that are not actually transcendent for the damage progression of materials like concrete. Furthermore, errors in the transfer operations of internal variables introduce some extra damage diffusion that should be analysed in order to assess its actual influence in the traced equilibrium path.

@&#ACKNOWLEDGEMENTS@&#

The authors are thankful to Mr. Miquel Portabella for his collaboration in the implementation of the mesh-adaptive technique.

This research was partially funded by the Advanced Grant project SAFECON (267521) of the European Research Council and project NUMEXAS (611636) of the FP7 of the European Commission.

@&#REFERENCES@&#

