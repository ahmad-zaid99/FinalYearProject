@&#MAIN-TITLE@&#Topology optimization of photonic structures for all-angle negative refraction

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new topology optimization algorithm for photonic crystals is proposed.


                        
                        
                           
                           Novel photonic crystals for all-angle negative refraction (AANR) are found.


                        
                        
                           
                           The optimized solutions are analyzed and discussed in detail.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Topology optimization

Photonic crystal

Negative refraction

Bi-directional evolutionary structural optimization (BESO)

@&#ABSTRACT@&#


                  This paper proposes a new topology optimization algorithm based on the bi-directional evolutionary structural optimization (BESO) method to design photonic crystals with broad all-angle negative refraction (AANR) frequency range. The photonic crystals are assumed to be two-dimensional periodical structures, which consist of dielectric materials and air. The conditions for the occurrence of AANR are identified and the design objective is to enlarge the AANR frequency range. The BESO algorithm is proposed based on finite element analysis for band diagrams of photonic crystals and the derived sensitivity numbers. Starting from a simple initial design without any AANR, BESO gradually re-distributes the dielectric materials within the periodical unit cell so that the AANR property emerges and its frequency range is enlarged accordingly. The numerical results show that the proposed BESO algorithm can effectively obtain AANR photonic crystals with novel patterns. The effects of dielectric permittivity contrast of two constituent materials, mesh-refinement and filter are discussed.
               

@&#INTRODUCTION@&#

Negative refraction of electromagnetic waves has attracted a lot of attention in recent years. It refers to the phenomenon that, when light beams travel to the interface of two materials, they refract to the same side of the surface normal. Theoretical analysis of negative refraction originates from the investigation on “left-handed material” which has negative permittivity and negative permeability simultaneously. This kind of material was predicted by Veselago in 1960s [1]. Its unique property gives rise to some interesting applications such as superlensing [2]. Although materials that having negative refractive indices do not exist in nature, some early researchers like Pendry [3], Smith [4] and Shelby [5] have successfully constructed negative refractive metamaterials constituted by periodic metallic resonant structures. These composites are capable of working at microwave region, which has a wavelength much larger than the periodicity of the structure. In recent years, the available frequency of metamaterials has been expanded to visible or higher frequency regions [6–9]. However, the high loss caused by resonance and the intrinsic fabrication limitations are still significant difficulties in the design of metamaterials. Therefore, many researchers have turned to achieve negative refraction through photonic crystals.

Photonic crystals are periodic structures consisting of two or more materials, which could be metal, dielectric material or air/vacuum. The diffraction in photonic crystals may result in one of the components of the group velocity propagating the opposite direction of the wave vector k, which will induce negative refraction. Compared with metamaterials, photonic crystals can interfere with light with wavelength comparable to its lattice constant, which mean they can work at higher frequencies like optical or infrared regions. Thus, photonic crystals can take advantage of the unique dispersion properties and generate negative refraction even without negative indices. Furthermore, typical photonic crystals composed of dielectric materials have lower absorption in high frequency regions [10]. Many researchers have investigated the negative refraction in photonic crystals [11–15]. So far, most researches focused on the mechanisms and experiments of photonic crystals. The systematic design of photonic crystals has not been reported yet.

The property of photonic crystals stems from their constituent materials and their spatial distribution. The negative refraction possibly occurs by rationally designing the structures of photonic crystals. In practice, negative refraction for all incident angles is essential for superlensing of near-field images. It is of significant importance to design low-absorption photonic crystals with broad AANR frequency range, which can give rise to a large available bandwidth, or lower the monochromaticity requirement of light sources. Furthermore, the diffraction effects should be avoided to ensure all the optical energy is negatively refracted.

Topology optimization is an efficient way to acquire the optimal design of structures based on the mathematical formulation of design objectives and constraints. Topology optimization methods were often employed to find the best or most economic material arrangement of structures in a given design domain. The most commonly used topology optimization methods include Solid Isotropic Material with Penalization (SIMP) method [16–18], level-set method [19,20], Evolutionary Structural Optimization (ESO) [21,22] and its later version Bidirectional Evolutionary Structural Optimization (BESO) [23,24]. Meanwhile, topology optimization methods have been successfully implemented in the design of optical devices [25–27], electromagnetic metamaterials [28–31] and photonic crystals [32–34]. The past research has demonstrated that topology optimization methods possess a powerful capability to find novel designs with extreme or exotic properties which were hardly obtained from physical intuitions.

In order to create novel photonic crystals with broad AANR frequency range, this paper proposes a new topology optimization algorithm based on BESO. The fundamental idea of BESO is to remove low-efficiency materials from and add high-efficiency materials to the design domain simultaneously. Thus, the resulting topology of a structure evolves to an optimum. Although BESO was established based on this simple concept, it has been proven to be effective and reliable for various structural optimization problems [35–37]. In recent years, the BESO algorithm has been further extended to design the microstructures of materials with extreme mechanical properties [38,39], electromagnetic properties [30], and photonic crystals with large band gaps [40].

This paper is organized as follows. Section 2 describes the mechanism of AANR in two-dimensional dielectric photonic crystals and the calculation of AANR frequency range. Section 3 introduces the finite element analysis formulation which is used to calculate the equi-frequency contours of the photonic crystal. Section 4 depicts the optimization problem, sensitivity analysis and the implement of BESO method. Numerical results are presented and discussed in Section 5. Finally, some conclusions are drawn in Section 6.

Negative refraction of electromagnetic waves for metamaterials requires its effective permittivity and permeability to be negative simultaneously. However, the mechanism of negative refraction for photonic crystals is totally different. It arises due to the dispersion characteristics of waves in a periodic medium. The band diagram along the boundary of the irreducible Brillouin zone and the equi-frequency contours (EFC) in k-space can be employed to identify the possibility of AANR. AANR in a photonic crystal may happen in different frequency ranges, but AANR at lower frequencies is more meaningful in superlensing, because high order diffractions can be suppressed and all the optical energy is negatively refracted [12,41]. Therefore, this paper focuses on the AANR on the first photonic band.

To illustrate the mechanism of AANR on the first band, an example from Ref. [12] is demonstrated in 
                     Fig. 1. The two-dimensional square-lattice photonic crystal is composed of air holes in dielectric materials with a relative permittivity of 12. As shown in Fig. 1(a), the lattice constant is a, and the radius of air holes are 0.35a. The normal of the air-photonic crystal surface is arranged to be parallel to the Γ–M direction. The EFC of the first TE band is shown in Fig. 1(b). For wave vectors k on the Γ–M edge, the eigenfrequency increases monotonically, while the curvature of the equal-frequency contours gradually changes from concave to convex. As demonstrated in Fig. 1(c), for an incident beam from air with frequency ω, wave vector k
                     1 and group velocity 
                        v
                     
                     g1, if there is a convex EFC on the first band of photonic crystal and the contour intersects with the surface normal, a negative refracted beam with wave vector k
                     2 and group velocity 
                        v
                     
                     g2 will arise.

The AANR frequency range is illustrated in 
                     Fig. 2. The black curve is the first photonic band in Γ-M direction and the red line is the light line ω=ck which is shifted to M point [10]. The modes at the first photonic band below the light line can exist and propagate inside photonic crystals to generate negative refraction. Light above the light line cannot be confined in photonic crystals thus the upper limit of AANR ω
                     
                        u
                      can be obtained by finding the intersection of light line and the first band. The corresponding frequency of the intersection is the upper limit, ω
                     
                        u
                     , of the AANR frequency range. The relationship between the radius of EFC curvature and wave number |k| along Γ–M is the blue curve depicted in Fig. 2. As illustrated in [10], AANR can only be generated when EFC curvature becomes convex. The lower limit, ω
                     
                        l
                     , of AANR is therefore determined by the point where the concave EFC changes to a convex one. In other words, the radius of EFC curvature changes from a positive infinity to a negative infinity at the lower limit ω
                     
                        l
                      of AANR frequency range. An incident light from any angle within the range between ω
                     
                        u
                      and ω
                     
                        l
                      will result in a negative refraction beam.

To identify the lower and upper limit of AANR frequency range, the first photonic band and the radius of EFC curvature along Γ-M should be obtained. In this paper, they are calculated by using the finite element method.

The propagation of light in a photonic crystal is governed by the macroscopic Maxwell׳s equations [10]. For 2D photonic crystals, there are two possible polarizations of electromagnetic fields, named TM (transverse magnetic) modes, in which the electric field E=(0, 0, E(k, r)) is perpendicular to the lattice plane, and TE (transverse electric) modes, in which the magnetic field H=(0, 0, H(k, r)) is perpendicular to the lattice plane. k=(k
                     x, k
                     y) is the wave vector and r=(x, y) denotes the coordinates in the plane of unit cell. When there are no point sources or sinks of electric and magnetic fields, the Maxwell equations can be reduced to two decoupled equations as
                        
                           (1a)
                           
                              
                                 −
                                 ∇
                                 ⋅
                                 
                                    (
                                    
                                       ∇
                                       E
                                       
                                          (
                                          
                                             k
                                             ,
                                             r
                                          
                                          )
                                       
                                    
                                    )
                                 
                                 =
                                 ε
                                 
                                    (
                                    r
                                    )
                                 
                                 
                                    
                                       (
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                c
                                             
                                          
                                       
                                       )
                                    
                                    2
                                 
                                 E
                                 
                                    (
                                    
                                       k
                                       ,
                                       r
                                    
                                    )
                                 
                                 
                                 for
                                 
                                 TM
                                 
                                 modes
                              
                           
                        
                     
                     
                        
                           (1b)
                           
                              
                                 −
                                 ∇
                                 ⋅
                                 
                                    (
                                    
                                       
                                          1
                                          
                                             ε
                                             
                                                (
                                                r
                                                )
                                             
                                          
                                       
                                       ∇
                                       H
                                       
                                          (
                                          
                                             k
                                             ,
                                             r
                                          
                                          )
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                c
                                             
                                          
                                       
                                       )
                                    
                                    2
                                 
                                 H
                                 
                                    (
                                    
                                       k
                                       ,
                                       r
                                    
                                    )
                                 
                                 
                                 for
                                 
                                 TE
                                 
                                 modes
                              
                           
                        
                     where c is the speed of light, ε(r) is the dielectric function which illustrate the structure of photonic crystal. The dielectric function satisfies ε(r)=ε(r+R), E(k, r)=E(k, r+R) and H(k, r)=E(k, r+R) because of the periodicity of the crystal, where R is the lattice translation vector. According to the Bloch–Floquet theory [42], magnetic and electric fields can be represented as the product of a periodic function and an exponential factor as
                        
                           (2a)
                           
                              
                                 E
                                 
                                    (
                                    
                                       k
                                       ,
                                       r
                                    
                                    )
                                 
                                 =
                                 E
                                 
                                    (
                                    r
                                    )
                                 
                                 ⋅
                                 exp
                                 
                                    (
                                    
                                       i
                                       k
                                       ⋅
                                       r
                                    
                                    )
                                 
                                 
                                 for
                                 
                                 TM
                                 
                                 modes
                              
                           
                        
                     
                     
                        
                           (2b)
                           
                              
                                 H
                                 
                                    (
                                    
                                       k
                                       ,
                                       r
                                    
                                    )
                                 
                                 =
                                 H
                                 
                                    (
                                    r
                                    )
                                 
                                 ⋅
                                 exp
                                 
                                    (
                                    
                                       i
                                       k
                                       ⋅
                                       r
                                    
                                    )
                                 
                                 
                                 for
                                 
                                 TE
                                 
                                 modes
                              
                           
                        
                     
                  

Thus, the governing equations can be converted to eigenvalue problems within a unit cell as
                        
                           (3a)
                           
                              
                                 −
                                 
                                    (
                                    
                                       ∇
                                       +
                                       i
                                       k
                                    
                                    )
                                 
                                 ⋅
                                 
                                    (
                                    
                                       
                                          (
                                          
                                             ∇
                                             +
                                             i
                                             k
                                          
                                          )
                                       
                                       E
                                       
                                          (
                                          r
                                          )
                                       
                                    
                                    )
                                 
                                 =
                                 ε
                                 
                                    
                                       (
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                c
                                             
                                          
                                       
                                       )
                                    
                                    2
                                 
                                 E
                                 
                                    (
                                    r
                                    )
                                 
                                 
                                 for
                                 
                                 TM
                                 
                                 modes
                              
                           
                        
                     
                     
                        
                           (3b)
                           
                              
                                 −
                                 
                                    (
                                    
                                       ∇
                                       +
                                       i
                                       k
                                    
                                    )
                                 
                                 ⋅
                                 
                                    (
                                    
                                       
                                          1
                                          
                                             ε
                                          
                                       
                                       
                                          (
                                          
                                             ∇
                                             +
                                             i
                                             k
                                          
                                          )
                                       
                                       H
                                       
                                          (
                                          r
                                          )
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                c
                                             
                                          
                                       
                                       )
                                    
                                    2
                                 
                                 H
                                 
                                    (
                                    r
                                    )
                                 
                                 
                                 for
                                 
                                 TE
                                 
                                 modes
                              
                           
                        
                     
                  

For a given wave vector k=(k
                     x, k
                     y), Eqs. (3a) and (3b) are typical eigenvalue problems and can be solved by finite element method. Multiplying an arbitrary test function on both side and taking the integral over the unit cell lead to their weak forms as
                        
                           (4a)
                           
                              
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    [
                                    
                                       v
                                       
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   2
                                                
                                             
                                             E
                                             
                                                (
                                                
                                                   r
                                                
                                                )
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       +
                                       v
                                       
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   2
                                                
                                             
                                             E
                                             
                                                (
                                                
                                                   r
                                                
                                                )
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       +
                                       v
                                       
                                          
                                             ∂
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       
                                          (
                                          
                                             i
                                             
                                                
                                                   k
                                                
                                                
                                                   x
                                                
                                             
                                             E
                                             
                                                (
                                                
                                                   r
                                                
                                                )
                                             
                                          
                                          )
                                       
                                       +
                                       v
                                       
                                          
                                             ∂
                                          
                                          
                                             ∂
                                             y
                                          
                                       
                                       
                                          (
                                          
                                             i
                                             
                                                
                                                   k
                                                
                                                
                                                   y
                                                
                                             
                                             E
                                             
                                                (
                                                
                                                   r
                                                
                                                )
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       +
                                       i
                                       
                                          
                                             k
                                          
                                          
                                             x
                                          
                                       
                                       v
                                       
                                          
                                             ∂
                                             E
                                             
                                                (
                                                
                                                   r
                                                
                                                )
                                             
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       +
                                       i
                                       
                                          
                                             k
                                          
                                          
                                             y
                                          
                                       
                                       v
                                       
                                          
                                             ∂
                                             E
                                             
                                                (
                                                
                                                   r
                                                
                                                )
                                             
                                          
                                          
                                             ∂
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       v
                                       E
                                       
                                          (
                                          
                                             r
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       v
                                       ϵ
                                       E
                                       
                                          (
                                          
                                             r
                                          
                                          )
                                       
                                    
                                    ]
                                 
                                 d
                                 Ω
                                 =
                                 0
                              
                           
                        
                     
                     
                        
                           (4b)
                           
                              
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    [
                                    
                                       v
                                       
                                          
                                             ∂
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   ϵ
                                                
                                             
                                             
                                                
                                                   ∂
                                                   H
                                                   
                                                      (
                                                      
                                                         r
                                                      
                                                      )
                                                   
                                                
                                                
                                                   ∂
                                                   x
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       v
                                       
                                          
                                             ∂
                                          
                                          
                                             ∂
                                             y
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   ϵ
                                                
                                             
                                             
                                                
                                                   ∂
                                                   H
                                                   
                                                      (
                                                      
                                                         r
                                                      
                                                      )
                                                   
                                                
                                                
                                                   ∂
                                                   y
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       v
                                       
                                          
                                             ∂
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   ϵ
                                                
                                             
                                             i
                                             
                                                
                                                   k
                                                
                                                
                                                   x
                                                
                                             
                                             H
                                             
                                                (
                                                
                                                   r
                                                
                                                )
                                             
                                          
                                          )
                                       
                                       +
                                       v
                                       
                                          
                                             ∂
                                          
                                          
                                             ∂
                                             y
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   ϵ
                                                
                                             
                                             i
                                             
                                                
                                                   k
                                                
                                                
                                                   y
                                                
                                             
                                             H
                                             
                                                (
                                                
                                                   r
                                                
                                                )
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       +
                                       i
                                       
                                          
                                             k
                                          
                                          
                                             x
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             ϵ
                                          
                                       
                                       v
                                       
                                          
                                             ∂
                                             H
                                             
                                                (
                                                
                                                   r
                                                
                                                )
                                             
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       +
                                       i
                                       
                                          
                                             k
                                          
                                          
                                             y
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             ϵ
                                          
                                       
                                       v
                                       
                                          
                                             ∂
                                             H
                                             
                                                (
                                                
                                                   r
                                                
                                                )
                                             
                                          
                                          
                                             ∂
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             ϵ
                                          
                                       
                                       v
                                       H
                                       
                                          (
                                          
                                             r
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       v
                                       H
                                       
                                          (
                                          
                                             r
                                          
                                          )
                                       
                                    
                                    ]
                                 
                                 d
                                 Ω
                                 =
                                 0
                              
                           
                        
                     where v is the test function, Ω is the region of the unit cell. By discretizing the unit cell with 4-node square elements, Eqs. (4a) and (4b) can be written in the matrix format as
                        
                           (5)
                           
                              
                                 [
                                 
                                    K
                                    −
                                    
                                       
                                          (
                                          
                                             
                                                ω
                                                c
                                             
                                          
                                          )
                                       
                                       2
                                    
                                    M
                                 
                                 ]
                              
                              u
                              =
                              0
                           
                        
                     where 
                        
                           K
                           ≡
                           ∑
                           
                              
                                 
                                    K
                                 
                                 
                                    e
                                 
                              
                           
                        
                     , 
                        
                           M
                           ≡
                           ∑
                           
                              
                                 
                                    ε
                                 
                                 
                                    e
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    e
                                 
                              
                           
                        
                      and 
                        
                           u
                           ≡
                           E
                        
                      for TM modes, and 
                        
                           K
                           ≡
                           ∑
                           
                              
                                 1
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    e
                                 
                              
                           
                        
                     , 
                        
                           M
                           ≡
                           ∑
                           
                              
                                 
                                    M
                                 
                                 
                                    e
                                 
                              
                           
                        
                      and 
                        
                           u
                           ≡
                           H
                        
                      for TE modes, respectively. 
                        
                           
                              K
                           
                           
                              e
                           
                        
                      and 
                        
                           
                              M
                           
                           
                              e
                           
                        
                      denote the elemental stiffness and mass matrices.

In order to determine a proper finite element mesh size, the photonic band and radius of EFC curvature of a simple structure at different mesh size are calculated and compared. As shown in 
                     Figs. 3(a) and 
                     4(a), the micro structure within a unit cell is a dielectric square column in air for TM modes and a square frame for TE modes. The relative permittivity of the dielectric material is 18. The unit cell is meshed uniformly by 16×16, 32×32, 64×64 and 128×128 square elements, respectively. Following the proposed FEA method, the corresponding photonic band and radius of EFC curvature are calculated and depicted in Figs. 3(b) and 4(b). The results indicate that, apart from the coarse mesh with 16×16, other meshes give the nearly identical results for both TM and TE modes. Therefore, the 64×64 mesh has sufficient accuracy and will be adopt in the following optimization.

The aim of this paper is to design dielectric photonic crystals with a broad AANR frequency range. Due to the lack of fundamental length scale in Maxwell׳s equation, the AANR frequency range can be measured by the non-dimensional ratio between the difference of upper limit ω
                        u and lower limit ω
                        l and the mean value of them. Thus, the objective function of the present optimization problem can be expressed as
                           
                              (6)
                              
                                 
                                    Maximize
                                    
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                u
                                             
                                          
                                          −
                                          
                                             
                                                ω
                                             
                                             
                                                l
                                             
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      u
                                                   
                                                
                                                +
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      l
                                                   
                                                
                                             
                                             )
                                          
                                          /
                                          2
                                       
                                    
                                 
                              
                           
                        
                     

Although the above objective function has a clear physical meaning, it is hardly to formulate ω
                        u or ω
                        l mathematically. An alternative way can be developed to overcome this issue. It is noted that an initial guess design may not have AANR, which means ω
                        l might be larger than ω
                        u. Even so, both ω
                        u and ω
                        l can be easily determined following the procedure described in Section 2. A reference point on the first band just right to the lower limit ω
                        l as shown in Fig. 2 is selected, and then the radius of EFC curvature at the reference point is maximized. Consequently, the lower limit ω
                        l will be moved toward the reference point. As this process is repeated step by step and the lower limit ω
                        l will be gradually moved toward to the Γ point. As ω
                        u is determined by the constant light line, the decrease of ω
                        l is equivalent to enlarge the AANR frequency range. In this paper, the normalized wave vector 
                           
                              |
                              k
                              |
                           
                           a
                           /
                           2
                           π
                         of the reference point is set to be 
                           
                              
                                 2
                              
                              /
                              20
                           
                         smaller than that of the lower limit. During the optimization process, the reference point updates iteratively with the change of lower limit.

To calculate the EFC, it is necessary to calculate the first eigenfrequency, 
                           ω
                        , for various wave vectors k=(k
                        x, k
                        y) within the irreducible Brillouin zone. In this paper, the irreducible Brillouin zone is divide by 100×100 square grids and the first eigenfrequencies at grid points are calculated numerically. This is illustrated by 
                        Fig. 5 with a coarse grid. The radius of EFC curvature can be defined with
                           
                              (7)
                              
                                 
                                    R
                                    =
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         ′
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         ′
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                3
                                                /
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                f
                                             
                                             
                                                x
                                                x
                                             
                                             
                                                ″
                                             
                                          
                                          ⋅
                                          
                                             
                                                f
                                             
                                             
                                                y
                                             
                                             
                                                ′
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                f
                                             
                                             
                                                y
                                                y
                                             
                                             
                                                ″
                                             
                                          
                                          ⋅
                                          
                                             
                                                f
                                             
                                             
                                                x
                                             
                                             
                                                ′
                                                2
                                             
                                          
                                          −
                                          2
                                          ⋅
                                          
                                             
                                                f
                                             
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                          ⋅
                                          
                                             
                                                f
                                             
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                          ⋅
                                          
                                             
                                                f
                                             
                                             
                                                x
                                                y
                                             
                                             
                                                ″
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    f
                                 
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    ∂
                                    ω
                                 
                                 
                                    ∂
                                    
                                       
                                          k
                                       
                                       
                                          x
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    y
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    ∂
                                    ω
                                 
                                 
                                    ∂
                                    
                                       
                                          k
                                       
                                       
                                          y
                                       
                                    
                                 
                              
                           
                        . 
                           
                              
                                 f
                              
                              
                                 x
                                 x
                              
                              
                                 ″
                              
                           
                        , 
                           
                              
                                 f
                              
                              
                                 y
                                 y
                              
                              
                                 ″
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 x
                                 y
                              
                              
                                 ″
                              
                           
                         are the second-order partial derivatives. Those derivatives will be calculated by using the finite difference method.

Due to the symmetry of EFC, only the first eigenfrequencies at the points on Γ–M boundary and two adjacent parallel rows as shown in Fig. 5 will be used to calculate the first- and second-order partial derivatives. Considering Δk
                        x=Δk
                        y, the first partial derivatives of an eigenfrequency, e.g. at point 1, can be expressed by
                           
                              (8)
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          y
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                4
                                             
                                          
                                          −
                                          
                                             
                                                ω
                                             
                                             
                                                5
                                             
                                          
                                       
                                       
                                          2
                                          ⋅
                                          
                                             Δ
                                          
                                          
                                             
                                                k
                                             
                                             
                                                x
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Similarly, the second order partial derivatives are
                           
                              (9)
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          x
                                          x
                                       
                                       
                                          ″
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          y
                                          y
                                       
                                       
                                          ″
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                6
                                             
                                          
                                          −
                                          
                                             
                                                ω
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                ω
                                             
                                             
                                                8
                                             
                                          
                                          −
                                          
                                             
                                                ω
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          4
                                          ⋅
                                          
                                             
                                                (
                                                
                                                   
                                                      Δ
                                                   
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                    
                                       and
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          x
                                          y
                                       
                                       
                                          ″
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                ω
                                             
                                             
                                                7
                                             
                                          
                                          +
                                          
                                             
                                                ω
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                ω
                                             
                                             
                                                7
                                             
                                          
                                       
                                       
                                          4
                                          ⋅
                                          
                                             
                                                (
                                                
                                                   
                                                      Δ
                                                   
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In summary, the present objective of the optimization problem is modified by maximizing the radius of EFC curvature at the reference point as
                           
                              (10)
                              
                                 
                                    Maximize
                                    
                                    R
                                    =
                                    
                                       
                                          
                                             2
                                          
                                          
                                             
                                                f
                                             
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                f
                                             
                                             
                                                x
                                                x
                                             
                                             
                                                ″
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                x
                                                y
                                             
                                             
                                                ″
                                             
                                          
                                       
                                    
                                    
                                    at
                                    
                                    the
                                    
                                    reference
                                    
                                    point
                                 
                              
                           
                        
                     

After the finite element discretization, the topology of the unit cell is represented by assigning each element a design variable which is related to the property of this element. The photonic crystals in this paper are composed of two materials with permittivity ε
                        1 and ε
                        2 (where ε
                        1<ε
                        2), respectively. A design variable x
                        e are constructed by assuming its corresponding element e is composed of material 1 with low permittivity ε
                        1 when x
                        e=0, and material 2 with high permittivity ε
                        2 when x
                        e=1. In the optimization process, the evolution of topology is reflected by the change of design variables, which is updated iteratively based on the elemental sensitivity numbers. Sensitivity numbers denote the relative ranking of elemental sensitivities which is the derivative of the objective function with regard to a design variable. The present objective is to maximize the radius of EFC curvature at the reference point as described in Section 4.1. Therefore, the sensitivity number α
                        
                           e
                         for element e can be defined according to the chain rule as
                           
                              (11)
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          ∂
                                          R
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                i
                                             
                                             =
                                             3
                                             ,
                                             6
                                          
                                       
                                       
                                          
                                             
                                                ∂
                                                R
                                             
                                             
                                                ∂
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ⋅
                                          
                                             
                                                ∂
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ⋅
                                          
                                             
                                                ∂
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      e
                                                   
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                i
                                             
                                             =
                                             1
                                             ,
                                             5
                                             ,
                                             7
                                          
                                       
                                       
                                          
                                             
                                                ∂
                                                R
                                             
                                             
                                                ∂
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                          
                                          ⋅
                                          
                                             
                                                ∂
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ⋅
                                          
                                             
                                                ∂
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      e
                                                   
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                i
                                             
                                             =
                                             2
                                             ,
                                             4
                                             ,
                                             8
                                          
                                       
                                       
                                          
                                             
                                                ∂
                                                R
                                             
                                             
                                                ∂
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                          
                                          ⋅
                                          
                                             
                                                ∂
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      ″
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ⋅
                                          
                                             
                                                ∂
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      e
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For any grid point, i, within the irreducible Brillouin zone, it corresponds to the wave vector k
                        i, the first eigenfrequency ω
                        i and eigenvector u
                        i. According to Eq. (5), the derivative of ω
                        i with regard to x
                        e can be easily calculated by
                           
                              (12)
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ∂
                                                
                                                   K
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      e
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ∂
                                                
                                                   M
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      e
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                     

In this paper, as the same as the band gap optimization of photonic crystals [40], a linear interpolation scheme is used for TM modes and an inverse linear material interpolation is adopted For TE modes:
                           
                              (13a)
                              
                                 
                                    ϵ
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          e
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          ϵ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          1
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ϵ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          e
                                       
                                    
                                    
                                    
                                       for
                                    
                                    
                                    
                                       TM
                                    
                                    
                                    
                                       modes
                                    
                                 
                              
                           
                        
                        
                           
                              (13b)
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          ϵ
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                ϵ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          1
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                ϵ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          e
                                       
                                    
                                    
                                    
                                       for
                                    
                                    
                                    
                                       TE
                                    
                                    
                                    
                                       modes
                                    
                                 
                              
                           
                        
                     

Based on the material interpolation functions, the derivatives of matrices K and M to x
                        e For TM modes and TE modes can be obtained:
                           
                              (14a)
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             K
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                       
                                    
                                    =
                                    0
                                    
                                    
                                       and
                                    
                                    
                                    
                                       
                                          ∂
                                          
                                             M
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                ϵ
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                ϵ
                                             
                                             
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          M
                                       
                                       
                                          e
                                       
                                    
                                    
                                    
                                       for
                                    
                                    
                                    
                                       TM
                                    
                                    
                                    
                                       modes
                                    
                                 
                              
                           
                        
                        
                           
                              (14b)
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             K
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          K
                                       
                                       
                                          e
                                       
                                    
                                    
                                    
                                       and
                                    
                                    
                                    
                                       
                                          ∂
                                          
                                             M
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                       
                                    
                                    =
                                    0
                                    
                                    
                                       for
                                    
                                    
                                    
                                       TE
                                    
                                    
                                    
                                       modes
                                    
                                 
                              
                           
                        
                     

Afterwards, in order to improve the stability and convergence of optimization process, elemental sensitivity numbers except for that of the first iteration are averaged with their historical information as
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                α
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          e
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                e
                                             
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                α
                                             
                                             
                                                e
                                             
                                             
                                                k
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where k is the current iteration number.

After obtaining the sensitivity number of every element, BESO will increase design variables for elements with highest sensitivity numbers and decrease design variables for elements with lowest sensitivity numbers simultaneously to maximize the radius of the EFC curvature at the reference point. Different from other topology optimization problems, e.g. maximizing stiffness of a structure with a given volume constraint, the optimization of photonic crystals for AANR has no volume constraint. Numerical analysis indicates that the optimal volume fraction of photonic crystals for AANR is normally around 50%. In order to accelerate the search process, BESO starts from an initial design which is almost full of material 2 and gradually decreases the volume fraction until V
                        f reaches a prescribed target, 
                           
                              
                                 
                                    V
                                 
                                 
                                    f
                                 
                                 
                                    *
                                 
                              
                           
                         as
                           
                              (16)
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          f
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          V
                                       
                                       
                                          f
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          1
                                          −
                                          E
                                          R
                                       
                                       )
                                    
                                    
                                    when
                                    
                                    
                                       
                                          V
                                       
                                       
                                          f
                                       
                                       
                                          k
                                       
                                    
                                    >
                                    
                                       
                                          V
                                       
                                       
                                          f
                                       
                                       
                                          *
                                       
                                    
                                 
                              
                           
                        where ER is the evolution rate, ER = 0.5%. 
                           
                              
                                 
                                    V
                                 
                                 
                                    f
                                 
                                 
                                    *
                                 
                              
                              =
                              50
                              %
                           
                         is selected arbitrarily. Thereafter, the evolution of volume fraction will determined by the variation history of the fractional AANR frequency range, F, as
                           
                              (17)
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          f
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          V
                                       
                                       
                                          f
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          1
                                          +
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            k
                                                            −
                                                            2
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ⋅
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            f
                                                         
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            f
                                                         
                                                         
                                                            k
                                                            −
                                                            2
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            k
                                                            −
                                                            2
                                                         
                                                      
                                                   
                                                   |
                                                
                                                ⋅
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            f
                                                         
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            f
                                                         
                                                         
                                                            k
                                                            −
                                                            2
                                                         
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                          E
                                          R
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

As a result, the volume fraction may continue to decrease or increase gradually. When the AANR frequency range achieves its maximum value, the volume fraction would fluctuate around a constant. In the final stage, the volume fraction will keep to be the constant until the topology is stably convergent.

BESO therefore updates the design variables according to the relative ranking of sensitivity numbers and the volume fraction of the next iteration. The details of the BESO algorithm can also refer to the references [23,24]. The traditional BESO method uses the binary design variable x
                        e=0 or 1 only. However, numerical experience indicates that the design of photonic band gap crystals is very sensitive to the change of the design variables [40]. For the sake of caution, the design variable is assigned with discrete intermediate design values between 0 and 1 with a constant step size Δx
                        e. The update scheme of the design variable of each element follows the following criterion
                           
                              (18)
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          e
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         Δ
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            e
                                                         
                                                      
                                                      ,
                                                      
                                                      1
                                                      )
                                                      ,
                                                      
                                                      
                                                         
                                                            if
                                                         
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      >
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            t
                                                            h
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      max
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         Δ
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            e
                                                         
                                                      
                                                      ,
                                                      
                                                      0
                                                      )
                                                      ,
                                                      
                                                      
                                                         if
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      <
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            t
                                                            h
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where Δx
                        e=0.1 throughout the paper, which means the possible variation of the design variable in each iteration is limited to 0.1. 
                           
                              
                                 α
                              
                              
                                 t
                                 h
                              
                              
                                 k
                              
                           
                         is the sensitivity threshold for the kth iteration determined by 
                           
                              
                                 
                                    α
                                    ^
                                 
                              
                              
                                 e
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 f
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        . Although discrete intermediate design variables are involved in the optimization, the final design tends to a clear 0/1 design because a larger permittivity contrast leads to a larger AANR frequency range.


                        
                        Fig. 6 illustrate the proposed BESO procedure for the design of AANR photonic crystals.

In this paper, photonic crystals for TM and TE modes are analyzed and optimized for AANR property independently. A square lattice with lattice constant a=1 is considered. The photonic crystals are composed of two materials: low permittivity material 1, ε
                        1=1 (air) and high permittivity material 2, ε
                        2=18 (Ge at 1.55µm). The unit cell is meshed with 64×64 bilinear square elements and plotted as greyscale images to illustrate the topologies of photonic crystals. White and black areas denote materials 1 and 2, respectively, while grey areas denote the transitional elements with permittivity between ε
                        1 and ε
                        2 in the optimization process. The optimization process starts from an initial design which fully consists of material 2 except that a circular with a radius of 0.1 in the center is material 1, as shown in the inset of 
                        Fig. 7.


                        Fig. 7(a) and (b) presents the evolution histories of AANR frequency range, volume fraction and topology of the unit cell during the optimization process of photonic crystals for TM and TE modes, respectively. It can be seen that the fractional frequency ranges of the initial guess design are −13.78% for TM mode and −17.89% for TE mode, which means the initial design has no AANR property. BESO redistributes the constituent materials within the unit cell step by step so that the AANR frequency range gradually increases. Meanwhile, the volume fraction of material 2 reduces to the target volume fraction and then fluctuates up and down till an optimal one around the target volume fraction is obtained. Both the AANR frequency range and topologies are stably converged after 199 and 229 iterations for TE and TM modes, respectively.

The optimized designs with 3×3 unit cells for TM and TE modes and their corresponding band diagrams with indicated AANR frequency range are shown in 
                        Fig. 8. The optimized topology for TM modes shows that the high permittivity materials are separated by the air. The maximized AANR range is 2.56% and the optimal volume fraction of material 2 is 40.8%. On the contrary, the optimized topology for TE modes shows that the high permittivity material is connected and forms the hollow square with inner “comb” corners as shown in Fig. 8(b). The corresponding AANR frequency range is 14.08% and the optimal volume fraction of material 2 is 50.98%.

Surprisingly, the distribution characteristics of constituent materials for AANR of TM and TE modes are similar to those for the formation of the first TM and TE band gap [40] although the band gap has not been considered in the proposed optimization algorithm. Luo et. al. [12] has demonstrated photonic band gap crystals with AANR property, and their intuitive designs with 3×3 unit cells are shown in 
                        Fig. 9 for comparison. It shows the current optimized designs have larger AANR frequency ranges for both TM and TE modes. Numerical calculations indicate that the current AANR frequency ranges are 115% larger than that of the intuitive design for TE mode ε
                        2=12, and 24% larger for TM mode when ε
                        2=18.

Our numerical experiments also indicate that the optimized topology is independent on the permittivity contrast of the constitutive materials except for the magnitude of the AANR frequency range. Fig. 9 also shows the variation of fractional AANR frequency range against the permittivity contrast of the constitutive materials. Similar to the conclusion of Luo et al. [12], optimized AANR frequency range reduce monotonically with the decrease of permittivity contrast. The smallest permittivity contrast for a 2D square-lattice photonic crystal having AANR is about 8.6 for TE mode, and 13.4 for TM mode.

For topology optimization of continuum structures, the resulting designs may contain tiny features and more holes when a fine mesh is used and this phenomenon is called the mesh-dependent problem. In essence, topology optimization of elastic continuum structures lacks the existence of solutions and therefore produces the dependence of numerical solutions on mesh-refinement [24]. It is necessary to investigate the effect of mesh-refinement in electromagnetic optimization problems. 
                        
                        Figs. 10 and 11 show the optimized topologies by using various meshes for TM and TE modes, respectively. For TM modes, the optimized topologies do not depend on the assigned meshes except that a fine mesh gives smoother boundaries as shown in Fig. 10, and the final fractional AANR frequency ranges are 1.75%, 2.39%, 2.56% and 2.60%, respectively. For TE modes, optimized topologies for meshes 32×32, 64×64, 128×128 are very similar except for the number of “comb” tooth. For the coarsest mesh 16×16, its optimized topology is hardly to form the inside “comb” structure which is replaced with some “grey” elements as shown in Fig. 11(a). Their fractional AANR frequency ranges are 11.59%, 13.20%, 14.08% and 14.09%, respectively. Similar to the design of elastic structures, the mesh-refinement improves the numerical solution of the objective function. However, it should be noted that for the design of AANR photonic crystal, the mesh-refinement generally provides smoother boundaries rather than different topologies such as with more holes which normally occurs in the design of elastic continuums.

It is observed that the optimized topology for TE mode as shown in Fig. 8(b) contains some inside “comb” teeth which might be difficultly manufactured. To overcome this problem, similar to the topology optimization of elastic structures, the heuristic filter scheme with little computational effort can be integrated into the optimization algorithm. The filter scheme for the BESO method can refer to the reference [40]. 
                        Fig. 12 shows the resulting topologies by using various filter radii. It can be observed that the number of “comb” teeth reduces but do not totally disappear when r
                        min=0.025a, 0.05a and 0.075a. When the filter radius increases to 0.1a, the “comb” teeth are successfully eliminated as shown in Fig. 12(d). Its fractional AANR frequency range is 13.81% which is slightly smaller than that of the optimized design in Fig. 8(b) without using the filter. However, the optimized design shown in Fig. 12(d) may be more practical and easily manufactured compared with the complicate topology shown in Fig. 8(b).

In the proposed BESO method, the step size Δx
                        e=0.1 is used and some artificial intermediate elements are introduced. Due to the fact that a larger permittivity contrast leads to a larger AANR frequency range, the obtained topologies are close to 0/1 designs. It is curious to test the traditional BESO method with the step size Δx
                        e=1. The design variables in the traditional BESO method can only be 0 or 1 so that there are no “grey” elements in the designs, which provide the more clear topologies. In order to investigate the viability of traditional BESO method, the TM and TE modes are optimized respectively. Except for the difference in the step size, the other parameters are the same to those that used in Section 5.1.


                        
                        Fig. 13 shows the optimized designs for TM and TE modes using the traditional BESO method. For TM mode, the optimized solution is almost identical to that shown in Fig. 8(a). For TE mode, the optimized solution contains some subtle structures and checkerboard area. Its fractional AANR frequency range is 13.59% which is a little narrower than that of Fig. 8(b), 14.08%. This difference may attribute to that the intermediate elements in the proposed BESO method can partly compensate the inaccuracy of zig-zag boundaries from the traditional BESO method. Generally speaking, there is no significant difference between those two designs.

This conclusion can be further confirmed when the filter scheme is applied for the traditional BESO method. The optimized topologies of TE modes with various filter radii are shown in 
                        Fig. 14. With the increase of filter radius, the subtle structure gradually disappears and the resulting optimized topologies have less zig-zag boundaries. As a result, both the optimized topologies and its fractional AANR frequency range tend to be the same to those shown in Fig. 12. In such cases, the step size, Δx
                        e, almost has no significant effect on the optimization solution.

@&#CONCLUSIONS@&#

This paper develops a new topology optimization algorithm based on the BESO method to design photonic crystals with broad AANR frequency ranges for both TM and TE modes. The photonic crystals are assumed to be two-dimensional and made of dielectric materials and air. An objective function is put forward based on the definition of the upper limit and lower limit of the AANR range. Starting from a simple design without AANR, FEA and sensitivity analysis are carried out, and the optimization algorithm gradually evolves the structure of the unit cell to a design with desired AANR property. Numerical simulations show that the BESO algorithm is effective and applicable. The resulting novel patterns have larger AANR frequency range than the intuitive designs. The results indicate that the smallest permittivity contrast for a 2D square-lattice photonic crystal having AANR is about 8.6 for TE mode, and 13.4 for TM mode. Mesh-refinement generally generates smoother boundary of the optimized design so as to enlarge the fractional AANR frequency range. Furthermore, the filter scheme can be used to improve the manufacturability of the optimized design for TE mode. Since the principle of AANR for 3D photonic crystals and their equal-frequency contours become extremely complicated, further work on topology optimization of 3D photonic crystals with AANR is recommended.

@&#ACKNOWLEDGMENT@&#

The authors wish to acknowledge the financial support from the Australian Research Council (FT130101094) and the China Scholarship Council.

@&#REFERENCES@&#

