@&#MAIN-TITLE@&#A new method for QRS complex detection in multichannel ECG: Application to self-monitoring of fetal health

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Novel unsupervised approach for enhanced QRS signal extraction from multichannel ECG.


                        
                        
                           
                           Application to fetal QRS detection from abdominal recordings.


                        
                        
                           
                           The method exploits the pseudo-periodicity of maternal and fetal QRS.


                        
                        
                           
                           Overcomes the limitation of methods based on the independence of signal sources.


                        
                        
                           
                           The approach foresees the application to self-monitoring of fetal in pregnant women.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Fetal QRS detection

Multichannel ECG processing

Self-monitoring

Fetal electrocardiography

Optimization

Nelder–Mead simplex

Independent component analysis (ICA)

@&#ABSTRACT@&#


                  This paper proposes a new approach for QRS complex detection in multichannel ECG and presents its application to fetal QRS (fQRS) detection in signals acquired from maternal abdominal leads. The method exploits the characteristics of pseudo-periodicity and time shape of QRS, it consists of devising a quality index (QI) which synthesizes these characteristics and of finding the linear combination of the acquired ECGs, which maximizes this QI. In the application for fQRS detection two QIs are devised, one QI (mQI) for maternal ECG (mECG) and one QI (fQI) for fetal ECG (fECG). The method is completely unsupervised and based on the following steps: signal pre-processing; maternal QRS-enhanced signal extraction by finding the linear combination that maximize the mQI; detection of maternal QRSs; mECG component approximation and canceling by weighted Singular Value Decomposition (SVD); fQRS-enhanced signal extraction by finding the linear combination that maximize the fQI and fQRS detection. The proposed method was compared with our previously developed Independent Component Analysis (ICA) based method as well as with simple mECG canceling and simple ICA methods. The comparison was carried out by evaluating the performances of the procedures in fQRS detection. The new method outperformed the results of the other approaches on the annotated open set of the Computing in Cardiology Challenge 2013 database. The proposed method seems to be promising for its implementation on portable device and for use in self-monitoring of fetal health in pregnant women.
               

@&#INTRODUCTION@&#

Non-invasive acquisition of data from human body often provides signals containing components coming from different sources. In such cases, signal processing methods are exploited in order to separate the informative component from undesired ones.

The progress in micro electronic technology and the decreasing of its cost allow small devices to be available in the market, able to acquire and analyze multi-lead electrocardiograms (ECG) for cardiac self-monitoring [1]. These instruments can be connected to personal devices such as smart-phone, tablet or personal computers. Software applications (for Android/IOS or for PC operating systems) have been developed providing automatic ECG analysis and summary reports.

In a self-monitoring context great effort is required for separating and enhancing the informative component by signal processing methods. Sometimes the enhancement of the component of interest from a set of poor quality signals is addressed as a problem of blind source separation and independent component analysis (ICA) algorithms are applied. This paper proposes a new strategy for QRS detection based on the extraction of a QRS-enhanced signal from multichannel ECG. This strategy takes into account the specific time structure of the ECG (specifically the QRS) instead of the unspecific independence of sources [2]. The method consists of devising a quality index (QI), which exploits the characteristics of pseudo-periodicity and time shape of QRS, and finding the signal, linear combination of the acquired ECGs, which maximize this QI.

The power of this QI optimization (QIO) based method is shown by its application to the challenging task of fetal QRS (fQRS) detection in maternal abdominal ECGs. This could allow realizing an instrument aimed at self-monitoring of fetal health in pregnant women.

Actually, fetal electrocardiography raises a lot of interest because it can provide useful information about the physiological condition of the fetus. For example, particular patterns of fetal heart rate are closely related to fetal acidemia, the level changes of ST-segment are relevant in the diagnosis of fetal hypoxia while QT interval and T-wave changes are associated with fetal acidosis [3]. Moreover, some clinically significant cardiac events are rare and can be captured only by the long-term monitoring. Despite this potentiality, the use of fetal ECG (fECG) has been quite limited up to now, due to the difficulties in its non-invasive extraction. In fact, the fECG is commonly extracted from signals acquired non-invasively by using electrodes placed on the mother's abdomen. These signals are a mixture of several components and the fECG can be very weak. The main components are maternal ECG (mECG), fetal ECG (fECG) and various types of noise such as baseline wander, power line interference, electromyographic signal (EMG), contact electrode noise and artifacts. Several signal processing approaches for the detection of the fQRS from the composite abdominal ECG signals have been proposed in literature, which can be subset in three groups. The first group consists in methods that estimate the mECG component then subtract it from abdominal signal. The estimation of mECG is commonly performed by synchronous averaging [4,5], optimal/adaptive filtering [6,7], or subspace approximation of mother PQRST complexes (Principal Component analysis, PCA or Singular Value Decomposition, SVD) [8,9]. A second group includes approaches that attempt to separate the different components in the abdominal signals by using PCA (or SVD) [10,11] or ICA [12–14]. Finally the third group covers methods based on combination of mECG canceling and source separation [15–17]. The paper of Behar et al. [16] presents a benchmarking of several methods for fECG extraction through a comparison of their performance in fQRS detection. The Physionet/CinC Challenge 2013 provided a quite large dataset of fECG signals and gave the opportunity of developing advanced signal processing algorithms that overcome some of the limitations of the previous available methods [18]. The algorithms developed for the Challenge were reviewed and discussed in Clifford et al. [19]. Our team participated [20] at the Physionet/CinC Challenge 2013 obtaining the top official scores in the open source section. The method presented, described in details in Varanini et al. [15], was a fully automatic unsupervised procedure for the extraction of the fECG that integrated ICA and mECG cancellation. Despite the good performance achieved for most of the records on which the procedure was tested, in some of them ICA was not able to extract a sufficiently clean fECG. ICA sometimes fails in extracting fECG because of the limited number of abdominal derivations and because the presence of noise (myoelectric and contact loss) on each derivation makes the number of sources greater than the number of measured signals [5]. For this reason a strategy that a priori takes into account specific characteristics of the fECG and not only the unspecific independence of sources might be preferred [2]. In the method proposed in the present paper, two QIs, discriminating from noises the two components of interest (i.e. fECG and mECG) are devised. These indexes (fQI and mQI respectively) take into account the quasi periodicity, the time duration and the amplitude of the QRS complex waveform. Assuming that a maternal QRS-enhanced ECG signal (or a fetal QRS-enhanced ECG signal) can be approximately reconstructed as linear combination of n abdominal maternal leads, then the mQI (or the fQI) of such reconstructed signal is a multivariate function of the n coefficients of this combination. An optimization algorithm is used with the aim of finding the linear combination of abdominal signals, which maximizes this function. Since an analytic form of the derivative of such function is unavailable, a direct search method is required and the commonly used simplex-based optimization algorithm of Nelder and Mead [21] was adopted. This algorithm iteratively evolves n+1 points (simplex) on the n-dimensional space using four basic moves and among the other direct search methods has the advantages of being simple and fast, as well as of giving a good performance in many practical low dimensional applications [22].

To get a fair comparison between this new approach and our previous method, the algorithms based on the mQI and fQI maximization were implemented in two modules, which substitute the ICA ones in the procedure developed in Varanini et al. [15]. In the following the term “ICA-based” will be used to indicate the procedure developed for the Challenge 2013 and the term “QIO-based” to refer to the procedure using mQI and fQI maximization. It is worth noting that both the procedures also include mECG canceling.

The QIO-based method was evaluated on the same subset of open annotated records used in Varanini et al. [15]. Notably, the QIO-based method achieved quite a better performance in fQRS detection of that obtained using the criterion of independent sources.

The good performances achieved by the QIO-based method in detecting weak fetal QRSs using only four abdominal signals, together with it is unsupervised nature foresee its implementation on portable device and its applicability in self-monitoring of fetal health in pregnant women. However several challenges need to be taken into account when considering wearable applications in pregnant women.

Fetal ECG component in abdominal signals has very low voltage, thus the main challenge is to be able to detect fetal QRSs. A strength requirement is to get a good and stable skin-electrode contact. Adhesive gel electrodes generally produce better skin contacts than dry electrodes, but they should be replaced. Dry electrodes can be quite adequate but adding gel is advised. Moreover electrodes should be easy to apply and their number should be low to avoid fetal ECG monitoring to be uncomfortable.

A strict requirement in self-monitoring of fECG is also acquiring and processing many signals at high-frequency, with high precision and for long duration. The selection of state of the art electronic digital components, which provides powerful, light and low consumption instruments fulfilling this requirement, is an important point.

Finally the implementation of strategies for an automatic estimation of quantitative parameters for an objective evaluation of fetal health and for periodic transfer of data from the device to the hospital would reduce the number of hospital visits and significantly reduce costs.

The following section “Materials and methods” is organized as follows: the first and the second subsections describe the core components of the new method based on the extraction of a QRS-enhanced signal: the defined mQI and fQI and the Nelder–Mead optimization algorithm; the third subsection describes the dataset; the fourth describes the whole unsupervised procedure for abdominal ECG processing with its six steps (preprocessing, enhancement of mQRS, mQRS detection, mECG canceling, fQRS enhancement and fQRS detection); the last subsection concerns the methods used for the evaluation and comparison of QIO-based algorithm with and ICA-based one as well as with simple mECG canceling and simple ICA methods.

Two QIs characterizing the signal from the point of view of the two sources of interest, i.e. mECG or fECG, were designed. These two QIs were designed in such a way that they reflect the morphological configuration and the time distribution of the QRS in the two signals. It is assumed that a linear combination of abdominal signals enhancing the desired component (mQRS or fQRS) exists. Therefore mQI (fQI) of a linear combination of processed abdominal signals is computed and mQI (fQI) results a multivariate functions of the coefficients of the linear combination. The proposed method attempts to maximize mQI (fQI) by searching for the maximum of this multivariate function. These QIs should have low computational cost, to reduce time consuming during each optimization iteration.

The QIs were built exploiting the following morphological and temporal characteristics of each component of abdominal ECG recordings after signal pre-processing:
                           
                              •
                              mECG: pseudo-periodicity with period in the range 0.5–1.2s, (120–50bpm, mother in rest condition), maternal QRS (mQRS) duration distributed around 0.09s with rising and falling edges of maximum amplitude wave (R or S waves) varying around 0.03s, mQRS amplitude usually greater than other types of components (fECG and other noises).

fECG: pseudo-periodicity with period in the range 0.3–0.8s (200–75bpm), fetal QRS (fQRS) with mean duration 0.04s and with rising and falling edges of the maximum amplitude wave (R or S wave) with mean value of 0.015s, fQRS amplitude usually greater than the other noise components.

Residual noise: not periodic, quasi-stationary stochastic process.

Typical features of each of these components can be obtained by applying three types of derivatives: a derivative dm computed on quite wide intervals (0.023s) suitable to enhance mQRS event and smoothing the other components; a derivative df computed on shorter intervals (0.013s) enhancing fQRS but smoothing noise; a derivative dhn computed on even shorter intervals (0.003s) to take into account the noise alone. In order to capture the characteristics of periodicity of each component of the abdominal ECG, five windows of different lengths were considered: i) a window with duration of 1.5s (w15) to capture the mQRS periodicity; ii) a window of 0.4s (w04) to capture the fQRS periodicity; iii) a window of 0.13s (w013) specific for high frequency noise; iv) a window of 0.1s (w01) specific for very high frequency noise; v) a window of 4.0s (w40) specific to isolate impulsive artifacts.

The following quantities were derived:
                           
                              •
                              
                                 Dm as the trimmed mean of the maxima of adm computed on successive w15;


                                 Df as the trimmed mean of the maxima of adf computed on successive w04;


                                 Dn as the trimmed mean of the maxima of adf computed on successive w013;


                                 Dhn as the trimmed mean of the maxima of adhn computed on successive w01;


                                 Dma as the trimmed mean of the maxima of adm computed on successive w40;


                                 Dfa as the trimmed mean of the maxima of adf computed on successive w40

where the terms adm, adf, adhn are the absolute values respectively of dm, df, dhn.

The characteristics of each component of the abdominal signal can be described on the basis of the previously defined quantities:
                           
                              •
                              mECG: most of successive windows of 1.5s contain at least one mQRS, Dm value is high, whereas Df and Dn are low because computed as the average of values extracted from windows many of which do not contain a mQRS;

fECG: most of successive windows of 0.4s contain at least one fQRS, Dm and Df values are high whereas Dn is low because computed as the average of values extracted from windows many of which do not contain a fQRS;

noise: Dm and Df are low as they are based on slow derivatives, whereas Dn results relatively high;

signal with sporadic residual high derivative artifacts: Dm and Df have low values since they are computed as the average of values extracted from windows many of which do not contain artifacts, whereas Dma and Dfa may result relatively high.

On the basis of these considerations, different quality indexes for the mQRS-enhanced signal (mQI) and the fQRS-enhanced signal (fQI) can be empirically built as expressions of the quantities Dm, Df, Dn, Dhn, Dma and Dfa. The adopted formulas are the simplest as only weighted additions and subtractions are used; normalization was introduced only to get scale invariance. The weights were initially set according the mean value of each quantity and adjusted with a few manual trials.

Specifically, for mQRS-enhanced signal the following quality index is defined:
                           
                              
                                 
                                    
                                       mQI
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             Dm
                                          
                                          
                                             −
                                          
                                          
                                             Df
                                          
                                          
                                             −
                                             2
                                             *
                                          
                                          
                                             Dhn
                                          
                                          
                                             −
                                             2
                                             *
                                          
                                          
                                             Dma
                                          
                                          
                                             −
                                          
                                          
                                             ϵ
                                          
                                       
                                       
                                          
                                             Dm
                                          
                                          
                                             +
                                          
                                          
                                             Df
                                          
                                          
                                             +
                                             2
                                             *
                                          
                                          
                                             Dhn
                                          
                                          
                                             +
                                             2
                                             *
                                          
                                          
                                             Dma
                                          
                                          
                                             +
                                          
                                          
                                             ϵ
                                          
                                       
                                    
                                 
                              
                           
                        where ε is a very small constant added to avoid division by zero. In this expression the trimmed value Df is computed discarding the 50% of the maxima in the averaging as, in about 50% of intervals, the highest derivatives belong to the mECG. The trimmed values Dm, Dma and Dhn are computed discarding a small percentage of the maxima.

Analogously, for the fQRS-enhanced signal the following quality index is defined:
                           
                              
                                 
                                    
                                       fQI
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             Df
                                          
                                          
                                             −
                                          
                                          
                                             Dn
                                          
                                          
                                             −
                                             3
                                             *
                                          
                                          
                                             Dhn
                                          
                                          
                                             −
                                             0
                                             .
                                             1
                                             *
                                          
                                          
                                             Dfa
                                          
                                          
                                             −
                                          
                                          
                                             ϵ
                                          
                                       
                                       
                                          
                                             Df
                                          
                                          
                                             +
                                          
                                          
                                             Dn
                                          
                                          
                                             +
                                             3
                                             *
                                          
                                          
                                             Dhn
                                          
                                          
                                             +
                                             0
                                             .
                                             1
                                             *
                                          
                                          
                                             Dfa
                                          
                                          
                                             +
                                          
                                          
                                             ϵ
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The trimmed values Df, Dn, Dhn and Dfa are computed discarding a small percentage of the maxima. It should be highlighted that fQI was designed to be applied to signals where an estimate of mECG was previously canceled.

Both maternal and fetal QIs are applied to signals obtained as a linear combination of other signals (abdominal maternal ECGs for mQI) thus they are multivariate functions of the coefficients of such a combination. A peculiar characteristic of these functions is that, being the constant ε negligible, they are scale independent. Therefore the surface, described by these functions in the n dimensional coefficients space, has a radial shape. In particular the maxima of these QIs are located on lines crossing the axes origin.

It should be highlighted that fQI is specific of each record, in particular it is affected by fECG inter-beat interval. Therefore the value of the maximum fQI is not an absolute index of quality of the enhanced fQRS signal extracted from the different abdominal ECGs.

The previously defined quality functions do not allow to get an analytic expression for the derivatives therefore direct search algorithms must be adopted with the aim of searching for the maxima.

The property of scale independence avoids imposing bounds on coefficient norm then it allows obtaining the coefficients, which maximize the quality function through the application of an unconstrained optimization method. The low dimensionality of the optimization problem (the number of abdominal signals is four) leads us to use the Nelder–Mead (NM) simplex algorithm.

The NM algorithm [21] is one of the best known and most used algorithms for low dimensional unconstrained optimization. The method belongs to the general class of direct search methods and it does not require any derivative information, making it suitable for problems with functions whose derivative is not easily computable. Although the convergence of the algorithm was not been demonstrated it works well in many practical applications [22].

The NM method is based on “simplex”. A simplex in R
                        
                           n
                         is defined as a convex geometric figure of n+1 vertices x
                        0,…,x
                        
                           n
                        ∈ R
                        
                           n
                         (a simplex in R
                        2 is a triangle).

The method attempts to minimize a multivariate function; it begins with an initial simplex S (n+1 points x
                        0,…,x
                        
                           n
                        ∈ R
                        
                           n
                        ), and the corresponding set of function values at its vertices f(x
                        0),…,f(x
                        
                           n
                        )∈ R. Then the simplex S is updated in order to decrease the function values at its vertices. At each iteration step, the function values in one or more test points are computed and compared with those at the vertices. Accordingly one or more vertices of the simplex are changed. This updating process terminates when the simplex S becomes sufficiently small, or when the function values f(x
                        
                           j
                        ) are close to each other. The transformations involved in simplex updating can be grouped in two categories: the first one including reflection, expansion and contraction where only one point of the simplex is changed, the second consisting in shrinking where all points except one are updated. For a detailed description of the algorithm see Lagarias et al. [22].

The simplex transformations are controlled by four parameters: ρ for reflection, χ for expansion, ψ for contraction and σ for shrinkage. The standard values, used in the implementation of the Matlab routine “fminsearch.m”, are ρ=1, χ=2, ψ=0.5, σ=0.5. According to the paper by Gao and Han [23], these values should be changed with the dimensionality n. In our case the dimensionality is 4 and the values resulted ρ=1, χ=1.5, ψ=0.625, σ=0.75. Moreover, the expansion parameter is decreased setting as χ=1.3, considering the high non-uniformity of the function to be optimize.

Standard algorithms for optimization search for the minimum, thus the functions to optimize are given by −mQI and −fQI. These quality functions are scale independent that means the maxima lie on radial lines and the norm of coefficients is not subjected to a constrain. However, the NM algorithm could shift the simplex toward very high or very low coefficient values, which would increase the numerical error. This problem is solved exploding the function invariance and thus scaling the simplex coordinates towards numerically tractable values (e.g. dividing by the infinite norm of the first coordinate) at the last step of each iteration of the algorithm.

To partially overcome the convergence failure of NM direct search, NM algorithm is locally restarted (i.e., re-initialize the simplex), from the last solution found, until no improvement was reached. Restarting NM regenerates its search simplex so different search directions are covered [24]. Of course NM restarting increases computation time.

The QIO-based method was tested on the annotated open set of recordings “set-a” made available on the Physionet server for the CinC Challenge 2013 [18,19]. The dataset used in this study consisted of 75 records (length:60s) from five abdominal signal collections obtained using different instrumentations and collected in various laboratories. Reference annotations of fQRS of these records were available. Each record included 4 channels of maternal abdominal ECG sampled at 1KHz. Records were often affected by noise, artifacts, EMG, power line interference and baseline wandering. The same subset of 69 records selected for our previously developed ICA-based method [15] was adopted, specifically the records a33, a38, a52, a54, a71, a74 were excluded because they had partial or inaccurate reference annotations (identified by visual inspection). Moreover, the first and the last annotated beat of each record were ruled out from the evaluation because their reference annotations were often inaccurate.

The proposed method was integrated in the procedure for fQRS detection from abdominal ECGs developed and tested for the CinC challenge 2013 [20,15]. In order to conduct a fair comparison between the ICA-based approach and the new QIO-based method the ICA modules were replaced with the modules implementing the new algorithm for the extraction of mQRS- and fQRS- enhanced signals.

Before fQRS enhancement and fQRS detection, a sequence of pre-processing step was applied aimed at removing most of the undesired components, which affect the ECG signals i.e. impulsive artifacts, baseline wandering and power line interference.

After this cleaning, the mQRS-enhanced signal was estimated by a first application of the method based on the optimization of the mQI. Subsequently, the maternal QRS (mQRS) was detected using an algorithm based on derivative. In the successive step each channel was cleaned from the mECG component by subtracting a reduced rank approximation obtained by SVD. After these steps, the fQRS-enhanced signal was extracted by a second application of our method i.e. by searching for a direction in the space of the resulting residual signals, which maximize the fQI. Finally fQRS detection was performed.

In this section each step of the procedure for abdominal fECG analysis is briefly described. A more detailed description of each module, except the ones introduced in this paper, can be found in Varanini et al. [15]. A synthetic block scheme of the main steps of the procedure is shown in 
                        Fig. 1.


                           
                              
                                 •
                                 Impulsive artifacts canceling

The absolute difference between the original and the reference signal obtained by median filtering (60ms window) was computed and a threshold was estimated considering the maximum of this difference. When the absolute difference of a specific segment of signal exceeded the threshold, that segment was considered as an artifact and its values were assigned with the average of the values of the signal immediately before and after the segment [15].

Baseline wandering removal

A low-pass first order Butterworth filter (cutoff frequency at 5Hz) was applied in forward and backward directions to estimate the baseline signal. This signal was then subtracted from original signals to obtain detrended signals. The artifacts caused by the occurrences of fast baseline movements, were managed applying locally median filtering [15].

Power-line interference canceling

In order to evaluate the presence a power-line component, the peak of the power density, estimated by the Welch method in a narrow interval around 50 and 60Hz, was compared with the average power density in the neighbors of those frequencies. Notch filters (forward–backward, zero phase, 1Hz bandwidth) at the estimated peak frequency and at its three harmonics were applied to remove the detected power-line interference [15].


                                    
                                    Fig. 2 shows a 5s length interval of abdominal signals extracted from record “a72” of Physionet database and 
                                    Fig. 3 shows the same interval after the application of the pre-processing steps previously described.

For the enhancement of mQRS, the linear combination of the four preprocessed abdominal signals was computed
                              
                                 
                                    
                                       z
                                       =
                                       
                                          
                                             a
                                          
                                          T
                                       
                                       X
                                    
                                 
                              
                           where X is a matrix containing a preprocessed abdominal signal on each row and a is a vector of coefficients. The aim is to find the vector of coefficients a, which maximizes the mQI applied to the linear combination of signal z. This results in maximizing the function mQI(a) with respect to the coefficients vector a. It is worth noting that mQI(a) function is independent from the scale of these coefficients. The optimization was obtained by the Matlab function “fminsearch”, which implements the previously described unconstrained NM algorithm. For the initialization of the optimization algorithm, the mQI was calculated for each of the four abdominal signal and the elements of the vector a were assigned to zero except for the one corresponding the maximum mQI, which was set to one. Then, in order to find the coefficient vector a which maximizes mQI(a), the “fminsearch” routine was applied in minimizing “−mQI(a)”. As previously mentioned, in order to avoid that the coefficients of the unconstrained NM algorithm assume very small or very large values, the “fminsearch” Matlab routine was modified by scaling the simplex. 
                           Fig. 4 shows the mQRS-enhanced signal extracted by the mQI optimization method applied to the pre-processed signals of record “a72” (5s length interval of Fig. 2).

A prerequisite of the next steps, concerning the fQRS-enhanced signal extraction, is the accurate canceling of mECG, which requires a precise time location of the mQRSs. Therefore the mQRS-enhanced signal, previously extracted, and the four preprocessed abdominal signals were upsampled at 4KHz with Fourier transform method.

The mQRS detection was performed on the mQRS-enhanced signal using the absolute derivative adm. An adaptive threshold on that derivative was applied for QRS detection: first the QRS value was automatically initialized, and then it was recursively updated depending on the temporal distance from the previously detected QRS [25]. The fiducial point of each detected QRS was selected as the time of the maximum or minimum (according to the sign assigned in the initialization phase) of the derivative signal.

Maternal ECG canceling was performed independently for each of the four maternal channels applying the procedure based on the approximation of each mECG beat obtained by Singular Value Decomposition (SVD), as described in Varanini et al. [15].

According to this procedure a trapezoidal window is used to select and weight the signal around each detected maternal QRS. A matrix Q (nd×nq) in which each column contained one weighted PQRST interval was built. The number of rows (nd) of Q was equal to the length of the PQRST segments and the number of columns (nq) was equal to the number of detected maternal beats. The matrix Q was then decomposed by SVD. Since the columns of the matrix consisted in synchronized and weighted maternal PQRST, they mostly contributed to covariance. Therefore the first left singular vectors (first eigenvectors in the Principal Component view), mainly represent the maternal PQRST waves. The rebuilding of matrix Q (Qr), obtained using a reduced number of eigenvectors, indeed maintain mostly maternal PQRST waveforms.

Since the classical methods for an unconstrained automatic choice of the number of singular values did not provide good results, the following empirical decision rule was applied: if the third singular value was great than 1.5 times than the fourth a subspace of dimension 3 was used, otherwise a subspace of dimension 2 was selected. The previous trapezoidal window was applied to unweight the estimated PQRST segments on each column of the matrix. The unweighted segments were then connected with a straight line to obtain an estimated mECG, which was then subtracted from the maternal signal.


                           
                           Fig. 5 shows the result of this canceling procedure applied to the 2nd of the four signals of records “a72”: mECG is canceled preserving the fQRS complexes even when they occur overlapped to the mQRS ones (e.g. fQRS and mQRS occurring at 13.5s). In this record the fECG component in the residual signal is quite high and direct fQRS detection would be feasible.

Canceling of mECG provides four residual signals but in some records (for example record “a59”, 
                           Fig. 6) the fECG amplitude results very low compared to other components or even not visible and spread out on most of the residual channels. In these cases the fQRS enhancement step becomes mandatory.

The fQRS-enhanced signal was extracted as the linear combination z=a
                           
                              T
                           
                           X
                           r where each row of the matrix X
                           r contains a residual signal. The aim is to find the signal z which maximizes the fQI(z), being the matrix X
                           r constant, it results in searching for the coefficients vector a which maximizes the function fQI(a). This function is independent from the scale of coefficients a and the same procedure and algorithm used for mQI optimization was applied. 
                           Fig. 7 shows the fQRS-enhanced signal extracted from the residual signals of record “a59” by the application of the fQI optimization algorithm.

The fQRS detection was based on the previously mentioned adf derivative as it was able to enhance fQRS events. The fetal QRS complex may still have small power and be mixed with residual noise, resulting in poor signal-to-noise ratio, even if the previously described procedures for noise, artifact and mECG removal have been applied and the fQRS enhancement process has been adopted. For this reason a QRS detection procedure based on two passes was applied, as described in Varanini et al. [15]: the 1st pass was similar to the maternal QRS detector; the 2nd pass was based on a QRS detector, which starting from the best fetal RR interval identified in the previous step, proceeded in forward/backward direction. This software version was improved including a decision rule choosing between the 1st pass and the 2nd pass of QRS detections. This selection was based both on a priori knowledge of typical fetal RR values and on a minimization criteria dependent on the following features: the trimmed mean of absolute RR first derivative, the trimmed mean of absolute RR second derivative and the number of detected fQRSs that matched mQRSs.


                           
                           Fig. 8 shows the correct identification of all the fetal beats of the record “a59” by the fQRS detection algorithm, which provided an estimated RR series almost superimposed to the reference one.

@&#PERFORMANCE EVALUATION@&#

In order to compare the performance of the novel QIO-based method to that of the ICA-based approach [15], both the methods were applied using the same procedural steps (preprocessing, mQRS detection, mECG canceling and fQRS detection). Indeed respect to the original version implemented at the time of the CinC challenge, our ICA-based software was modified with the few previously described improvement (automatic choice of the number of singular values in the mECG canceling module and automatic choice between the fQRS detections obtained by the first or the second pass).

To compare the QIO-based approach with two methods commonly adopted in fQRS detection literature, the performance of the mECG canceling and the simple ICA approaches was also tested. These last two methods were obtained using modules developed in our previous work [15]. In particular the mECG canceling consisted of: preprocessing of the four abdominal signals, selection of signal with best mQI, upsampling and mQRS detection, mECG canceling by SVD applied to each of the four cleaned signal, fQRS detection on each residual signal, selection of the signal corresponding to the best fetal RR-series [15]. The simple ICA procedure included: preprocessing of the four signals, component separation by ICA [15], upsampling, fQRS detection on all channels, selection of the channel corresponding to the best fetal RR-series [15].

The algorithms were tested in a fully automatic unsupervised mode using the same parameterization for all the records.

The performance of the different methods was synthesized by sensitivity (Sens), positive predictive accuracy (PPA) and their harmonic mean (F1) [16] obtained by comparing the estimated fQRS and the reference fQRS annotations. With regard to Sens and PPA calculation, each fQRS detection was considered correct if it differed of less than 50ms from the reference annotation. Since the first and last fetal QRSs were sometimes not- or mis-annotated in the Challenge database, they were excluded from the evaluation. The Sens and PPA indexes were then evaluated on the total 9588 beats occurred in 69 records of 1min length. These performance indexes (Sens and PPA) were computed on the same dataset used for tuning both QIO-based and ICA-based methods, therefore these indexes may not be considered as estimates of the true performance. However, they provide information for QIO-based and ICA-based methods comparison.

@&#RESULTS@&#

The new QIO-based method for fQRS detection provided the highest performance of the different tested methods: Sens=0.9975, PPA=0.9976, F1=0.9976 (fQI optimization by NM with local restart; Sens=0.9974, PPA=0.9975, F1=0.9974, without).

The performance indexes obtained by using the original ICA-based method, implemented for the CinC 2013 challenge were Sens=0.9912, PPA=0.9886, F1=0.9899 [15]. The successive changes in the analysis procedure (the introduction of the automatic selection of the number of singular values in the mECG canceling module, the automatic choice between the fQRS detections provided by the 1st pass detector and that by the 2nd pass detector, implemented in the fQRS detection module) and the choice to exclude from evaluation the first and the last annotated beat, increased the performance to: Sens=0.9936, PPA=0.9938, F1=0.9937.

The performances indexes for mECG canceling and simple ICA were lower compared to that of both the QIO-based and ICA-based algorithms (Sens=0.923, PPA=0.9125, F1=0.9213 and Sens=0.7338, PPA=0.6895, F1=0.7110 respectively).


                     
                     Table 1 shows the results for the different approaches: the QIO-based method, ICA-based method, the mECG canceling and the simple ICA.

A comparison of the QIO-based method and ICA-based in term of computation time showed that QIO-based had worse performances respect to ICA-based. In facts the average time (on a standard I7-cpu@2.00GHz, SSD notebook) needed to process one record was 23.0s (min=14.9s, max=45.2s) for QIO-based with NM restart and 17.7s (min=10.1s, max=34.6s) without NM restart while it was only 2.57s (min=2.19s, max=4.46s) for our ICA-based.


                     
                     Table 2 shows the results specific of each record comparing the performances of QIO-based and ICA-based methods. The new QIO-based algorithm outperformed ICA-based approach in 11 records (a06, a10, a11, a14, a16, a18, a53, a55, a61, a67, a68). The improvement was particularly high for records “a06” and “a16”. The ICA-based algorithm results slightly better only for 3 records (a07, a47 and a69). The overall F1 index difference F1=0.9976 (QIO-based) and F1=0.9937 (ICA-based) resumes these results.

@&#DISCUSSION@&#

In this paper a novel approach for the QRS detection based on the extraction of a QRS-enhanced signal from multichannel ECG was proposed. It consists of two core components: a) the definition of a quality index exploiting the pseudo-periodicity and the time shape of QRS b) an optimization algorithm to search for the linear combination of the signals, which maximizes this index. An application of this method to the difficult task of fQRS detection in maternal abdominal ECG signals was presented. This is based on the definition of two quality indexes (one for the mQRS and one for the fQRS) and on the Nelder–Mead simplex algorithm used to search for the linear combination of the abdominal signals, which maximizes these indexes. The method was integrated in the procedure developed and presented by our team at CinC Challenge 2013, which obtained the best official results in the open source section [20,15].

The new QIO-based method was compared with the ICA-based one by applying the same steps without modifications except for the specific modules performing ICA that were substituted with the mQRS/fQRS enhancement modules.

The QIO-based method outperformed the ICA-based approach in fQRS detection once tested on the available annotated fECG database “set-a” of the CinC-Physionet Challenge (F1=0.9976 vs. F1=0.9937).

Moreover, it is showed that the performance obtained applying the QIO-based procedure was quite higher than that obtained applying only the mECG canceling (F1=0.9976 vs. F1=0.9213) and considerably higher to that of simple ICA (F1=0.9976 vs. F1=0.7338) proving the improvement of our QIO-based method to these commonly used approaches.

The going down performance from ICA-based to mECGcanc and to simple ICA agrees with the results of work of Behar et al. [16] that presents a wide review and benchmarking of methods of fQRS detection. The same dataset “set-a” of the Challenge was used, the same records (plus record a47) were excluded for their inaccurate reference annotations, the first and the last 2s of each records were skipped and the same performance indexes were used.

The main novelty of the proposed QIO-based approach is that it is based on the specific characteristics of mECG and fECG signals since it exploits some basic QRS features and the pseudo-periodic structure of such ECGs. Conversely, the ICA-based source separation methods rely on the generic criterion of independence of the sources and they do not take advantage from any specific characteristics of fECG/mECG signals. Therefore, ICA-based approaches can fail in separating fECG if the number of underlying sources is higher than the number of the measured signals and if the fECG power is small compared to noise.

Another advantage of the QIO-based method consists in eliminating the problem of ICA approach of automatically selecting the mECG (or fECG) among the estimated independent sources.

It should be highlighted that our QIO-based method does not make strong assumptions on periodicity and temporal shape of QRS, therefore it is able to detect also aberrant QRS complexes in ECG signals affected by arrhythmias. In fact the QI algorithm considers trimmed mean values of the maxima of the absolute derivatives and it does not change or changes a little if some windows contain one QRS, more than one or none, analogously for some windows containing aberrant QRS.

One limitation of the QIO-based method is the computation time, which is longer than that of the ICA-based approach. This may be due to the poor convergence speed of the NM algorithm. However this computation time refers to a non optimized procedure implemented in Matlab (on a standard I7-core, SSD notebook) and nevertheless it is about half the real time (24s to process one record of 60s).

Critical points of this study are: 1) the limited annotated dataset which could not well represent the fECG population and 2) the performances, obtained on the same data set used for tuning the algorithm, could be over-estimated due to over-fitting.

However, it should be noted that the QIs are formulated using a priori knowledge and derived from QI used in previous unpublished works to select the best ECG channel in noisy multi-signals contest. Only a few parameters, at this time, were manually adjusted on the dataset.

Most importantly, the obtained performance should be regarded only as relative index for the comparison with the ICA-based method. It should be considered that: a) the ICA-based algorithm performance was also evaluated on the same dataset used for its tuning; b) the modules of the procedure: preprocessing, mECG canceling, mQRS and fQRS detection were tuned, at the challenge 2013 time, in order to optimize the performance with the ICA-based approach, therefore the QIO-based method could result penalized; c) there was not an automatic learning phase from data as in curve fitting or in estimating the parameters of a classifier.

It should be clear that the goal of our work was to introduce a new strategy for QRS detection in multichannel ECG and to show its capability, applying it to a difficult task like that of fQRS detection in abdominal signals. The aim was not to assess the true performance of QIO-based method but to show that this novel approach, based on the specific temporal structure of ECG is able to detect the fQRSs at least as good as the method based on the independence of sources (ICA).

Improvements of performance and/or decreasing computing time could be achieved both using more efficient or more suitable optimization algorithm and/or tuning/changing the mQI and fQI functions. However, this optimization could be possible, without truly incurring in over-fitting, only if a larger annotated database will be available. At this regard it should be emphasize the importance of the database Physionet CinC Challenge, which allowed to tune and test our algorithms on a quite large number on records.

Furthermore, as the QIO-based method and the ICA-based approach use different information in separating fECG, therefore an integration of the two criteria should lead to an improvement in the performance in fQRS enhancement and fQRS detection.

Finally, it should be pointed out that our QIO-based procedure (like the ICA-based one) provided such good results in a fully unsupervised way with the same parameter setting for all the records of the database. Therefore, it is suitable for instrumental application in clinical practice and results suitable in self-monitoring of fetal health in pregnant women. In this context, in order to be able to reliable detect the fQRSs, mothers should be instructed with procedures that guarantee good skin-electrode contact and to avoid recording of epochs including muscular contractions.

@&#CONCLUSION@&#

This study presents a novel method for the detection of QRS from multichannel ECG on the basis of the extraction of QRS-enhanced signal, and proposed its application to the challenging task of fetal QRS detection from abdominal maternal leads. The novel QIO-based method exploits the characteristics of the pseudo-periodicity and time shape of QRS. Our results show that the proposed method outperformed the ICA-based approach in fQRS detection. The method eliminates the problem of ICA approaches of automatically selecting the maternal ECG (or fetal ECG) among the estimated independent sources. The algorithm can be applied in a fully unsupervised way and works also in presence of weak fECG signal. In summary, the proposed method could be a valid alternative method to those used for non-invasive fQRS detection, which could be also applied in clinical practice for self-monitoring of fetal health in pregnant women.

None declared.

@&#REFERENCES@&#

