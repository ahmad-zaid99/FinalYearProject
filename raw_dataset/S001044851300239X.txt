@&#MAIN-TITLE@&#A generalized surface subdivision scheme of arbitrary order with a tension parameter

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Presents a generalized 
                                 B
                              -spline surface subdivision with arbitrary order 
                                 k
                              .


                        
                        
                           
                           The scheme is conveniently implemented using local operations.


                        
                        
                           
                           It produces 
                                 
                                    
                                       C
                                    
                                    
                                       k
                                       −
                                       2
                                    
                                 
                               limit surfaces with 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               at extraordinary vertices.


                        
                        
                           
                           It can define exact analytic, sweeping and revolution surfaces.


                        
                        
                           
                           New rules for sharp and semi-sharp features are embedded in local operations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Subdivision scheme

Generalized subdivision

Generalized 




                        B




                     -splines

Arbitrary topology

Surface of revolution

Sharp features

@&#ABSTRACT@&#


                  This article presents a generalized 
                        B
                     -spline surface subdivision scheme of arbitrary order with a tension parameter. We first propose a tensor-product subdivision scheme that produces 
                        
                           
                              k
                           
                           
                              u
                           
                        
                        ×
                        
                           
                              k
                           
                           
                              v
                           
                        
                      order generalized 
                        B
                     -spline limit surfaces. Generalized 
                        B
                     -spline surface is the unified and extended form of 
                        B
                     -splines, trigonometric 
                        B
                     -splines and hyperbolic 
                        B
                     -splines (Fang et al. 2010). The tensor product subdivision scheme can be used to generate various surfaces of revolution, including those generated by classical analytic curves that can be exactly represented by generalized 
                        B
                     -spline curves. By extending a bi-order (say 
                        k
                     ) tensor-product scheme to meshes of arbitrary topology, we further propose a generalized surface subdivision scheme with a tension parameter. Several well-known subdivision schemes, including Doo–Sabin subdivision, Catmull–Clark subdivision, and two other subdivision schemes proposed by Morin et al. (2001) and Stam (2001), become special cases of the generalized subdivision scheme. The tension parameter can be used to adjust the shape of subdivision surfaces. The scheme produces higher order 
                        
                           
                              C
                           
                           
                              k
                              −
                              2
                           
                        
                      continuous limit surfaces except at extraordinary points where the continuity is 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     . Convenient and hierarchical methods are also presented for embedding sharp features and semi-sharp features on the resulting limit surfaces.
               

@&#INTRODUCTION@&#

Recursively generating smooth surfaces from an initial control polygon is a standard method in computer graphics (CG) and computer aided design (CAD) due to its numerical stability and simplicity for implementation. Extensive work has been done in the area of subdivision-based modelling since the 1970s. Today one can find families of subdivision schemes for geometric design and graphics applications [1–6].

In connection with the proposed subdivision scheme, Lane and Riesenfeld  [7] proposed an algorithm for the subdivision of uniform 
                        B
                     -splines with an arbitrary order. Stam, Zorin and Schröder [8,9] further extended the scheme to surface subdivision for quadrilateral meshes of arbitrary topology that produces uniform bi-degree 
                        B
                     -spline surfaces with an arbitrary order. Lu et al. [10,11] also proposed subdivision schemes for uniform algebraic-trigonometric 
                        B
                     -splines and uniform algebraic-hyperbolic 
                        B
                     -splines. Fang et al. [12] further proposed a generalized curve subdivision scheme that produces uniform generalized 
                        B
                     -spline limit curves including classic 
                        B
                     -splines, algebraic-trigonometric 
                        B
                     -splines and algebraic-hyperbolic 
                        B
                     -splines. One can also find a class of subdivision schemes based on an alternative form of generalized 
                        B
                     -splines known as exponential 
                        B
                     -splines [13–17]. Many other known subdivision schemes can be viewed as special cases of generalized subdivision schemes that can produce an individual class of generalized 
                        B
                     -splines [18–23].  In the literature, there are also some subdivision surfaces representing a superset of the standard non-uniform rational 
                        B
                     -spline (NURBS) representation [24,25] and T-NURCCs (Non-Uniform Rational Catmull–Clark Surfaces with T-junctions) representing a superset of both 
                        T
                     -splines and Catmull–Clark surfaces [26]. All the above subdivision schemes have their respective spline or 
                        T
                     -spline background.

This article presents a generalized subdivision scheme of arbitrary order with a tension parameter for meshes of arbitrary topology. The scheme falls in the class of non-stationary subdivision schemes and it produces uniform generalized 
                        B
                     -spline surfaces of an arbitrary order in the case of a regular control mesh. The scenario is similar to the subdivision schemes of [8,9] in relation to 
                        B
                     -splines, but is different from NURBS-based subdivision or T-NURCCs [24–26] that fall in the class of non-uniform subdivision schemes. In this article, we first discuss a tensor-product version of the generalized 
                        B
                     -spline subdivision scheme and its applications in producing various surfaces of revolution and general sweeping surfaces. The proposed generalized subdivision scheme is then further presented for surface subdivision using meshes of arbitrary topology. The proposed scheme has the following features, all seamlessly realized in a single framework of a generalized 
                        B
                     -spline subdivision scheme: 
                        
                           •
                           The generalized surface subdivision scheme produces higher order limit surfaces with 
                                 
                                    
                                       C
                                    
                                    
                                       k
                                       −
                                       2
                                    
                                 
                               continuity except at a limited number of extraordinary vertices where 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               continuity is obtained.

The scheme can be conveniently implemented using repeated local operations that only involve direct neighbors of the newly inserted or updated vertices.

Depending on the order 
                                 k
                               and the initial tension parameter 
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                              , the scheme reduces to several well-known subdivision schemes, such as Doo–Sabin [27], Catmull–Clark [28] and 
                                 B
                              -spline subdivision [8].

The scheme can also exactly reproduce sphere, torus, conical shapes, the subdivisions of Morin et al. [20], general sweeping surfaces, and various surfaces of revolution from curves of generalized 
                                 B
                              -splines. All these geometric features are quite important for CAD applications.

For a regular set of control vertices, the scheme produces uniform generalized 
                                 B
                              -spline surfaces of an arbitrary order at the limit, including classic 
                                 B
                              -splines, algebraic-trigonometric 
                                 B
                              -splines and algebraic-hyperbolic 
                                 B
                              -splines, through mid-point knot insertion.

An alternative hierarchical method is also proposed for producing sharp features and semi-sharp features with similar effect as that of a level-based method proposed by DeRose et al. [29], but with new rules hierarchically embedded in individual steps of local refinements.

The article is organized as follows. In Section  2, we first give the rules of generalized 
                        B
                     -spline curve subdivision and construct a tensor-product version of generalized 
                        B
                     -spline surface subdivision. Design methodologies for generating surfaces of revolution and sweep surfaces by the tensor-product scheme are also introduced in this section. In Section  3, a generalized surface subdivision scheme for meshes of arbitrary topology is further proposed. Treatment of sharp features including semi-sharp features and discussion on continuity conditions are presented in Sections  4 and 5, respectively. Conclusions are given in Section  6.

The subdivision algorithm derived from generalized 
                        B
                     -spline curves can be described as follows.

Let 
                        
                           {
                           
                              
                                 P
                              
                              
                                 i
                              
                              
                                 0
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                           }
                        
                      be the sequence of zeroth level control vertices. For the 
                        l
                     th level of generalized 
                        B
                     -spline curve subdivision of orders 
                        k
                      (
                        k
                        ≥
                        3
                     ), the new control vertices are computed from one step of Chaikin-like refinement [18] as defined in Eq. (1) and 
                        k
                        −
                        3
                      steps of local average operations as defined in Eq. (2), i.e.,  
                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               i
                                                               /
                                                               2
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         +
                                                         
                                                            (
                                                            1
                                                            +
                                                            2
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               
                                                                  (
                                                                  i
                                                                  +
                                                                  2
                                                                  )
                                                               
                                                               /
                                                               2
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         
                                                            (
                                                            1
                                                            +
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   i
                                                     even.
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            1
                                                            +
                                                            2
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               
                                                                  (
                                                                  i
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                               /
                                                               2
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               
                                                                  (
                                                                  i
                                                                  +
                                                                  3
                                                                  )
                                                               
                                                               /
                                                               2
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         
                                                            (
                                                            1
                                                            +
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   i
                                                     odd;
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           (2)
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       r
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       r
                                       −
                                       1
                                    
                                 
                                 )
                              
                              /
                              2
                              ,
                              
                              r
                              =
                              2
                              ,
                              …
                              ,
                              k
                              −
                              2
                              ,
                           
                        
                      where the superscript 
                        r
                      for 
                        
                           
                              P
                           
                           
                              r
                           
                        
                      indicates step number of repeated local refinements, and 
                        
                           
                              u
                           
                           
                              l
                           
                        
                      is a non-stationary tension parameter which is updated once at each level of subdivision by 
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                l
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                      from a given initial parameter 
                        
                           
                              u
                           
                           
                              0
                           
                        
                     . The above curve subdivision algorithm can be naturally extended to obtain a tensor-product version generalized surface subdivision algorithm.


                     
                        Algorithm 1
                        
                           Tensor-product generalized surface subdivision:
                        

Let 
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    
                                       {
                                       
                                          
                                             P
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                            be the initial set of control vertices. A tensor-product version of generalized surface subdivision with order 
                              
                                 
                                    k
                                 
                                 
                                    u
                                 
                              
                              ×
                              
                                 
                                    k
                                 
                                 
                                    v
                                 
                              
                            and tension parameters 
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            is implemented by doing curve subdivision algorithm twice, i.e., one for each parameter direction. 
                              
                                 •
                                 
                                    Initialization: Let 
                                       l
                                     represent the current level of subdivision. Initialize 
                                       l
                                       ≔
                                       0
                                     and assign the number of levels of expected subdivision to 
                                       L
                                    ;


                                    Apply one level of tensor-product generalized surface subdivision: Apply one level of generalized curve subdivision of order 
                                       
                                          
                                             k
                                          
                                          
                                             u
                                          
                                       
                                     with parameter 
                                       
                                          
                                             u
                                          
                                          
                                             l
                                          
                                       
                                     row by row and apply one level of generalized curve subdivision of order 
                                       
                                          
                                             k
                                          
                                          
                                             v
                                          
                                       
                                     with parameter 
                                       
                                          
                                             v
                                          
                                          
                                             l
                                          
                                       
                                     column by column at the same time to control mesh 
                                       
                                          
                                             M
                                          
                                          
                                             l
                                          
                                       
                                     to obtain new mesh 
                                       
                                          
                                             M
                                          
                                          
                                             l
                                             +
                                             1
                                          
                                       
                                    ;


                                    Prepare for the next level of subdivision: If 
                                       l
                                       =
                                       L
                                    , go to the next step for completion; otherwise update 
                                       l
                                       ≔
                                       l
                                       +
                                       1
                                    , let 
                                       
                                          
                                             u
                                          
                                          
                                             l
                                          
                                       
                                       ≔
                                       
                                          
                                             
                                                
                                                   1
                                                   +
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             v
                                          
                                          
                                             l
                                          
                                       
                                       ≔
                                       
                                          
                                             
                                                
                                                   1
                                                   +
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    , and go to the previous step for another level of subdivision;


                                    Completion: The refined control mesh after 
                                       L
                                     levels of subdivision can be exported as 
                                       
                                          
                                             M
                                          
                                          
                                             L
                                          
                                       
                                    .

It should be noted that, unless stated explicitly in this article, 
                        l
                      for 
                        
                           
                              M
                           
                           
                              l
                           
                        
                      stands for the level of subdivision as above, while 
                        r
                      for 
                        
                           
                              P
                           
                           
                              r
                           
                        
                      indicates the step number for repeated local refinements as seen in Eq. (2). It is also easy to note that the limit surface generated by this tensor-product surface subdivision scheme is 
                        
                           
                              C
                           
                           
                              min
                              
                                 (
                                 
                                    
                                       k
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       v
                                    
                                 
                                 )
                              
                              −
                              2
                           
                        
                      continuous. In case of bi-order subdivision surfaces, one may directly use Algorithms 3 and 4 that are more efficient for subdivision operations similar to that of the algorithm in [2]. The above scheme for tensor-product surface subdivision can be used to generate surfaces of revolution from any curve defined using generalized 
                        B
                     -spline curve subdivision proposed in [12]. Many analytical surfaces can thus be defined as a generalized subdivision surface by revolving classical analytical curves, such as conic curves, Lissajous curves, trigonometric function curves, hyperbolic function curves, catenary curves and helixes, around their axes. Algorithm 2 describes how to construct the control mesh from which a revolution surface can be generated by the subdivision scheme proposed in Algorithm 1.


                     
                        Algorithm 2
                        
                           Surface of revolution: Let a revolution surface 
                              
                                 
                                    R
                                 
                                 
                                    s
                                 
                              
                            be defined by revolving a curve 
                              
                                 
                                    R
                                 
                                 
                                    c
                                 
                              
                            around an axis and 
                              
                                 
                                    P
                                 
                                 
                                    c
                                 
                              
                            be the initial set of control vertices of 
                              
                                 
                                    R
                                 
                                 
                                    c
                                 
                              
                            defined using the generalized 
                              B
                           -spline curve subdivision scheme of order 
                              
                                 
                                    k
                                 
                                 
                                    u
                                 
                              
                            with tension parameter 
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                           . Without loss of generality, here we assume that the rotational axis is the 
                              z
                           -axis, as illustrated in Fig. 1
                           
                           (a). 
                              
                                 
                                    R
                                 
                                 
                                    s
                                 
                              
                            can be generated by subdivision with orders 
                              
                                 
                                    k
                                 
                                 
                                    u
                                 
                              
                              ×
                              3
                            and tension parameters 
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 cos
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                                 )
                              
                           . Its control mesh is defined as 
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          R
                                       
                                    
                                    ≔
                                    
                                       [
                                       
                                          
                                             P
                                          
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       
                                       
                                          
                                             P
                                          
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       
                                       
                                          
                                             P
                                          
                                          
                                             c
                                          
                                          
                                             3
                                          
                                       
                                       
                                       
                                          
                                             P
                                          
                                          
                                             c
                                          
                                          
                                             4
                                          
                                       
                                       
                                       
                                          
                                             P
                                          
                                          
                                             c
                                          
                                          
                                             5
                                          
                                       
                                       
                                       
                                          
                                             P
                                          
                                          
                                             c
                                          
                                          
                                             6
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          c
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       ,
                                       q
                                       )
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          cos
                                          θ
                                          ⋅
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                x
                                             
                                          
                                          −
                                          sin
                                          θ
                                          ⋅
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                y
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          sin
                                          θ
                                          ⋅
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          cos
                                          θ
                                          ⋅
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                y
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      c
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             z
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                            In the above equation, 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                            indicates the 
                              i
                           th row of 
                              
                                 
                                    M
                                 
                                 
                                    R
                                 
                              
                            with 
                              n
                            being the number of vertices of 
                              
                                 
                                    P
                                 
                                 
                                    c
                                 
                              
                           ; 
                              j
                              =
                              1
                              ,
                              …
                              ,
                              6
                            indicates the 
                              j
                           th column of 
                              
                                 
                                    M
                                 
                                 
                                    R
                                 
                              
                           ; 
                              q
                              =
                              1
                              ,
                              2
                              ,
                              3
                            indicates the 
                              q
                           th coordinates of the control vertices of 
                              
                                 
                                    M
                                 
                                 
                                    R
                                 
                              
                           ; and 
                              
                                 
                                    θ
                                    =
                                    
                                       
                                          j
                                          −
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    π
                                    +
                                    
                                       
                                          π
                                       
                                       
                                          4
                                       
                                    
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    6
                                    .
                                 
                              
                            The index 
                              q
                            implies that 
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          c
                                       
                                    
                                    
                                       (
                                       :
                                       ,
                                       :
                                       ,
                                       1
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   c
                                                
                                             
                                             )
                                          
                                       
                                       
                                          x
                                       
                                    
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          c
                                       
                                    
                                    
                                       (
                                       :
                                       ,
                                       :
                                       ,
                                       2
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   c
                                                
                                             
                                             )
                                          
                                       
                                       
                                          y
                                       
                                    
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          c
                                       
                                    
                                    
                                       (
                                       :
                                       ,
                                       :
                                       ,
                                       3
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   c
                                                
                                             
                                             )
                                          
                                       
                                       
                                          z
                                       
                                    
                                    .
                                 
                              
                           
                        


                     Fig. 1 shows an example to construct a surface of revolution following the above algorithm. In this figure, 
                        
                           
                              R
                           
                           
                              c
                           
                        
                      is a spatial curve, whose parametric equation is 
                        
                           (
                           x
                           
                              (
                              t
                              )
                           
                           ,
                           y
                           
                              (
                              t
                              )
                           
                           ,
                           z
                           
                              (
                              t
                              )
                           
                           )
                        
                        =
                        
                           (
                           t
                           +
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           ,
                           t
                           +
                           sin
                           
                              (
                              2
                              t
                              )
                           
                           ,
                           2
                           t
                           +
                           cos
                           
                              (
                              2
                              t
                              )
                           
                           +
                           2
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           )
                        
                        ,
                        t
                        ∈
                        
                           [
                           π
                           /
                           4
                           ,
                           π
                           ]
                        
                     . Following Fang et al. [12], it can be generated by generalized subdivision scheme of order 5 with tension parameter 
                        
                           
                              v
                           
                           
                              0
                           
                        
                        =
                        cos
                        
                           
                              π
                           
                           
                              4
                           
                        
                      and control points 
                        
                           
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       c
                                    
                                 
                                 )
                              
                           
                           
                              x
                           
                        
                        =
                        
                           {
                           6.002
                           ,
                           4.320
                           ,
                           2.638
                           ,
                           5.891
                           ,
                           9.143
                           ,
                           7.461
                           ,
                           5.779
                           ,
                           9.032
                           }
                        
                     , 
                        
                           
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       c
                                    
                                 
                                 )
                              
                           
                           
                              y
                           
                        
                        =
                        
                           {
                           4.768
                           ,
                           3.086
                           ,
                           3.871
                           ,
                           7.124
                           ,
                           7.910
                           ,
                           6.228
                           ,
                           7.013
                           ,
                           10.266
                           }
                        
                     , 
                        
                           
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       c
                                    
                                 
                                 )
                              
                           
                           
                              z
                           
                        
                        =
                        
                           {
                           21.756
                           ,
                           29.495
                           ,
                           33.534
                           ,
                           43.740
                           ,
                           60.116
                           ,
                           72.790
                           ,
                           81.763
                           ,
                           96.904
                           }
                        
                     . The corresponding generatrix, the control mesh, the results after one and two levels of subdivision and the final subdivision surface of revolution are all given in Fig. 1.


                     Algorithm 2 generalizes the scheme of generating revolution surfaces by subdivision proposed in [20]. Because it is permitted to use arbitrary orders and different tension parameters in the two parameter directions, our scheme can generate various kinds of revolution surfaces. In fact, it is also easy to generate sweeping surfaces in a similar way. Fig. 2
                      illustrates more revolution and sweeping surfaces generated by Algorithm 2. Further details about their section curves, orders, tension parameters on both parameter directions are listed in Table 1.

In this section, we extend the generalized 
                        B
                     -spline curve subdivision scheme to surfaces of arbitrary topology. A kind of new surface subdivision scheme of arbitrary order with a tension parameter is then proposed. The tension parameter can be used to control the shape of the resulting surface and the approximation between the limit surface and the control mesh. The order determines the continuity and smoothness of the limit surface. Classic Doo–Sabin subdivision, Catmull–Clark subdivision, uniform 
                        B
                     -spline subdivision with arbitrary order, and some other uniform subdivision schemes based on trigonometric and hyperbolic splines are special cases of the proposed new subdivision scheme.

From the rule of generalized 
                        B
                     -spline curve subdivision, we can see that order 
                        k
                      subdivision involves 
                        k
                        −
                        3
                      local average operations. Further referring to [8], we merge every two local average operations into one step of smoothing average which keeps the topology unchanged during the process of subdivision. In the following, we introduce the new subdivision scheme of both bi-even order and bi-odd order for meshes of arbitrary topology.

We first rewrite the rules (1) and (2) of generalized 
                           B
                        -spline curve subdivision. When the subdivision order 
                           k
                         is even, the 
                           l
                        th level of generalized 
                           B
                        -spline curve subdivision includes one Chaikin-like refinement and 
                           k
                           −
                           3
                         local average operations. We further divide the Chaikin-like refinement into two steps described as 
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                            /
                                                            2
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      i
                                                        even,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               
                                                                  (
                                                                  i
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                               /
                                                               2
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               
                                                                  (
                                                                  i
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                               /
                                                               2
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         )
                                                      
                                                      ,
                                                   
                                                   
                                                      i
                                                        odd,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                            /
                                                            2
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               (
                                                               i
                                                               +
                                                               2
                                                               )
                                                            
                                                            /
                                                            2
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      i
                                                        even,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               (
                                                               i
                                                               −
                                                               1
                                                               )
                                                            
                                                            /
                                                            2
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               (
                                                               i
                                                               +
                                                               1
                                                               )
                                                            
                                                            /
                                                            2
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      i
                                                        odd,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         and combine the refinement of Eq. (4) with one step of local average operation to get 
                           
                              (5)
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       
                                          (
                                          1
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                l
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             l
                                          
                                       
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             u
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       
                                          (
                                          1
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                l
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     

Finally, we merge every two steps of the remaining 
                           k
                           −
                           2
                         local average operations into one smoothing average operation as described by the following equation: 
                           
                              (6)
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       r
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       r
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                    
                                       r
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                 r
                                 =
                                 3
                                 ,
                                 …
                                 ,
                                 k
                                 /
                                 2
                                 
                                 
                                    (
                                    k
                                    >
                                    4
                                    )
                                 
                                 .
                              
                           
                        
                     

Based on the rewritten curve subdivision rules (3), (5) and (6), we extend the scheme to arbitrary topology.


                        
                           Algorithm 3
                           
                              Even order generalized surface subdivision (one level):
                           

Let the order 
                                 k
                               be an even number with 
                                 k
                                 ≥
                                 4
                              . The 
                                 l
                              th level of even order subdivision 
                                 E
                                 v
                                 e
                                 n
                                 
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          l
                                       
                                    
                                    ,
                                    k
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          l
                                       
                                    
                                    )
                                 
                               with its current mesh 
                                 
                                    
                                       M
                                    
                                    
                                       l
                                    
                                 
                               and tension parameter 
                                 
                                    
                                       u
                                    
                                    
                                       l
                                    
                                 
                               can be described as follows: 
                                 
                                    •
                                    
                                       Step 1 Linear Refinement of 
                                       
                                          
                                             
                                                M
                                             
                                             
                                                l
                                             
                                          
                                       : In this step, we compute the middle point for each edge and centroid of each face of 
                                          
                                             
                                                M
                                             
                                             
                                                l
                                             
                                          
                                        using the masks illustrated in Fig. 3
                                       (a)–(c). We then connect each centroid with those middle points incident to the same face and insert them into 
                                          
                                             
                                                M
                                             
                                             
                                                l
                                             
                                          
                                        to form a refined mesh, let us call 
                                          
                                             
                                                M
                                             
                                             
                                                l
                                                +
                                                1
                                             
                                          
                                       , which must be a quadrilateral mesh.


                                       Step 2 Nonuniform Smoothing of 
                                       
                                          
                                             
                                                M
                                             
                                             
                                                l
                                                +
                                                1
                                             
                                          
                                       : In this step, the topology of the mesh remains unchanged. We only update its vertices. The rule for updating the vertices is 
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      n
                                                      e
                                                      w
                                                   
                                                
                                                =
                                                α
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      o
                                                      l
                                                      d
                                                   
                                                
                                                +
                                                β
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                ∑
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      E
                                                   
                                                
                                                +
                                                γ
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                ∑
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      F
                                                   
                                                
                                             
                                          
                                        as illustrated in Fig. 3(d)–(f). In the above equation, 
                                          
                                             
                                                V
                                             
                                             
                                                E
                                             
                                          
                                        is a vertex which lies on the same edge with 
                                          
                                             
                                                V
                                             
                                             
                                                o
                                                l
                                                d
                                             
                                          
                                       , and 
                                          
                                             
                                                V
                                             
                                             
                                                F
                                             
                                          
                                        is a vertex which lies on the same face with 
                                          
                                             
                                                V
                                             
                                             
                                                o
                                                l
                                                d
                                             
                                          
                                       , but not 
                                          
                                             
                                                V
                                             
                                             
                                                E
                                             
                                          
                                       . We take 
                                          
                                             
                                                
                                                   α
                                                   
                                                      (
                                                      N
                                                      )
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            (
                                                            N
                                                            −
                                                            4
                                                            )
                                                         
                                                         
                                                            (
                                                            1
                                                            +
                                                            2
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         N
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               l
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         N
                                                         
                                                            
                                                               
                                                                  (
                                                                  1
                                                                  +
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     
                                                                        l
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   β
                                                   
                                                      (
                                                      N
                                                      )
                                                   
                                                   =
                                                   
                                                      
                                                         8
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  1
                                                                  +
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     
                                                                        l
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                   γ
                                                   
                                                      (
                                                      N
                                                      )
                                                   
                                                   =
                                                   
                                                      
                                                         4
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  1
                                                                  +
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     
                                                                        l
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                        with 
                                          α
                                          
                                             (
                                             N
                                             )
                                          
                                          +
                                          N
                                          β
                                          
                                             (
                                             N
                                             )
                                          
                                          +
                                          N
                                          γ
                                          
                                             (
                                             N
                                             )
                                          
                                          =
                                          1
                                       , where 
                                          N
                                        refers to the valence of the corresponding vertex.


                                       Step 3 Uniform Smoothing of 
                                       
                                          
                                             
                                                M
                                             
                                             
                                                l
                                                +
                                                1
                                             
                                          
                                       : This step is only performed if 
                                          k
                                          ≥
                                          6
                                        and it will be repeated for 
                                          
                                             
                                                k
                                                −
                                                4
                                             
                                             
                                                2
                                             
                                          
                                        times. The topology of the mesh also remains unchanged. The refinement formula is the same as that of Step 2, except that we take 
                                          
                                             
                                                α
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                =
                                                
                                                   
                                                      N
                                                      −
                                                      3
                                                   
                                                   
                                                      N
                                                   
                                                
                                                ,
                                                
                                                β
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                =
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                γ
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                =
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    


                                       Step 4 Tension parameter updating: The tension parameter will be updated for the next level of subdivision as 
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      l
                                                      +
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    


                        
                           Remark 1
                           When the control mesh is regular, the subdivision scheme described in Algorithm 3 provides an alternative implementation of Algorithm 1 for the case of bi-even order. Many existing subdivision methods are special cases of our scheme. When 
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 1
                              , the proposed scheme is equivalent to the even case subdivision of [8]; When 
                                 k
                                 =
                                 4
                              , it reduces to the scheme proposed in [20]; When 
                                 k
                                 =
                                 4
                               and 
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 1
                              , it reduces to the classic Catmull–Clark subdivision scheme [28]. These conclusions are not difficult to derive from the above masks of updating vertices.


                        Figs. 4 and 6
                         illustrate how the order and the tension parameter affect the resulting surfaces. Obviously, the bigger the 
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                        , the closer the resulting surface approaches to the initial control mesh. The higher the order, the smoother the resulting surface. Specially, the cases in Figs. 4(a) and 6(e) are actually the same as that of Catmull–Clark subdivision because 
                           k
                           =
                           4
                         and 
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           =
                           1
                        .

Similarly, when the subdivision order 
                           k
                         is odd, we merge two Linear refinement operations into one uniform smoothing average operation. The generalized 
                           B
                        -spline curve subdivision is then rewritten as 
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            2
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                            
                                                               (
                                                               1
                                                               +
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                            /
                                                            2
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                            
                                                               (
                                                               1
                                                               +
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               (
                                                               i
                                                               +
                                                               2
                                                               )
                                                            
                                                            /
                                                            2
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      i
                                                        even,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                            
                                                               (
                                                               1
                                                               +
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               (
                                                               i
                                                               −
                                                               1
                                                               )
                                                            
                                                            /
                                                            2
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            1
                                                            +
                                                            2
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                            
                                                               (
                                                               1
                                                               +
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               (
                                                               i
                                                               +
                                                               1
                                                               )
                                                            
                                                            /
                                                            2
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      i
                                                        odd,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              (8)
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       r
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       r
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                    
                                       r
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                 r
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       k
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     

Based on the rewritten curve subdivision rules (7) and (8), we can extend them to odd order generalized surface subdivision on arbitrary topology.


                        
                           Algorithm 4
                           
                              Odd order generalized surface subdivision (one level):
                           

Let the order 
                                 k
                               be an odd number with 
                                 k
                                 ≥
                                 3
                              . The 
                                 l
                              th level of odd order subdivision 
                                 O
                                 d
                                 d
                                 
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          l
                                       
                                    
                                    ,
                                    k
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          l
                                       
                                    
                                    )
                                 
                               with its current mesh 
                                 
                                    
                                       M
                                    
                                    
                                       l
                                    
                                 
                               and tension parameter 
                                 
                                    
                                       u
                                    
                                    
                                       l
                                    
                                 
                               can be described as follows: 
                                 
                                    •
                                    
                                       Step 1. Chaikin-like Refinement of 
                                       
                                          
                                             
                                                M
                                             
                                             
                                                l
                                             
                                          
                                       : In this step, we compute a new vertex for each vertex in each face according to the mask illustrated in Fig. 5
                                       (a) and (b), that is 
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      n
                                                      e
                                                      w
                                                   
                                                
                                                =
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      o
                                                      l
                                                      d
                                                   
                                                
                                                +
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                ∑
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      E
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                +
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                ∑
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      F
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                .
                                             
                                          
                                        Here 
                                          
                                             
                                                V
                                             
                                             
                                                E
                                             
                                             
                                                ′
                                             
                                          
                                        refers to a vertex which lies on the same edge in the current face, and 
                                          
                                             
                                                V
                                             
                                             
                                                F
                                             
                                             
                                                ′
                                             
                                          
                                        refers to other vertices except for 
                                          
                                             
                                                V
                                             
                                             
                                                o
                                                l
                                                d
                                             
                                          
                                        and 
                                          
                                             
                                                V
                                             
                                             
                                                E
                                             
                                             
                                                ′
                                             
                                          
                                        in the current face. We take 
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      (
                                                      N
                                                      )
                                                   
                                                   =
                                                   
                                                      
                                                         N
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               l
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         +
                                                         
                                                            (
                                                            2
                                                            N
                                                            −
                                                            4
                                                            )
                                                         
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                         +
                                                         1
                                                      
                                                      
                                                         N
                                                         
                                                            
                                                               
                                                                  (
                                                                  1
                                                                  +
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     
                                                                        l
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      (
                                                      N
                                                      )
                                                   
                                                   =
                                                   
                                                      
                                                         1
                                                         +
                                                         2
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                      
                                                      
                                                         N
                                                         
                                                            
                                                               
                                                                  (
                                                                  1
                                                                  +
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     
                                                                        l
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      (
                                                      N
                                                      )
                                                   
                                                   =
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         N
                                                         
                                                            
                                                               
                                                                  (
                                                                  1
                                                                  +
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     
                                                                        l
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                        with 
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                +
                                                2
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   N
                                                   −
                                                   3
                                                   )
                                                
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                =
                                                1
                                                .
                                             
                                          
                                        We denote the refined mesh as 
                                          
                                             
                                                M
                                             
                                             
                                                l
                                                +
                                                1
                                             
                                          
                                       .


                                       Step 2. Uniform Smoothing of 
                                       
                                          
                                             
                                                M
                                             
                                             
                                                l
                                                +
                                                1
                                             
                                          
                                       : In this step, the topology of the mesh remains unchanged. This step is actually the same as Step 3 of Algorithm 3. The mask of updating vertices is illustrated in Fig. 5(c). Here we take 
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                =
                                                
                                                   
                                                      N
                                                      −
                                                      3
                                                   
                                                   
                                                      N
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                =
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   N
                                                   )
                                                
                                                =
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    


                                       Step 3. Tension parameter updating: The tension parameter will be updated for the next level of subdivision as 
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      l
                                                      +
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    


                        
                           Remark 2
                           When the control mesh is regular, the subdivision scheme described in Algorithm 4 is also an alternative implementation of Algorithm 1 for the case of bi-odd order. When 
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 1
                              , the proposed scheme is equivalent to the odd case subdivision of [8]; When 
                                 k
                                 =
                                 3
                               and 
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 1
                              , it reduces to the classic Doo–Sabin subdivision scheme [27].

In Fig. 6(a)–(c), we can also see how the order and the tension parameter affect the subdivision results. In particular, Fig. 6(b) illustrates the result of Doo–Sabin subdivision as a special case because 
                           k
                           =
                           3
                         and 
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           =
                           1
                        .

Sharp features need to be processed in many practical applications. In such cases, we sometimes expect to have sharp features, such as crease edges, boundaries, corner vertices, darts, cusps, defined on the limit surface. In Warren et al. (2002), a method is proposed to process sharp features through restricting the application of averaging rules to a subset of the initial mesh corresponding to crease curves and vertices. In other words, rules for defining creases and other sharp features are automatically embedded in individual averaging operations. Similarly in this article, we also define rules for crease and sharp features in association with smoothing operations. However, we directly modify the rules of smoothing steps to special rules for defining sharp features in the proposed scheme. Such special rules/operations are thus hierarchically embedded in individual refinement operations of a particular level of subdivision.

We classify vertices into five types according to shape features incident to a particular vertex, i.e., smooth (0), dart (1), crease (2), corner (
                        ≥
                        3
                     ), and cusp (all crease edges shrinking into a single point with 0) vertices, where the number inside bracket indicates the number of incident crease edges to the respective vertex. In the whole process of subdivision, types of existing vertices remain unchanged. In the middle-point insertion step, the masks illustrated in Section  3.1 are applicable to all types of vertices. However, newly inserted vertices must be classified correctly. In fact, all other newly inserted vertices are smooth, except for those of crease edges which should still be classified as crease vertices. In smoothing steps, special masks should be applied to some types of vertices. For smooth and dart vertices, no special masks are required. For crease vertices, the corresponding subdivision masks in the non-uniform smoothing step and uniform smoothing step are illustrated in Fig. 7
                     (a) and (b), respectively. In Fig. 7(a), 
                        
                           
                              
                                 
                                    α
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    1
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          l
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    β
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                    
                                       (
                                       1
                                       +
                                       
                                          
                                             u
                                          
                                          
                                             l
                                          
                                       
                                       )
                                    
                                 
                              
                              .
                           
                        
                      For cusp and corner vertices, their subdivision masks are the same as that of the two smoothing steps, as illustrated in Fig. 7(c).


                     Fig. 8
                      shows several examples with different sharp features. In this and all other illustrations with sharp features, crease edges are drawn in thick lines. Dart, sharp, cusp and corner vertices are drawn in black squares with small, middle and big size, respectively.

In the literature, one can find a method for defining the so-called semi-sharp features by DeRose et al. [29]. The method uses special masks of sharp features in the first several levels of subdivisions, while it uses regular subdivision rules afterwards. This kind of level-based idea can be directly applied to all topologically primal subdivision schemes. It can also be applied to the proposed subdivision scheme of even order for producing semi-sharp features.

In this paper, we propose an alternative hierarchical method for producing semi-sharp features for the proposed generalized subdivision scheme. With the proposed method, subdivision rules used for producing semi-sharp features are embedded in individual local operations of the subdivision scheme and are the same for all levels of subdivisions, which is different from that of the level-based method [29] where sharp features are only applied to the first few levels of subdivisions.

In Algorithm 3, there are 
                        
                           
                              k
                           
                           
                              2
                           
                        
                        −
                        1
                      smoothing steps including one nonuniform smoothing step and 
                        
                           
                              k
                           
                           
                              2
                           
                        
                        −
                        2
                      uniform smoothing steps in one level of 
                        k
                     -order subdivision. All these smoothing steps will be substituted by special masks for sharp features. If only the front 
                        
                           
                              c
                           
                           
                              s
                           
                        
                      smoothing steps are substituted, we obtain semi-sharp features with sharpness coefficient 
                        
                           
                              c
                           
                           
                              s
                           
                        
                     . The sharpness of the resulting crease features is thus controlled by the number 
                        
                           
                              c
                           
                           
                              s
                           
                        
                        ∈
                        Z
                      of special rules applied in the same level of subdivision, not the number 
                        l
                      of subdivision levels.

For the subdivision scheme of bi-even order, 
                        
                           
                              c
                           
                           
                              s
                           
                        
                      can take values in 
                        
                           [
                           0
                           ,
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                           −
                           1
                           ]
                        
                      and is integrated in Algorithm 3 as follows. 
                        
                           •
                           When 
                                 
                                    
                                       c
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 0
                              , sharp feature rules will not be applied at all, leading to smooth limit surfaces.

When 
                                 
                                    
                                       c
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 1
                              , sharp feature rules will only be applied to replace Step 2 Nonuniform Smoothing, leading to semi-sharp features if 
                                 k
                                 ≥
                                 6
                               or sharp features if 
                                 k
                                 =
                                 4
                              .

When 
                                 2
                                 ≤
                                 
                                    
                                       c
                                    
                                    
                                       s
                                    
                                 
                                 ≤
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 1
                               and 
                                 k
                                 ≥
                                 6
                              , sharp feature rules will be further applied to replace the first 
                                 
                                    
                                       c
                                    
                                    
                                       s
                                    
                                 
                                 −
                                 1
                               
                              Uniform Smoothing operations of Step 3. If 
                                 
                                    
                                       c
                                    
                                    
                                       s
                                    
                                 
                                 <
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 1
                              , semi-sharp features will be produced on the final limit surface, while if 
                                 
                                    
                                       c
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 1
                              , i.e., all Uniform Smoothing operations of Step 3 will be replaced by sharp feature rules, pure sharp features will be produced on the final limit surface.


                     Fig. 9
                      provides some examples in defining semi-sharp features. In this case, 
                        k
                        =
                        8
                      and 
                        
                           
                              c
                           
                           
                              s
                           
                        
                      can take values of 
                        0
                        ,
                        1
                        ,
                        2
                        ,
                        3
                     . Different effects are shown in these illustrations with different 
                        
                           
                              c
                           
                           
                              s
                           
                        
                      values, which provide more alternatives for practical applications. Here we also treat open boundaries as internal crease edges commonly used by other researchers.

In fact, the hierarchical method can also be used together with the level-based method to implement more plentiful semi-sharp features. For bi-odd order subdivisions, however, the methods for defining sharp features are slightly different. This case should be further addressed in future work.

When the initial control meshes are regular, the subdivision surfaces converge to tensor-product generalized 
                        B
                     -spline surfaces of order 
                        k
                      which are 
                        
                           
                              C
                           
                           
                              k
                              −
                              2
                           
                        
                      continuous. Surfaces obtained by the proposed generalized surface subdivision scheme on arbitrary topology are naturally 
                        
                           
                              C
                           
                           
                              k
                              −
                              2
                           
                        
                      continuous except at those extraordinary vertices.


                     
                        Remark 3
                        Because 
                              
                                 
                                    u
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                l
                                                −
                                                1
                                             
                                          
                                          +
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           , we have 
                              
                                 
                                    lim
                                 
                                 
                                    l
                                    →
                                    ∞
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    l
                                 
                              
                              =
                              1
                           . When 
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              =
                              1
                           , we know that the generalized surface subdivision scheme reduces to the stationary subdivision scheme of [8].

As for the continuity at extraordinary vertices, it is 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      continuous when 
                        
                           
                              u
                           
                           
                              0
                           
                        
                        =
                        1
                      because the proposed scheme reduces to the subdivision scheme in [8] in this case. When 
                        
                           
                              u
                           
                           
                              0
                           
                        
                        ≠
                        1
                     , by Remark 3, we know that 
                        
                           
                              lim
                           
                           
                              l
                              →
                              ∞
                           
                        
                        
                           
                              u
                           
                           
                              l
                           
                        
                        =
                        1
                     . So in the limit, our scheme has the same subdivision matrices, eigenvalues, eigenvectors and characteristic maps as those of the scheme proposed in paper [8], whose 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      continuity is verified already [8,30].

Similar to many other studies [31–34], we further numerically verify that our scheme has 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      continuity at extraordinary vertices. We have computed the eigenstructures of subdivision matrices for a wide range of different valences 
                        N
                        =
                        3
                        ,
                        4
                        ,
                        …
                        ,
                        20
                     , bi-even orders 
                        k
                        =
                        4
                        ,
                        6
                        ,
                        …
                        ,
                        22
                     , tension parameters 
                        
                           
                              u
                           
                           
                              0
                           
                        
                        =
                        0.01
                        ,
                        0.5
                        ,
                        1
                        ,
                        2
                        ,
                        50
                     , and levels of subdivisions 
                        l
                        =
                        1
                        ,
                        …
                        ,
                        10
                     . For each case, we have 
                        
                           
                              λ
                           
                           
                              0
                           
                        
                        =
                        1
                        >
                        
                           |
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           |
                        
                        =
                        
                           |
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           |
                        
                        >
                        
                           |
                           
                              
                                 λ
                              
                              
                                 3
                              
                           
                           |
                        
                     , if the eigenvalues of subdivision matrix are ordered from big to small according to their absolute values. The characteristic map subdivided from the characteristic mesh, which is formed by two eigenvectors corresponding to 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              λ
                           
                           
                              2
                           
                        
                     , is also regular and injective. By the theories proposed in [35,36], the scheme meeting the above two conditions is 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     -continuous at extraordinary vertices.

In Table 2
                     , we list selected results of 
                        
                           (
                           λ
                           ,
                           μ
                           ,
                           δ
                           )
                        
                      showing the eigenstructure of the proposed subdivision scheme with orders 
                        k
                        =
                        4
                        ,
                        6
                        ,
                        8
                        ,
                        …
                        ,
                        16
                     , valences 
                        N
                        =
                        3
                        ,
                        5
                        ,
                        6
                        ,
                        7
                     , tension parameter 
                        
                           
                              u
                           
                           
                              0
                           
                        
                        =
                        2
                     , and the subdivision level 
                        l
                        =
                        1
                        ,
                        9
                     , where 
                        λ
                      is the subdominant eigenvalue, 
                        μ
                      is the next largest eigenvalue after 
                        λ
                     , 
                        δ
                        =
                        log
                        μ
                        /
                        log
                        λ
                      is computed for the convenience of comparing with the results from Table 1 of paper [8]. When the results for 
                        l
                        =
                        1
                        ,
                        9
                      are the same, we only list the common result in a single line. We can see that all results are in common with that of Stam’s scheme when 
                        l
                        =
                        9
                     . The corresponding characteristic meshes at extraordinary vertices with bi-odd orders 
                        k
                        =
                        4
                        ,
                        8
                        ,
                        12
                        ,
                        16
                        ,
                        22
                     , valences 
                        N
                        =
                        3
                        ,
                        6
                        ,
                        13
                        ,
                        20
                      and parameter 
                        
                           
                              u
                           
                           
                              0
                           
                        
                        =
                        0.01
                      are illustrated in Fig. 10
                     .

@&#CONCLUSIONS AND FUTURE WORK@&#

In this paper, we first extend the generalized 
                        B
                     -spline curve subdivision to a tensor-product version for generalized surface subdivision. The tensor-product scheme is applied to generate various surfaces of revolution and general sweeping surfaces. We further extend the scheme to arbitrary topology and obtain a non-stationary surface subdivision scheme of arbitrary order with a tension parameter. Classic uniform spline-based subdivision schemes, such as Doo–Sabin subdivision, Catmull–Clark subdivision, arbitrary order 
                        B
                     -spline subdivision, and some other subdivisions based on trigonometric and hyperbolic 
                        B
                     -splines, fall in the proposed generalized surface subdivision scheme as special cases. Shapes of the proposed subdivision surfaces can be easily adjusted by changing their tension parameters. The scheme is 
                        
                           
                              C
                           
                           
                              k
                              −
                              2
                           
                        
                      continuous except at a limited number of extra ordinary vertices where we numerically verify that the scheme is 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      continuous for a wide range of cases of different valences, bi-degrees and tension parameters. However, a rigorous theoretical proof should be further conducted as future work.

The proposed generalized subdivision scheme has also a good prospect in applications, such as isogeometric analysis (IGA), an active research area in the fields of CAD and CAE in recent years [37–39]. The scheme can be used to define not only classic analytical shapes, but also objects of arbitrary topology. The function, derivatives and integral of the proposed scheme can be efficiently evaluated. Local and adaptive refinements within the parametric domain can also be easily implemented. Details of the application of the proposed scheme in isogeometric analysis can be further addressed as future work.

The proposed tensor-product generalized subdivision scheme can be of an arbitrary order with different tension parameters in two parametric directions. The generalized subdivision scheme for arbitrary topology is however limited to bi-degree and a single tension parameter. A generalized subdivision scheme with truly arbitrary orders in different parametric directions and regions may also be further developed. As the tensor-product scheme can generate many classic shapes, such as classical analytic surfaces and general sweeping surfaces, its extension to arbitrary topology will also be meaningful and important for many applications. In addition to independent definition of analytic shapes, it is also interesting to have analytic shapes embedded on a general freeform surface.

@&#ACKNOWLEDGMENTS@&#

The work described in this article is partially supported by the Research Grants Council of Hong Kong SAR (CityU 118512), City University of Hong Kong (IPDA 6988010), National Science Foundation of China (61272032, 60904070), and Zhejiang Provincial Natural Science Foundation of China (LY1 2F02002).

@&#REFERENCES@&#

