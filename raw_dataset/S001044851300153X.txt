@&#MAIN-TITLE@&#Continuous penetration depth

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The resulting configuration causes the two objects to just touch.


                        
                        
                           
                           The penetration depth magnitude and direction continuously change for a continuous relative motion in configuration space.


                        
                        
                           
                           The derivatives of the continuous penetration depth are well defined if the contact space is smooth and the motion is continuous.


                        
                        
                           
                           Applicability to convex and non-convex contact spaces that are homeomorphic to a sphere.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Penetration depth

Discontinuity

Spherical parameterization

@&#ABSTRACT@&#


                  We present a new measure for computing the continuous penetration depth between two intersecting rigid objects. We generate a set of samples in the configuration space, precompute an approximation of the contact space for two intersecting objects using binary classification techniques, and construct a bijective mapping between the spherical space and the precomputed contact space. For a given in-collision configuration, we search the spherical space for the nearest neighbor, and find the corresponding image in the contact space based on the predefined spherical parameterization. The resulting image is a witness equivalent to the nearest configuration, and it is used to formulate the penetration depth direction based on our measure. Unlike prior algorithms, our algorithm guarantees that both the penetration depth magnitude and direction are continuous with respect to the motion parameters. Our algorithm is approximate in the sense that we approximate the exact contact space. We have applied our algorithm to complex rigid models composed of tens or hundreds of thousands of triangles, and the runtime query takes only around 0.01 ms.
               

@&#INTRODUCTION@&#

Measuring the extent of interpenetration between two intersecting objects is an important problem in physically based simulation, haptic rendering, geometric computing, and robotics. Among these applications, a key computation is find a measure to separate two overlapping objects. It is necessary to change the configuration variables which describe the translational or even rotational motion of the objects to eliminate their intersections. The problem has been well studied in computer-aided design and robotics for more than three decades  [1]. Perhaps the most natural measure for interpenetration is the penetration depth (PD), which is defined as the minimum rigid transformation required to separate two intersecting objects. This definition is widely used for contact resolution in dynamic simulation  [2], tolerance verification for virtual prototyping  [3], force computation in haptic rendering [4,5], motion planning in robotics  [6], etc.

In many applications, the penetration depth query is often performed repeatedly as the objects move continuously along a path. The query result includes the magnitude and direction separating the intersecting objects  [7]. However, the penetration depth computation can result in large discontinuities in terms of direction or even magnitude. These discontinuities, for instance, can significantly degrade the stability of the penalty response/force, which is computed as a function of the penetration depth. The unstable effects include noticeable jittering and sudden jumps in the computed force  [8]. Fig. 1
                      shows an example and illustrates this problem. For the optimization-based approaches  [9,10,5], the penetration depth computation relies upon initial guesses and a series of projections on the local contact space. A discontinuity can occur in terms of both the magnitude and direction of the penetration depth results. During the optimization, the local minimum can discontinuously vary with respect to the change of initial guesses. The discontinuity can become more severe when a contact space has many small surface features or local minima.


                     Main results: In this paper, we present a new measure of interpenetration which allows one to efficiently compute the continuous penetration depth between two intersecting rigid objects. Our new formulation of the continuous penetration depth can guarantee that both the penetration depth magnitude and direction are continuous with respect to the motion parameters. This formulation relies on an implicit distance metric defined using a space transformation and a bijective mapping between the spherical space and the contact space of two intersecting objects. Given the high complexity of an exact contact space, we approximate the contact space using support vector machines, and precompute the space transformation between the spherical space and the contact space using spherical parameterization, which can be precomputed. Our runtime algorithm uses a nearest-neighbor query in the spherical space and the space transformation to approximate the continuous penetration depth. Our approach has been tested using complex models with tens or hundreds of thousands of triangles. The computational overhead for the performance of the runtime query is almost constant, and it takes about 0.01 ms to compute the continuous penetration depth for these complex models.

Compared to prior approaches, our new measure of interpenetration and the derived approximation algorithm have the following advantages. 
                        
                           (i)
                           Continuity with respect to object motion: the penetration depth magnitude and direction continuously change for a continuous relative motion in configuration space.

Differentiability with respect to the motion parameters. The derivatives of continuous penetration depth are well defined if the contact space is smooth and the motion is continuous.

Applicability to convex and non-convex contact spaces that are homeomorphic to a sphere.


                     Organization: The rest of the paper is organized in the following manner. We survey related work on penetration depth formulations and techniques in Section  2. We introduce our terminology and derive the formulation of our continuous penetration depth in Section  3. Our methods for approximating a contact space using binary classification and for precomputing the spherical parameterization are given in Section  4. Our runtime penetration depth query is given in Section  5. Some experimental results and comparisons are given in Section  6. We conclude this paper and propose possible future work in Section  7.

@&#RELATED WORK@&#

There exists an extensive amount of work on the penetration depth computation in computer-aided design and robotics, and a few measures and algorithms have been proposed. Some authors used an intersecting volume as a measure of interpenetration [11–13]. However, this measure may not be able to correctly reflect the proximity situation when one object is completely inside in the other  [11]; the measure remains constant regardless of the amount of interpenetration. Moreover, a relatively small intersection between two complex objects may correspond to a deep penetration. Thus the volume of intersection may not provide an accurate measure of interpenetration.

The growth distance  [14,15] is a measure of interpenetration between convex objects that is based on the idea of “growing” objects with respect to an interior seed point. The measure corresponds to appropriate scaling of the two objects to be just touching. This measure is continuous with respect to an object motion. However, this formulation is only applicable to convex objects. A similar measure was proposed based on shrinking one of the objects towards a reference point on the object until the objects are touching  [16]. However, their measure is not continuous with respect to a continuous motion.

When the objects are in motion relative to one another, a motion trajectory-dependent penetration depth was proposed in  [16]. Their measure of interpenetration is defined as the distance that the object must move backward along the same path it used to approach before the objects are no longer interpenetrating, but just “touching”.

For convex polytopes, the penetration depth can be computed using the Minkowski sum  [17,18,3], and the penetration depth is defined as the shortest distance between the origin and the boundary of the Minkowski sum of two convex objects  [1,11]. For non-convex objects, there are various algorithms to compute their penetration depth. The penetration depth can be computed by decomposing each object into convex primitives, computing pairwise Minkowski sums of the convex primitives, and computing the union of all convex Minkowski sums  [19]. However, the union computation has a high computational complexity. Other acceleration techniques use rasterization hardware  [19]. There are some algorithms to compute only a local penetration depth, which computes a transformation to separate locally intersecting features [20–23,8,24]. Distance fields can also be used for local translational PD computation  [7], and they can be computed in real time using GPUs (Graphics Processing Units). Point-based Minkowski sum approximation  [25] can be used to approximate the translational penetration depth for non-convex objects. None of these algorithms can consistently avoid the problems of discontinuity.

The exact generalized PD can be computed by constructing the exact contact space and then searching the contact space to find a nearest point for a given query  [6]. However, due to high time and space complexity, most generalized PD algorithms use optimization-based techniques  [9,10,5,26], computing a locally optimal solution based on local approximation of the contact space. Convex decomposition techniques can be used to compute lower and upper bounds on the generalized PD  [6]. Recently, a new machine learning method was suggested to approximate the contact space for PD computation  [27]. None of them takes account of continuity.

In this section, we first introduce our notation, then introduce the conventional penetration depth formulation in terms of configuration space and analyze its discontinuity. We present our new formulation for computing the continuous penetration depth using a spherical space transformation, which avoids the problems with conventional discontinuous formulation and local contact space methods.

Given two objects 
                           A
                         and 
                           B
                        , we denote their configuration space as 
                           C
                        -Space. Each point (i.e., configuration) in 
                           C
                        -Space corresponds to the relative configuration of 
                           A
                         with respect to 
                           B
                        . For the rest of the paper, we assume that 
                           A
                         is movable and 
                           B
                         is fixed. Moreover, we limit 
                           A
                         to having a translational motion. In this case, 
                           C
                        -Space has two degrees of freedom (DOFs) for two-dimensional (2D) objects, and it has three DOFs for 3D objects. 
                           C
                        -Space is composed of two components: collision-free space 
                           
                              
                                 C
                              
                              
                                 
                                    free
                                 
                              
                           
                           =
                           
                              {
                              
                                 q
                              
                              :
                              A
                              
                                 (
                                 
                                    q
                                 
                                 )
                              
                              ∩
                              B
                              =
                              0̸
                              }
                           
                         and in-collision space 
                           
                              
                                 C
                              
                              
                                 
                                    col
                                 
                              
                           
                           =
                           
                              {
                              
                                 q
                              
                              :
                              A
                              
                                 (
                                 
                                    q
                                 
                                 )
                              
                              ∩
                              B
                              ≠
                              0̸
                              }
                           
                        , where 
                           A
                           
                              (
                              
                                 q
                              
                              )
                           
                         corresponds to 
                           A
                         located at the configuration 
                           
                              q
                           
                        . The contact space is the boundary of 
                           
                              
                                 C
                              
                              
                                 
                                    col
                                 
                              
                           
                        , and it is denoted as 
                           
                              
                                 C
                              
                              
                                 
                                    cont
                                 
                              
                           
                           =
                           ∂
                           
                              
                                 C
                              
                              
                                 
                                    col
                                 
                              
                           
                        . Intuitively, the contact space corresponds to a set of configurations where 
                           A
                         and 
                           B
                         just touch each other without any interpenetration.

The conventional penetration depth is defined as a minimum motion or transformation required to separate two intersecting objects 
                           A
                         and 
                           B
                           [18,3]. The penetration depth consists of two components: magnitude and direction. The underlying penetration depth formulation is defined as 
                           
                              (1)
                              
                                 
                                    |
                                    PD
                                    
                                       (
                                       A
                                       
                                          (
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       ,
                                       B
                                       )
                                    
                                    |
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       
                                          q
                                       
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             
                                                cont
                                             
                                          
                                       
                                    
                                 
                                 
                                    dist
                                 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       q
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                           
                         is an in-collision configuration (
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                           
                           ∈
                           
                              
                                 C
                              
                              
                                 
                                    col
                                 
                              
                           
                        ) and 
                           
                              q
                           
                         is a configuration that lies on the contact space 
                           
                              
                                 C
                              
                              
                                 
                                    cont
                                 
                              
                           
                        . We use 
                           
                              dist
                           
                           
                              (
                              ⋅
                              ,
                              ⋅
                              )
                           
                         to represent a distance metric between two configurations. The contact configuration at which 
                           
                              |
                              PD
                              
                                 (
                                 A
                                 ,
                                 B
                                 )
                              
                              |
                           
                         attains its minimal value is denoted as 
                           
                              (2)
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       0
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 
                                    
                                       
                                          argmin
                                       
                                    
                                    
                                       
                                          q
                                       
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             
                                                cont
                                             
                                          
                                       
                                    
                                 
                                 
                                    dist
                                 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       q
                                    
                                    )
                                 
                                 .
                              
                           
                        
                        
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                              
                                 C
                              
                           
                         is the nearest point from 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                           
                         to 
                           
                              
                                 C
                              
                              
                                 
                                    cont
                                 
                              
                           
                        , which realizes the 
                           
                              |
                              PD
                              
                                 (
                                 A
                                 ,
                                 B
                                 )
                              
                              |
                           
                        . We use the following metric for computing the magnitude of the penetration depth: 
                           
                              (3)
                              
                                 
                                    dist
                                 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       3
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              (
                              
                                 
                                    q
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         corresponds to a relative translation between 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 j
                              
                           
                        .

It is clear that the magnitude of the penetration depth defined by Eq. (1) is continuous, because it is a single-valued continuous mapping. However, the direction of the penetration depth defined by Eq. (2) is a multi-valued mapping between 
                           
                              
                                 C
                              
                              
                                 
                                    col
                                 
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 
                                    cont
                                 
                              
                           
                        . There can be more than one configuration in the contact space corresponding to the same magnitude of the penetration depth. The discontinuity is intrinsic in the penetration depth definition corresponding to Eqs. (1) and (2), and the discontinuity is also related to the medial axis  [28] of the in-collision space. Whenever a point crosses the medial axis, a discontinuity occurs. Since the medial axis has at least two nearest points on the boundary, there exists a sudden transition from one nearest point on the boundary to another when a query point crosses the medial axis (see Fig. 1). In the case of separation distance computation, a continuity can be guaranteed by using strictly convex objects such as sphere–torus patches bounding volumes (STPBVs)  [29] or 
                           k
                        -IOS  [30], but it does not work for penetration depth computation.

The necessity for an alternative solution is obvious. If we have a new metric 
                           
                              
                                 
                                    dist
                                 
                              
                              
                                 ˜
                              
                           
                           
                              (
                              ⋅
                              ,
                              ⋅
                              )
                           
                        , and under this metric Eq. (2) becomes a simple-valued mapping, there will be only one configuration in the contact space that realizes the penetration depth, and it is continuous. In order to simplify our derivation, we assume that the contact space is homeomorphic to a sphere. This assumption corresponds to the contact spaces used in our benchmarking models shown in Section  6. Unlike the explicit metric given in Eq. (3), our new metric is implicitly defined via an intermediate spherical space. Moreover, the medial axis of a sphere is reduced to a simple point (its center), which motivates us to choose spherical space as the intermediate space.

Now, we present our continuous penetration depth formulation using the contact space and the spherical space transformation. Let 
                           
                              (4)
                              
                                 ϕ
                                 :
                                 S
                                 ↦
                                 
                                    
                                       C
                                    
                                    
                                       
                                          cont
                                       
                                    
                                 
                              
                           
                         be a bijective mapping that maps a point of the spherical space 
                           S
                         onto the one on the contact space 
                           
                              
                                 C
                              
                              
                                 
                                    cont
                                 
                              
                           
                        . Assume that there exists another bijective mapping 
                           
                              (5)
                              
                                 φ
                                 :
                                 
                                    enc
                                 
                                 
                                    (
                                    S
                                    )
                                 
                                 ↦
                                 
                                    enc
                                 
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          
                                             cont
                                          
                                       
                                    
                                    )
                                 
                              
                           
                         that maps the space enclosed by 
                           S
                         onto the one enclosed by 
                           
                              
                                 C
                              
                              
                                 
                                    cont
                                 
                              
                           
                        , where 
                           
                              enc
                           
                         is the set of all points enclosed by a space including the space boundary. Given the new metric 
                           
                              (6)
                              
                                 
                                    
                                       
                                          dist
                                       
                                    
                                    
                                       ˜
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       q
                                    
                                    )
                                 
                                 =
                                 
                                    dist
                                 
                                 
                                    (
                                    
                                       
                                          φ
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                       
                                          ϕ
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          q
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         our new measure of the penetration depth can be analogously defined as 
                           
                              (7)
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       0
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 ϕ
                                 
                                    (
                                    
                                       
                                          
                                             argmin
                                          
                                       
                                       
                                          
                                             q
                                          
                                          ∈
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   cont
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             dist
                                          
                                       
                                       
                                          ˜
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          q
                                       
                                       )
                                    
                                    )
                                 
                              
                           
                         and 
                           
                              (8)
                              
                                 
                                    |
                                    PD
                                    
                                       (
                                       A
                                       
                                          (
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       ,
                                       B
                                       )
                                    
                                    |
                                 
                                 =
                                 
                                    dist
                                 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                       
                                          C
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                           
                         is an in-collision configuration, 
                           
                              q
                           
                         is a configuration that lies on the contact space 
                           
                              
                                 C
                              
                              
                                 
                                    cont
                                 
                              
                           
                        , and 
                           
                              dist
                           
                           
                              (
                              ⋅
                              ,
                              ⋅
                              )
                           
                         is defined by Eq. (3).


                        Fig. 2
                         illustrates our new definition and its geometric interpretation. Intuitively, 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                              
                                 S
                              
                           
                           =
                           
                              
                                 ϕ
                              
                              
                                 −
                                 1
                              
                           
                           
                              (
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    0
                                 
                                 
                                    C
                                 
                              
                              )
                           
                         is obtained by finding the nearest point in the intermediate space 
                           S
                         from 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                           
                        , and its image in 
                           
                              
                                 C
                              
                              
                                 
                                    cont
                                 
                              
                           
                         is computed using the bijective mapping 
                           ϕ
                        . If the intermediate space is the same as 
                           
                              
                                 C
                              
                              
                                 
                                    cont
                                 
                              
                           
                        , it is the same as the conventional penetration depth formulation given in Eqs. (1) and (2).


                        
                           Theorem 1
                           
                              Our new PD formulation defined in Eqs.   (5)–(8)   is continuous for any given in-collision configuration 
                              
                                 q
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       
                                          col
                                       
                                    
                                 
                               
                              (except the sphere center).
                           


                        
                           Proof
                           Based on an assumption that the bijective mapping 
                                 ϕ
                                 :
                                 S
                                 ↦
                                 
                                    
                                       C
                                    
                                    
                                       
                                          cont
                                       
                                    
                                 
                               is continuous, so is its inverse mapping 
                                 
                                    
                                       ϕ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 :
                                 
                                    
                                       C
                                    
                                    
                                       
                                          cont
                                       
                                    
                                 
                                 ↦
                                 S
                              . For any in-collision configuration point 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       0
                                    
                                 
                               undergoing a continuous motion, the Euclidean distance from the configuration to the spherical space is 
                                 
                                    (9)
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                q
                                             
                                             ∈
                                             S
                                          
                                       
                                       
                                          dist
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             q
                                          
                                          )
                                       
                                       =
                                       r
                                       −
                                       
                                          ‖
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ‖
                                       
                                       ,
                                    
                                 
                               where 
                                 r
                               is the sphere radius. It is obvious that this distance is continuous for any 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       0
                                    
                                 
                               (except the sphere center). The nearest point that realizes this distance is 
                                 
                                    (10)
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             0
                                          
                                          
                                             S
                                          
                                       
                                       =
                                       r
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                ‖
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ‖
                                             
                                          
                                       
                                       .
                                    
                                 
                               It is not difficult to understand that, for any given continuous query 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       0
                                    
                                 
                               except the sphere center, its nearest point 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       0
                                    
                                    
                                       S
                                    
                                 
                               is continuous. Since the bijective mapping 
                                 ϕ
                                 :
                                 S
                                 ↦
                                 
                                    
                                       C
                                    
                                    
                                       
                                          cont
                                       
                                    
                                 
                               is continuous, the nearest point in the contact space 
                                 
                                    
                                       C
                                    
                                    
                                       
                                          cont
                                       
                                    
                                 
                               is continuous (Eq. (7)). Then its distance computed using the nearest point (Eq. (8)) is continuous.□

The sphere center is a singular point that has an infinite number of nearest points on the spherical space. However, we can easily handle this problem by avoiding going through the sphere center.


                        Fig. 3
                         illustrates the intuitive interpretation of continuity. When the object 
                           A
                         moves along a continuous path (red) which connects 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 2
                              
                           
                        , the witness (nearest) point that realizes the minimum distance in the spherical space continuously moves from 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 1
                              
                              
                                 S
                              
                           
                         to 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 2
                              
                              
                                 S
                              
                           
                         (blue path), while the witness point of the contact space that realizes the final PD moves continuously from 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 1
                              
                              
                                 C
                              
                           
                         to 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 2
                              
                              
                                 C
                              
                           
                         (green path).


                        
                           
                              
                           
                        
                     

Our algorithm consists of two main phases: (a) precomputation, and (b) runtime PD query.


                        Precomputation: For two given intersecting objects, we precompute their contact space and then compute its spherical space transformation. The time complexity of exact contact space computation in three dimensions can be very high for two non-convex input models. Thus we use binary classification techniques to efficiently approximate the contact space. Then we use a spherical parameterization to compute the space transformation between the approximate contact space and the spherical space.


                        Runtime query: After computing the contact space and spherical parameterization, we embed the contact space into the space enclosed by the spherical space under appropriate alignment. Given a query 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                           
                        , we first search the spherical space for a point 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                              
                                 S
                              
                           
                         that has the minimum distance. An image 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                              
                                 C
                              
                           
                         in the contact space can be uniquely found for the point of the spherical space. Finally, the distance between 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                              
                                 C
                              
                           
                         is computed using an appropriate metric dist(
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 0
                              
                              
                                 C
                              
                           
                        ).

The corresponding pseudocode is given in Algorithm 1.

The time complexity of exact contact space computation in three dimensions can be as high as 
                           O
                           
                              (
                              
                                 
                                    m
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    n
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         for a translational PD, where 
                           m
                         and 
                           n
                         are the number of triangles for two non-convex input models. Given the high complexity of exact contact space computation, many approximate algorithms have been proposed  [25,31,5]. However, these methods are either too slow or they generate only a local contact space approximation. Here, we use a new method suggested in  [27] to approximate the contact space. To guarantee consistent continuity, we assume that the resulting approximation is homeomorphic to the exact contact space. Our method uses a binary classification algorithm to accelerate the computation of the contact space.

The algorithm is illustrated in Fig. 4
                        . For a pair of objects 
                           A
                         and 
                           B
                         (Fig. 4(a)), our goal is to compute their contact space (Fig. 4(b)). We first uniformly generate a small set of configuration samples in a subspace of 
                           C
                        -space that covers the entire in-collision space 
                           
                              
                                 C
                              
                              
                                 
                                    col
                                 
                              
                           
                         (Fig. 4(c)). Next, we classify these configurations into two classes, the collision-free class (
                           
                              
                                 C
                              
                              
                                 
                                    free
                                 
                              
                           
                        ) or the in-collision class (
                           
                              
                                 C
                              
                              
                                 
                                    col
                                 
                              
                           
                        ), by performing exact collision detection at the sampled configurations. Using the classified configuration samples, an initial approximation of the contact space (Fig. 4(d)) is computed using a binary classifier based on support vector machines (SVMs). However, since this initial approximation is too coarse to be used immediately, we add more new samples to refine the classification model (Fig. 4(e)). Then we update the approximation (the black curve in Fig. 4(e)). This sampling process can be further accelerated using active machine learning techniques such as  [27].

A support vector machine (SVM) is a classification technique. It is straightforward to implement and computationally efficient.

As shown in Fig. 5
                           , the core of an SVM is to use a mapping that transforms the original data in the input space to data in the feature space, so that the classification in the input space is reduced to a linearly separable problem in the feature space. Then the optimal separating hyperplane in the feature space is mapped back into the input space via its inverse mapping. Though the separating hyperplane is linear in the feature space, the resulting surface in the input space can have a very high complexity. Let 
                              Φ
                            be a mapping function from input 
                              C
                           -Space (configuration space) into a feature space 
                              H
                           . We assume 
                              C
                            to be 
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 n
                                 ≤
                                 3
                                 )
                              
                            and 
                              H
                            to be 
                              R
                           . Let 
                              K
                              
                                 (
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                              =
                              
                                 〈
                                 Φ
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ,
                                 Φ
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 〉
                              
                            be the kernel function. Essentially, 
                              K
                            is a function used to calculate inner products in the feature space. In our algorithm, we use the radial basis function (RBF) as the kernel: 
                              
                                 (11)
                                 
                                    K
                                    
                                       (
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    =
                                    exp
                                    
                                       (
                                       γ
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                            where 
                              γ
                            is a positive parameter. Then the classifier can be modeled using an function 
                              
                                 (12)
                                 
                                    f
                                    
                                       (
                                       
                                          q
                                       
                                       )
                                    
                                    =
                                    
                                       w
                                    
                                    ⋅
                                    Φ
                                    
                                       (
                                       
                                          q
                                       
                                       )
                                    
                                    +
                                    b
                                    ,
                                 
                              
                            where 
                              
                                 w
                              
                              ∈
                              H
                            and 
                              b
                              ∈
                              R
                           . 
                              f
                              
                                 (
                                 
                                    q
                                 
                                 )
                              
                              =
                              0
                            is called a decision boundary. The formulation can be rewritten as 
                              
                                 (13)
                                 
                                    f
                                    
                                       (
                                       
                                          q
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    K
                                    
                                       (
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          q
                                       
                                       )
                                    
                                    +
                                    b
                                    ,
                                 
                              
                            where 
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              ≥
                              0
                           . A few of the 
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                            are non-zero, and the corresponding 
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                 
                              
                            are the support vectors. The 
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                            are collision states (either 
                              −
                              1
                            or 
                              +
                              1
                           ). This SVM problem can be solved using a sequential minimal optimization (SMO) algorithm  [32,33]. For more details on SVMs, we refer readers to  [34,35].

We propose a tree-based method for efficiently adding new samples in the configuration space and refining the initial contact space approximation. As shown in Fig. 6
                           , an octree is first constructed for the decision boundary of the initial SVM model. For each node in the tree, we predict the collision states of its center and all the neighbor corners using the initial SVM model 
                              f
                              
                                 (
                                 
                                    q
                                 
                                 )
                              
                           . If these states do not have identical signs and the distance from the node center to the decision boundary (
                              f
                              
                                 (
                                 
                                    q
                                 
                                 )
                              
                              =
                              0
                           ) is larger than a threshold, the node needs to be further split. Since 
                              f
                              
                                 (
                                 
                                    q
                                 
                                 )
                              
                            is a zero set function, it is non-trivial to compute the exact distance to the decision boundary. Therefore, we use the following strategy to compute the lower bound of distance for a given configuration. The idea is based on an observation that it is trivial to compute the distance from 
                              
                                 q
                              
                            to 
                              f
                              
                                 (
                                 
                                    q
                                 
                                 )
                              
                              =
                              0
                            in the feature space, where 
                              f
                              
                                 (
                                 
                                    q
                                 
                                 )
                              
                              =
                              0
                            is in the form of a hyperplane: 
                              
                                 (14)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          f
                                          t
                                       
                                    
                                    =
                                    
                                    
                                       dist
                                    
                                    
                                       (
                                       Φ
                                       
                                          (
                                          
                                             q
                                          
                                          )
                                       
                                       ,
                                         HyperPlane
                                       
                                          (
                                          
                                             w
                                          
                                          ,
                                          b
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                    
                                       
                                          
                                             |
                                             
                                                w
                                             
                                             ⋅
                                             Φ
                                             
                                                (
                                                
                                                   q
                                                
                                                )
                                             
                                             +
                                             b
                                             |
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      w
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             |
                                             f
                                             
                                                (
                                                
                                                   q
                                                
                                                )
                                             
                                             |
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      j
                                                   
                                                
                                                K
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            Since we use the RBF as the kernel, the distance 
                              
                                 
                                    d
                                 
                                 
                                    f
                                    t
                                 
                              
                            in the feature space corresponds to a lower bound of the distance 
                              
                                 
                                    d
                                 
                                 
                                    i
                                    n
                                 
                              
                            in the input space: 
                              
                                 (15)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          n
                                       
                                    
                                    ≥
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          γ
                                       
                                    
                                    ln
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   f
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            After the tree structure is computed, the centers of all the leaf nodes are the candidates for new samples near the decision boundary. We use a 
                              k
                           -centroid clustering algorithm to select the required number of samples from these candidates.

To further accelerate the computation, we can use active learning and non-uniform sampling techniques  [27].

Given an SVM model and its decision boundary 
                           f
                           
                              (
                              
                                 q
                              
                              )
                           
                           =
                           0
                        , we convert it into a triangular mesh and perform mesh parameterization. A parameterization is a bijective mapping between a surface and a parameter domain. If the surface and the parameter domain have the same topology, then such a bijective mapping is guaranteed to exist. For this reason, we assume that the resulting contact space is homeomorphic to a sphere, and we apply spherical parameterization to the contact space.

Since any compact convex space with a non-empty interior is homeomorphic to a closed ball  [36], a spherical parameterization for a convex contact space can be easily computed by projecting each point of 
                              
                                 
                                    C
                                 
                                 
                                    
                                       cont
                                    
                                 
                              
                            onto the sphere along the radial direction. 
                              ϕ
                              :
                              S
                              ↦
                              
                                 
                                    C
                                 
                                 
                                    
                                       cont
                                    
                                 
                              
                            can be expressed as follows: 
                              
                                 (16)
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          q
                                       
                                       )
                                    
                                    =
                                    r
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      q
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       q
                                    
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          
                                             cont
                                          
                                       
                                    
                                    .
                                 
                              
                            Due to convexity, the simple projection 
                              ϕ
                              :
                              S
                              ↦
                              
                                 
                                    C
                                 
                                 
                                    
                                       cont
                                    
                                 
                              
                            is bicontinuous.

Here, we consider the contact space embedding in 
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                            and the intermediate space being a spherical surface in 
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           . Given a contact surface 
                              
                                 
                                    C
                                 
                                 
                                    
                                       cont
                                    
                                 
                              
                           , the spherical parameterization is to find a continuous invertible map 
                              ϕ
                              :
                              S
                              ↦
                              
                                 
                                    C
                                 
                                 
                                    
                                       cont
                                    
                                 
                              
                            from a sphere 
                              S
                            to the contact surface 
                              
                                 
                                    C
                                 
                                 
                                    
                                       cont
                                    
                                 
                              
                           . For a given approximate contact space represented by a mesh, the map is specified by assigning to each point 
                              
                                 q
                              
                            a parameterization 
                              
                                 
                                    ϕ
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    q
                                 
                                 )
                              
                              ∈
                              S
                           . Each mesh edge is mapped to a great circle arc, and each mesh triangle is mapped to a spherical triangle bounded by these arcs. If we assume that contact surface 
                              
                                 
                                    C
                                 
                                 
                                    
                                       cont
                                    
                                 
                              
                            is homeomorphic to a sphere, then the map is continuous and one-to-one. To guarantee a valid spherical parameterization, each vertex position must be expressed as a convex combination of the positions of its neighbors projected on the sphere  [37]. Let 
                              
                                 (
                                 
                                    V
                                 
                                 ,
                                 
                                    E
                                 
                                 )
                              
                            be a mesh in 
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                            if the contact space is represented as a triangulation, where 
                              
                                 V
                              
                            is a set of vertices and 
                              
                                 E
                              
                            is a set of edges. The convex combination can be expressed with respect to the neighborhood of a vertex. 
                              
                                 (17)
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          V
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       0
                                       
                                       if  
                                       
                                       
                                          
                                             
                                                e
                                             
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ∉
                                       
                                          E
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       >
                                       0
                                       
                                       if  
                                       
                                       
                                          
                                             
                                                e
                                             
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ∈
                                       
                                          E
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       1
                                       ,
                                    
                                 
                              
                            where 
                              
                                 
                                    
                                       e
                                    
                                 
                                 
                                    i
                                    j
                                 
                              
                              ∈
                              
                                 E
                              
                            is the edge connecting 
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    i
                                 
                              
                            and its neighbor 
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    j
                                 
                              
                           .

Under the above convex condition, none of the triangles are allowed to overlap. In the 2D planar case, once the boundary of the triangulation has been fixed and the barycentric coordinates are chosen, the positions of the interior vertices are uniquely determined by solving a linear system. Uniqueness may not be guaranteed for the spherical case, which requires more constraints. First, the spherical triangulation may be controlled by choosing a proper set of symmetric weights. The above system can be expressed as a set of non-linear equations in terms of the vertices of a mesh after introducing 
                              k
                            auxiliary scaling variables 
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                            and spherical distance constraint 
                              
                                 
                                    v
                                 
                                 
                                    x
                                    ,
                                    i
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    v
                                 
                                 
                                    y
                                    ,
                                    i
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    v
                                 
                                 
                                    z
                                    ,
                                    i
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                            for any vertex 
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       y
                                       ,
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       z
                                       ,
                                       i
                                    
                                 
                                 )
                              
                           . 
                              
                                 (18)
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             x
                                             ,
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             v
                                          
                                          
                                             y
                                             ,
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             v
                                          
                                          
                                             z
                                             ,
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       1
                                       .
                                    
                                 
                              
                            These equations can be solved by iteratively minimizing the quadratic spring energy, 
                              
                                 (19)
                                 
                                    W
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      v
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      v
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                            To avoid degenerate scenarios and have fast convergence, we can anchor one or two vertices to a fixed position on the sphere. In our implementation, we choose the farthest vertex from the origin and map it to the closet point on the sphere. 
                              Theorem 2
                              
                                 
                                    ϕ
                                    :
                                    S
                                    ↦
                                    
                                       
                                          C
                                       
                                       
                                          
                                             cont
                                          
                                       
                                    
                                  
                                 is bicontinuous.
                              


                           
                              Proof
                              This directly follows from the assumption that the genus-zero contact space is homeomorphic to a sphere. Therefore, 
                                    ϕ
                                    :
                                    S
                                    ↦
                                    
                                       
                                          C
                                       
                                       
                                          
                                             cont
                                          
                                       
                                    
                                  is a bijection, 
                                    ϕ
                                    :
                                    S
                                    ↦
                                    
                                       
                                          C
                                       
                                       
                                          
                                             cont
                                          
                                       
                                    
                                  is continuous, and the inverse function 
                                    
                                       
                                          ϕ
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    :
                                    
                                       
                                          C
                                       
                                       
                                          
                                             cont
                                          
                                       
                                    
                                    ↦
                                    S
                                  is continuous (
                                    ϕ
                                    :
                                    S
                                    ↦
                                    
                                       
                                          C
                                       
                                       
                                          
                                             cont
                                          
                                       
                                    
                                  is an open mapping). At the same time, based on our assumption on the homeomorphism between 
                                    
                                       
                                          C
                                       
                                       
                                          
                                             cont
                                          
                                       
                                    
                                  and its approximation, the mapping between 
                                    
                                       
                                          C
                                       
                                       
                                          
                                             cont
                                          
                                       
                                    
                                  and its approximation is bicontinuous, too.□

Note that any continuous motion on the spherical space 
                              S
                            corresponds to a continuous trajectory on the approximate contact space 
                              
                                 
                                    C
                                 
                                 
                                    
                                       cont
                                    
                                 
                              
                            and corresponds to another continuous trajectory on the exact contact space 
                              
                                 
                                    C
                                 
                                 
                                    
                                       cont
                                    
                                 
                              
                            as long as the homeomorphism between these spaces remains valid.


                           Fig. 7
                            shows two examples of approximated contact space and their spherical parameterization. Note that we can use other spherical parameterization methods  [38] to compute 
                              ϕ
                            as long as it is a bijective mapping without local and global overlaps.

We use the approximated contact space and its corresponding spherical parameterization to perform runtime queries. Based on our new PD formulation (also refer to Fig. 2), a runtime query is very straightforward after space transformation. Given a configuration 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                        
                        ∈
                        
                           
                              C
                           
                           
                              
                                 col
                              
                           
                        
                     , we find the nearest point in the spherical space by projecting 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                        
                      along the radial direction. Let 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                           
                              S
                           
                        
                        ∈
                        S
                      be this nearest point. 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                           
                              S
                           
                        
                      can be computed using Eq. (10). Next, we search the spherical parameter domain for the spherical triangle containing 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                           
                              S
                           
                        
                     . Let this spherical triangle be 
                        
                           
                              
                                 v
                              
                           
                           
                              1
                           
                        
                        
                           
                              
                                 v
                              
                           
                           
                              2
                           
                        
                        
                           
                              
                                 v
                              
                           
                           
                              3
                           
                        
                     . We compute 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                           
                              S
                           
                        
                     ’s barycentric coordinates 
                        
                           (
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 3
                              
                           
                           )
                        
                      with respect to the spherical triangle 
                        
                           
                              
                                 v
                              
                           
                           
                              1
                           
                        
                        
                           
                              
                                 v
                              
                           
                           
                              2
                           
                        
                        
                           
                              
                                 v
                              
                           
                           
                              3
                           
                        
                     . Based on the spherical parameterization 
                        ϕ
                     , the corresponding triangle in the contact space is 
                        ϕ
                        
                           (
                           
                              
                                 
                                    v
                                 
                              
                              
                                 1
                              
                           
                           )
                        
                        ϕ
                        
                           (
                           
                              
                                 
                                    v
                                 
                              
                              
                                 2
                              
                           
                           )
                        
                        ϕ
                        
                           (
                           
                              
                                 
                                    v
                                 
                              
                              
                                 3
                              
                           
                           )
                        
                     . Using 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                           
                              S
                           
                        
                     ’s barycentric coordinates, the point of the contact space corresponding to the nearest point 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                           
                              S
                           
                        
                      is 
                        
                           (20)
                           
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    0
                                 
                                 
                                    C
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    1
                                 
                              
                              ϕ
                              
                                 (
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    w
                                 
                                 
                                    2
                                 
                              
                              ϕ
                              
                                 (
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    w
                                 
                                 
                                    3
                                 
                              
                              ϕ
                              
                                 (
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              .
                           
                        
                      Since the spherical parameterization is represented as a triangular mesh, the barycentric coordinates can be computed by 
                        
                           (21)
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 △
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       0
                                    
                                    
                                       S
                                    
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       3
                                    
                                 
                                 /
                                 △
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 △
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       0
                                    
                                    
                                       S
                                    
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       1
                                    
                                 
                                 /
                                 △
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 △
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       0
                                    
                                    
                                       S
                                    
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       2
                                    
                                 
                                 /
                                 △
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       3
                                    
                                 
                                 .
                              
                           
                        
                      We use bounding volume hierarchies and hashing techniques  [39] to accelerate the search for the triangle that contains 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                           
                              S
                           
                        
                     . Eventually, the PD magnitude can be computed using Eq. (8) for 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                           
                              C
                           
                        
                     . The runtime complexity to compute the PD is constant (e.g., 
                        O
                        
                           (
                           1
                           )
                        
                     ).

For now, we only consider the continuity for a configurations inside 
                        
                           
                              C
                           
                           
                              
                                 col
                              
                           
                        
                     . However, for a configuration 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                        
                        ∈
                        
                           
                              C
                           
                           
                              
                                 cont
                              
                           
                        
                     , its PD magnitude may not be a non-zero value. When a configuration moves from the collision-free space into the in-collision space or moves out of the in-collision space to the collision-free space, a discontinuity may occur. We illustrate this problem in Fig. 8
                     . Consider a continuous path from 
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                        
                      to 
                        
                           
                              
                                 q
                              
                           
                           
                              2
                           
                        
                      (
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              
                                 q
                              
                           
                           
                              2
                           
                        
                        ∈
                        
                           
                              C
                           
                           
                              
                                 cont
                              
                           
                        
                     ). For the configurations 
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              
                                 q
                              
                           
                           
                              2
                           
                        
                     , their nearest points in the spherical space 
                        S
                      are initially 
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                           
                              S
                           
                        
                      and 
                        
                           
                              
                                 q
                              
                           
                           
                              2
                           
                           
                              S
                           
                        
                     . Then the corresponding points in the contact space are 
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                           
                              C
                           
                        
                      and 
                        
                           
                              
                                 q
                              
                           
                           
                              2
                           
                           
                              C
                           
                        
                     . If 
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                           
                              C
                           
                        
                        ≠
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                        
                     , its PD magnitude will suddenly jump from zero to non-zero when 
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                        
                      moves from 
                        
                           
                              C
                           
                           
                              
                                 free
                              
                           
                        
                      into 
                        
                           
                              C
                           
                           
                              
                                 col
                              
                           
                        
                     . Similarly, when a point 
                        
                           
                              
                                 q
                              
                           
                           
                              2
                           
                        
                      moves out of 
                        
                           
                              C
                           
                           
                              
                                 col
                              
                           
                        
                      to 
                        
                           
                              C
                           
                           
                              
                                 free
                              
                           
                        
                     , the PD magnitude may suddenly jump from non-zero to zero.

This discontinuity problem is mainly caused by the distortion of spherical parameterization and by our assumption that the mapping 
                        
                           
                              φ
                           
                           
                              −
                              1
                           
                        
                      is self-mapping. As a result, for a configuration 
                        
                           
                              
                                 q
                              
                           
                           
                              0
                           
                        
                        ∈
                        
                           
                              C
                           
                           
                              
                                 cont
                              
                           
                        
                     , the nearest point is not necessary to be itself and its PD magnitude can be a non-zero value. In order to eliminate such discontinuity, we use the following strategies.


                     Move in 
                     
                        
                           
                              C
                           
                           
                              
                                 col
                              
                           
                        
                     : The discontinuity can be avoid by introducing a rotation to the mapping 
                        ϕ
                      between the spherical space and the contact space during a runtime query. As shown in Fig. 9
                     , for a move-in configuration 
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                        
                     , we first find the nearest point 
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                           
                              S
                           
                        
                      in the spherical space. At the same time, for 
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                        
                     , we search for its corresponding point 
                        
                           
                              ϕ
                           
                           
                              −
                              1
                           
                        
                        
                           (
                           
                              
                                 
                                    q
                                 
                              
                              
                                 1
                              
                           
                           )
                        
                      in the contact space using spherical mapping 
                        ϕ
                     . Then we rotate the spherical space by 
                        χ
                        
                           (
                           θ
                           )
                        
                      so that 
                        
                           
                              ϕ
                           
                           
                              −
                              1
                           
                        
                        
                           (
                           
                              
                                 
                                    q
                                 
                              
                              
                                 1
                              
                           
                           )
                        
                        =
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                           
                              S
                           
                        
                     . After applying the rotation to the spherical space, the nearest point is identical to the move-in point 
                        
                           
                              
                                 q
                              
                           
                           
                              1
                           
                        
                     , and the PD magnitude becomes zero. When a configuration moves deep inside the in-collision space, we gradually and continuously relax the rotation applied to the spherical space so that the point 
                        
                           
                              ϕ
                           
                           
                              −
                              1
                           
                        
                        
                           (
                           
                              
                                 
                                    q
                                 
                              
                              
                                 1
                              
                           
                           )
                        
                      is restored to the original position. If we let the restoring region be 
                        
                           [
                           0
                           ,
                           ε
                           ]
                        
                     , the following linear rotation allows us to continuously restore the original spherical space: 
                        
                           
                              
                                 
                                    S
                                 
                                 
                                    ′
                                 
                              
                              =
                              χ
                              
                                 (
                                 
                                    
                                       ε
                                       −
                                       
                                          |
                                          PD
                                          |
                                       
                                    
                                    
                                       ε
                                    
                                 
                                 θ
                                 )
                              
                              S
                              ,
                              
                              
                                 |
                                 PD
                                 |
                              
                              ∈
                              
                                 [
                                 0
                                 ,
                                 ε
                                 ]
                              
                              .
                           
                        
                      Here, 
                        
                           
                              S
                           
                           
                              ′
                           
                        
                      is the spherical space after rotation.


                     Move out of 
                     
                        
                           
                              C
                           
                           
                              
                                 col
                              
                           
                        
                     : The above strategy does not work for a configuration moving from the in-collision space to the collision-free space, because we have little knowledge about the transitioning contact configuration a priori. Instead, we use a linearly decreasing function to eliminate the discontinuity when the configuration leaves the in-collision space. As shown in Fig. 9, if we let 
                        
                           
                              
                                 q
                              
                           
                           
                              2
                           
                        
                      be a move-out configuration, the PD magnitude at the contact point 
                        
                           
                              
                                 q
                              
                           
                           
                              2
                           
                        
                      is 
                        
                           |
                           P
                           D
                           |
                        
                     . When two objects separate (i.e., the configuration moves out of the in-collision space), let the distance between them be 
                        d
                     . If their distance falls within a distance interval 
                        
                           [
                           0
                           ,
                           ε
                           ]
                        
                     , we use the following formulation to diminish the discontinuity:
                        
                           
                              
                                 
                                    
                                       |
                                       PD
                                       |
                                    
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    ε
                                    −
                                    d
                                 
                                 
                                    ε
                                 
                              
                              
                                 |
                                 PD
                                 |
                              
                              .
                           
                        
                      The new PD magnitude will gradually and continuously reduce to zero, and the nearest point will remain the same.

In this section, we give some implementation details, highlight the performance of our algorithm on some complex benchmarks, and compare our algorithm with prior techniques.

@&#IMPLEMENTATION@&#

We implemented our algorithm using C++ under Visual Studio 2010 and Windows 7. We use the following algorithms and libraries in our implementation. The performance is measured on a PC with 3.2 GHz Intel Core i7 CPU and 6G memory.


                        SVM-based classifier: We used the open SVM library SVMLIB  [33] for approximating the contact surface.


                        Collision detection: Bounding volume hierarchies (BVHs) are the most popular techniques and data structure to accelerate collision queries. Thus, we used the open library OBB-Tree  [40] for exact collision detection between polygonal objects.


                        Spherical parameterization: A non-manifold geometric library ARCHMIND
                           2
                        
                        
                           2
                           
                              http://www.cs.uoi.gr/~fudos/smi2011.html.
                         was used for spherical parameterization.


                        Others: We use the library PQP
                           3
                        
                        
                           3
                           
                              http://gamma.cs.unc.edu/SSV/.
                           [41] to perform distance computation. This is mainly used for avoiding discontinuity when a point moves from in-collision space to collision-free space. The open PD library PolyDepth
                           4
                        
                        
                           4
                           
                              https://code.google.com/p/polydepth/.
                           [5] based on local optimization and projection is used for comparison.

We used the following benchmarks to evaluate the performance of our algorithm. Some of them are shown in Figs. 10–13
                        
                        
                        
                        . It typically takes 0.5–3 s to approximate the contact space using the binary classification technique, including collision detection and solving the SVM classifier. It takes 2–10 s for spherical parameterization. The runtime query takes a nearly constant time, around 0.01 ms.

We analyze the continuity in these benchmarking scenarios. In Figs. 10–13, we use green curves to highlight the PD magnitude computed by our algorithm and gray curves to represent the result computed by PolyDepth. We use individual colors to illustrate each coordinate of the nearest point. The 
                           x
                        , 
                           y
                        , and 
                           z
                         coordinates are plotted in blue, red, and orange, respectively.


                        Hose versus point: The contact space between a model and a point is the model itself. Fig. 10 shows a hose model (4.2 K triangles) and its spherical parameterization. When a point undergoes a continuous path (from top to bottom) inside the model, the PD magnitude and nearest points are shown in Fig. 10(c)–(d).


                        Dragon versus sphere: Fig. 11 shows a dragon model and a sphere model, where the sphere undergoes a continuous motion. The dragon model consists of 214 K triangles and the sphere consists of 1.6 K triangles. The intermediate contact surface and its parameterization are shown in Fig. 11(b) and (c).


                        Cup versus spoon: We demonstrate our algorithm using the cup and spoon models. The cup and spoon consist of 1000 and 1344 triangles, respectively. In the top row of Fig. 12, the spoon is placed inside the cup and moves.


                        Buddha versus Buddha: Fig. 13(a) shows two Buddha models; one model is stationary and the other undergoes a continuous motion in the configuration space. Each Buddha model consists of 20 K triangles. The intermediate contact surface and parameterization are shown in Fig. 13(b) and (c).

In Section  2, we highlighted different techniques for PD computation. In order to better understand the difference between our algorithm and previous methods, we compared our algorithm with optimization-based methods  [9,10,5]. In these methods, a sequence of configuration samples on the contact space is iteratively computed until a local minimum configuration is found. The performance of these algorithms relies heavily upon the initial configuration guesses. Continuity is not guaranteed in these algorithms. As shown in Figs. 10–13, our PD algorithm provide continuous, smooth PD values compared to the most recent optimization-based method, PolyDepth  [5].

The intersecting volume-based method can obtain continuous PD magnitude and direction when the normal cones are well defined  [12,13]. However, it is not clear whether it can be extended to cases where normal cones are not defined. For instance, when one object is completely embedded inside the other object, the normal cones cannot be defined using the techniques suggested in  [13]. Growth distance  [14,15] can achieve continuous penetration depth for convex objects, but the property of continuity may not be preserved for non-convex objects.

Penetration depth computation is used in various collision response algorithms and many applications. Under the conditions of continuous motion, conventional penetration depth formulations exhibit a discontinuity with respect to the motion parameters, which can cause an instability in collision response. We have presented a new approach to computing the continuous penetration depth between polygonal models. The main idea is based on contact space approximation and spherical parameterization.

The overall approach is simple (see Algorithm 1). The basic components of our continuous penetration depth algorithm consist of the following routines: SVM-based classification, collision detection, nearest-neighbor computation, and spherical parameterization. Good implementations of these algorithms are readily available in public domain (see Section  6.1).

Our approach has a few limitations. The algorithm only handles translational penetration depth. Moreover, our algorithm currently computes an approximation to the continuous PD formulation in Eqs. (7) and (8), and its accuracy depends almost completely on the sufficiency of samples during classification. Without sufficient sampling, the assumption of homeomorphism between the exact contact space and its approximation may not be valid. For example, a dumbbell-shape contact space with a very thin neck may require very dense samples to preserve the shape using an SVM classifier; otherwise, the approximate contact space may contain two disconnected components. In this case, sampling techniques using adaptive and active strategies such as  [27] can be a very promising alternative. Our algorithm is based on an assumption that there is homeomorphism between the contact space and spherical space. This simplification brings about a few benefits in terms of reducing the problem complexity, but it can be challenging to extend to high-genus contact spaces. It is not very desirable for queries that require frequent recomputation of the contact space and the spherical parameterization since these two precomputation steps largely dominate the overall computation.

There are many avenues for future work. We would like to extend our algorithm to generalized penetration depth computation. The basic components of our precomputation and run-time phases (SVM-based classifier, collision detection, nearest-neighbor computation, and spherical parameterization) can be accelerated using GPU parallelism. It would be interesting to investigate the discontinuity with other PD formulations, such as intersecting volume  [12] and growth distance  [15] for non-convex models.

@&#ACKNOWLEDGMENTS@&#

This research was supported in part by ARO under contract W911NF-10-1-0506, by NSF awards 1000579 and 1117127. This research was supported in part by NRF in Korea (No. 2012R1A2A2A01046246, No. 2012R1A2A2A06047007).

@&#REFERENCES@&#

